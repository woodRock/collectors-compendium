/*! For license information please see main.54ac9ddc.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var r=n(853),i=n(43),a=n(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function h(e){if(l(e)!==e)throw Error(s(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var f=Object.assign,p=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),b=Symbol.for("react.consumer"),S=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope");var C=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var A=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var I=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var P=Symbol.for("react.client.reference");function N(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===P?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case _:return"Profiler";case y:return"StrictMode";case w:return"Suspense";case E:return"SuspenseList";case C:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case S:return e.displayName||"Context";case b:return(e._context.displayName||"Context")+".Consumer";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:N(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return N(e(t))}catch(ni){}}return null}var k=Array.isArray,L=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},U=[],F=-1;function z(e){return{current:e}}function B(e){0>F||(e.current=U[F],U[F]=null,F--)}function V(e,t){F++,U[F]=e.current,e.current=t}var H,j,G=z(null),W=z(null),q=z(null),X=z(null);function Y(e,t){switch(V(q,t),V(W,e),V(G,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=_h(t=yh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(G),V(G,e)}function K(){B(G),B(W),B(q)}function J(e){null!==e.memoizedState&&V(X,e);var t=G.current,n=_h(t,e.type);t!==n&&(V(W,e),V(G,n))}function Q(e){W.current===e&&(B(G),B(W)),X.current===e&&(B(X),hd._currentValue=O)}function Z(e){if(void 0===H)try{throw Error()}catch(ni){var t=ni.stack.trim().match(/\n( *(at )?)/);H=t&&t[1]||"",j=-1<ni.stack.indexOf("\n    at")?" (<anonymous>)":-1<ni.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+H+e+j}var $=!1;function ee(e,t){if(!e||$)return"";$=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(ni){var r=ni}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=r.DetermineComponentFrameRoot(),s=a[0],o=a[1];if(s&&o){var l=s.split("\n"),c=o.split("\n");for(i=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;if(r===l.length||i===c.length)for(r=l.length-1,i=c.length-1;1<=r&&0<=i&&l[r]!==c[i];)i--;for(;1<=r&&0<=i;r--,i--)if(l[r]!==c[i]){if(1!==r||1!==i)do{if(r--,0>--i||l[r]!==c[i]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=i);break}}}finally{$=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Z(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return Z(e.type);case 16:return Z("Lazy");case 13:return e.child!==t&&null!==t?Z("Suspense Fallback"):Z("Suspense");case 19:return Z("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return Z("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(ni){return"\nError generating stack: "+ni.message+"\n"+ni.stack}}var re=Object.prototype.hasOwnProperty,ie=r.unstable_scheduleCallback,ae=r.unstable_cancelCallback,se=r.unstable_shouldYield,oe=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,he=r.unstable_UserBlockingPriority,de=r.unstable_NormalPriority,fe=r.unstable_LowPriority,pe=r.unstable_IdlePriority,me=r.log,ge=r.unstable_setDisableYieldValue,ve=null,ye=null;function _e(e){if("function"===typeof me&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(Se(e)/xe|0)|0},Se=Math.log,xe=Math.LN2;var we=256,Ee=262144,Te=4194304;function Me(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,n){var r=e.pendingLanes;if(0===r)return 0;var i=0,a=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var o=134217727&r;return 0!==o?0!==(r=o&~a)?i=Me(r):0!==(s&=o)?i=Me(s):n||0!==(n=o&~e)&&(i=Me(n)):0!==(o=r&~a)?i=Me(o):0!==s?i=Me(s):n||0!==(n=r&~e)&&(i=Me(n)),0===i?0:0!==t&&t!==i&&0===(t&a)&&((a=i&-i)>=(n=t&-t)||32===a&&0!==(4194048&n))?t:i}function Ae(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Ie(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Re(){var e=Te;return 0===(62914560&(Te<<=1))&&(Te=4194304),e}function Pe(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ne(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function ke(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|261930&n}function Le(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-be(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function De(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Oe(n))&(e.suspendedLanes|t))?0:n}function Oe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ue(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Fe(){var e=D.p;return 0!==e?e:void 0===(e=window.event)?32:Cd(e.type)}function ze(e,t){var n=D.p;try{return D.p=e,t()}finally{D.p=n}}var Be=Math.random().toString(36).slice(2),Ve="__reactFiber$"+Be,He="__reactProps$"+Be,je="__reactContainer$"+Be,Ge="__reactEvents$"+Be,We="__reactListeners$"+Be,qe="__reactHandles$"+Be,Xe="__reactResources$"+Be,Ye="__reactMarker$"+Be;function Ke(e){delete e[Ve],delete e[He],delete e[Ge],delete e[We],delete e[qe]}function Je(e){var t=e[Ve];if(t)return t;for(var n=e.parentNode;n;){if(t=n[je]||n[Ve]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Uh(e);null!==e;){if(n=e[Ve])return n;e=Uh(e)}return t}n=(e=n).parentNode}return null}function Qe(e){if(e=e[Ve]||e[je]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Ze(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function $e(e){var t=e[Xe];return t||(t=e[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Ye]=!0}var tt=new Set,nt={};function rt(e,t){it(e,t),it(e+"Capture",t)}function it(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var at=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),st={},ot={};function lt(e,t,n){if(i=t,re.call(ot,i)||!re.call(st,i)&&(at.test(i)?ot[i]=!0:(st[i]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var i}function ct(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,r){if(null===r)e.removeAttribute(n);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+r)}}function ht(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function dt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ft(e){if(!e._valueTracker){var t=dt(e)?"checked":"value";e._valueTracker=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=dt(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,r,i,a,s,o){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ht(t)):e.value!==""+ht(t)&&(e.value=""+ht(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?bt(e,s,ht(t)):null!=n?bt(e,s,ht(n)):null!=r&&e.removeAttribute("value"),null==i&&null!=a&&(e.defaultChecked=!!a),null!=i&&(e.checked=i&&"function"!==typeof i&&"symbol"!==typeof i),null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o?e.name=""+ht(o):e.removeAttribute("name")}function _t(e,t,n,r,i,a,s,o){if(null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.type=a),null!=t||null!=n){if(!("submit"!==a&&"reset"!==a||void 0!==t&&null!==t))return void ft(e);n=null!=n?""+ht(n):"",t=null!=t?""+ht(t):n,o||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:i)&&"symbol"!==typeof r&&!!r,e.checked=o?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s),ft(e)}function bt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function St(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ht(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function xt(e,t,n){null==t||((t=""+ht(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+ht(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,n,r){if(null==t){if(null!=r){if(null!=n)throw Error(s(92));if(k(r)){if(1<r.length)throw Error(s(93));r=r[0]}n=r}null==n&&(n=""),t=n}n=ht(t),e.defaultValue=n,(r=e.textContent)===n&&""!==r&&null!==r&&(e.value=r),ft(e)}function Et(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Tt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(e,t,n){var r=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,n):"number"!==typeof n||0===n||Tt.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Ct(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=n){for(var r in n)!n.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var i in t)r=t[i],t.hasOwnProperty(i)&&n[i]!==r&&Mt(e,i,r)}else for(var a in t)t.hasOwnProperty(a)&&Mt(e,a,t[a])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var It=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Pt(e){return Rt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Nt(){}var kt=null;function Lt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Dt=null,Ot=null;function Ut(e){var t=Qe(e);if(t&&(e=t.stateNode)){var n=e[He]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=r[He]||null;if(!i)throw Error(s(90));yt(r,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<n.length;t++)(r=n[t]).form===e.form&&pt(r)}break e;case"textarea":xt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&St(e,!!n.multiple,t,!1)}}}var Ft=!1;function zt(e,t,n){if(Ft)return e(t,n);Ft=!0;try{return e(t)}finally{if(Ft=!1,(null!==Dt||null!==Ot)&&(eu(),Dt&&(t=Dt,e=Ot,Ot=Dt=null,Ut(t),e)))for(t=0;t<e.length;t++)Ut(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var r=n[He]||null;if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Vt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),Ht=!1;if(Vt)try{var jt={};Object.defineProperty(jt,"passive",{get:function(){Ht=!0}}),window.addEventListener("test",jt,jt),window.removeEventListener("test",jt,jt)}catch(Zd){Ht=!1}var Gt=null,Wt=null,qt=null;function Xt(){if(qt)return qt;var e,t,n=Wt,r=n.length,i="value"in Gt?Gt.value:Gt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return qt=i.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function Jt(){return!1}function Qt(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Kt:Jt,this.isPropagationStopped=Jt,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var Zt,$t,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Qt(tn),rn=f({},tn,{view:0,detail:0}),an=Qt(rn),sn=f({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Zt=e.screenX-en.screenX,$t=e.screenY-en.screenY):$t=Zt=0,en=e),Zt)},movementY:function(e){return"movementY"in e?e.movementY:$t}}),on=Qt(sn),ln=Qt(f({},sn,{dataTransfer:0})),cn=Qt(f({},rn,{relatedTarget:0})),un=Qt(f({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),hn=Qt(f({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),dn=Qt(f({},tn,{data:0})),fn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function vn(){return gn}var yn=Qt(f({},rn,{key:function(e){if(e.key){var t=fn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?pn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),_n=Qt(f({},sn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),bn=Qt(f({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),Sn=Qt(f({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),xn=Qt(f({},sn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),wn=Qt(f({},tn,{newState:0,oldState:0})),En=[9,13,27,32],Tn=Vt&&"CompositionEvent"in window,Mn=null;Vt&&"documentMode"in document&&(Mn=document.documentMode);var Cn=Vt&&"TextEvent"in window&&!Mn,An=Vt&&(!Tn||Mn&&8<Mn&&11>=Mn),In=String.fromCharCode(32),Rn=!1;function Pn(e,t){switch(e){case"keyup":return-1!==En.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var kn=!1;var Ln={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ln[e.type]:"textarea"===t}function On(e,t,n,r){Dt?Ot?Ot.push(r):Ot=[r]:Dt=r,0<(t=ih(t,"onChange")).length&&(n=new nn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Un=null,Fn=null;function zn(e){Ju(e,0)}function Bn(e){if(pt(Ze(e)))return e}function Vn(e,t){if("change"===e)return t}var Hn=!1;if(Vt){var jn;if(Vt){var Gn="oninput"in document;if(!Gn){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Gn="function"===typeof Wn.oninput}jn=Gn}else jn=!1;Hn=jn&&(!document.documentMode||9<document.documentMode)}function qn(){Un&&(Un.detachEvent("onpropertychange",Xn),Fn=Un=null)}function Xn(e){if("value"===e.propertyName&&Bn(Fn)){var t=[];On(t,Fn,e,Lt(e)),zt(zn,t)}}function Yn(e,t,n){"focusin"===e?(qn(),Fn=n,(Un=t).attachEvent("onpropertychange",Xn)):"focusout"===e&&qn()}function Kn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Fn)}function Jn(e,t){if("click"===e)return Bn(t)}function Qn(e,t){if("input"===e||"change"===e)return Bn(t)}var Zn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function $n(e,t){if(Zn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!re.call(t,i)||!Zn(e[i],t[i]))return!1}return!0}function er(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function tr(e,t){var n,r=er(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=er(r)}}function nr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rr(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ir(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ar=Vt&&"documentMode"in document&&11>=document.documentMode,sr=null,or=null,lr=null,cr=!1;function ur(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;cr||null==sr||sr!==mt(r)||("selectionStart"in(r=sr)&&ir(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},lr&&$n(lr,r)||(lr=r,0<(r=ih(or,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=sr)))}function hr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var dr={animationend:hr("Animation","AnimationEnd"),animationiteration:hr("Animation","AnimationIteration"),animationstart:hr("Animation","AnimationStart"),transitionrun:hr("Transition","TransitionRun"),transitionstart:hr("Transition","TransitionStart"),transitioncancel:hr("Transition","TransitionCancel"),transitionend:hr("Transition","TransitionEnd")},fr={},pr={};function mr(e){if(fr[e])return fr[e];if(!dr[e])return e;var t,n=dr[e];for(t in n)if(n.hasOwnProperty(t)&&t in pr)return fr[e]=n[t];return e}Vt&&(pr=document.createElement("div").style,"AnimationEvent"in window||(delete dr.animationend.animation,delete dr.animationiteration.animation,delete dr.animationstart.animation),"TransitionEvent"in window||delete dr.transitionend.transition);var gr=mr("animationend"),vr=mr("animationiteration"),yr=mr("animationstart"),_r=mr("transitionrun"),br=mr("transitionstart"),Sr=mr("transitioncancel"),xr=mr("transitionend"),wr=new Map,Er="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(e,t){wr.set(e,t),rt(t,[e])}Er.push("scrollEnd");var Mr="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Cr=[],Ar=0,Ir=0;function Rr(){for(var e=Ar,t=Ir=Ar=0;t<e;){var n=Cr[t];Cr[t++]=null;var r=Cr[t];Cr[t++]=null;var i=Cr[t];Cr[t++]=null;var a=Cr[t];if(Cr[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==a&&Lr(n,i,a)}}function Pr(e,t,n,r){Cr[Ar++]=e,Cr[Ar++]=t,Cr[Ar++]=n,Cr[Ar++]=r,Ir|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Nr(e,t,n,r){return Pr(e,t,n,r),Dr(e)}function kr(e,t){return Pr(e,null,null,t),Dr(e)}function Lr(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(r=a.alternate)&&(r.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;return 3===e.tag?(a=e.stateNode,i&&null!==t&&(i=31-be(n),null===(r=(e=a.hiddenUpdates)[i])?e[i]=[t]:r.push(t),t.lane=536870912|n),a):null}function Dr(e){if(50<Wc)throw Wc=0,qc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Or={};function Ur(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fr(e,t,n,r){return new Ur(e,t,n,r)}function zr(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Br(e,t){var n=e.alternate;return null===n?((n=Fr(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Vr(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hr(e,t,n,r,i,a){var o=0;if(r=e,"function"===typeof e)zr(e)&&(o=1);else if("string"===typeof e)o=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,G.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Fr(31,n,t,i)).elementType=C,e.lanes=a,e;case v:return jr(n.children,i,a,t);case y:o=8,i|=24;break;case _:return(e=Fr(12,n,t,2|i)).elementType=_,e.lanes=a,e;case w:return(e=Fr(13,n,t,i)).elementType=w,e.lanes=a,e;case E:return(e=Fr(19,n,t,i)).elementType=E,e.lanes=a,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:o=10;break e;case b:o=9;break e;case x:o=11;break e;case T:o=14;break e;case M:o=16,r=null;break e}o=29,n=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Fr(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function jr(e,t,n,r){return(e=Fr(7,e,r,t)).lanes=n,e}function Gr(e,t,n){return(e=Fr(6,e,null,t)).lanes=n,e}function Wr(e){var t=Fr(18,null,null,0);return t.stateNode=e,t}function qr(e,t,n){return(t=Fr(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Xr=new WeakMap;function Yr(e,t){if("object"===typeof e&&null!==e){var n=Xr.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Xr.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Kr=[],Jr=0,Qr=null,Zr=0,$r=[],ei=0,ti=null,ri=1,ii="";function ai(e,t){Kr[Jr++]=Zr,Kr[Jr++]=Qr,Qr=e,Zr=t}function si(e,t,n){$r[ei++]=ri,$r[ei++]=ii,$r[ei++]=ti,ti=e;var r=ri;e=ii;var i=32-be(r)-1;r&=~(1<<i),n+=1;var a=32-be(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,ri=1<<32-be(t)+i|n<<i|r,ii=a+e}else ri=1<<a|n<<i|r,ii=e}function oi(e){null!==e.return&&(ai(e,1),si(e,1,0))}function li(e){for(;e===Qr;)Qr=Kr[--Jr],Kr[Jr]=null,Zr=Kr[--Jr],Kr[Jr]=null;for(;e===ti;)ti=$r[--ei],$r[ei]=null,ii=$r[--ei],$r[ei]=null,ri=$r[--ei],$r[ei]=null}function ci(e,t){$r[ei++]=ri,$r[ei++]=ii,$r[ei++]=ti,ri=t.id,ii=t.overflow,ti=e}var ui=null,hi=null,di=!1,fi=null,pi=!1,mi=Error(s(519));function gi(e){throw xi(Yr(Error(s(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),mi}function vi(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ve]=e,t[He]=r,n){case"dialog":Qu("cancel",t),Qu("close",t);break;case"iframe":case"object":case"embed":Qu("load",t);break;case"video":case"audio":for(n=0;n<Yu.length;n++)Qu(Yu[n],t);break;case"source":Qu("error",t);break;case"img":case"image":case"link":Qu("error",t),Qu("load",t);break;case"details":Qu("toggle",t);break;case"input":Qu("invalid",t),_t(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case"select":Qu("invalid",t);break;case"textarea":Qu("invalid",t),wt(t,r.value,r.defaultValue,r.children)}"string"!==typeof(n=r.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===r.suppressHydrationWarning||uh(t.textContent,n)?(null!=r.popover&&(Qu("beforetoggle",t),Qu("toggle",t)),null!=r.onScroll&&Qu("scroll",t),null!=r.onScrollEnd&&Qu("scrollend",t),null!=r.onClick&&(t.onclick=Nt),t=!0):t=!1,t||gi(e,!0)}function yi(e){for(ui=e.return;ui;)switch(ui.tag){case 5:case 31:case 13:return void(pi=!1);case 27:case 3:return void(pi=!0);default:ui=ui.return}}function _i(e){if(e!==ui)return!1;if(!di)return yi(e),di=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||bh(e.type,e.memoizedProps)),t=!t),t&&hi&&gi(e),yi(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));hi=Oh(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));hi=Oh(e)}else 27===n?(n=hi,Ch(e.type)?(e=Dh,Dh=null,hi=e):hi=n):hi=ui?Lh(e.stateNode.nextSibling):null;return!0}function bi(){hi=ui=null,di=!1}function Si(){var e=fi;return null!==e&&(null===Pc?Pc=e:Pc.push.apply(Pc,e),fi=null),e}function xi(e){null===fi?fi=[e]:fi.push(e)}var wi=z(null),Ei=null,Ti=null;function Mi(e,t,n){V(wi,t._currentValue),t._currentValue=n}function Ci(e){e._currentValue=wi.current,B(wi)}function Ai(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ii(e,t,n,r){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var a=i.dependencies;if(null!==a){var o=i.child;a=a.firstContext;e:for(;null!==a;){var l=a;a=i;for(var c=0;c<t.length;c++)if(l.context===t[c]){a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ai(a.return,n,e),r||(o=null);break e}a=l.next}}else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=n,null!==(a=o.alternate)&&(a.lanes|=n),Ai(o,n,e),o=null}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===e){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}}function Ri(e,t,n,r){e=null;for(var i=t,a=!1;null!==i;){if(!a)if(0!==(524288&i.flags))a=!0;else if(0!==(262144&i.flags))break;if(10===i.tag){var o=i.alternate;if(null===o)throw Error(s(387));if(null!==(o=o.memoizedProps)){var l=i.type;Zn(i.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(i===X.current){if(null===(o=i.alternate))throw Error(s(387));o.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(hd):e=[hd])}i=i.return}null!==e&&Ii(t,e,n,r),t.flags|=262144}function Pi(e){for(e=e.firstContext;null!==e;){if(!Zn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ni(e){Ei=e,Ti=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function ki(e){return Di(Ei,e)}function Li(e,t){return null===Ei&&Ni(e),Di(e,t)}function Di(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Ti){if(null===e)throw Error(s(308));Ti=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ti=Ti.next=t;return n}var Oi="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Ui=r.unstable_scheduleCallback,Fi=r.unstable_NormalPriority,zi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Bi(){return{controller:new Oi,data:new Map,refCount:0}}function Vi(e){e.refCount--,0===e.refCount&&Ui(Fi,function(){e.controller.abort()})}var Hi=null,ji=0,Gi=0,Wi=null;function qi(){if(0===--ji&&null!==Hi){null!==Wi&&(Wi.status="fulfilled");var e=Hi;Hi=null,Gi=0,Wi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Xi=L.S;L.S=function(e,t){Lc=le(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===Hi){var n=Hi=[];ji=0,Gi=ju(),Wi={status:"pending",value:void 0,then:function(e){n.push(e)}}}ji++,t.then(qi,qi)}(0,t),null!==Xi&&Xi(e,t)};var Yi=z(null);function Ki(){var e=Yi.current;return null!==e?e:mc.pooledCache}function Ji(e,t){V(Yi,null===t?Yi.current:t.pool)}function Qi(){var e=Ki();return null===e?null:{parent:zi._currentValue,pool:e}}var Zi=Error(s(460)),$i=Error(s(474)),ea=Error(s(542)),ta={then:function(){}};function na(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ra(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Nt,Nt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw oa(e=t.reason),e;default:if("string"===typeof t.status)t.then(Nt,Nt);else{if(null!==(e=mc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw oa(e=t.reason),e}throw aa=t,Zi}}function ia(e){try{return(0,e._init)(e._payload)}catch(ni){if(null!==ni&&"object"===typeof ni&&"function"===typeof ni.then)throw aa=ni,Zi;throw ni}}var aa=null;function sa(){if(null===aa)throw Error(s(459));var e=aa;return aa=null,e}function oa(e){if(e===Zi||e===ea)throw Error(s(483))}var la=null,ca=0;function ua(e){var t=ca;return ca+=1,null===la&&(la=[]),ra(la,e,t)}function ha(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function da(e,t){if(t.$$typeof===p)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function fa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Br(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=67108866,n):r:(t.flags|=67108866,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Gr(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===v?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===M&&ia(a)===t.type)?(ha(t=i(t,n.props),n),t.return=e,t):(ha(t=Hr(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=qr(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=jr(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Gr(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return ha(n=Hr(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=qr(t,e.mode,n)).return=e,t;case M:return d(e,t=ia(t),n)}if(k(t)||R(t))return(t=jr(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return d(e,ua(t),n);if(t.$$typeof===S)return d(e,Li(e,t),n);da(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===i?c(e,t,n,r):null;case g:return n.key===i?u(e,t,n,r):null;case M:return f(e,t,n=ia(n),r)}if(k(n)||R(n))return null!==i?null:h(e,t,n,r,null);if("function"===typeof n.then)return f(e,t,ua(n),r);if(n.$$typeof===S)return f(e,t,Li(e,n),r);da(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case m:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case g:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case M:return p(e,t,n,r=ia(r),i)}if(k(r)||R(r))return h(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return p(e,t,n,ua(r),i);if(r.$$typeof===S)return p(e,t,n,Li(t,r),i);da(t,r)}return null}function y(l,c,u,h){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var _=u.key;null!==c;){if(c.key===_){if((_=u.type)===v){if(7===c.tag){n(l,c.sibling),(h=i(c,u.props.children)).return=l,l=h;break e}}else if(c.elementType===_||"object"===typeof _&&null!==_&&_.$$typeof===M&&ia(_)===c.type){n(l,c.sibling),ha(h=i(c,u.props),u),h.return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}u.type===v?((h=jr(u.props.children,l.mode,h,u.key)).return=l,l=h):(ha(h=Hr(u.type,u.key,u.props,null,l.mode,h),u),h.return=l,l=h)}return o(l);case g:e:{for(_=u.key;null!==c;){if(c.key===_){if(4===c.tag&&c.stateNode.containerInfo===u.containerInfo&&c.stateNode.implementation===u.implementation){n(l,c.sibling),(h=i(c,u.children||[])).return=l,l=h;break e}n(l,c);break}t(l,c),c=c.sibling}(h=qr(u,l.mode,h)).return=l,l=h}return o(l);case M:return y(l,c,u=ia(u),h)}if(k(u))return function(i,s,o,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),s=a(v,s,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(i,h),di&&ai(i,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(i,o[m],l))&&(s=a(h,s,m),null===u?c=h:u.sibling=h,u=h);return di&&ai(i,m),c}for(h=r(h);m<o.length;m++)null!==(g=p(h,i,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),di&&ai(i,m),c}(l,c,u,h);if(R(u)){if("function"!==typeof(_=R(u)))throw Error(s(150));return function(i,o,l,c){if(null==l)throw Error(s(151));for(var u=null,h=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=f(i,m,y.value,c);if(null===_){null===m&&(m=v);break}e&&m&&null===_.alternate&&t(i,m),o=a(_,o,g),null===h?u=_:h.sibling=_,h=_,m=v}if(y.done)return n(i,m),di&&ai(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return di&&ai(i,g),u}for(m=r(m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=a(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach(function(e){return t(i,e)}),di&&ai(i,g),u}(l,c,u=_.call(u),h)}if("function"===typeof u.then)return y(l,c,ua(u),h);if(u.$$typeof===S)return y(l,c,Li(l,u),h);da(l,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==c&&6===c.tag?(n(l,c.sibling),(h=i(c,u)).return=l,l=h):(n(l,c),(h=Gr(u,l.mode,h)).return=l,l=h),o(l)):n(l,c)}return function(e,t,n,r){try{ca=0;var i=y(e,t,n,r);return la=null,i}catch(ni){if(ni===Zi||ni===ea)throw ni;var a=Fr(29,ni,null,e.mode);return a.lanes=r,a.return=e,a}}}var pa=fa(!0),ma=fa(!1),ga=!1;function va(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ya(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function _a(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ba(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&pc)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Dr(e),Lr(e,null,n),t}return Pr(e,r,t,n),Dr(e)}function Sa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Le(e,n)}}function xa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var wa=!1;function Ea(){if(wa){if(null!==Wi)throw Wi}}function Ta(e,t,n,r){wa=!1;var i=e.updateQueue;ga=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=-536870913&o.lane,p=d!==o.lane;if(p?(vc&d)===d:(r&d)===d){0!==d&&d===Gi&&(wa=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var m=e,g=o;d=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){h=m.call(v,h,d);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(d="function"===typeof(m=g.payload)?m.call(v,h,d):m)||void 0===d)break e;h=f({},h,d);break e;case 2:ga=!0}}null!==(d=o.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[d]:p.push(d))}else p={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=p,l=h):u=u.next=p,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(p=o).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===a&&(i.shared.lanes=0),Tc|=s,e.lanes=s,e.memoizedState=h}}function Ma(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function Ca(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ma(n[e],t)}var Aa=z(null),Ia=z(0);function Ra(e,t){V(Ia,e=wc),V(Aa,t),wc=e|t.baseLanes}function Pa(){V(Ia,wc),V(Aa,Aa.current)}function Na(){wc=Ia.current,B(Aa),B(Ia)}var ka=z(null),La=null;function Da(e){var t=e.alternate;V(Ba,1&Ba.current),V(ka,e),null===La&&(null===t||null!==Aa.current||null!==t.memoizedState)&&(La=e)}function Oa(e){V(Ba,Ba.current),V(ka,e),null===La&&(La=e)}function Ua(e){22===e.tag?(V(Ba,Ba.current),V(ka,e),null===La&&(La=e)):Fa()}function Fa(){V(Ba,Ba.current),V(ka,ka.current)}function za(e){B(ka),La===e&&(La=null),B(Ba)}var Ba=z(0);function Va(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Nh(n)||kh(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ha=0,ja=null,Ga=null,Wa=null,qa=!1,Xa=!1,Ya=!1,Ka=0,Ja=0,Qa=null,Za=0;function $a(){throw Error(s(321))}function es(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Zn(e[n],t[n]))return!1;return!0}function ts(e,t,n,r,i,a){return Ha=a,ja=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,L.H=null===e||null===e.memoizedState?vo:yo,Ya=!1,a=n(r,i),Ya=!1,Xa&&(a=rs(t,n,r,i)),ns(e),a}function ns(e){L.H=go;var t=null!==Ga&&null!==Ga.next;if(Ha=0,Wa=Ga=ja=null,qa=!1,Ja=0,Qa=null,t)throw Error(s(300));null===e||Lo||null!==(e=e.dependencies)&&Pi(e)&&(Lo=!0)}function rs(e,t,n,r){ja=e;var i=0;do{if(Xa&&(Qa=null),Ja=0,Xa=!1,25<=i)throw Error(s(301));if(i+=1,Wa=Ga=null,null!=e.updateQueue){var a=e.updateQueue;a.lastEffect=null,a.events=null,a.stores=null,null!=a.memoCache&&(a.memoCache.index=0)}L.H=_o,a=t(n,r)}while(Xa);return a}function is(){var e=L.H,t=e.useState()[0];return t="function"===typeof t.then?us(t):t,e=e.useState()[0],(null!==Ga?Ga.memoizedState:null)!==e&&(ja.flags|=1024),t}function as(){var e=0!==Ka;return Ka=0,e}function ss(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function os(e){if(qa){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}qa=!1}Ha=0,Wa=Ga=ja=null,Xa=!1,Ja=Ka=0,Qa=null}function ls(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Wa?ja.memoizedState=Wa=e:Wa=Wa.next=e,Wa}function cs(){if(null===Ga){var e=ja.alternate;e=null!==e?e.memoizedState:null}else e=Ga.next;var t=null===Wa?ja.memoizedState:Wa.next;if(null!==t)Wa=t,Ga=e;else{if(null===e){if(null===ja.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(Ga=e).memoizedState,baseState:Ga.baseState,baseQueue:Ga.baseQueue,queue:Ga.queue,next:null},null===Wa?ja.memoizedState=Wa=e:Wa=Wa.next=e}return Wa}function us(e){var t=Ja;return Ja+=1,null===Qa&&(Qa=[]),e=ra(Qa,e,t),t=ja,null===(null===Wa?t.memoizedState:Wa.next)&&(t=t.alternate,L.H=null===t||null===t.memoizedState?vo:yo),e}function hs(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return us(e);if(e.$$typeof===S)return ki(e)}throw Error(s(438,String(e)))}function ds(e){var t=null,n=ja.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=ja.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},ja.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function fs(e,t){return"function"===typeof t?t(e):t}function ps(e){return ms(cs(),Ga,e)}function ms(e,t,n){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=n;var i=e.baseQueue,a=r.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}t.baseQueue=i=a,r.pending=null}if(a=e.baseState,null===i)e.memoizedState=a;else{var l=o=null,c=null,u=t=i.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(vc&d)===d:(Ha&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Gi&&(h=!0);else{if((Ha&f)===f){u=u.next,f===Gi&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=a):c=c.next=d,ja.lanes|=f,Tc|=f}d=u.action,Ya&&n(a,d),a=u.hasEagerState?u.eagerState:n(a,d)}else f={lane:d,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=a):c=c.next=f,ja.lanes|=d,Tc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?o=a:c.next=l,!Zn(a,e.memoizedState)&&(Lo=!0,h&&null!==(n=Wi)))throw n;e.memoizedState=a,e.baseState=o,e.baseQueue=c,r.lastRenderedState=a}return null===i&&(r.lanes=0),[e.memoizedState,r.dispatch]}function gs(e){var t=cs(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);Zn(a,t.memoizedState)||(Lo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function vs(e,t,n){var r=ja,i=cs(),a=di;if(a){if(void 0===n)throw Error(s(407));n=n()}else n=t();var o=!Zn((Ga||i).memoizedState,n);if(o&&(i.memoizedState=n,Lo=!0),i=i.queue,Hs(bs.bind(null,r,i,e),[e]),i.getSnapshot!==t||o||null!==Wa&&1&Wa.memoizedState.tag){if(r.flags|=2048,Us(9,{destroy:void 0},_s.bind(null,r,i,n,t),null),null===mc)throw Error(s(349));a||0!==(127&Ha)||ys(r,t,n)}return n}function ys(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ja.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},ja.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function _s(e,t,n,r){t.value=n,t.getSnapshot=r,Ss(t)&&xs(e)}function bs(e,t,n){return n(function(){Ss(t)&&xs(e)})}function Ss(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Zn(e,n)}catch(ox){return!0}}function xs(e){var t=kr(e,2);null!==t&&Kc(t,e,2)}function ws(e){var t=ls();if("function"===typeof e){var n=e;if(e=n(),Ya){_e(!0);try{n()}finally{_e(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:e},t}function Es(e,t,n,r){return e.baseState=n,ms(e,Ga,"function"===typeof r?r:fs)}function Ts(e,t,n,r,i){if(fo(e))throw Error(s(485));if(null!==(e=t.action)){var a={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){a.listeners.push(e)}};null!==L.T?n(!0):a.isTransition=!1,r(a),null===(n=t.pending)?(a.next=t.pending=a,Ms(t,a)):(a.next=n.next,t.pending=n.next=a)}}function Ms(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=L.T,s={};L.T=s;try{var o=n(i,r),l=L.S;null!==l&&l(s,o),Cs(e,t,o)}catch(ox){Is(e,t,ox)}finally{null!==a&&null!==s.types&&(a.types=s.types),L.T=a}}else try{Cs(e,t,a=n(i,r))}catch(c){Is(e,t,c)}}function Cs(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){As(e,t,n)},function(n){return Is(e,t,n)}):As(e,t,n)}function As(e,t,n){t.status="fulfilled",t.value=n,Rs(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ms(e,n)))}function Is(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,Rs(t),t=t.next}while(t!==r)}e.action=null}function Rs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ps(e,t){return t}function Ns(e,t){if(di){var n=mc.formState;if(null!==n){e:{var r=ja;if(di){if(hi){t:{for(var i=hi,a=pi;8!==i.nodeType;){if(!a){i=null;break t}if(null===(i=Lh(i.nextSibling))){i=null;break t}}i="F!"===(a=i.data)||"F"===a?i:null}if(i){hi=Lh(i.nextSibling),r="F!"===i.data;break e}}gi(r)}r=!1}r&&(t=n[0])}}return(n=ls()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:t},n.queue=r,n=co.bind(null,ja,r),r.dispatch=n,r=ws(!1),a=ho.bind(null,ja,!1,r.queue),i={state:t,dispatch:null,action:e,pending:null},(r=ls()).queue=i,n=Ts.bind(null,ja,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function ks(e){return Ls(cs(),Ga,e)}function Ls(e,t,n){if(t=ms(e,t,Ps)[0],e=ps(fs)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var r=us(t)}catch(ni){if(ni===Zi)throw ea;throw ni}else r=t;var i=(t=cs()).queue,a=i.dispatch;return n!==t.memoizedState&&(ja.flags|=2048,Us(9,{destroy:void 0},Ds.bind(null,i,n),null)),[r,a,e]}function Ds(e,t){e.action=t}function Os(e){var t=cs(),n=Ga;if(null!==n)return Ls(t,n,e);cs(),t=t.memoizedState;var r=(n=cs()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Us(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},null===(t=ja.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},ja.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Fs(){return cs().memoizedState}function zs(e,t,n,r){var i=ls();ja.flags|=e,i.memoizedState=Us(1|t,{destroy:void 0},n,void 0===r?null:r)}function Bs(e,t,n,r){var i=cs();r=void 0===r?null:r;var a=i.memoizedState.inst;null!==Ga&&null!==r&&es(r,Ga.memoizedState.deps)?i.memoizedState=Us(t,a,n,r):(ja.flags|=e,i.memoizedState=Us(1|t,a,n,r))}function Vs(e,t){zs(8390656,8,e,t)}function Hs(e,t){Bs(2048,8,e,t)}function js(e){var t=cs().memoizedState;return function(e){ja.flags|=4;var t=ja.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},ja.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&pc))throw Error(s(440));return t.impl.apply(void 0,arguments)}}function Gs(e,t){return Bs(4,2,e,t)}function Ws(e,t){return Bs(4,4,e,t)}function qs(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Xs(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Bs(4,4,qs.bind(null,t,e),n)}function Ys(){}function Ks(e,t){var n=cs();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&es(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Js(e,t){var n=cs();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&es(t,r[1]))return r[0];if(r=e(),Ya){_e(!0);try{e()}finally{_e(!1)}}return n.memoizedState=[r,t],r}function Qs(e,t,n){return void 0===n||0!==(1073741824&Ha)&&0===(261930&vc)?e.memoizedState=t:(e.memoizedState=n,e=Yc(),ja.lanes|=e,Tc|=e,n)}function Zs(e,t,n,r){return Zn(n,t)?n:null!==Aa.current?(e=Qs(e,n,r),Zn(e,t)||(Lo=!0),e):0===(42&Ha)||0!==(1073741824&Ha)&&0===(261930&vc)?(Lo=!0,e.memoizedState=n):(e=Yc(),ja.lanes|=e,Tc|=e,t)}function $s(e,t,n,r,i){var a=D.p;D.p=0!==a&&8>a?a:8;var s=L.T,o={};L.T=o,ho(e,!1,t,n);try{var l=i(),c=L.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r);uo(e,t,u,Xc())}else uo(e,t,r,Xc())}catch(ox){uo(e,t,{then:function(){},status:"rejected",reason:ox},Xc())}finally{D.p=a,null!==s&&null!==o.types&&(s.types=o.types),L.T=s}}function eo(){}function to(e,t,n,r){if(5!==e.tag)throw Error(s(476));var i=no(e).queue;$s(e,i,t,O,null===n?eo:function(){return ro(e),n(r)})}function no(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:O},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fs,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function ro(e){var t=no(e);null===t.next&&(t=e.alternate.memoizedState),uo(e,t.next.queue,{},Xc())}function io(){return ki(hd)}function ao(){return cs().memoizedState}function so(){return cs().memoizedState}function oo(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Xc(),r=ba(t,e=_a(n),n);return null!==r&&(Kc(r,t,n),Sa(r,t,n)),t={cache:Bi()},void(e.payload=t)}t=t.return}}function lo(e,t,n){var r=Xc();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},fo(e)?po(t,n):null!==(n=Nr(e,t,n,r))&&(Kc(n,e,r),mo(n,t,r))}function co(e,t,n){uo(e,t,n,Xc())}function uo(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(fo(e))po(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,Zn(o,s))return Pr(e,t,i,0),null===mc&&Rr(),!1}catch(ox){}if(null!==(n=Nr(e,t,i,r)))return Kc(n,e,r),mo(n,t,r),!0}return!1}function ho(e,t,n,r){if(r={lane:2,revertLane:ju(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},fo(e)){if(t)throw Error(s(479))}else null!==(t=Nr(e,n,r,2))&&Kc(t,e,2)}function fo(e){var t=e.alternate;return e===ja||null!==t&&t===ja}function po(e,t){Xa=qa=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function mo(e,t,n){if(0!==(4194048&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,Le(e,n)}}var go={readContext:ki,use:hs,useCallback:$a,useContext:$a,useEffect:$a,useImperativeHandle:$a,useLayoutEffect:$a,useInsertionEffect:$a,useMemo:$a,useReducer:$a,useRef:$a,useState:$a,useDebugValue:$a,useDeferredValue:$a,useTransition:$a,useSyncExternalStore:$a,useId:$a,useHostTransitionStatus:$a,useFormState:$a,useActionState:$a,useOptimistic:$a,useMemoCache:$a,useCacheRefresh:$a};go.useEffectEvent=$a;var vo={readContext:ki,use:hs,useCallback:function(e,t){return ls().memoizedState=[e,void 0===t?null:t],e},useContext:ki,useEffect:Vs,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,zs(4194308,4,qs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return zs(4194308,4,e,t)},useInsertionEffect:function(e,t){zs(4,2,e,t)},useMemo:function(e,t){var n=ls();t=void 0===t?null:t;var r=e();if(Ya){_e(!0);try{e()}finally{_e(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=ls();if(void 0!==n){var i=n(t);if(Ya){_e(!0);try{n(t)}finally{_e(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=lo.bind(null,ja,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ls().memoizedState=e},useState:function(e){var t=(e=ws(e)).queue,n=co.bind(null,ja,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ys,useDeferredValue:function(e,t){return Qs(ls(),e,t)},useTransition:function(){var e=ws(!1);return e=$s.bind(null,ja,e.queue,!0,!1),ls().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=ja,i=ls();if(di){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===mc)throw Error(s(349));0!==(127&vc)||ys(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Vs(bs.bind(null,r,a,e),[e]),r.flags|=2048,Us(9,{destroy:void 0},_s.bind(null,r,a,n,t),null),n},useId:function(){var e=ls(),t=mc.identifierPrefix;if(di){var n=ii;t="_"+t+"R_"+(n=(ri&~(1<<32-be(ri)-1)).toString(32)+n),0<(n=Ka++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Za++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:io,useFormState:Ns,useActionState:Ns,useOptimistic:function(e){var t=ls();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=ho.bind(null,ja,!0,n),n.dispatch=t,[e,t]},useMemoCache:ds,useCacheRefresh:function(){return ls().memoizedState=oo.bind(null,ja)},useEffectEvent:function(e){var t=ls(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&pc))throw Error(s(440));return n.impl.apply(void 0,arguments)}}},yo={readContext:ki,use:hs,useCallback:Ks,useContext:ki,useEffect:Hs,useImperativeHandle:Xs,useInsertionEffect:Gs,useLayoutEffect:Ws,useMemo:Js,useReducer:ps,useRef:Fs,useState:function(){return ps(fs)},useDebugValue:Ys,useDeferredValue:function(e,t){return Zs(cs(),Ga.memoizedState,e,t)},useTransition:function(){var e=ps(fs)[0],t=cs().memoizedState;return["boolean"===typeof e?e:us(e),t]},useSyncExternalStore:vs,useId:ao,useHostTransitionStatus:io,useFormState:ks,useActionState:ks,useOptimistic:function(e,t){return Es(cs(),0,e,t)},useMemoCache:ds,useCacheRefresh:so};yo.useEffectEvent=js;var _o={readContext:ki,use:hs,useCallback:Ks,useContext:ki,useEffect:Hs,useImperativeHandle:Xs,useInsertionEffect:Gs,useLayoutEffect:Ws,useMemo:Js,useReducer:gs,useRef:Fs,useState:function(){return gs(fs)},useDebugValue:Ys,useDeferredValue:function(e,t){var n=cs();return null===Ga?Qs(n,e,t):Zs(n,Ga.memoizedState,e,t)},useTransition:function(){var e=gs(fs)[0],t=cs().memoizedState;return["boolean"===typeof e?e:us(e),t]},useSyncExternalStore:vs,useId:ao,useHostTransitionStatus:io,useFormState:Os,useActionState:Os,useOptimistic:function(e,t){var n=cs();return null!==Ga?Es(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:ds,useCacheRefresh:so};function bo(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:f({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}_o.useEffectEvent=js;var So={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Xc(),i=_a(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ba(e,i,r))&&(Kc(t,e,r),Sa(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Xc(),i=_a(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ba(e,i,r))&&(Kc(t,e,r),Sa(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Xc(),r=_a(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ba(e,r,n))&&(Kc(t,e,n),Sa(t,e,n))}};function xo(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!$n(n,r)||!$n(i,a))}function wo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&So.enqueueReplaceState(t,t.state,null)}function Eo(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function To(e){Mr(e)}function Mo(e){console.error(e)}function Co(e){Mr(e)}function Ao(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Io(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Ro(e,t,n){return(n=_a(n)).tag=3,n.payload={element:null},n.callback=function(){Ao(e,t)},n}function Po(e){return(e=_a(e)).tag=3,e}function No(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){Io(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Io(t,n,r),"function"!==typeof i&&(null===Uc?Uc=new Set([this]):Uc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var ko=Error(s(461)),Lo=!1;function Do(e,t,n,r){t.child=null===e?ma(t,null,n,r):pa(t,e.child,n,r)}function Oo(e,t,n,r,i){n=n.render;var a=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return Ni(t),r=ts(e,t,n,s,a,i),o=as(),null===e||Lo?(di&&o&&oi(t),t.flags|=1,Do(e,t,r,i),t.child):(ss(e,t,i),al(e,t,i))}function Uo(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||zr(a)||void 0!==a.defaultProps||null!==n.compare?((e=Hr(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Fo(e,t,a,r,i))}if(a=e.child,!sl(e,i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:$n)(s,r)&&e.ref===t.ref)return al(e,t,i)}return t.flags|=1,(e=Br(a,r)).ref=t.ref,e.return=t,t.child=e}function Fo(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if($n(a,r)&&e.ref===t.ref){if(Lo=!1,t.pendingProps=r=a,!sl(e,i))return t.lanes=e.lanes,al(e,t,i);0!==(131072&e.flags)&&(Lo=!0)}}return Wo(e,t,n,r,i)}function zo(e,t,n,r){var i=r.children,a=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===r.mode){if(0!==(128&t.flags)){if(a=null!==a?a.baseLanes|n:n,null!==e){for(r=t.child=e.child,i=0;null!==r;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~a}else r=0,t.child=null;return Vo(e,t,a,n,r)}if(0===(536870912&n))return r=t.lanes=536870912,Vo(e,t,null!==a?a.baseLanes|n:n,n,r);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ji(0,null!==a?a.cachePool:null),null!==a?Ra(t,a):Pa(),Ua(t)}else null!==a?(Ji(0,a.cachePool),Ra(t,a),Fa(),t.memoizedState=null):(null!==e&&Ji(0,null),Pa(),Fa());return Do(e,t,i,n),t.child}function Bo(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function Vo(e,t,n,r,i){var a=Ki();return a=null===a?null:{parent:zi._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},null!==e&&Ji(0,null),Pa(),Ua(t),null!==e&&Ri(e,t,r,!0),t.childLanes=i,null}function Ho(e,t){return(t=el({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function jo(e,t,n){return pa(t,e.child,null,n),(e=Ho(t,t.pendingProps)).flags|=2,za(t),t.memoizedState=null,e}function Go(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(s(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Wo(e,t,n,r,i){return Ni(t),n=ts(e,t,n,r,void 0,i),r=as(),null===e||Lo?(di&&r&&oi(t),t.flags|=1,Do(e,t,n,i),t.child):(ss(e,t,i),al(e,t,i))}function qo(e,t,n,r,i,a){return Ni(t),t.updateQueue=null,n=rs(t,r,n,i),ns(e),r=as(),null===e||Lo?(di&&r&&oi(t),t.flags|=1,Do(e,t,n,a),t.child):(ss(e,t,a),al(e,t,a))}function Xo(e,t,n,r,i){if(Ni(t),null===t.stateNode){var a=Or,s=n.contextType;"object"===typeof s&&null!==s&&(a=ki(s)),a=new n(r,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=So,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=r,a.state=t.memoizedState,a.refs={},va(t),s=n.contextType,a.context="object"===typeof s&&null!==s?ki(s):Or,a.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(bo(t,n,s,r),a.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(s=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&So.enqueueReplaceState(a,a.state,null),Ta(t,r,a,i),Ea(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){a=t.stateNode;var o=t.memoizedProps,l=Eo(n,o);a.props=l;var c=a.context,u=n.contextType;s=Or,"object"===typeof u&&null!==u&&(s=ki(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o||c!==s)&&wo(t,a,r,s),ga=!1;var d=t.memoizedState;a.state=d,Ta(t,r,a,i),Ea(),c=t.memoizedState,o||d!==c||ga?("function"===typeof h&&(bo(t,n,h,r),c=t.memoizedState),(l=ga||xo(t,n,l,r,d,c,s))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=s,r=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ya(e,t),u=Eo(n,s=t.memoizedProps),a.props=u,h=t.pendingProps,d=a.context,c=n.contextType,l=Or,"object"===typeof c&&null!==c&&(l=ki(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&wo(t,a,r,l),ga=!1,d=t.memoizedState,a.state=d,Ta(t,r,a,i),Ea();var f=t.memoizedState;s!==h||d!==f||ga||null!==e&&null!==e.dependencies&&Pi(e.dependencies)?("function"===typeof o&&(bo(t,n,o,r),f=t.memoizedState),(u=ga||xo(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Pi(e.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,Go(e,t),r=0!==(128&t.flags),a||r?(a=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&r?(t.child=pa(t,e.child,null,i),t.child=pa(t,null,n,i)):Do(e,t,n,i),t.memoizedState=a.state,e=t.child):e=al(e,t,i),e}function Yo(e,t,n,r){return bi(),t.flags|=256,Do(e,t,n,r),t.child}var Ko={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Jo(e){return{baseLanes:e,cachePool:Qi()}}function Qo(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=Ac),e}function Zo(e,t,n){var r,i=t.pendingProps,a=!1,o=0!==(128&t.flags);if((r=o)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Ba.current)),r&&(a=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(di){if(a?Da(t):Fa(),(e=hi)?null!==(e=null!==(e=Ph(e,pi))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,ui=t,hi=null):e=null,null===e)throw gi(t);return kh(e)?t.lanes=32:t.lanes=536870912,null}var l=i.children;return i=i.fallback,a?(Fa(),l=el({mode:"hidden",children:l},a=t.mode),i=jr(i,a,n,null),l.return=t,i.return=t,l.sibling=i,t.child=l,(i=t.child).memoizedState=Jo(n),i.childLanes=Qo(e,r,n),t.memoizedState=Ko,Bo(null,i)):(Da(t),$o(t,l))}var c=e.memoizedState;if(null!==c&&null!==(l=c.dehydrated)){if(o)256&t.flags?(Da(t),t.flags&=-257,t=tl(e,t,n)):null!==t.memoizedState?(Fa(),t.child=e.child,t.flags|=128,t=null):(Fa(),l=i.fallback,a=t.mode,i=el({mode:"visible",children:i.children},a),(l=jr(l,a,n,null)).flags|=2,i.return=t,l.return=t,i.sibling=l,t.child=i,pa(t,e.child,null,n),(i=t.child).memoizedState=Jo(n),i.childLanes=Qo(e,r,n),t.memoizedState=Ko,t=Bo(null,i));else if(Da(t),kh(l)){if(r=l.nextSibling&&l.nextSibling.dataset)var u=r.dgst;r=u,(i=Error(s(419))).stack="",i.digest=r,xi({value:i,source:null,stack:null}),t=tl(e,t,n)}else if(Lo||Ri(e,t,n,!1),r=0!==(n&e.childLanes),Lo||r){if(null!==(r=mc)&&(0!==(i=De(r,n))&&i!==c.retryLane))throw c.retryLane=i,kr(e,i),Kc(r,e,i),ko;Nh(l)||ou(),t=tl(e,t,n)}else Nh(l)?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,hi=Lh(l.nextSibling),ui=t,di=!0,fi=null,pi=!1,null!==e&&ci(t,e),(t=$o(t,i.children)).flags|=4096);return t}return a?(Fa(),l=i.fallback,a=t.mode,u=(c=e.child).sibling,(i=Br(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==u?l=Br(u,l):(l=jr(l,a,n,null)).flags|=2,l.return=t,i.return=t,i.sibling=l,t.child=i,Bo(null,i),i=t.child,null===(l=e.child.memoizedState)?l=Jo(n):(null!==(a=l.cachePool)?(c=zi._currentValue,a=a.parent!==c?{parent:c,pool:c}:a):a=Qi(),l={baseLanes:l.baseLanes|n,cachePool:a}),i.memoizedState=l,i.childLanes=Qo(e,r,n),t.memoizedState=Ko,Bo(e.child,i)):(Da(t),e=(n=e.child).sibling,(n=Br(n,{mode:"visible",children:i.children})).return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n)}function $o(e,t){return(t=el({mode:"visible",children:t},e.mode)).return=e,e.child=t}function el(e,t){return(e=Fr(22,e,null,t)).lanes=0,e}function tl(e,t,n){return pa(t,e.child,null,n),(e=$o(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function nl(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ai(e.return,t,n)}function rl(e,t,n,r,i,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i,s.treeForkCount=a)}function il(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;r=r.children;var s=Ba.current,o=0!==(2&s);if(o?(s=1&s|2,t.flags|=128):s&=1,V(Ba,s),Do(e,t,r,n),r=di?Zr:0,!o&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nl(e,n,t);else if(19===e.tag)nl(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Va(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),rl(t,!1,i,n,a,r);break;case"backwards":case"unstable_legacy-backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Va(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}rl(t,!0,n,null,a,r);break;case"together":rl(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function al(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Tc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Ri(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Br(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Br(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function sl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Pi(e))}function ol(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Lo=!0;else{if(!sl(e,n)&&0===(128&t.flags))return Lo=!1,function(e,t,n){switch(t.tag){case 3:Y(t,t.stateNode.containerInfo),Mi(0,zi,e.memoizedState.cache),bi();break;case 27:case 5:J(t);break;case 4:Y(t,t.stateNode.containerInfo);break;case 10:Mi(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,Oa(t),null;break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Da(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Zo(e,t,n):(Da(t),null!==(e=al(e,t,n))?e.sibling:null);Da(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(Ri(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return il(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),V(Ba,Ba.current),r)break;return null;case 22:return t.lanes=0,zo(e,t,n,t.pendingProps);case 24:Mi(0,zi,e.memoizedState.cache)}return al(e,t,n)}(e,t,n);Lo=0!==(131072&e.flags)}else Lo=!1,di&&0!==(1048576&t.flags)&&si(t,Zr,t.index);switch(t.lanes=0,t.tag){case 16:e:{var r=t.pendingProps;if(e=ia(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var i=e.$$typeof;if(i===x){t.tag=11,t=Oo(null,t,e,r,n);break e}if(i===T){t.tag=14,t=Uo(null,t,e,r,n);break e}}throw t=N(e)||e,Error(s(306,t,""))}zr(e)?(r=Eo(e,r),t.tag=1,t=Xo(null,t,e,r,n)):(t.tag=0,t=Wo(null,t,e,r,n))}return t;case 0:return Wo(e,t,t.type,t.pendingProps,n);case 1:return Xo(e,t,r=t.type,i=Eo(r,t.pendingProps),n);case 3:e:{if(Y(t,t.stateNode.containerInfo),null===e)throw Error(s(387));r=t.pendingProps;var a=t.memoizedState;i=a.element,ya(e,t),Ta(t,r,null,n);var o=t.memoizedState;if(r=o.cache,Mi(0,zi,r),r!==a.cache&&Ii(t,[zi],n,!0),Ea(),r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Yo(e,t,r,n);break e}if(r!==i){xi(i=Yr(Error(s(424)),t)),t=Yo(e,t,r,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(hi=Lh(e.firstChild),ui=t,di=!0,fi=null,pi=!0,n=ma(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(bi(),r===i){t=al(e,t,n);break e}Do(e,t,r,n)}t=t.child}return t;case 26:return Go(e,t),null===e?(n=qh(t.type,null,t.pendingProps,null))?t.memoizedState=n:di||(n=t.type,e=t.pendingProps,(r=vh(q.current).createElement(n))[Ve]=t,r[He]=e,fh(r,n,e),et(r),t.stateNode=r):t.memoizedState=qh(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return J(t),null===e&&di&&(r=t.stateNode=Fh(t.type,t.pendingProps,q.current),ui=t,pi=!0,i=hi,Ch(t.type)?(Dh=i,hi=Lh(r.firstChild)):hi=i),Do(e,t,t.pendingProps.children,n),Go(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&di&&((i=r=hi)&&(null!==(r=function(e,t,n,r){for(;1===e.nodeType;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[Ye])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(a=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(a!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((a=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&a&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var a=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===a)return e}if(null===(e=Lh(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,pi))?(t.stateNode=r,ui=t,hi=Lh(r.firstChild),pi=!1,i=!0):i=!1),i||gi(t)),J(t),i=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,r=a.children,bh(i,a)?r=null:null!==o&&bh(i,o)&&(t.flags|=32),null!==t.memoizedState&&(i=ts(e,t,is,null,null,n),hd._currentValue=i),Go(e,t),Do(e,t,r,n),t.child;case 6:return null===e&&di&&((e=n=hi)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Lh(e.nextSibling)))return null}return e}(n,t.pendingProps,pi))?(t.stateNode=n,ui=t,hi=null,e=!0):e=!1),e||gi(t)),null;case 13:return Zo(e,t,n);case 4:return Y(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=pa(t,null,r,n):Do(e,t,r,n),t.child;case 11:return Oo(e,t,t.type,t.pendingProps,n);case 7:return Do(e,t,t.pendingProps,n),t.child;case 8:case 12:return Do(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Mi(0,t.type,r.value),Do(e,t,r.children,n),t.child;case 9:return i=t.type._context,r=t.pendingProps.children,Ni(t),r=r(i=ki(i)),t.flags|=1,Do(e,t,r,n),t.child;case 14:return Uo(e,t,t.type,t.pendingProps,n);case 15:return Fo(e,t,t.type,t.pendingProps,n);case 19:return il(e,t,n);case 31:return function(e,t,n){var r=t.pendingProps,i=0!==(128&t.flags);if(t.flags&=-129,null===e){if(di){if("hidden"===r.mode)return e=Ho(t,r),t.lanes=536870912,Bo(null,e);if(Oa(t),(e=hi)?null!==(e=null!==(e=Ph(e,pi))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==ti?{id:ri,overflow:ii}:null,retryLane:536870912,hydrationErrors:null},(n=Wr(e)).return=t,t.child=n,ui=t,hi=null):e=null,null===e)throw gi(t);return t.lanes=536870912,null}return Ho(t,r)}var a=e.memoizedState;if(null!==a){var o=a.dehydrated;if(Oa(t),i)if(256&t.flags)t.flags&=-257,t=jo(e,t,n);else{if(null===t.memoizedState)throw Error(s(558));t.child=e.child,t.flags|=128,t=null}else if(Lo||Ri(e,t,n,!1),i=0!==(n&e.childLanes),Lo||i){if(null!==(r=mc)&&0!==(o=De(r,n))&&o!==a.retryLane)throw a.retryLane=o,kr(e,o),Kc(r,e,o),ko;ou(),t=jo(e,t,n)}else e=a.treeContext,hi=Lh(o.nextSibling),ui=t,di=!0,fi=null,pi=!1,null!==e&&ci(t,e),(t=Ho(t,r)).flags|=4096;return t}return(e=Br(e.child,{mode:r.mode,children:r.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return zo(e,t,n,t.pendingProps);case 24:return Ni(t),r=ki(zi),null===e?(null===(i=Ki())&&(i=mc,a=Bi(),i.pooledCache=a,a.refCount++,null!==a&&(i.pooledCacheLanes|=n),i=a),t.memoizedState={parent:r,cache:i},va(t),Mi(0,zi,i)):(0!==(e.lanes&n)&&(ya(e,t),Ta(t,null,null,n),Ea()),i=e.memoizedState,a=t.memoizedState,i.parent!==r?(i={parent:r,cache:r},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Mi(0,zi,r)):(r=a.cache,Mi(0,zi,r),r!==i.cache&&Ii(t,[zi],n,!0))),Do(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}function ll(e){e.flags|=4}function cl(e,t,n,r,i){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&i)===i)if(e.stateNode.complete)e.flags|=8192;else{if(!iu())throw aa=ta,$i;e.flags|=8192}}else e.flags&=-16777217}function ul(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!ad(t)){if(!iu())throw aa=ta,$i;e.flags|=8192}}function hl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Re():536870912,e.lanes|=t,Ic|=t)}function dl(e,t){if(!di)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function fl(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=65011712&i.subtreeFlags,r|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function pl(e,t,n){var r=t.pendingProps;switch(li(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return fl(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ci(zi),K(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(_i(t)?ll(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,Si())),fl(t),null;case 26:var i=t.type,a=t.memoizedState;return null===e?(ll(t),null!==a?(fl(t),ul(t,a)):(fl(t),cl(t,i,0,0,n))):a?a!==e.memoizedState?(ll(t),fl(t),ul(t,a)):(fl(t),t.flags&=-16777217):((e=e.memoizedProps)!==r&&ll(t),fl(t),cl(t,i,0,0,n)),null;case 27:if(Q(t),n=q.current,i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ll(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return fl(t),null}e=G.current,_i(t)?vi(t):(e=Fh(i,r,n),t.stateNode=e,ll(t))}return fl(t),null;case 5:if(Q(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&ll(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return fl(t),null}if(a=G.current,_i(t))vi(t);else{var o=vh(q.current);switch(a){case 1:a=o.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:a=o.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":a=o.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":a=o.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(a=o.createElement("div")).innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a="string"===typeof r.is?o.createElement("select",{is:r.is}):o.createElement("select"),r.multiple?a.multiple=!0:r.size&&(a.size=r.size);break;default:a="string"===typeof r.is?o.createElement(i,{is:r.is}):o.createElement(i)}}a[Ve]=t,a[He]=r;e:for(o=t.child;null!==o;){if(5===o.tag||6===o.tag)a.appendChild(o.stateNode);else if(4!==o.tag&&27!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break e;for(;null===o.sibling;){if(null===o.return||o.return===t)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}t.stateNode=a;e:switch(fh(a,i,r),i){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ll(t)}}return fl(t),cl(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&ll(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=q.current,_i(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(i=ui))switch(i.tag){case 27:case 5:r=i.memoizedProps}e[Ve]=t,(e=!!(e.nodeValue===n||null!==r&&!0===r.suppressHydrationWarning||uh(e.nodeValue,n)))||gi(t,!0)}else(e=vh(e).createTextNode(r))[Ve]=t,t.stateNode=e}return fl(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(r=_i(t),null!==n){if(null===e){if(!r)throw Error(s(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(s(557));e[Ve]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),e=!1}else n=Si(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(za(t),t):(za(t),null);if(0!==(128&t.flags))throw Error(s(558))}return fl(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=_i(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[Ve]=t}else bi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;fl(t),i=!1}else i=Si(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(za(t),t):(za(t),null)}return za(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==r,e=null!==e&&null!==e.memoizedState,n&&(i=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(i=r.alternate.memoizedState.cachePool.pool),a=null,null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(a=r.memoizedState.cachePool.pool),a!==i&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),hl(t,t.updateQueue),fl(t),null);case 4:return K(),null===e&&eh(t.stateNode.containerInfo),fl(t),null;case 10:return Ci(t.type),fl(t),null;case 19:if(B(Ba),null===(r=t.memoizedState))return fl(t),null;if(i=0!==(128&t.flags),null===(a=r.rendering))if(i)dl(r,!1);else{if(0!==Ec||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(a=Va(e))){for(t.flags|=128,dl(r,!1),e=a.updateQueue,t.updateQueue=e,hl(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Vr(n,e),n=n.sibling;return V(Ba,1&Ba.current|2),di&&ai(t,r.treeForkCount),t.child}e=e.sibling}null!==r.tail&&le()>Dc&&(t.flags|=128,i=!0,dl(r,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=Va(a))){if(t.flags|=128,i=!0,e=e.updateQueue,t.updateQueue=e,hl(t,e),dl(r,!0),null===r.tail&&"hidden"===r.tailMode&&!a.alternate&&!di)return fl(t),null}else 2*le()-r.renderingStartTime>Dc&&536870912!==n&&(t.flags|=128,i=!0,dl(r,!1),t.lanes=4194304);r.isBackwards?(a.sibling=t.child,t.child=a):(null!==(e=r.last)?e.sibling=a:t.child=a,r.last=a)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=le(),e.sibling=null,n=Ba.current,V(Ba,i?1&n|2:1&n),di&&ai(t,r.treeForkCount),e):(fl(t),null);case 22:case 23:return za(t),Na(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(fl(t),6&t.subtreeFlags&&(t.flags|=8192)):fl(t),null!==(n=t.updateQueue)&&hl(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&B(Yi),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ci(zi),fl(t),null;case 25:case 30:return null}throw Error(s(156,t.tag))}function ml(e,t){switch(li(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ci(zi),K(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Q(t),null;case 31:if(null!==t.memoizedState){if(za(t),null===t.alternate)throw Error(s(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(za(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));bi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(Ba),null;case 4:return K(),null;case 10:return Ci(t.type),null;case 22:case 23:return za(t),Na(),null!==e&&B(Yi),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ci(zi),null;default:return null}}function gl(e,t){switch(li(t),t.tag){case 3:Ci(zi),K();break;case 26:case 27:case 5:Q(t);break;case 4:K();break;case 31:null!==t.memoizedState&&za(t);break;case 13:za(t);break;case 19:B(Ba);break;case 10:Ci(t.type);break;case 22:case 23:za(t),Na(),null!==e&&B(Yi);break;case 24:Ci(zi)}}function vl(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,s=n.inst;r=a(),s.destroy=r}n=n.next}while(n!==i)}}catch(ox){Eu(t,t.return,ox)}}function yl(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,i=t;var l=n,c=o;try{c()}catch(ox){Eu(i,l,ox)}}}r=r.next}while(r!==a)}}catch(ox){Eu(t,t.return,ox)}}function _l(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{Ca(t,n)}catch(ox){Eu(e,e.return,ox)}}}function bl(e,t,n){n.props=Eo(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(ox){Eu(e,t,ox)}}function Sl(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;default:r=e.stateNode}"function"===typeof n?e.refCleanup=n(r):n.current=r}}catch(ox){Eu(e,t,ox)}}function xl(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(ox){Eu(e,t,ox)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){Eu(e,t,i)}else n.current=null}function wl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&r.focus();break e;case"img":n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(ox){Eu(e,e.return,ox)}}function El(e,t,n){try{var r=e.stateNode;!function(e,t,n,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,a=null,o=null,l=null,c=null,u=null,h=null;for(p in n){var d=n[p];if(n.hasOwnProperty(p)&&null!=d)switch(p){case"checked":case"value":break;case"defaultValue":c=d;default:r.hasOwnProperty(p)||hh(e,t,p,null,r,d)}}for(var f in r){var p=r[f];if(d=n[f],r.hasOwnProperty(f)&&(null!=p||null!=d))switch(f){case"type":a=p;break;case"name":i=p;break;case"checked":u=p;break;case"defaultChecked":h=p;break;case"value":o=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==d&&hh(e,t,f,p,r,d)}}return void yt(e,o,l,c,u,h,a,i);case"select":for(a in p=o=l=f=null,n)if(c=n[a],n.hasOwnProperty(a)&&null!=c)switch(a){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(a)||hh(e,t,a,null,r,c)}for(i in r)if(a=r[i],c=n[i],r.hasOwnProperty(i)&&(null!=a||null!=c))switch(i){case"value":f=a;break;case"defaultValue":l=a;break;case"multiple":o=a;default:a!==c&&hh(e,t,i,a,r,c)}return t=l,n=o,r=p,void(null!=f?St(e,!!n,f,!1):!!r!==!!n&&(null!=t?St(e,!!n,t,!0):St(e,!!n,n?[]:"",!1)));case"textarea":for(l in p=f=null,n)if(i=n[l],n.hasOwnProperty(l)&&null!=i&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:hh(e,t,l,null,r,i)}for(o in r)if(i=r[o],a=n[o],r.hasOwnProperty(o)&&(null!=i||null!=a))switch(o){case"value":f=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(s(91));break;default:i!==a&&hh(e,t,o,i,r,a)}return void xt(e,f,p);case"option":for(var m in n)if(f=n[m],n.hasOwnProperty(m)&&null!=f&&!r.hasOwnProperty(m))if("selected"===m)e.selected=!1;else hh(e,t,m,null,r,f);for(c in r)if(f=r[c],p=n[c],r.hasOwnProperty(c)&&f!==p&&(null!=f||null!=p))if("selected"===c)e.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else hh(e,t,c,f,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)f=n[g],n.hasOwnProperty(g)&&null!=f&&!r.hasOwnProperty(g)&&hh(e,t,g,null,r,f);for(u in r)if(f=r[u],p=n[u],r.hasOwnProperty(u)&&f!==p&&(null!=f||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(s(137,t));break;default:hh(e,t,u,f,r,p)}return;default:if(At(t)){for(var v in n)f=n[v],n.hasOwnProperty(v)&&void 0!==f&&!r.hasOwnProperty(v)&&dh(e,t,v,void 0,r,f);for(h in r)f=r[h],p=n[h],!r.hasOwnProperty(h)||f===p||void 0===f&&void 0===p||dh(e,t,h,f,r,p);return}}for(var y in n)f=n[y],n.hasOwnProperty(y)&&null!=f&&!r.hasOwnProperty(y)&&hh(e,t,y,null,r,f);for(d in r)f=r[d],p=n[d],!r.hasOwnProperty(d)||f===p||null==f&&null==p||hh(e,t,d,f,r,p)}(r,e.type,n,t),r[He]=t}catch(ox){Eu(e,e.return,ox)}}function Tl(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Ch(e.type)||4===e.tag}function Ml(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Tl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Ch(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Nt));else if(4!==r&&(27===r&&Ch(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Cl(e,t,n),e=e.sibling;null!==e;)Cl(e,t,n),e=e.sibling}function Al(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&(27===r&&Ch(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(Al(e,t,n),e=e.sibling;null!==e;)Al(e,t,n),e=e.sibling}function Il(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);fh(t,r,n),t[Ve]=e,t[He]=n}catch(ox){Eu(e,e.return,ox)}}var Rl=!1,Pl=!1,Nl=!1,kl="function"===typeof WeakSet?WeakSet:Set,Ll=null;function Dl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Kl(e,n),4&r&&vl(5,n);break;case 1:if(Kl(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(ox){Eu(n,n.return,ox)}else{var i=Eo(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Eu(n,n.return,s)}}64&r&&_l(n),512&r&&Sl(n,n.return);break;case 3:if(Kl(e,n),64&r&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{Ca(e,t)}catch(ox){Eu(n,n.return,ox)}}break;case 27:null===t&&4&r&&Il(n);case 26:case 5:Kl(e,n),null===t&&4&r&&wl(n),512&r&&Sl(n,n.return);break;case 12:Kl(e,n);break;case 31:Kl(e,n),4&r&&Vl(e,n);break;case 13:Kl(e,n),4&r&&Hl(e,n),64&r&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var r=function(){t(),n.removeEventListener("DOMContentLoaded",r)};n.addEventListener("DOMContentLoaded",r),e._reactRetry=r}}(e,n=Au.bind(null,n))));break;case 22:if(!(r=null!==n.memoizedState||Rl)){t=null!==t&&null!==t.memoizedState||Pl,i=Rl;var a=Pl;Rl=r,(Pl=t)&&!a?Ql(e,n,0!==(8772&n.subtreeFlags)):Kl(e,n),Rl=i,Pl=a}break;case 30:break;default:Kl(e,n)}}function Ol(e){var t=e.alternate;null!==t&&(e.alternate=null,Ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ke(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ul=null,Fl=!1;function zl(e,t,n){for(n=n.child;null!==n;)Bl(e,t,n),n=n.sibling}function Bl(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(a){}switch(n.tag){case 26:Pl||xl(n,t),zl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Pl||xl(n,t);var r=Ul,i=Fl;Ch(n.type)&&(Ul=n.stateNode,Fl=!1),zl(e,t,n),zh(n.stateNode),Ul=r,Fl=i;break;case 5:Pl||xl(n,t);case 6:if(r=Ul,i=Fl,Ul=null,zl(e,t,n),Fl=i,null!==(Ul=r))if(Fl)try{(9===Ul.nodeType?Ul.body:"HTML"===Ul.nodeName?Ul.ownerDocument.body:Ul).removeChild(n.stateNode)}catch(ox){Eu(n,t,ox)}else try{Ul.removeChild(n.stateNode)}catch(ox){Eu(n,t,ox)}break;case 18:null!==Ul&&(Fl?(Ah(9===(e=Ul).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wd(e)):Ah(Ul,n.stateNode));break;case 4:r=Ul,i=Fl,Ul=n.stateNode.containerInfo,Fl=!0,zl(e,t,n),Ul=r,Fl=i;break;case 0:case 11:case 14:case 15:yl(2,n,t),Pl||yl(4,n,t),zl(e,t,n);break;case 1:Pl||(xl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&bl(n,t,r)),zl(e,t,n);break;case 21:zl(e,t,n);break;case 22:Pl=(r=Pl)||null!==n.memoizedState,zl(e,t,n),Pl=r;break;default:zl(e,t,n)}}function Vl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wd(e)}catch(ox){Eu(t,t.return,ox)}}}function Hl(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wd(e)}catch(ox){Eu(t,t.return,ox)}}function jl(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new kl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new kl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=Iu.bind(null,e,t);t.then(r,r)}})}function Gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r],a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 27:if(Ch(l.type)){Ul=l.stateNode,Fl=!1;break e}break;case 5:Ul=l.stateNode,Fl=!1;break e;case 3:case 4:Ul=l.stateNode.containerInfo,Fl=!0;break e}l=l.return}if(null===Ul)throw Error(s(160));Bl(a,o,i),Ul=null,Fl=!1,null!==(a=i.alternate)&&(a.return=null),i.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)ql(t,e),t=t.sibling}var Wl=null;function ql(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Gl(t,e),Xl(e),4&r&&(yl(3,e,e.return),vl(3,e),yl(5,e,e.return));break;case 1:Gl(t,e),Xl(e),512&r&&(Pl||null===n||xl(n,n.return)),64&r&&Rl&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:var i=Wl;if(Gl(t,e),Xl(e),512&r&&(Pl||null===n||xl(n,n.return)),4&r){var a=null!==n?n.memoizedState:null;if(r=e.memoizedState,null===n)if(null===r)if(null===e.stateNode){e:{r=e.type,n=e.memoizedProps,i=i.ownerDocument||i;t:switch(r){case"title":(!(a=i.getElementsByTagName("title")[0])||a[Ye]||a[Ve]||"http://www.w3.org/2000/svg"===a.namespaceURI||a.hasAttribute("itemprop"))&&(a=i.createElement(r),i.head.insertBefore(a,i.querySelector("head > title"))),fh(a,r,n),a[Ve]=e,et(a),r=a;break e;case"link":var o=rd("link","href",i).get(r+(n.href||""));if(o)for(var l=0;l<o.length;l++)if((a=o[l]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&a.getAttribute("rel")===(null==n.rel?null:n.rel)&&a.getAttribute("title")===(null==n.title?null:n.title)&&a.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){o.splice(l,1);break t}fh(a=i.createElement(r),r,n),i.head.appendChild(a);break;case"meta":if(o=rd("meta","content",i).get(r+(n.content||"")))for(l=0;l<o.length;l++)if((a=o[l]).getAttribute("content")===(null==n.content?null:""+n.content)&&a.getAttribute("name")===(null==n.name?null:n.name)&&a.getAttribute("property")===(null==n.property?null:n.property)&&a.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&a.getAttribute("charset")===(null==n.charSet?null:n.charSet)){o.splice(l,1);break t}fh(a=i.createElement(r),r,n),i.head.appendChild(a);break;default:throw Error(s(468,r))}a[Ve]=e,et(a),r=a}e.stateNode=r}else id(i,e.type,e.stateNode);else e.stateNode=Zh(i,r,e.memoizedProps);else a!==r?(null===a?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):a.count--,null===r?id(i,e.type,e.stateNode):Zh(i,r,e.memoizedProps)):null===r&&null!==e.stateNode&&El(e,e.memoizedProps,n.memoizedProps)}break;case 27:Gl(t,e),Xl(e),512&r&&(Pl||null===n||xl(n,n.return)),null!==n&&4&r&&El(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Gl(t,e),Xl(e),512&r&&(Pl||null===n||xl(n,n.return)),32&e.flags){i=e.stateNode;try{Et(i,"")}catch(ox){Eu(e,e.return,ox)}}4&r&&null!=e.stateNode&&El(e,i=e.memoizedProps,null!==n?n.memoizedProps:i),1024&r&&(Nl=!0);break;case 6:if(Gl(t,e),Xl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(ox){Eu(e,e.return,ox)}}break;case 3:if(nd=null,i=Wl,Wl=Hh(t.containerInfo),Gl(t,e),Wl=i,Xl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wd(t.containerInfo)}catch(ox){Eu(e,e.return,ox)}Nl&&(Nl=!1,Yl(e));break;case 4:r=Wl,Wl=Hh(e.stateNode.containerInfo),Gl(t,e),Xl(e),Wl=r;break;case 12:default:Gl(t,e),Xl(e);break;case 31:case 19:Gl(t,e),Xl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,jl(e,r)));break;case 13:Gl(t,e),Xl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(kc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,jl(e,r)));break;case 22:i=null!==e.memoizedState;var c=null!==n&&null!==n.memoizedState,u=Rl,h=Pl;if(Rl=u||i,Pl=h||c,Gl(t,e),Pl=h,Rl=u,Xl(e),8192&r)e:for(t=e.stateNode,t._visibility=i?-2&t._visibility:1|t._visibility,i&&(null===n||c||Rl||Pl||Jl(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){c=n=t;try{if(a=c.stateNode,i)"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{l=c.stateNode;var d=c.memoizedProps.style,f=void 0!==d&&null!==d&&d.hasOwnProperty("display")?d.display:null;l.style.display=null==f||"boolean"===typeof f?"":(""+f).trim()}}catch(ox){Eu(c,c.return,ox)}}}else if(6===t.tag){if(null===n){c=t;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(ox){Eu(c,c.return,ox)}}}else if(18===t.tag){if(null===n){c=t;try{var p=c.stateNode;i?Ih(p,!0):Ih(c.stateNode,!1)}catch(ox){Eu(c,c.return,ox)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,jl(e,n))));case 30:case 21:}}function Xl(e){var t=e.flags;if(2&t){try{for(var n,r=e.return;null!==r;){if(Tl(r)){n=r;break}r=r.return}if(null==n)throw Error(s(160));switch(n.tag){case 27:var i=n.stateNode;Al(e,Ml(e),i);break;case 5:var a=n.stateNode;32&n.flags&&(Et(a,""),n.flags&=-33),Al(e,Ml(e),a);break;case 3:case 4:var o=n.stateNode.containerInfo;Cl(e,Ml(e),o);break;default:throw Error(s(161))}}catch(ox){Eu(e,e.return,ox)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Yl(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Yl(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Kl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Dl(e,t.alternate,t),t=t.sibling}function Jl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yl(4,t,t.return),Jl(t);break;case 1:xl(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&bl(t,t.return,n),Jl(t);break;case 27:zh(t.stateNode);case 26:case 5:xl(t,t.return),Jl(t);break;case 22:null===t.memoizedState&&Jl(t);break;default:Jl(t)}e=e.sibling}}function Ql(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,a=t,s=a.flags;switch(a.tag){case 0:case 11:case 15:Ql(i,a,n),vl(4,a);break;case 1:if(Ql(i,a,n),"function"===typeof(i=(r=a).stateNode).componentDidMount)try{i.componentDidMount()}catch(ox){Eu(r,r.return,ox)}if(null!==(i=(r=a).updateQueue)){var o=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)Ma(l[i],o)}catch(ox){Eu(r,r.return,ox)}}n&&64&s&&_l(a),Sl(a,a.return);break;case 27:Il(a);case 26:case 5:Ql(i,a,n),n&&null===r&&4&s&&wl(a),Sl(a,a.return);break;case 12:Ql(i,a,n);break;case 31:Ql(i,a,n),n&&4&s&&Vl(i,a);break;case 13:Ql(i,a,n),n&&4&s&&Hl(i,a);break;case 22:null===a.memoizedState&&Ql(i,a,n),Sl(a,a.return);break;case 30:break;default:Ql(i,a,n)}t=t.sibling}}function Zl(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Vi(n))}function $l(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e))}function ec(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)tc(e,t,n,r),t=t.sibling}function tc(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:ec(e,t,n,r),2048&i&&vl(9,t);break;case 1:case 31:case 13:default:ec(e,t,n,r);break;case 3:ec(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vi(e)));break;case 12:if(2048&i){ec(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,s=a.id,o=a.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(ox){Eu(t,t.return,ox)}}else ec(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,s=t.alternate,null!==t.memoizedState?2&a._visibility?ec(e,t,n,r):rc(e,t):2&a._visibility?ec(e,t,n,r):(a._visibility|=2,nc(e,t,n,r,0!==(10256&t.subtreeFlags)||!1)),2048&i&&Zl(s,t);break;case 24:ec(e,t,n,r),2048&i&&$l(t.alternate,t)}}function nc(e,t,n,r,i){for(i=i&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var a=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:nc(a,s,o,l,i),vl(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?2&u._visibility?nc(a,s,o,l,i):rc(a,s):(u._visibility|=2,nc(a,s,o,l,i)),i&&2048&c&&Zl(s.alternate,s);break;case 24:nc(a,s,o,l,i),i&&2048&c&&$l(s.alternate,s);break;default:nc(a,s,o,l,i)}t=t.sibling}}function rc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:rc(n,r),2048&i&&Zl(r.alternate,r);break;case 24:rc(n,r),2048&i&&$l(r.alternate,r);break;default:rc(n,r)}t=t.sibling}}var ic=8192;function ac(e,t,n){if(e.subtreeFlags&ic)for(e=e.child;null!==e;)sc(e,t,n),e=e.sibling}function sc(e,t,n){switch(e.tag){case 26:ac(e,t,n),e.flags&ic&&null!==e.memoizedState&&function(e,t,n,r){if("stylesheet"===n.type&&("string"!==typeof r.media||!1!==matchMedia(r.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var i=Xh(r.href),a=t.querySelector(Yh(i));if(a)return null!==(t=a._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=od.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=a,void et(a);a=t.ownerDocument||t,r=Kh(r),(i=Bh.get(i))&&ed(r,i),et(a=a.createElement("link"));var s=a;s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),fh(a,"link",r),n.instance=a}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=od.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wl,e.memoizedState,e.memoizedProps);break;case 5:default:ac(e,t,n);break;case 3:case 4:var r=Wl;Wl=Hh(e.stateNode.containerInfo),ac(e,t,n),Wl=r;break;case 22:null===e.memoizedState&&(null!==(r=e.alternate)&&null!==r.memoizedState?(r=ic,ic=16777216,ac(e,t,n),ic=r):ac(e,t,n))}}function oc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function lc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ll=r,hc(r,e)}oc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)cc(e),e=e.sibling}function cc(e){switch(e.tag){case 0:case 11:case 15:lc(e),2048&e.flags&&yl(9,e,e.return);break;case 3:case 12:default:lc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,uc(e)):lc(e)}}function uc(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];Ll=r,hc(r,e)}oc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yl(8,t,t.return),uc(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,uc(t));break;default:uc(t)}e=e.sibling}}function hc(e,t){for(;null!==Ll;){var n=Ll;switch(n.tag){case 0:case 11:case 15:yl(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Vi(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,Ll=r;else e:for(n=e;null!==Ll;){var i=(r=Ll).sibling,a=r.return;if(Ol(r),r===n){Ll=null;break e}if(null!==i){i.return=a,Ll=i;break e}Ll=a}}}var dc={getCacheForType:function(e){var t=ki(zi),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ki(zi).controller.signal}},fc="function"===typeof WeakMap?WeakMap:Map,pc=0,mc=null,gc=null,vc=0,yc=0,_c=null,bc=!1,Sc=!1,xc=!1,wc=0,Ec=0,Tc=0,Mc=0,Cc=0,Ac=0,Ic=0,Rc=null,Pc=null,Nc=!1,kc=0,Lc=0,Dc=1/0,Oc=null,Uc=null,Fc=0,zc=null,Bc=null,Vc=0,Hc=0,jc=null,Gc=null,Wc=0,qc=null;function Xc(){return 0!==(2&pc)&&0!==vc?vc&-vc:null!==L.T?ju():Fe()}function Yc(){if(0===Ac)if(0===(536870912&vc)||di){var e=Ee;0===(3932160&(Ee<<=1))&&(Ee=262144),Ac=e}else Ac=536870912;return null!==(e=ka.current)&&(e.flags|=32),Ac}function Kc(e,t,n){(e!==mc||2!==yc&&9!==yc)&&null===e.cancelPendingCommit||(nu(e,0),$c(e,vc,Ac,!1)),Ne(e,n),0!==(2&pc)&&e===mc||(e===mc&&(0===(2&pc)&&(Mc|=n),4===Ec&&$c(e,vc,Ac,!1)),Ou(e))}function Jc(e,t,n){if(0!==(6&pc))throw Error(s(327));for(var r=!n&&0===(127&t)&&0===(t&e.expiredLanes)||Ae(e,t),i=r?function(e,t){var n=pc;pc|=2;var r=au(),i=su();mc!==e||vc!==t?(Oc=null,Dc=le()+500,nu(e,t)):Sc=Ae(e,t);e:for(;;)try{if(0!==yc&&null!==gc){t=gc;var a=_c;t:switch(yc){case 1:yc=0,_c=null,fu(e,t,a,1);break;case 2:case 9:if(na(a)){yc=0,_c=null,du(t);break}t=function(){2!==yc&&9!==yc||mc!==e||(yc=7),Ou(e)},a.then(t,t);break e;case 3:yc=7;break e;case 4:yc=5;break e;case 7:na(a)?(yc=0,_c=null,du(t)):(yc=0,_c=null,fu(e,t,a,7));break;case 5:var o=null;switch(gc.tag){case 26:o=gc.memoizedState;case 5:case 27:var l=gc;if(o?ad(o):l.stateNode.complete){yc=0,_c=null;var c=l.sibling;if(null!==c)gc=c;else{var u=l.return;null!==u?(gc=u,pu(u)):gc=null}break t}}yc=0,_c=null,fu(e,t,a,5);break;case 6:yc=0,_c=null,fu(e,t,a,6);break;case 8:tu(),Ec=6;break e;default:throw Error(s(462))}}uu();break}catch(h){ru(e,h)}return Ti=Ei=null,L.H=r,L.A=i,pc=n,null!==gc?0:(mc=null,vc=0,Rr(),Ec)}(e,t):lu(e,t,!0),a=r;;){if(0===i){Sc&&!r&&$c(e,t,0,!1);break}if(n=e.current.alternate,!a||Zc(n)){if(2===i){if(a=t,e.errorRecoveryDisabledLanes&a)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;i=Rc;var c=l.current.memoizedState.isDehydrated;if(c&&(nu(l,o).flags|=256),2!==(o=lu(l,o,!1))){if(xc&&!c){l.errorRecoveryDisabledLanes|=a,Mc|=a,i=4;break e}a=Pc,Pc=i,null!==a&&(null===Pc?Pc=a:Pc.push.apply(Pc,a))}i=o}if(a=!1,2!==i)continue}}if(1===i){nu(e,0),$c(e,t,0,!0);break}e:{switch(r=e,a=i){case 0:case 1:throw Error(s(345));case 4:if((4194048&t)!==t)break;case 6:$c(r,t,Ac,!bc);break e;case 2:Pc=null;break;case 3:case 5:break;default:throw Error(s(329))}if((62914560&t)===t&&10<(i=kc+300-le())){if($c(r,t,Ac,!bc),0!==Ce(r,0,!0))break e;Vc=t,r.timeoutHandle=xh(Qc.bind(null,r,n,Pc,Oc,Nc,t,Ac,Mc,Ic,bc,a,"Throttled",-0,0),i)}else Qc(r,n,Pc,Oc,Nc,t,Ac,Mc,Ic,bc,a,null,-0,0)}break}i=lu(e,t,!1),a=!1}Ou(e)}function Qc(e,t,n,r,i,a,s,o,l,c,u,h,d,f){if(e.timeoutHandle=-1,8192&(h=t.subtreeFlags)||16785408===(16785408&h)){sc(t,a,h={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nt});var p=(62914560&a)===a?kc-le():(4194048&a)===a?Lc-le():0;if(p=function(e,t){return e.stylesheets&&0===e.count&&cd(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&cd(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===sd&&(sd=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),r=0;r<n.length;r++){var i=n[r],a=i.transferSize,s=i.initiatorType,o=i.duration;if(a&&o&&ph(s)){for(s=0,o=i.responseEnd,r+=1;r<n.length;r++){var l=n[r],c=l.startTime;if(c>o)break;var u=l.transferSize,h=l.initiatorType;u&&ph(h)&&(s+=u*((l=l.responseEnd)<o?1:(o-c)/(l-c)))}if(--r,t+=8*(a+s)/(i.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,"number"===typeof e)?e:5}());var i=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&cd(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>sd?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}(h,p),null!==p)return Vc=a,e.cancelPendingCommit=p(gu.bind(null,e,t,a,n,r,i,s,o,l,u,h,null,d,f)),void $c(e,a,s,!c)}gu(e,t,a,n,r,i,s,o,l)}function Zc(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Zn(a(),i))return!1}catch(ox){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $c(e,t,n,r){t&=~Cc,t&=~Mc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-be(i),s=1<<a;r[a]=-1,i&=~s}0!==n&&ke(e,n,t)}function eu(){return 0!==(6&pc)||(Uu(0,!1),!1)}function tu(){if(null!==gc){if(0===yc)var e=gc.return;else Ti=Ei=null,os(e=gc),la=null,ca=0,e=gc;for(;null!==e;)gl(e.alternate,e),e=e.return;gc=null}}function nu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,wh(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),Vc=0,tu(),mc=e,gc=n=Br(e.current,null),vc=t,yc=0,_c=null,bc=!1,Sc=Ae(e,t),xc=!1,Ic=Ac=Cc=Mc=Tc=Ec=0,Pc=Rc=null,Nc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-be(r),a=1<<i;t|=e[i],r&=~a}return wc=t,Rr(),n}function ru(e,t){ja=null,L.H=go,t===Zi||t===ea?(t=sa(),yc=3):t===$i?(t=sa(),yc=4):yc=t===ko?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,_c=t,null===gc&&(Ec=1,Ao(e,Yr(t,e.current)))}function iu(){var e=ka.current;return null===e||((4194048&vc)===vc?null===La:((62914560&vc)===vc||0!==(536870912&vc))&&e===La)}function au(){var e=L.H;return L.H=go,null===e?go:e}function su(){var e=L.A;return L.A=dc,e}function ou(){Ec=4,bc||(4194048&vc)!==vc&&null!==ka.current||(Sc=!0),0===(134217727&Tc)&&0===(134217727&Mc)||null===mc||$c(mc,vc,Ac,!1)}function lu(e,t,n){var r=pc;pc|=2;var i=au(),a=su();mc===e&&vc===t||(Oc=null,nu(e,t)),t=!1;var s=Ec;e:for(;;)try{if(0!==yc&&null!==gc){var o=gc,l=_c;switch(yc){case 8:tu(),s=6;break e;case 3:case 2:case 9:case 6:null===ka.current&&(t=!0);var c=yc;if(yc=0,_c=null,fu(e,o,l,c),n&&Sc){s=0;break e}break;default:c=yc,yc=0,_c=null,fu(e,o,l,c)}}cu(),s=Ec;break}catch(u){ru(e,u)}return t&&e.shellSuspendCounter++,Ti=Ei=null,pc=r,L.H=i,L.A=a,null===gc&&(mc=null,vc=0,Rr()),s}function cu(){for(;null!==gc;)hu(gc)}function uu(){for(;null!==gc&&!se();)hu(gc)}function hu(e){var t=ol(e.alternate,e,wc);e.memoizedProps=e.pendingProps,null===t?pu(e):gc=t}function du(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=qo(n,t,t.pendingProps,t.type,void 0,vc);break;case 11:t=qo(n,t,t.pendingProps,t.type.render,t.ref,vc);break;case 5:os(t);default:gl(n,t),t=ol(n,t=gc=Vr(t,wc),wc)}e.memoizedProps=e.pendingProps,null===t?pu(e):gc=t}function fu(e,t,n,r){Ti=Ei=null,os(t),la=null,ca=0;var i=t.return;try{if(function(e,t,n,r,i){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&Ri(t,n,i,!0),null!==(n=ka.current)){switch(n.tag){case 31:case 13:return null===La?ou():null===n.alternate&&0===Ec&&(Ec=3),n.flags&=-257,n.flags|=65536,n.lanes=i,r===ta?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),Tu(e,r,i)),!1;case 22:return n.flags|=65536,r===ta?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),Tu(e,r,i)),!1}throw Error(s(435,n.tag))}return Tu(e,r,i),ou(),!1}if(di)return null!==(t=ka.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,r!==mi&&xi(Yr(e=Error(s(422),{cause:r}),n))):(r!==mi&&xi(Yr(t=Error(s(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,r=Yr(r,n),xa(e,i=Ro(e.stateNode,r,i)),4!==Ec&&(Ec=2)),!1;var a=Error(s(520),{cause:r});if(a=Yr(a,n),null===Rc?Rc=[a]:Rc.push(a),4!==Ec&&(Ec=2),null===t)return!0;r=Yr(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=i&-i,n.lanes|=e,xa(n,e=Ro(n.stateNode,r,e)),!1;case 1:if(t=n.type,a=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==a&&"function"===typeof a.componentDidCatch&&(null===Uc||!Uc.has(a))))return n.flags|=65536,i&=-i,n.lanes|=i,No(i=Po(i),e,n,r),xa(n,i),!1}n=n.return}while(null!==n);return!1}(e,i,t,n,vc))return Ec=1,Ao(e,Yr(n,e.current)),void(gc=null)}catch(ox){if(null!==i)throw gc=i,ox;return Ec=1,Ao(e,Yr(n,e.current)),void(gc=null)}32768&t.flags?(di||1===r?e=!0:Sc||0!==(536870912&vc)?e=!1:(bc=e=!0,(2===r||9===r||3===r||6===r)&&(null!==(r=ka.current)&&13===r.tag&&(r.flags|=16384))),mu(t,e)):pu(t)}function pu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,bc);e=t.return;var n=pl(t.alternate,t,wc);if(null!==n)return void(gc=n);if(null!==(t=t.sibling))return void(gc=t);gc=t=e}while(null!==t);0===Ec&&(Ec=5)}function mu(e,t){do{var n=ml(e.alternate,e);if(null!==n)return n.flags&=32767,void(gc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(gc=e);gc=e=n}while(null!==e);Ec=6,gc=null}function gu(e,t,n,r,i,a,o,l,c){e.cancelPendingCommit=null;do{Su()}while(0!==Fc);if(0!==(6&pc))throw Error(s(327));if(null!==t){if(t===e.current)throw Error(s(177));if(a=t.lanes|t.childLanes,function(e,t,n,r,i,a){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-be(n),h=1<<u;o[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&ke(e,r,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,n,a|=Ir,o,l,c),e===mc&&(gc=mc=null,vc=0),Bc=t,zc=e,Vc=n,Hc=a,jc=i,Gc=r,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,ie(de,function(){return xu(),null})):(e.callbackNode=null,e.callbackPriority=0),r=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||r){r=L.T,L.T=null,i=D.p,D.p=2,o=pc,pc|=4;try{!function(e,t){if(e=e.containerInfo,mh=bd,ir(e=rr(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(g){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=o+i),d!==a||0!==r&&3!==d.nodeType||(c=o+r),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++h===r&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(gh={focusedElem:e,selectionRange:n},bd=!1,Ll=t;null!==Ll;)if(e=(t=Ll).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ll=e;else for(;null!==Ll;){switch(a=(t=Ll).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(i=e[n]).ref.impl=i.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==a){e=void 0,n=t,i=a.memoizedProps,a=a.memoizedState,r=n.stateNode;try{var m=Eo(n.type,i);e=r.getSnapshotBeforeUpdate(m,a),r.__reactInternalSnapshotBeforeUpdate=e}catch(ox){Eu(n,n.return,ox)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))Rh(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Rh(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,Ll=e;break}Ll=t.return}}(e,t)}finally{pc=o,D.p=i,L.T=r}}Fc=1,vu(),yu(),_u()}}function vu(){if(1===Fc){Fc=0;var e=zc,t=Bc,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=L.T,L.T=null;var r=D.p;D.p=2;var i=pc;pc|=4;try{ql(t,e);var a=gh,s=rr(e.containerInfo),o=a.focusedElem,l=a.selectionRange;if(s!==o&&o&&o.ownerDocument&&nr(o.ownerDocument.documentElement,o)){if(null!==l&&ir(o)){var c=l.start,u=l.end;if(void 0===u&&(u=c),"selectionStart"in o)o.selectionStart=c,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=o.textContent.length,m=Math.min(l.start,p),g=void 0===l.end?m:Math.min(l.end,p);!f.extend&&m>g&&(s=g,g=m,m=s);var v=tr(o,m),y=tr(o,g);if(v&&y&&(1!==f.rangeCount||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==y.node||f.focusOffset!==y.offset)){var _=h.createRange();_.setStart(v.node,v.offset),f.removeAllRanges(),m>g?(f.addRange(_),f.extend(y.node,y.offset)):(_.setEnd(y.node,y.offset),f.addRange(_))}}}}for(h=[],f=o;f=f.parentNode;)1===f.nodeType&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for("function"===typeof o.focus&&o.focus(),o=0;o<h.length;o++){var b=h[o];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}bd=!!mh,gh=mh=null}finally{pc=i,D.p=r,L.T=n}}e.current=t,Fc=2}}function yu(){if(2===Fc){Fc=0;var e=zc,t=Bc,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=L.T,L.T=null;var r=D.p;D.p=2;var i=pc;pc|=4;try{Dl(e,t.alternate,t)}finally{pc=i,D.p=r,L.T=n}}Fc=3}}function _u(){if(4===Fc||3===Fc){Fc=0,oe();var e=zc,t=Bc,n=Vc,r=Gc;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Fc=5:(Fc=0,Bc=zc=null,bu(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(Uc=null),Ue(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(l){}if(null!==r){t=L.T,i=D.p,D.p=2,L.T=null;try{for(var a=e.onRecoverableError,s=0;s<r.length;s++){var o=r[s];a(o.value,{componentStack:o.stack})}}finally{L.T=t,D.p=i}}0!==(3&Vc)&&Su(),Ou(e),i=e.pendingLanes,0!==(261930&n)&&0!==(42&i)?e===qc?Wc++:(Wc=0,qc=e):Wc=0,Uu(0,!1)}}function bu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Vi(t)))}function Su(){return vu(),yu(),_u(),xu()}function xu(){if(5!==Fc)return!1;var e=zc,t=Hc;Hc=0;var n=Ue(Vc),r=L.T,i=D.p;try{D.p=32>n?32:n,L.T=null,n=jc,jc=null;var a=zc,o=Vc;if(Fc=0,Bc=zc=null,Vc=0,0!==(6&pc))throw Error(s(331));var l=pc;if(pc|=4,cc(a.current),tc(a,a.current,o,n),pc=l,Uu(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,a)}catch(c){}return!0}finally{D.p=i,L.T=r,bu(e,t)}}function wu(e,t,n){t=Yr(n,t),null!==(e=ba(e,t=Ro(e.stateNode,t,2),2))&&(Ne(e,2),Ou(e))}function Eu(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Uc||!Uc.has(r))){e=Yr(n,e),null!==(r=ba(t,n=Po(2),2))&&(No(n,r,t,e),Ne(r,2),Ou(r));break}}t=t.return}}function Tu(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fc;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(xc=!0,i.add(n),e=Mu.bind(null,e,t,n),t.then(e,e))}function Mu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,mc===e&&(vc&n)===n&&(4===Ec||3===Ec&&(62914560&vc)===vc&&300>le()-kc?0===(2&pc)&&nu(e,0):Cc|=n,Ic===vc&&(Ic=0)),Ou(e)}function Cu(e,t){0===t&&(t=Re()),null!==(e=kr(e,t))&&(Ne(e,t),Ou(e))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Cu(e,n)}function Iu(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),Cu(e,n)}var Ru=null,Pu=null,Nu=!1,ku=!1,Lu=!1,Du=0;function Ou(e){e!==Pu&&null===e.next&&(null===Pu?Ru=Pu=e:Pu=Pu.next=e),ku=!0,Nu||(Nu=!0,Th(function(){0!==(6&pc)?ie(ue,Fu):zu()}))}function Uu(e,t){if(!Lu&&ku){Lu=!0;do{for(var n=!1,r=Ru;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-be(42|e)+1)-1,a=201326741&(a&=i&~(s&~o))?201326741&a|1:a?2|a:0}0!==a&&(n=!0,Hu(r,a))}else a=vc,0===(3&(a=Ce(r,r===mc?a:0,null!==r.cancelPendingCommit||-1!==r.timeoutHandle)))||Ae(r,a)||(n=!0,Hu(r,a));r=r.next}}while(n);Lu=!1}}function Fu(){zu()}function zu(){ku=Nu=!1;var e=0;0!==Du&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Sh&&(Sh=e,!0);return Sh=null,!1}()&&(e=Du);for(var t=le(),n=null,r=Ru;null!==r;){var i=r.next,a=Bu(r,t);0===a?(r.next=null,null===n?Ru=i:n.next=i,null===i&&(Pu=n)):(n=r,(0!==e||0!==(3&a))&&(ku=!0)),r=i}0!==Fc&&5!==Fc||Uu(e,!1),0!==Du&&(Du=0)}function Bu(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var s=31-be(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=Ie(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(n=vc,n=Ce(e,e===(t=mc)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),r=e.callbackNode,0===n||e===t&&(2===yc||9===yc)||null!==e.cancelPendingCommit)return null!==r&&null!==r&&ae(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||Ae(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&ae(r),Ue(n)){case 2:case 8:n=he;break;case 32:default:n=de;break;case 268435456:n=pe}return r=Vu.bind(null,e),n=ie(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&ae(r),e.callbackPriority=2,e.callbackNode=null,2}function Vu(e,t){if(0!==Fc&&5!==Fc)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Su()&&e.callbackNode!==n)return null;var r=vc;return 0===(r=Ce(e,e===mc?r:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Jc(e,r,t),Bu(e,le()),null!=e.callbackNode&&e.callbackNode===n?Vu.bind(null,e):null)}function Hu(e,t){if(Su())return null;Jc(e,t,!0)}function ju(){if(0===Du){var e=Gi;0===e&&(e=we,0===(261888&(we<<=1))&&(we=256)),Du=e}return Du}function Gu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Pt(""+e)}function Wu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var qu=0;qu<Er.length;qu++){var Xu=Er[qu];Tr(Xu.toLowerCase(),"on"+(Xu[0].toUpperCase()+Xu.slice(1)))}Tr(gr,"onAnimationEnd"),Tr(vr,"onAnimationIteration"),Tr(yr,"onAnimationStart"),Tr("dblclick","onDoubleClick"),Tr("focusin","onFocus"),Tr("focusout","onBlur"),Tr(_r,"onTransitionRun"),Tr(br,"onTransitionStart"),Tr(Sr,"onTransitionCancel"),Tr(xr,"onTransitionEnd"),it("onMouseEnter",["mouseout","mouseover"]),it("onMouseLeave",["mouseout","mouseover"]),it("onPointerEnter",["pointerout","pointerover"]),it("onPointerLeave",["pointerout","pointerover"]),rt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),rt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),rt("onBeforeInput",["compositionend","keypress","textInput","paste"]),rt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),rt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ku=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Yu));function Ju(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=c;try{a(i)}catch(ox){Mr(ox)}i.currentTarget=null,a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;a=o,i.currentTarget=c;try{a(i)}catch(ox){Mr(ox)}i.currentTarget=null,a=l}}}}function Qu(e,t){var n=t[Ge];void 0===n&&(n=t[Ge]=new Set);var r=e+"__bubble";n.has(r)||(th(t,e,2,!1),n.add(r))}function Zu(e,t,n){var r=0;t&&(r|=4),th(n,e,r,t)}var $u="_reactListening"+Math.random().toString(36).slice(2);function eh(e){if(!e[$u]){e[$u]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Ku.has(t)||Zu(t,!1,e),Zu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$u]||(t[$u]=!0,Zu("selectionchange",!1,t))}}function th(e,t,n,r){switch(Cd(t)){case 2:var i=Sd;break;case 8:i=xd;break;default:i=wd}n=i.bind(null,t,n,e),i=void 0,!Ht||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function nh(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i)break;if(4===s)for(s=r.return;null!==s;){var c=s.tag;if((3===c||4===c)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==o;){if(null===(s=Je(o)))return;if(5===(c=s.tag)||6===c||26===c||27===c){r=a=s;continue e}o=o.parentNode}}r=r.return}zt(function(){var r=a,i=Lt(n),s=[];e:{var o=wr.get(e);if(void 0!==o){var c=nn,u=e;switch(e){case"keypress":if(0===Yt(n))break e;case"keydown":case"keyup":c=yn;break;case"focusin":u="focus",c=cn;break;case"focusout":u="blur",c=cn;break;case"beforeblur":case"afterblur":c=cn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=on;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=ln;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=bn;break;case gr:case vr:case yr:c=un;break;case xr:c=Sn;break;case"scroll":case"scrollend":c=an;break;case"wheel":c=xn;break;case"copy":case"cut":case"paste":c=hn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=_n;break;case"toggle":case"beforetoggle":c=wn}var h=0!==(4&t),d=!h&&("scroll"===e||"scrollend"===e),f=h?null!==o?o+"Capture":null:o;h=[];for(var p,m=r;null!==m;){var g=m;if(p=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===p||null===f||null!=(g=Bt(m,f))&&h.push(rh(m,g,p)),d)break;m=m.return}0<h.length&&(o=new c(o,u,null,n,i),s.push({event:o,listeners:h}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===kt||!(u=n.relatedTarget||n.fromElement)||!Je(u)&&!u[je])&&(c||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Je(u):null)&&(d=l(u),h=u.tag,u!==d||5!==h&&27!==h&&6!==h)&&(u=null)):(c=null,u=r),c!==u)){if(h=on,g="onMouseLeave",f="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(h=_n,g="onPointerLeave",f="onPointerEnter",m="pointer"),d=null==c?o:Ze(c),p=null==u?o:Ze(u),(o=new h(g,m+"leave",c,n,i)).target=d,o.relatedTarget=p,g=null,Je(i)===r&&((h=new h(f,m+"enter",u,n,i)).target=p,h.relatedTarget=d,g=h),d=g,c&&u)e:{for(h=ah,m=u,p=0,g=f=c;g;g=h(g))p++;g=0;for(var v=m;v;v=h(v))g++;for(;0<p-g;)f=h(f),p--;for(;0<g-p;)m=h(m),g--;for(;p--;){if(f===m||null!==m&&f===m.alternate){h=f;break e}f=h(f),m=h(m)}h=null}else h=null;null!==c&&sh(s,o,c,h,!1),null!==u&&null!==d&&sh(s,d,u,h,!0)}if("select"===(c=(o=r?Ze(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var y=Vn;else if(Dn(o))if(Hn)y=Qn;else{y=Kn;var _=Yn}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?r&&At(r.elementType)&&(y=Vn):y=Jn;switch(y&&(y=y(e,r))?On(s,y,n,i):(_&&_(e,o,r),"focusout"===e&&r&&"number"===o.type&&null!=r.memoizedProps.value&&bt(o,"number",o.value)),_=r?Ze(r):window,e){case"focusin":(Dn(_)||"true"===_.contentEditable)&&(sr=_,or=r,lr=null);break;case"focusout":lr=or=sr=null;break;case"mousedown":cr=!0;break;case"contextmenu":case"mouseup":case"dragend":cr=!1,ur(s,n,i);break;case"selectionchange":if(ar)break;case"keydown":case"keyup":ur(s,n,i)}var b;if(Tn)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else kn?Pn(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(An&&"ko"!==n.locale&&(kn||"onCompositionStart"!==S?"onCompositionEnd"===S&&kn&&(b=Xt()):(Wt="value"in(Gt=i)?Gt.value:Gt.textContent,kn=!0)),0<(_=ih(r,S)).length&&(S=new dn(S,e,null,n,i),s.push({event:S,listeners:_}),b?S.data=b:null!==(b=Nn(n))&&(S.data=b))),(b=Cn?function(e,t){switch(e){case"compositionend":return Nn(t);case"keypress":return 32!==t.which?null:(Rn=!0,In);case"textInput":return(e=t.data)===In&&Rn?null:e;default:return null}}(e,n):function(e,t){if(kn)return"compositionend"===e||!Tn&&Pn(e,t)?(e=Xt(),qt=Wt=Gt=null,kn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return An&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(S=ih(r,"onBeforeInput")).length&&(_=new dn("onBeforeInput","beforeinput",null,n,i),s.push({event:_,listeners:S}),_.data=b)),function(e,t,n,r,i){if("submit"===t&&n&&n.stateNode===i){var a=Gu((i[He]||null).action),s=r.submitter;s&&null!==(t=(t=s[He]||null)?Gu(t.formAction):s.getAttribute("formAction"))&&(a=t,s=null);var o=new nn("action","action",null,r,i);e.push({event:o,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==Du){var e=s?Wu(i,s):new FormData(i);to(n,{pending:!0,data:e,method:i.method,action:a},null,e)}}else"function"===typeof a&&(o.preventDefault(),e=s?Wu(i,s):new FormData(i),to(n,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}(s,e,r,n,i)}Ju(s,t)})}function rh(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ih(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===a||(null!=(i=Bt(e,n))&&r.unshift(rh(e,i,a)),null!=(i=Bt(e,t))&&r.push(rh(e,i,a))),3===e.tag)return r;e=e.return}return[]}function ah(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function sh(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(o=o.tag,null!==l&&l===r)break;5!==o&&26!==o&&27!==o||null===c||(l=c,i?null!=(c=Bt(n,a))&&s.unshift(rh(n,c,l)):i||null!=(c=Bt(n,a))&&s.push(rh(n,c,l))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var oh=/\r\n?/g,lh=/\u0000|\uFFFD/g;function ch(e){return("string"===typeof e?e:""+e).replace(oh,"\n").replace(lh,"")}function uh(e,t){return t=ch(t),ch(e)===t}function hh(e,t,n,r,i,a){switch(n){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||Et(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&Et(e,""+r);break;case"className":ct(e,"class",r);break;case"tabIndex":ct(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":ct(e,n,r);break;case"style":Ct(e,r,a);break;case"data":if("object"!==t){ct(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof a&&("formAction"===n?("input"!==t&&hh(e,t,"name",i.name,i,null),hh(e,t,"formEncType",i.formEncType,i,null),hh(e,t,"formMethod",i.formMethod,i,null),hh(e,t,"formTarget",i.formTarget,i,null)):(hh(e,t,"encType",i.encType,i,null),hh(e,t,"method",i.method,i,null),hh(e,t,"target",i.target,i,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(n);break}r=Pt(""+r),e.setAttribute(n,r);break;case"onClick":null!=r&&(e.onclick=Nt);break;case"onScroll":null!=r&&Qu("scroll",e);break;case"onScrollEnd":null!=r&&Qu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}n=Pt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""+r):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===r?e.setAttribute(n,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(n,r):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case"popover":Qu("beforetoggle",e),Qu("toggle",e),lt(e,"popover",r);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":lt(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&lt(e,n=It.get(n)||n,r)}}function dh(e,t,n,r,i,a){switch(n){case"style":Ct(e,r,a);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(n=r.__html)){if(null!=i.children)throw Error(s(60));e.innerHTML=n}}break;case"children":"string"===typeof r?Et(e,r):("number"===typeof r||"bigint"===typeof r)&&Et(e,""+r);break;case"onScroll":null!=r&&Qu("scroll",e);break;case"onScrollEnd":null!=r&&Qu("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Nt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(i=n.endsWith("Capture"),t=n.slice(2,i?n.length-7:void 0),"function"===typeof(a=null!=(a=e[He]||null)?a[n]:null)&&e.removeEventListener(t,a,i),"function"!==typeof r)?n in e?e[n]=r:!0===r?e.setAttribute(n,""):lt(e,n,r):("function"!==typeof a&&null!==a&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,i)))}}function fh(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qu("error",e),Qu("load",e);var r,i=!1,a=!1;for(r in n)if(n.hasOwnProperty(r)){var o=n[r];if(null!=o)switch(r){case"src":i=!0;break;case"srcSet":a=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:hh(e,t,r,o,n,null)}}return a&&hh(e,t,"srcSet",n.srcSet,n,null),void(i&&hh(e,t,"src",n.src,n,null));case"input":Qu("invalid",e);var l=r=o=a=null,c=null,u=null;for(i in n)if(n.hasOwnProperty(i)){var h=n[i];if(null!=h)switch(i){case"name":a=h;break;case"type":o=h;break;case"checked":c=h;break;case"defaultChecked":u=h;break;case"value":r=h;break;case"defaultValue":l=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(s(137,t));break;default:hh(e,t,i,h,n,null)}}return void _t(e,r,l,c,u,o,a,!1);case"select":for(a in Qu("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(a)&&null!=(l=n[a]))switch(a){case"value":r=l;break;case"defaultValue":o=l;break;case"multiple":i=l;default:hh(e,t,a,l,n,null)}return t=r,n=o,e.multiple=!!i,void(null!=t?St(e,!!i,t,!1):null!=n&&St(e,!!i,n,!0));case"textarea":for(o in Qu("invalid",e),r=a=i=null,n)if(n.hasOwnProperty(o)&&null!=(l=n[o]))switch(o){case"value":i=l;break;case"defaultValue":a=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:hh(e,t,o,l,n,null)}return void wt(e,i,a,r);case"option":for(c in n)if(n.hasOwnProperty(c)&&null!=(i=n[c]))if("selected"===c)e.selected=i&&"function"!==typeof i&&"symbol"!==typeof i;else hh(e,t,c,i,n,null);return;case"dialog":Qu("beforetoggle",e),Qu("toggle",e),Qu("cancel",e),Qu("close",e);break;case"iframe":case"object":Qu("load",e);break;case"video":case"audio":for(i=0;i<Yu.length;i++)Qu(Yu[i],e);break;case"image":Qu("error",e),Qu("load",e);break;case"details":Qu("toggle",e);break;case"embed":case"source":case"link":Qu("error",e),Qu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(i=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:hh(e,t,u,i,n,null)}return;default:if(At(t)){for(h in n)n.hasOwnProperty(h)&&(void 0!==(i=n[h])&&dh(e,t,h,i,n,void 0));return}}for(l in n)n.hasOwnProperty(l)&&(null!=(i=n[l])&&hh(e,t,l,i,n,null))}function ph(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var mh=null,gh=null;function vh(e){return 9===e.nodeType?e:e.ownerDocument}function yh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function _h(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function bh(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Sh=null;var xh="function"===typeof setTimeout?setTimeout:void 0,wh="function"===typeof clearTimeout?clearTimeout:void 0,Eh="function"===typeof Promise?Promise:void 0,Th="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Eh?function(e){return Eh.resolve(null).then(e).catch(Mh)}:xh;function Mh(e){setTimeout(function(){throw e})}function Ch(e){return"head"===e}function Ah(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)||"/&"===n){if(0===r)return e.removeChild(i),void Wd(t);r--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)r++;else if("html"===n)zh(e.ownerDocument.documentElement);else if("head"===n){zh(n=e.ownerDocument.head);for(var a=n.firstChild;a;){var s=a.nextSibling,o=a.nodeName;a[Ye]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===a.rel.toLowerCase()||n.removeChild(a),a=s}}else"body"===n&&zh(e.ownerDocument.body);n=i}while(n);Wd(t)}function Ih(e,t){var n=e;e=0;do{var r=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=r}while(n)}function Rh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Rh(n),Ke(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Ph(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Lh(e.nextSibling)))return null}return e}function Nh(e){return"$?"===e.data||"$~"===e.data}function kh(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Lh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Dh=null;function Oh(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Lh(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function Uh(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Fh(e,t,n){switch(t=vh(n),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}function zh(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ke(e)}var Bh=new Map,Vh=new Set;function Hh(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var jh=D.d;D.d={f:function(){var e=jh.f(),t=eu();return e||t},r:function(e){var t=Qe(e);null!==t&&5===t.tag&&"form"===t.type?ro(t):jh.r(e)},D:function(e){jh.D(e),Wh("dns-prefetch",e,null)},C:function(e,t){jh.C(e,t),Wh("preconnect",e,t)},L:function(e,t,n){jh.L(e,t,n);var r=Gh;if(r&&e&&t){var i='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(i+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(i+='[imagesizes="'+vt(n.imageSizes)+'"]')):i+='[href="'+vt(e)+'"]';var a=i;switch(t){case"style":a=Xh(e);break;case"script":a=Jh(e)}Bh.has(a)||(e=f({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Bh.set(a,e),null!==r.querySelector(i)||"style"===t&&r.querySelector(Yh(a))||"script"===t&&r.querySelector(Qh(a))||(fh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}},m:function(e,t){jh.m(e,t);var n=Gh;if(n&&e){var r=t&&"string"===typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+vt(r)+'"][href="'+vt(e)+'"]',a=i;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":a=Jh(e)}if(!Bh.has(a)&&(e=f({rel:"modulepreload",href:e},t),Bh.set(a,e),null===n.querySelector(i))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Qh(a)))return}fh(r=n.createElement("link"),"link",e),et(r),n.head.appendChild(r)}}},X:function(e,t){jh.X(e,t);var n=Gh;if(n&&e){var r=$e(n).hoistableScripts,i=Jh(e),a=r.get(i);a||((a=n.querySelector(Qh(i)))||(e=f({src:e,async:!0},t),(t=Bh.get(i))&&td(e,t),et(a=n.createElement("script")),fh(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}},S:function(e,t,n){jh.S(e,t,n);var r=Gh;if(r&&e){var i=$e(r).hoistableStyles,a=Xh(e);t=t||"default";var s=i.get(a);if(!s){var o={loading:0,preload:null};if(s=r.querySelector(Yh(a)))o.loading=5;else{e=f({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Bh.get(a))&&ed(e,n);var l=s=r.createElement("link");et(l),fh(l,"link",e),l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),l.addEventListener("load",function(){o.loading|=1}),l.addEventListener("error",function(){o.loading|=2}),o.loading|=4,$h(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:o},i.set(a,s)}}},M:function(e,t){jh.M(e,t);var n=Gh;if(n&&e){var r=$e(n).hoistableScripts,i=Jh(e),a=r.get(i);a||((a=n.querySelector(Qh(i)))||(e=f({src:e,async:!0,type:"module"},t),(t=Bh.get(i))&&td(e,t),et(a=n.createElement("script")),fh(a,"link",e),n.head.appendChild(a)),a={type:"script",instance:a,count:1,state:null},r.set(i,a))}}};var Gh="undefined"===typeof document?null:document;function Wh(e,t,n){var r=Gh;if(r&&"string"===typeof t&&t){var i=vt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"===typeof n&&(i+='[crossorigin="'+n+'"]'),Vh.has(i)||(Vh.add(i),e={rel:e,crossOrigin:n,href:t},null===r.querySelector(i)&&(fh(t=r.createElement("link"),"link",e),et(t),r.head.appendChild(t)))}}function qh(e,t,n,r){var i=(i=q.current)?Hh(i):null;if(!i)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Xh(n.href),(r=(n=$e(i).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Xh(n.href);var a=$e(i).hoistableStyles,o=a.get(e);if(o||(i=i.ownerDocument||i,o={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},a.set(e,o),(a=i.querySelector(Yh(e)))&&!a._p&&(o.instance=a,o.state.loading=5),Bh.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Bh.set(e,n),a||function(e,t,n,r){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?r.loading=1:(t=e.createElement("link"),r.preload=t,t.addEventListener("load",function(){return r.loading|=1}),t.addEventListener("error",function(){return r.loading|=2}),fh(t,"link",n),et(t),e.head.appendChild(t))}(i,e,n,o.state))),t&&null===r)throw Error(s(528,""));return o}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=Jh(n),(r=(n=$e(i).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},n.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function Xh(e){return'href="'+vt(e)+'"'}function Yh(e){return'link[rel="stylesheet"]['+e+"]"}function Kh(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function Jh(e){return'[src="'+vt(e)+'"]'}function Qh(e){return"script[async]"+e}function Zh(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(r)return t.instance=r,et(r),r;var i=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(r=(e.ownerDocument||e).createElement("style")),fh(r,"style",i),$h(r,n.precedence,e),t.instance=r;case"stylesheet":i=Xh(n.href);var a=e.querySelector(Yh(i));if(a)return t.state.loading|=4,t.instance=a,et(a),a;r=Kh(n),(i=Bh.get(i))&&ed(r,i),et(a=(e.ownerDocument||e).createElement("link"));var o=a;return o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),fh(a,"link",r),t.state.loading|=4,$h(a,n.precedence,e),t.instance=a;case"script":return a=Jh(n.src),(i=e.querySelector(Qh(a)))?(t.instance=i,et(i),i):(r=n,(i=Bh.get(a))&&td(r=f({},n),i),et(i=(e=e.ownerDocument||e).createElement("script")),fh(i,"link",r),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,$h(r,n.precedence,e));return t.instance}function $h(e,t,n){for(var r=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=r.length?r[r.length-1]:null,a=i,s=0;s<r.length;s++){var o=r[s];if(o.dataset.precedence===t)a=o;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function td(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var nd=null;function rd(e,t,n){if(null===nd){var r=new Map,i=nd=new Map;i.set(n,r)}else(r=(i=nd).get(n))||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var a=n[i];if(!(a[Ye]||a[Ve]||"link"===e&&"stylesheet"===a.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==a.namespaceURI){var s=a.getAttribute(t)||"";s=e+s;var o=r.get(s);o?o.push(a):r.set(s,[a])}}return r}function id(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function ad(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var sd=0;function od(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)cd(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ld=null;function cd(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ld=new Map,t.forEach(ud,e),ld=null,od.call(e))}function ud(e,t){if(!(4&t.state.loading)){var n=ld.get(e);if(n)var r=n.get(null);else{n=new Map,ld.set(e,n);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),a=0;a<i.length;a++){var s=i[a];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(n.set(s.dataset.precedence,s),r=s)}r&&n.set(null,r)}s=(i=t.instance).getAttribute("data-precedence"),(a=n.get(s)||r)===r&&n.set(null,i),n.set(s,i),this.count++,r=od.bind(this),i.addEventListener("load",r),i.addEventListener("error",r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var hd={$$typeof:S,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function dd(e,t,n,r,i,a,s,o,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pe(0),this.hiddenUpdates=Pe(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function fd(e,t,n,r,i,a,s,o,l,c,u,h){return e=new dd(e,t,n,s,l,c,u,h,o),t=1,!0===a&&(t|=24),a=Fr(3,null,null,t),e.current=a,a.stateNode=e,(t=Bi()).refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:r,isDehydrated:n,cache:t},va(a),e}function pd(e){return e?e=Or:Or}function md(e,t,n,r,i,a){i=pd(i),null===r.context?r.context=i:r.pendingContext=i,(r=_a(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(r.callback=a),null!==(n=ba(e,r,t))&&(Kc(n,0,t),Sa(n,e,t))}function gd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function vd(e,t){gd(e,t),(e=e.alternate)&&gd(e,t)}function yd(e){if(13===e.tag||31===e.tag){var t=kr(e,67108864);null!==t&&Kc(t,0,67108864),vd(e,67108864)}}function _d(e){if(13===e.tag||31===e.tag){var t=Xc(),n=kr(e,t=Oe(t));null!==n&&Kc(n,0,t),vd(e,t)}}var bd=!0;function Sd(e,t,n,r){var i=L.T;L.T=null;var a=D.p;try{D.p=2,wd(e,t,n,r)}finally{D.p=a,L.T=i}}function xd(e,t,n,r){var i=L.T;L.T=null;var a=D.p;try{D.p=8,wd(e,t,n,r)}finally{D.p=a,L.T=i}}function wd(e,t,n,r){if(bd){var i=Ed(r);if(null===i)nh(e,t,r,Td,n),Od(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Id=Ud(Id,e,t,n,r,i),!0;case"dragenter":return Rd=Ud(Rd,e,t,n,r,i),!0;case"mouseover":return Pd=Ud(Pd,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return Nd.set(a,Ud(Nd.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,kd.set(a,Ud(kd.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Od(e,r),4&t&&-1<Dd.indexOf(e)){for(;null!==i;){var a=Qe(i);if(null!==a)switch(a.tag){case 3:if((a=a.stateNode).current.memoizedState.isDehydrated){var s=Me(a.pendingLanes);if(0!==s){var o=a;for(o.pendingLanes|=2,o.entangledLanes|=2;s;){var l=1<<31-be(s);o.entanglements[1]|=l,s&=~l}Ou(a),0===(6&pc)&&(Dc=le()+500,Uu(0,!1))}}break;case 31:case 13:null!==(o=kr(a,2))&&Kc(o,0,2),eu(),vd(a,2)}if(null===(a=Ed(r))&&nh(e,t,r,Td,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else nh(e,t,r,null,n)}}function Ed(e){return Md(e=Lt(e))}var Td=null;function Md(e){if(Td=null,null!==(e=Je(e))){var t=l(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=c(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Td=e,null}function Cd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case he:return 8;case de:case fe:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Ad=!1,Id=null,Rd=null,Pd=null,Nd=new Map,kd=new Map,Ld=[],Dd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Od(e,t){switch(e){case"focusin":case"focusout":Id=null;break;case"dragenter":case"dragleave":Rd=null;break;case"mouseover":case"mouseout":Pd=null;break;case"pointerover":case"pointerout":Nd.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kd.delete(t.pointerId)}}function Ud(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=Qe(t))&&yd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Fd(e){var t=Je(e.target);if(null!==t){var n=l(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=c(n)))return e.blockedOn=t,void ze(e.priority,function(){_d(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void ze(e.priority,function(){_d(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function zd(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ed(e.nativeEvent);if(null!==n)return null!==(t=Qe(n))&&yd(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);kt=r,n.target.dispatchEvent(r),kt=null,t.shift()}return!0}function Bd(e,t,n){zd(e)&&n.delete(t)}function Vd(){Ad=!1,null!==Id&&zd(Id)&&(Id=null),null!==Rd&&zd(Rd)&&(Rd=null),null!==Pd&&zd(Pd)&&(Pd=null),Nd.forEach(Bd),kd.forEach(Bd)}function Hd(e,t){e.blockedOn===t&&(e.blockedOn=null,Ad||(Ad=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Vd)))}var jd=null;function Gd(e){jd!==e&&(jd=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){jd===e&&(jd=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if("function"!==typeof r){if(null===Md(r||n))continue;break}var a=Qe(n);null!==a&&(e.splice(t,3),t-=3,to(a,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Wd(e){function t(t){return Hd(t,e)}null!==Id&&Hd(Id,e),null!==Rd&&Hd(Rd,e),null!==Pd&&Hd(Pd,e),Nd.forEach(t),kd.forEach(t);for(var n=0;n<Ld.length;n++){var r=Ld[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Ld.length&&null===(n=Ld[0]).blockedOn;)Fd(n),null===n.blockedOn&&Ld.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<n.length;r+=3){var i=n[r],a=n[r+1],s=i[He]||null;if("function"===typeof a)s||Gd(n);else if(s){var o=null;if(a&&a.hasAttribute("formAction")){if(i=a,s=a[He]||null)o=s.formAction;else if(null!==Md(i))continue}else o=s.action;"function"===typeof o?n[r+1]=o:(n.splice(r,3),r-=3),Gd(n)}}}function qd(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==i&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var r=!1,i=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==i&&(i(),i=null)}}}function Xd(e){this._internalRoot=e}function Yd(e){this._internalRoot=e}Yd.prototype.render=Xd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));md(t.current,Xc(),e,t,null,null)},Yd.prototype.unmount=Xd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;md(e.current,2,null,e,null,null),eu(),t[je]=null}},Yd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Fe();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ld.length&&0!==t&&t<Ld[n].priority;n++);Ld.splice(n,0,e),0===n&&Fd(e)}};var Kd=i.version;if("19.2.3"!==Kd)throw Error(s(527,Kd,"19.2.3"));D.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return h(i),e;if(a===r)return h(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o){for(c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Jd={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.2.3"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Qd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qd.isDisabled&&Qd.supportsFiber)try{ve=Qd.inject(Jd),ye=Qd}catch($d){}}t.createRoot=function(e,t){if(!o(e))throw Error(s(299));var n=!1,r="",i=To,a=Mo,l=Co;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(a=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),t=fd(e,1,!1,null,0,n,r,null,i,a,l,qd),e[je]=t.current,eh(e),new Xd(t)},t.hydrateRoot=function(e,t,n){if(!o(e))throw Error(s(299));var r=!1,i="",a=To,l=Mo,c=Co,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onUncaughtError&&(a=n.onUncaughtError),void 0!==n.onCaughtError&&(l=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=fd(e,1,!0,t,0,r,i,u,a,l,c,qd)).context=pd(null),n=t.current,(i=_a(r=Oe(r=Xc()))).callback=null,ba(n,i,r),n=r,t.current.lanes=n,Ne(t,n),Ou(t),e[je]=t.current,eh(e),new Yd(t)},t.version="19.2.3"},16:(e,t,n)=>{e.exports=n(492)},43:(e,t,n)=>{e.exports=n(288)},179:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,P();else{var t=r(u);null!==t&&N(S,t.startTime-e)}}var x,w=!1,E=-1,T=5,M=-1;function C(){return!(t.unstable_now()-M<T)}function A(){if(w){var e=t.unstable_now();M=e;var n=!0;try{e:{m=!1,g&&(g=!1,y(E),E=-1),p=!0;var a=f;try{t:{for(b(e),d=r(c);null!==d&&!(d.expirationTime>e&&C());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){d.callback=o,b(e),n=!0;break t}d===r(c)&&i(c),b(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&N(S,l.startTime-e),n=!1}}break e}finally{d=null,f=a,p=!1}n=void 0}}finally{n?x():w=!1}}}if("function"===typeof _)x=function(){_(A)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,R=I.port2;I.port1.onmessage=A,x=function(){R.postMessage(null)}}else x=function(){v(A,0)};function P(){w||(w=!0,x())}function N(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(y(E),E=-1):g=!0,N(S,a-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,P())),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},205:(e,t,n)=>{e.exports=n(252)},252:(e,t)=>{t.ConcurrentRoot=1,t.ContinuousEventPriority=8,t.DefaultEventPriority=32,t.DiscreteEventPriority=2},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),p=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function _(){}function b(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=y.prototype;var S=b.prototype=new _;S.constructor=b,g(S,y.prototype),S.isPureReactComponent=!0;var x=Array.isArray;function w(){}var E={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function M(e,t,r){var i=r.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==i?i:null,props:r}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var A=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function R(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(o){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0;break;case d:return R((u=e._init)(e._payload),t,i,a,s)}}if(u)return s=s(e),u=""===a?"."+I(e,0):a,x(s)?(i="",null!=u&&(i=u.replace(A,"$&/")+"/"),R(s,t,i,"",function(e){return e})):null!=s&&(C(s)&&(l=s,c=i+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(A,"$&/")+"/")+u,s=M(l.type,c,l.props)),t.push(s)),1;u=0;var h,f=""===a?".":a+":";if(x(e))for(var m=0;m<e.length;m++)u+=R(a=e[m],t,i,o=f+I(a,m),s);else if("function"===typeof(m=null===(h=e)||"object"!==typeof h?null:"function"===typeof(h=p&&h[p]||h["@@iterator"])?h:null))for(e=m.call(e),m=0;!(a=e.next()).done;)u+=R(a=a.value,t,i,o=f+I(a,m++),s);else if("object"===o){if("function"===typeof e.then)return R(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(w,w):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,i,a,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function P(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",function(e){return t.call(n,e,i++)}),r}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var k="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},L={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=f,t.Children=L,t.Component=y,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=E,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return E.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=g({},e.props),i=e.key;if(null!=t)for(a in void 0!==t.key&&(i=""+t.key),t)!T.call(t,a)||"key"===a||"__self"===a||"__source"===a||"ref"===a&&void 0===t.ref||(r[a]=t[a]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),o=0;o<a;o++)s[o]=arguments[o+2];r.children=s}return M(e.type,i,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:o,_context:e},e},t.createElement=function(e,t,n){var r,i={},a=null;if(null!=t)for(r in void 0!==t.key&&(a=""+t.key),t)T.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var o=Array(s),l=0;l<s;l++)o[l]=arguments[l+2];i.children=o}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return M(e,a,i)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=E.T,n={};E.T=n;try{var r=e(),i=E.S;null!==i&&i(n,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(w,k)}catch(ox){k(ox)}finally{null!==t&&null!==n.types&&(t.types=n.types),E.T=t}},t.unstable_useCacheRefresh=function(){return E.H.useCacheRefresh()},t.use=function(e){return E.H.use(e)},t.useActionState=function(e,t,n){return E.H.useActionState(e,t,n)},t.useCallback=function(e,t){return E.H.useCallback(e,t)},t.useContext=function(e){return E.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return E.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return E.H.useEffect(e,t)},t.useEffectEvent=function(e){return E.H.useEffectEvent(e)},t.useId=function(){return E.H.useId()},t.useImperativeHandle=function(e,t,n){return E.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return E.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return E.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return E.H.useMemo(e,t)},t.useOptimistic=function(e,t){return E.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return E.H.useReducer(e,t,n)},t.useRef=function(e){return E.H.useRef(e)},t.useState=function(e){return E.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return E.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return E.H.useTransition()},t.version="19.2.3"},330:(e,t,n)=>{var r=n(43);var i="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},a=r.useState,s=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function c(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!i(e,n)}catch(ox){return!0}}var u="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var n=t(),r=a({inst:{value:n,getSnapshot:t}}),i=r[0].inst,u=r[1];return o(function(){i.value=n,i.getSnapshot=t,c(i)&&u({inst:i})},[e,n,t]),s(function(){return c(i)&&u({inst:i}),e(function(){c(i)&&u({inst:i})})},[e]),l(n),n};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},388:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,P();else{var t=r(u);null!==t&&N(S,t.startTime-e)}}var x,w=!1,E=-1,T=5,M=-1;function C(){return!(t.unstable_now()-M<T)}function A(){if(w){var e=t.unstable_now();M=e;var n=!0;try{e:{m=!1,g&&(g=!1,y(E),E=-1),p=!0;var a=f;try{t:{for(b(e),d=r(c);null!==d&&!(d.expirationTime>e&&C());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){d.callback=o,b(e),n=!0;break t}d===r(c)&&i(c),b(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&N(S,l.startTime-e),n=!1}}break e}finally{d=null,f=a,p=!1}n=void 0}}finally{n?x():w=!1}}}if("function"===typeof _)x=function(){_(A)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,R=I.port2;I.port1.onmessage=A,x=function(){R.postMessage(null)}}else x=function(){v(A,0)};function P(){w||(w=!0,x())}function N(e,n){E=v(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(y(E),E=-1):g=!0,N(S,a-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,P())),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},443:(e,t,n)=>{e.exports=n(717)},461:(e,t,n)=>{e.exports=n(330)},492:(e,t,n)=>{e.exports=function(e){function t(e,t,n,r){return new Ti(e,t,n,r)}function r(){}function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=ca&&e[ca]||e["@@iterator"])?e:null}function s(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===ua?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case Yi:return"Fragment";case Xi:return"Portal";case Ji:return"Profiler";case Ki:return"StrictMode";case ta:return"Suspense";case na:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case $i:return(e.displayName||"Context")+".Provider";case Zi:return(e._context.displayName||"Context")+".Consumer";case ea:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case ra:return null!==(t=e.displayName||null)?t:s(e.type)||"Memo";case ia:t=e._payload,e=e._init;try{return s(e(t))}catch(ni){}}return null}function o(e){if(void 0===sa)try{throw Error()}catch(ni){var t=ni.stack.trim().match(/\n( *(at )?)/);sa=t&&t[1]||"",oa=-1<ni.stack.indexOf("\n    at")?" (<anonymous>)":-1<ni.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+sa+e+oa}function l(e,t){if(!e||da)return"";da=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(ni){var r=ni}Reflect.construct(e,[],n)}else{try{n.call()}catch(i){r=i}e.call(n.prototype)}}else{try{throw Error()}catch(a){r=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&r&&"string"===typeof s.stack)return[s.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var a=r.DetermineComponentFrameRoot(),s=a[0],l=a[1];if(s&&l){var c=s.split("\n"),u=l.split("\n");for(i=r=0;r<c.length&&!c[r].includes("DetermineComponentFrameRoot");)r++;for(;i<u.length&&!u[i].includes("DetermineComponentFrameRoot");)i++;if(r===c.length||i===u.length)for(r=c.length-1,i=u.length-1;1<=r&&0<=i&&c[r]!==u[i];)i--;for(;1<=r&&0<=i;r--,i--)if(c[r]!==u[i]){if(1!==r||1!==i)do{if(r--,0>--i||c[r]!==u[i]){var h="\n"+c[r].replace(" at new "," at ");return e.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",e.displayName)),h}}while(1<=r&&0<=i);break}}}finally{da=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?o(n):""}function c(e){switch(e.tag){case 26:case 27:case 5:return o(e.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return e=l(e.type,!1);case 11:return e=l(e.type.render,!1);case 1:return e=l(e.type,!0);default:return""}}function u(e){try{var t="";do{t+=c(e),e=e.return}while(e);return t}catch(ni){return"\nError generating stack: "+ni.message+"\n"+ni.stack}}function h(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function d(e){if(h(e)!==e)throw Error(i(188))}function f(e){var t=e.alternate;if(!t){if(null===(t=h(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(r=a.return)){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return d(a),e;if(s===r)return d(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,r=s;break}if(l===r){o=!0,r=a,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=a;break}if(l===r){o=!0,r=s,n=a;break}l=l.sibling}if(!o)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}function p(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=p(e)))return t;e=e.sibling}return null}function m(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(4!==e.tag&&null!==(t=m(e)))return t;e=e.sibling}return null}function g(e){return{current:e}}function v(e){0>_o||(e.current=yo[_o],yo[_o]=null,_o--)}function y(e,t){_o++,yo[_o]=e.current,e.current=t}function _(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function b(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=e.warmLanes;e=0!==e.finishedLanes;var o=134217727&n;return 0!==o?0!==(n=o&~i)?r=_(n):0!==(a&=o)?r=_(a):e||0!==(s=o&~s)&&(r=_(s)):0!==(o=n&~i)?r=_(o):0!==a?r=_(a):e||0!==(s=n&~s)&&(r=_(s)),0===r?0:0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||32===i&&0!==(4194176&s))?t:r}function S(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function x(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function w(){var e=Eo;return 0===(4194176&(Eo<<=1))&&(Eo=128),e}function E(){var e=To;return 0===(62914560&(To<<=1))&&(To=4194304),e}function T(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function M(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function C(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-So(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&n}function A(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-So(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function I(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function R(e){if("function"===typeof Do&&Oo(e),Fo&&"function"===typeof Fo.setStrictMode)try{Fo.setStrictMode(Uo,e)}catch(t){}}function P(e,t){if("object"===typeof e&&null!==e){var n=Bo.get(e);return void 0!==n?n:(t={value:e,source:t,stack:u(t)},Bo.set(e,t),t)}return{value:e,source:t,stack:u(t)}}function N(e,t){Vo[Ho++]=Go,Vo[Ho++]=jo,jo=e,Go=t}function k(e,t,n){Wo[qo++]=Yo,Wo[qo++]=Ko,Wo[qo++]=Xo,Xo=e;var r=Yo;e=Ko;var i=32-So(r)-1;r&=~(1<<i),n+=1;var a=32-So(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Yo=1<<32-So(t)+i|n<<i|r,Ko=a+e}else Yo=1<<a|n<<i|r,Ko=e}function L(e){null!==e.return&&(N(e,1),k(e,1,0))}function D(e){for(;e===jo;)jo=Vo[--Ho],Vo[Ho]=null,Go=Vo[--Ho],Vo[Ho]=null;for(;e===Xo;)Xo=Wo[--qo],Wo[qo]=null,Ko=Wo[--qo],Wo[qo]=null,Yo=Wo[--qo],Wo[qo]=null}function O(e,t){y(Zo,t),y(Qo,e),y(Jo,null),e=ya(t),v(Jo),y(Jo,e)}function U(){v(Jo),v(Qo),v(Zo)}function F(e){null!==e.memoizedState&&y($o,e);var t=Jo.current,n=_a(t,e.type);t!==n&&(y(Qo,e),y(Jo,n))}function z(e){Qo.current===e&&(v(Jo),v(Qo)),$o.current===e&&(v($o),Ra?Xa._currentValue=qa:Xa._currentValue2=qa)}function B(e){throw W(P(Error(i(418,"")),e)),al}function V(e,t){if(!ka)throw Error(i(175));Bs(e.stateNode,e.type,e.memoizedProps,t,e)||B(e)}function H(e){for(el=e.return;el;)switch(el.tag){case 3:case 27:return void(il=!0);case 5:case 13:return void(il=!1);default:el=el.return}}function j(e){if(!ka||e!==el)return!1;if(!nl)return H(e),nl=!0,!1;var t=!1;if(ho?3!==e.tag&&27!==e.tag&&(5!==e.tag||Ys(e.type)&&!Ta(e.type,e.memoizedProps))&&(t=!0):3!==e.tag&&(5!==e.tag||Ys(e.type)&&!Ta(e.type,e.memoizedProps))&&(t=!0),t&&tl&&B(e),H(e),13===e.tag){if(!ka)throw Error(i(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));tl=js(e)}else tl=el?ks(e.stateNode):null;return!0}function G(){ka&&(tl=el=null,nl=!1)}function W(e){null===rl?rl=[e]:rl.push(e)}function q(){for(var e=ol,t=ll=ol=0;t<e;){var n=sl[t];sl[t++]=null;var r=sl[t];sl[t++]=null;var i=sl[t];sl[t++]=null;var a=sl[t];if(sl[t++]=null,null!==r&&null!==i){var s=r.pending;null===s?i.next=i:(i.next=s.next,s.next=i),r.pending=i}0!==a&&J(n,i,a)}}function X(e,t,n,r){sl[ol++]=e,sl[ol++]=t,sl[ol++]=n,sl[ol++]=r,ll|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Y(e,t,n,r){return X(e,t,n,r),Q(e)}function K(e,t){return X(e,null,null,t),Q(e)}function J(e,t,n){e.lanes|=n;var r=e.alternate;null!==r&&(r.lanes|=n);for(var i=!1,a=e.return;null!==a;)a.childLanes|=n,null!==(r=a.alternate)&&(r.childLanes|=n),22===a.tag&&(null===(e=a.stateNode)||1&e._visibility||(i=!0)),e=a,a=a.return;i&&null!==t&&3===e.tag&&(a=e.stateNode,i=31-So(n),null===(e=(a=a.hiddenUpdates)[i])?a[i]=[t]:e.push(t),t.lane=536870912|n)}function Q(e){if(50<ru)throw ru=0,iu=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}function Z(e){var t;e!==ul&&null===e.next&&(null===ul?cl=ul=e:ul=ul.next=e),dl=!0,hl||(hl=!0,t=ee,Ka?Ja(function(){0!==(6&Ic)?Mo(Po,t):t()}):Mo(Po,t))}function $(e,t){if(!fl&&dl){fl=!0;do{for(var n=!1,r=cl;null!==r;){if(!t)if(0!==e){var i=r.pendingLanes;if(0===i)var a=0;else{var s=r.suspendedLanes,o=r.pingedLanes;a=(1<<31-So(42|e)+1)-1,a=201326677&(a&=i&~(s&~o))?201326677&a|1:a?2|a:0}0!==a&&(n=!0,re(r,a))}else a=Nc,0===(3&(a=b(r,r===Rc?a:0)))||S(r,a)||(n=!0,re(r,a));r=r.next}}while(n);fl=!1}}function ee(){dl=hl=!1;var e=0;0!==pl&&(za()&&(e=pl),pl=0);for(var t=Ro(),n=null,r=cl;null!==r;){var i=r.next,a=te(r,t);0===a?(r.next=null,null===n?cl=i:n.next=i,null===i&&(ul=n)):(n=r,(0!==e||0!==(3&a))&&(dl=!0)),r=i}$(e,!1)}function te(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=-62914561&e.pendingLanes;0<a;){var s=31-So(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=x(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}if(n=Nc,n=b(e,e===(t=Rc)?n:0),r=e.callbackNode,0===n||e===t&&2===kc||null!==e.cancelPendingCommit)return null!==r&&null!==r&&Co(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||S(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==r&&Co(r),I(n)){case 2:case 8:n=No;break;case 32:default:n=ko;break;case 268435456:n=Lo}return r=ne.bind(null,e),n=Mo(n,r),e.callbackPriority=t,e.callbackNode=n,t}return null!==r&&null!==r&&Co(r),e.callbackPriority=2,e.callbackNode=null,2}function ne(e,t){var n=e.callbackNode;if(vi()&&e.callbackNode!==n)return null;var r=Nc;return 0===(r=b(e,e===Rc?r:0))?null:(Xr(e,r,t),te(e,Ro()),null!=e.callbackNode&&e.callbackNode===n?ne.bind(null,e):null)}function re(e,t){if(vi())return null;Xr(e,t,!0)}function ie(){return 0===pl&&(pl=w()),pl}function ae(){if(0===--gl&&null!==ml){null!==yl&&(yl.status="fulfilled");var e=ml;ml=null,vl=0,yl=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function se(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function oe(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function le(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ce(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Ic)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=Q(e),J(e,null,n),t}return X(e,r,t,n),Q(e)}function ue(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,A(e,n)}}function he(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function de(){if(bl){if(null!==yl)throw yl}}function fe(e,t,n,r){bl=!1;var i=e.updateQueue;_l=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=-536870913&o.lane,f=d!==o.lane;if(f?(Nc&d)===d:(r&d)===d){0!==d&&d===vl&&(bl=!0),null!==u&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=e,m=o;d=t;var g=n;switch(m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(g,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(g,h,d):p)||void 0===d)break e;h=Gi({},h,d);break e;case 2:_l=!0}}null!==(d=o.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=i.callbacks)?i.callbacks=[d]:f.push(d))}else f={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(f=o).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null===a&&(i.shared.lanes=0),Bc|=s,e.lanes=s,e.memoizedState=h}}function pe(e,t){if("function"!==typeof e)throw Error(i(191,e));e.call(t)}function me(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)pe(n[e],t)}function ge(e,t){if(zo(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Sl.call(t,i)||!zo(e[i],t[i]))return!1}return!0}function ve(e){return"fulfilled"===(e=e.status)||"rejected"===e}function ye(){}function _e(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(ye,ye),t=n),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===xl)throw Error(i(483));throw e;default:if("string"===typeof t.status)t.then(ye,ye);else{if(null!==(e=Rc)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===xl)throw Error(i(483));throw e}throw Tl=t,xl}}function be(){if(null===Tl)throw Error(i(459));var e=Tl;return Tl=null,e}function Se(e){var t=Cl;return Cl+=1,null===Ml&&(Ml=[]),_e(Ml,e,t)}function xe(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function we(e,t){if(t.$$typeof===Wi)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ee(e){return(0,e._init)(e._payload)}function Te(e){function n(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function r(t,r){if(!e)return null;for(;null!==r;)n(t,r),r=r.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,t){return(e=Ci(e,t)).index=0,e.sibling=null,e}function l(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=33554434,n):r:(t.flags|=33554434,n):(t.flags|=1048576,n)}function c(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Ni(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n,r){var i=n.type;return i===Yi?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===ia&&Ee(i)===t.type)?(xe(t=o(t,n.props),n),t.return=e,t):(xe(t=Ii(n.type,n.key,n.props,null,e.mode,r),n),t.return=e,t)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=ki(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Ri(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Ni(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case qi:return xe(n=Ii(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case Xi:return(t=ki(t,e.mode,n)).return=e,t;case ia:return p(e,t=(0,t._init)(t._payload),n)}if(fa(t)||a(t))return(t=Ri(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return p(e,Se(t),n);if(t.$$typeof===$i)return p(e,kn(e,t),n);we(e,t)}return null}function m(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case qi:return n.key===i?h(e,t,n,r):null;case Xi:return n.key===i?d(e,t,n,r):null;case ia:return m(e,t,n=(i=n._init)(n._payload),r)}if(fa(n)||a(n))return null!==i?null:f(e,t,n,r,null);if("function"===typeof n.then)return m(e,t,Se(n),r);if(n.$$typeof===$i)return m(e,t,kn(e,n),r);we(e,n)}return null}function g(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case qi:return h(t,e=e.get(null===r.key?n:r.key)||null,r,i);case Xi:return d(t,e=e.get(null===r.key?n:r.key)||null,r,i);case ia:return g(e,t,n,r=(0,r._init)(r._payload),i)}if(fa(r)||a(r))return f(t,e=e.get(n)||null,r,i,null);if("function"===typeof r.then)return g(e,t,n,Se(r),i);if(r.$$typeof===$i)return g(e,t,n,kn(t,r),i);we(t,r)}return null}function v(t,u,h,d){if("object"===typeof h&&null!==h&&h.type===Yi&&null===h.key&&(h=h.props.children),"object"===typeof h&&null!==h){switch(h.$$typeof){case qi:e:{for(var f=h.key;null!==u;){if(u.key===f){if((f=h.type)===Yi){if(7===u.tag){r(t,u.sibling),(d=o(u,h.props.children)).return=t,t=d;break e}}else if(u.elementType===f||"object"===typeof f&&null!==f&&f.$$typeof===ia&&Ee(f)===u.type){r(t,u.sibling),xe(d=o(u,h.props),h),d.return=t,t=d;break e}r(t,u);break}n(t,u),u=u.sibling}h.type===Yi?((d=Ri(h.props.children,t.mode,d,h.key)).return=t,t=d):(xe(d=Ii(h.type,h.key,h.props,null,t.mode,d),h),d.return=t,t=d)}return c(t);case Xi:e:{for(f=h.key;null!==u;){if(u.key===f){if(4===u.tag&&u.stateNode.containerInfo===h.containerInfo&&u.stateNode.implementation===h.implementation){r(t,u.sibling),(d=o(u,h.children||[])).return=t,t=d;break e}r(t,u);break}n(t,u),u=u.sibling}(d=ki(h,t.mode,d)).return=t,t=d}return c(t);case ia:return v(t,u,h=(f=h._init)(h._payload),d)}if(fa(h))return function(t,i,a,o){for(var c=null,u=null,h=i,d=i=0,f=null;null!==h&&d<a.length;d++){h.index>d?(f=h,h=null):f=h.sibling;var v=m(t,h,a[d],o);if(null===v){null===h&&(h=f);break}e&&h&&null===v.alternate&&n(t,h),i=l(v,i,d),null===u?c=v:u.sibling=v,u=v,h=f}if(d===a.length)return r(t,h),nl&&N(t,d),c;if(null===h){for(;d<a.length;d++)null!==(h=p(t,a[d],o))&&(i=l(h,i,d),null===u?c=h:u.sibling=h,u=h);return nl&&N(t,d),c}for(h=s(h);d<a.length;d++)null!==(f=g(h,t,d,a[d],o))&&(e&&null!==f.alternate&&h.delete(null===f.key?d:f.key),i=l(f,i,d),null===u?c=f:u.sibling=f,u=f);return e&&h.forEach(function(e){return n(t,e)}),nl&&N(t,d),c}(t,u,h,d);if(a(h)){if("function"!==typeof(f=a(h)))throw Error(i(150));return function(t,a,o,c){if(null==o)throw Error(i(151));for(var u=null,h=null,d=a,f=a=0,v=null,y=o.next();null!==d&&!y.done;f++,y=o.next()){d.index>f?(v=d,d=null):v=d.sibling;var _=m(t,d,y.value,c);if(null===_){null===d&&(d=v);break}e&&d&&null===_.alternate&&n(t,d),a=l(_,a,f),null===h?u=_:h.sibling=_,h=_,d=v}if(y.done)return r(t,d),nl&&N(t,f),u;if(null===d){for(;!y.done;f++,y=o.next())null!==(y=p(t,y.value,c))&&(a=l(y,a,f),null===h?u=y:h.sibling=y,h=y);return nl&&N(t,f),u}for(d=s(d);!y.done;f++,y=o.next())null!==(y=g(d,t,f,y.value,c))&&(e&&null!==y.alternate&&d.delete(null===y.key?f:y.key),a=l(y,a,f),null===h?u=y:h.sibling=y,h=y);return e&&d.forEach(function(e){return n(t,e)}),nl&&N(t,f),u}(t,u,h=f.call(h),d)}if("function"===typeof h.then)return v(t,u,Se(h),d);if(h.$$typeof===$i)return v(t,u,kn(t,h),d);we(t,h)}return"string"===typeof h&&""!==h||"number"===typeof h||"bigint"===typeof h?(h=""+h,null!==u&&6===u.tag?(r(t,u.sibling),(d=o(u,h)).return=t,t=d):(r(t,u),(d=Ni(h,t.mode,d)).return=t,t=d),c(t)):r(t,u)}return function(e,n,r,i){try{Cl=0;var a=v(e,n,r,i);return Ml=null,a}catch(ni){if(ni===xl)throw ni;var s=t(29,ni,null,e.mode);return s.lanes=i,s.return=e,s}}}function Me(e,t){y(Pl,e=Fc),y(Rl,t),Fc=e|t.baseLanes}function Ce(){y(Pl,Fc),y(Rl,Rl.current)}function Ae(){Fc=Pl.current,v(Rl),v(Pl)}function Ie(e){var t=e.alternate;y(Ll,1&Ll.current),y(Nl,e),null===kl&&(null===t||null!==Rl.current||null!==t.memoizedState)&&(kl=e)}function Re(e){if(22===e.tag){if(y(Ll,Ll.current),y(Nl,e),null===kl){var t=e.alternate;null!==t&&null!==t.memoizedState&&(kl=e)}}else Pe()}function Pe(){y(Ll,Ll.current),y(Nl,Nl.current)}function Ne(e){v(Nl),kl===e&&(kl=null),v(Ll)}function ke(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Cs(n)||As(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Le(){throw Error(i(321))}function De(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zo(e[n],t[n]))return!1;return!0}function Oe(e,t,n,r,i,a){return Dl=a,Ol=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ha.H=null===e||null===e.memoizedState?Yl:Kl,Vl=!1,a=n(r,i),Vl=!1,Bl&&(a=Fe(t,n,r,i)),Ue(e),a}function Ue(e){ha.H=Xl;var t=null!==Ul&&null!==Ul.next;if(Dl=0,Fl=Ul=Ol=null,zl=!1,jl=0,Gl=null,t)throw Error(i(300));null===e||ec||null!==(e=e.dependencies)&&Rn(e)&&(ec=!0)}function Fe(e,t,n,r){Ol=e;var a=0;do{if(Bl&&(Gl=null),jl=0,Bl=!1,25<=a)throw Error(i(301));if(a+=1,Fl=Ul=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}ha.H=Jl,s=t(n,r)}while(Bl);return s}function ze(){var e=ha.H,t=e.useState()[0];return t="function"===typeof t.then?We(t):t,e=e.useState()[0],(null!==Ul?Ul.memoizedState:null)!==e&&(Ol.flags|=1024),t}function Be(){var e=0!==Hl;return Hl=0,e}function Ve(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function He(e){if(zl){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}zl=!1}Dl=0,Fl=Ul=Ol=null,Bl=!1,jl=Hl=0,Gl=null}function je(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Fl?Ol.memoizedState=Fl=e:Fl=Fl.next=e,Fl}function Ge(){if(null===Ul){var e=Ol.alternate;e=null!==e?e.memoizedState:null}else e=Ul.next;var t=null===Fl?Ol.memoizedState:Fl.next;if(null!==t)Fl=t,Ul=e;else{if(null===e){if(null===Ol.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Ul=e).memoizedState,baseState:Ul.baseState,baseQueue:Ul.baseQueue,queue:Ul.queue,next:null},null===Fl?Ol.memoizedState=Fl=e:Fl=Fl.next=e}return Fl}function We(e){var t=jl;return jl+=1,null===Gl&&(Gl=[]),e=_e(Gl,e,t),t=Ol,null===(null===Fl?t.memoizedState:Fl.next)&&(t=t.alternate,ha.H=null===t||null===t.memoizedState?Yl:Kl),e}function qe(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return We(e);if(e.$$typeof===$i)return Nn(e)}throw Error(i(438,String(e)))}function Xe(e){var t=null,n=Ol.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var r=Ol.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n=ql(),Ol.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=la;return t.index++,n}function Ye(e,t){return"function"===typeof t?t(e):t}function Ke(e){return Je(Ge(),Ul,e)}function Je(e,t,n){var r=e.queue;if(null===r)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,s=r.pending;if(null!==s){if(null!==a){var o=a.next;a.next=s.next,s.next=o}t.baseQueue=a=s,r.pending=null}if(s=e.baseState,null===a)e.memoizedState=s;else{var l=o=null,c=null,u=t=a.next,h=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(Nc&d)===d:(Dl&d)===d){var f=u.revertLane;if(0===f)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===vl&&(h=!0);else{if((Dl&f)===f){u=u.next,f===vl&&(h=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=d,o=s):c=c.next=d,Ol.lanes|=f,Bc|=f}d=u.action,Vl&&n(s,d),s=u.hasEagerState?u.eagerState:n(s,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=f,o=s):c=c.next=f,Ol.lanes|=d,Bc|=d;u=u.next}while(null!==u&&u!==t);if(null===c?o=s:c.next=l,!zo(s,e.memoizedState)&&(ec=!0,h&&null!==(n=yl)))throw n;e.memoizedState=s,e.baseState=o,e.baseQueue=c,r.lastRenderedState=s}return null===a&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Qe(e){var t=Ge(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,s=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{s=e(s,o.action),o=o.next}while(o!==a);zo(s,t.memoizedState)||(ec=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Ze(e,t,n){var r=Ol,a=Ge(),s=nl;if(s){if(void 0===n)throw Error(i(407));n=n()}else n=t();var o=!zo((Ul||a).memoizedState,n);if(o&&(a.memoizedState=n,ec=!0),a=a.queue,wt(tt.bind(null,r,a,e),[e]),a.getSnapshot!==t||o||null!==Fl&&1&Fl.memoizedState.tag){if(r.flags|=2048,yt(9,et.bind(null,r,a,n,t),{destroy:void 0},null),null===Rc)throw Error(i(349));s||0!==(60&Dl)||$e(r,t,n)}return n}function $e(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ol.updateQueue)?(t=ql(),Ol.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function et(e,t,n,r){t.value=n,t.getSnapshot=r,nt(t)&&rt(e)}function tt(e,t,n){return n(function(){nt(t)&&rt(e)})}function nt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zo(e,n)}catch(ox){return!0}}function rt(e){var t=K(e,2);null!==t&&qr(t,e,2)}function it(e){var t=je();if("function"===typeof e){var n=e;if(e=n(),Vl){R(!0);try{n()}finally{R(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ye,lastRenderedState:e},t}function at(e,t,n,r){return e.baseState=n,Je(e,Ul,"function"===typeof r?r:Ye)}function st(e,t,n,r,a){if(jt(e))throw Error(i(485));if(null!==(e=t.action)){var s={payload:a,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==ha.T?n(!0):s.isTransition=!1,r(s),null===(n=t.pending)?(s.next=t.pending=s,ot(t,s)):(s.next=n.next,t.pending=n.next=s)}}function ot(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=ha.T,s={};ha.T=s;try{var o=n(i,r),l=ha.S;null!==l&&l(s,o),lt(e,t,o)}catch(ox){ut(e,t,ox)}finally{ha.T=a}}else try{lt(e,t,a=n(i,r))}catch(c){ut(e,t,c)}}function lt(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){ct(e,t,n)},function(n){return ut(e,t,n)}):ct(e,t,n)}function ct(e,t,n){t.status="fulfilled",t.value=n,ht(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,ot(e,n)))}function ut(e,t,n){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=n,ht(t),t=t.next}while(t!==r)}e.action=null}function ht(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function dt(e,t){return t}function ft(e,t){if(nl){var n=Rc.formState;if(null!==n){e:{var r=Ol;if(nl){if(tl){var i=Ps(tl,il);if(i){tl=ks(i),r=Ns(i);break e}}B(r)}r=!1}r&&(t=n[0])}}(n=je()).memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dt,lastRenderedState:t},n.queue=r,n=Bt.bind(null,Ol,r),r.dispatch=n,r=it(!1);var a=Ht.bind(null,Ol,!1,r.queue);return i={state:t,dispatch:null,action:e,pending:null},(r=je()).queue=i,n=st.bind(null,Ol,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function pt(e){return mt(Ge(),Ul,e)}function mt(e,t,n){t=Je(e,t,dt)[0],e=Ke(Ye)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?We(t):t;var r=Ge(),i=r.queue,a=i.dispatch;return n!==r.memoizedState&&(Ol.flags|=2048,yt(9,gt.bind(null,i,n),{destroy:void 0},null)),[t,a,e]}function gt(e,t){e.action=t}function vt(e){var t=Ge(),n=Ul;if(null!==n)return mt(t,n,e);Ge(),t=t.memoizedState;var r=(n=Ge()).queue.dispatch;return n.memoizedState=e,[t,r,!1]}function yt(e,t,n,r){return e={tag:e,create:t,inst:n,deps:r,next:null},null===(t=Ol.updateQueue)&&(t=ql(),Ol.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function _t(){return Ge().memoizedState}function bt(e,t,n,r){var i=je();Ol.flags|=e,i.memoizedState=yt(1|t,n,{destroy:void 0},void 0===r?null:r)}function St(e,t,n,r){var i=Ge();r=void 0===r?null:r;var a=i.memoizedState.inst;null!==Ul&&null!==r&&De(r,Ul.memoizedState.deps)?i.memoizedState=yt(t,n,a,r):(Ol.flags|=e,i.memoizedState=yt(1|t,n,a,r))}function xt(e,t){bt(8390656,8,e,t)}function wt(e,t){St(2048,8,e,t)}function Et(e,t){return St(4,2,e,t)}function Tt(e,t){return St(4,4,e,t)}function Mt(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ct(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,St(4,4,Mt.bind(null,t,e),n)}function At(){}function It(e,t){var n=Ge();t=void 0===t?null:t;var r=n.memoizedState;return null!==t&&De(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Rt(e,t){var n=Ge();t=void 0===t?null:t;var r=n.memoizedState;if(null!==t&&De(t,r[1]))return r[0];if(r=e(),Vl){R(!0);try{e()}finally{R(!1)}}return n.memoizedState=[r,t],r}function Pt(e,t,n){return void 0===n||0!==(1073741824&Dl)?e.memoizedState=t:(e.memoizedState=n,e=Wr(),Ol.lanes|=e,Bc|=e,n)}function Nt(e,t,n,r){return zo(n,t)?n:null!==Rl.current?(e=Pt(e,n,r),zo(e,t)||(ec=!0),e):0===(42&Dl)?(ec=!0,e.memoizedState=n):(e=Wr(),Ol.lanes|=e,Bc|=e,t)}function kt(e,t,n,r,i){var a=Ua();Oa(0!==a&&8>a?a:8);var s=ha.T,o={};ha.T=o,Ht(e,!1,t,n);try{var l=i(),c=ha.S;if(null!==c&&c(o,l),null!==l&&"object"===typeof l&&"function"===typeof l.then){var u=function(e,t){var n=[],r={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status="fulfilled",r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status="rejected",r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}(l,r);Vt(e,t,u,Gr())}else Vt(e,t,r,Gr())}catch(ox){Vt(e,t,{then:function(){},status:"rejected",reason:ox},Gr())}finally{Oa(a),ha.T=s}}function Lt(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:qa,baseState:qa,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ye,lastRenderedState:qa},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ye,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Dt(){return Nn(Xa)}function Ot(){return Ge().memoizedState}function Ut(){return Ge().memoizedState}function Ft(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gr(),r=ce(t,e=le(n),n);return null!==r&&(qr(r,t,n),ue(r,t,n)),t={cache:Dn()},void(e.payload=t)}t=t.return}}function zt(e,t,n){var r=Gr();n={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},jt(e)?Gt(t,n):null!==(n=Y(e,t,n,r))&&(qr(n,e,r),Wt(n,t,r))}function Bt(e,t,n){Vt(e,t,n,Gr())}function Vt(e,t,n,r){var i={lane:r,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(jt(e))Gt(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,zo(o,s))return X(e,t,i,0),null===Rc&&q(),!1}catch(ox){}if(null!==(n=Y(e,t,i,r)))return qr(n,e,r),Wt(n,t,r),!0}return!1}function Ht(e,t,n,r){if(r={lane:2,revertLane:ie(),action:r,hasEagerState:!1,eagerState:null,next:null},jt(e)){if(t)throw Error(i(479))}else null!==(t=Y(e,n,r,2))&&qr(t,e,2)}function jt(e){var t=e.alternate;return e===Ol||null!==t&&t===Ol}function Gt(e,t){Bl=zl=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Wt(e,t,n){if(0!==(4194176&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,A(e,n)}}function qt(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:Gi({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}function Xt(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!ge(n,r)||!ge(i,a))}function Yt(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ql.enqueueReplaceState(t,t.state,null)}function Kt(e,t){var n=t;if("ref"in t)for(var r in n={},t)"ref"!==r&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=Gi({},n)),e)void 0===n[i]&&(n[i]=e[i]);return n}function Jt(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Qt(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function Zt(e,t,n){return(n=le(n)).tag=3,n.payload={element:null},n.callback=function(){Jt(e,t)},n}function $t(e){return(e=le(e)).tag=3,e}function en(e,t,n,r){var i=n.type.getDerivedStateFromError;if("function"===typeof i){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){Qt(t,n,r)}}var s=n.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Qt(t,n,r),"function"!==typeof i&&(null===Qc?Qc=new Set([this]):Qc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}function tn(e,t,n,r){t.child=null===e?Il(t,null,n,r):Al(t,e.child,n,r)}function nn(e,t,n,r,i){n=n.render;var a=t.ref;if("ref"in r){var s={};for(var o in r)"ref"!==o&&(s[o]=r[o])}else s=r;return Pn(t),r=Oe(e,t,n,s,a,i),o=Be(),null===e||ec?(nl&&o&&L(t),t.flags|=1,tn(e,t,r,i),t.child):(Ve(e,t,i),xn(e,t,i))}function rn(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Mi(a)||void 0!==a.defaultProps||null!==n.compare?((e=Ii(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,an(e,t,a,r,i))}if(a=e.child,!wn(e,i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:ge)(s,r)&&e.ref===t.ref)return xn(e,t,i)}return t.flags|=1,(e=Ci(a,r)).ref=t.ref,e.return=t,t.child=e}function an(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(ge(a,r)&&e.ref===t.ref){if(ec=!1,t.pendingProps=r=a,!wn(e,i))return t.lanes=e.lanes,xn(e,t,i);0!==(131072&e.flags)&&(ec=!0)}}return cn(e,t,n,r,i)}function sn(e,t,n){var r=t.pendingProps,i=r.children,a=0!==(2&t.stateNode._pendingVisibility),s=null!==e?e.memoizedState:null;if(ln(e,t),"hidden"===r.mode||a){if(0!==(128&t.flags)){if(r=null!==s?s.baseLanes|n:n,null!==e){for(i=t.child=e.child,a=0;null!==i;)a=a|i.lanes|i.childLanes,i=i.sibling;t.childLanes=a&~r}else t.childLanes=0,t.child=null;return on(e,t,r,n)}if(0===(536870912&n))return t.lanes=t.childLanes=536870912,on(e,t,null!==s?s.baseLanes|n:n,n);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Fn(t,null!==s?s.cachePool:null),null!==s?Me(t,s):Ce(),Re(t)}else null!==s?(Fn(t,s.cachePool),Me(t,s),Pe(),t.memoizedState=null):(null!==e&&Fn(t,null),Ce(),Pe());return tn(e,t,i,n),t.child}function on(e,t,n,r){var i=Un();return i=null===i?null:{parent:Ra?lc._currentValue:lc._currentValue2,pool:i},t.memoizedState={baseLanes:n,cachePool:i},null!==e&&Fn(t,null),Ce(),Re(t),null!==e&&In(e,t,r,!0),null}function ln(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(i(284));null!==e&&e.ref===n||(t.flags|=2097664)}}function cn(e,t,n,r,i){return Pn(t),n=Oe(e,t,n,r,void 0,i),r=Be(),null===e||ec?(nl&&r&&L(t),t.flags|=1,tn(e,t,n,i),t.child):(Ve(e,t,i),xn(e,t,i))}function un(e,t,n,r,i,a){return Pn(t),t.updateQueue=null,n=Fe(t,r,n,i),Ue(e),r=Be(),null===e||ec?(nl&&r&&L(t),t.flags|=1,tn(e,t,n,a),t.child):(Ve(e,t,a),xn(e,t,a))}function hn(e,t,n,r,i){if(Pn(t),null===t.stateNode){var a=bo,s=n.contextType;"object"===typeof s&&null!==s&&(a=Nn(s)),a=new n(r,a),t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,a.updater=Ql,t.stateNode=a,a._reactInternals=t,(a=t.stateNode).props=r,a.state=t.memoizedState,a.refs={},se(t),s=n.contextType,a.context="object"===typeof s&&null!==s?Nn(s):bo,a.state=t.memoizedState,"function"===typeof(s=n.getDerivedStateFromProps)&&(qt(t,n,s,r),a.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(s=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),s!==a.state&&Ql.enqueueReplaceState(a,a.state,null),fe(t,r,a,i),de(),a.state=t.memoizedState),"function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){a=t.stateNode;var o=t.memoizedProps,l=Kt(n,o);a.props=l;var c=a.context,u=n.contextType;s=bo,"object"===typeof u&&null!==u&&(s=Nn(u));var h=n.getDerivedStateFromProps;u="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate,o=t.pendingProps!==o,u||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o||c!==s)&&Yt(t,a,r,s),_l=!1;var d=t.memoizedState;a.state=d,fe(t,r,a,i),de(),c=t.memoizedState,o||d!==c||_l?("function"===typeof h&&(qt(t,n,h,r),c=t.memoizedState),(l=_l||Xt(t,n,l,r,d,c,s))?(u||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=s,r=l):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,oe(e,t),u=Kt(n,s=t.memoizedProps),a.props=u,h=t.pendingProps,d=a.context,c=n.contextType,l=bo,"object"===typeof c&&null!==c&&(l=Nn(c)),(c="function"===typeof(o=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&Yt(t,a,r,l),_l=!1,d=t.memoizedState,a.state=d,fe(t,r,a,i),de();var f=t.memoizedState;s!==h||d!==f||_l||null!==e&&null!==e.dependencies&&Rn(e.dependencies)?("function"===typeof o&&(qt(t,n,o,r),f=t.memoizedState),(u=_l||Xt(t,n,u,r,d,f,l)||null!==e&&null!==e.dependencies&&Rn(e.dependencies))?(c||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=l,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,ln(e,t),r=0!==(128&t.flags),a||r?(a=t.stateNode,n=r&&"function"!==typeof n.getDerivedStateFromError?null:a.render(),t.flags|=1,null!==e&&r?(t.child=Al(t,e.child,null,i),t.child=Al(t,null,n,i)):tn(e,t,n,i),t.memoizedState=a.state,e=t.child):e=xn(e,t,i),e}function dn(e,t,n,r){return G(),t.flags|=256,tn(e,t,n,r),t.child}function fn(e){return{baseLanes:e,cachePool:zn()}}function pn(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=jc),e}function mn(e,n,r){var a,s=n.pendingProps,o=!1,l=0!==(128&n.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&Ll.current)),a&&(o=!0,n.flags&=-129),a=0!==(32&n.flags),n.flags&=-33,null===e){if(nl){if(o?Ie(n):Pe(),nl){var c,u=tl;(c=u)&&(null!==(u=zs(u,il))?(n.memoizedState={dehydrated:u,treeContext:null!==Xo?{id:Yo,overflow:Ko}:null,retryLane:536870912},(c=t(18,null,null,0)).stateNode=u,c.return=n,n.child=c,el=n,tl=null,c=!0):c=!1),c||B(n)}if(null!==(u=n.memoizedState)&&null!==(u=u.dehydrated))return As(u)?n.lanes=16:n.lanes=536870912,null;Ne(n)}return u=s.children,s=s.fallback,o?(Pe(),u=vn({mode:"hidden",children:u},o=n.mode),s=Ri(s,o,r,null),u.return=n,s.return=n,u.sibling=s,n.child=u,(o=n.child).memoizedState=fn(r),o.childLanes=pn(e,a,r),n.memoizedState=tc,s):(Ie(n),gn(n,u))}if(null!==(c=e.memoizedState)&&null!==(u=c.dehydrated)){if(l)256&n.flags?(Ie(n),n.flags&=-257,n=yn(e,n,r)):null!==n.memoizedState?(Pe(),n.child=e.child,n.flags|=128,n=null):(Pe(),o=s.fallback,u=n.mode,s=vn({mode:"visible",children:s.children},u),(o=Ri(o,u,r,null)).flags|=2,s.return=n,o.return=n,s.sibling=o,n.child=s,Al(n,e.child,null,r),(s=n.child).memoizedState=fn(r),s.childLanes=pn(e,a,r),n.memoizedState=tc,n=o);else if(Ie(n),As(u))a=Is(u).digest,(s=Error(i(419))).stack="",s.digest=a,W({value:s,source:null,stack:null}),n=yn(e,n,r);else if(ec||In(e,n,r,!1),a=0!==(r&e.childLanes),ec||a){if(null!==(a=Rc)){if(0!==(42&(s=r&-r)))s=1;else switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=64;break;case 268435456:s=134217728;break;default:s=0}if(0!==(s=0!==(s&(a.suspendedLanes|r))?0:s)&&s!==c.retryLane)throw c.retryLane=s,K(e,s),qr(a,e,s),$l}Cs(u)||si(),n=yn(e,n,r)}else Cs(u)?(n.flags|=128,n.child=e.child,n=wi.bind(null,e),Rs(u,n),n=null):(e=c.treeContext,ka&&(tl=Os(u),el=n,nl=!0,rl=null,il=!1,null!==e&&(Wo[qo++]=Yo,Wo[qo++]=Ko,Wo[qo++]=Xo,Yo=e.id,Ko=e.overflow,Xo=n)),(n=gn(n,s.children)).flags|=4096);return n}return o?(Pe(),o=s.fallback,u=n.mode,l=(c=e.child).sibling,(s=Ci(c,{mode:"hidden",children:s.children})).subtreeFlags=31457280&c.subtreeFlags,null!==l?o=Ci(l,o):(o=Ri(o,u,r,null)).flags|=2,o.return=n,s.return=n,s.sibling=o,n.child=s,s=o,o=n.child,null===(u=e.child.memoizedState)?u=fn(r):(null!==(c=u.cachePool)?(l=Ra?lc._currentValue:lc._currentValue2,c=c.parent!==l?{parent:l,pool:l}:c):c=zn(),u={baseLanes:u.baseLanes|r,cachePool:c}),o.memoizedState=u,o.childLanes=pn(e,a,r),n.memoizedState=tc,s):(Ie(n),e=(r=e.child).sibling,(r=Ci(r,{mode:"visible",children:s.children})).return=n,r.sibling=null,null!==e&&(null===(a=n.deletions)?(n.deletions=[e],n.flags|=16):a.push(e)),n.child=r,n.memoizedState=null,r)}function gn(e,t){return(t=vn({mode:"visible",children:t},e.mode)).return=e,e.child=t}function vn(e,t){return Pi(e,t,0,null)}function yn(e,t,n){return Al(t,e.child,null,n),(e=gn(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function _n(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Cn(e.return,t,n)}function bn(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Sn(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(tn(e,t,r.children,n),0!==(2&(r=Ll.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&_n(e,n,t);else if(19===e.tag)_n(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(y(Ll,r),i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ke(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),bn(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ke(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}bn(t,!0,n,null,a);break;case"together":bn(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function xn(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Bc|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(In(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ci(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ci(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function wn(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Rn(e))}function En(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)ec=!0;else{if(!wn(e,n)&&0===(128&t.flags))return ec=!1,function(e,t,n){switch(t.tag){case 3:O(t,t.stateNode.containerInfo),Tn(t,lc,e.memoizedState.cache),G();break;case 27:case 5:F(t);break;case 4:O(t,t.stateNode.containerInfo);break;case 10:Tn(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(Ie(t),t.flags|=128,null):0!==(n&t.child.childLanes)?mn(e,t,n):(Ie(t),null!==(e=xn(e,t,n))?e.sibling:null);Ie(t);break;case 19:var i=0!==(128&e.flags);if((r=0!==(n&t.childLanes))||(In(e,t,n,!1),r=0!==(n&t.childLanes)),i){if(r)return Sn(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),y(Ll,Ll.current),r)break;return null;case 22:case 23:return t.lanes=0,sn(e,t,n);case 24:Tn(t,lc,e.memoizedState.cache)}return xn(e,t,n)}(e,t,n);ec=0!==(131072&e.flags)}else ec=!1,nl&&0!==(1048576&t.flags)&&k(t,Go,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,a=r._init;if(r=a(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((a=r.$$typeof)===ea){t.tag=11,t=nn(null,t,r,e,n);break e}if(a===ra){t.tag=14,t=rn(null,t,r,e,n);break e}}throw t=s(r)||r,Error(i(306,t,""))}Mi(r)?(e=Kt(r,e),t.tag=1,t=hn(null,t,r,e,n)):(t.tag=0,t=cn(null,t,r,e,n))}return t;case 0:return cn(e,t,t.type,t.pendingProps,n);case 1:return hn(e,t,r=t.type,a=Kt(r,t.pendingProps),n);case 3:e:{if(O(t,t.stateNode.containerInfo),null===e)throw Error(i(387));var o=t.pendingProps;r=(a=t.memoizedState).element,oe(e,t),fe(t,o,null,n);var l=t.memoizedState;if(o=l.cache,Tn(t,lc,o),o!==a.cache&&An(t,[lc],n,!0),de(),o=l.element,ka&&a.isDehydrated){if(a={element:o,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=dn(e,t,o,n);break e}if(o!==r){W(r=P(Error(i(424)),t)),t=dn(e,t,o,n);break e}for(ka&&(tl=Ds(t.stateNode.containerInfo),el=t,nl=!0,rl=null,il=!0),n=Il(t,null,o,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(G(),o===r){t=xn(e,t,n);break e}tn(e,t,o,n)}t=t.child}return t;case 26:if(Qs)return ln(e,t),null===e?(n=eo(t.type,null,t.pendingProps,null))?t.memoizedState=n:nl||(t.stateNode=so(t.type,t.pendingProps,Zo.current,t)):t.memoizedState=eo(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:if(ho)return F(t),null===e&&ho&&nl&&(r=t.stateNode=fo(t.type,t.pendingProps,Zo.current,Jo.current,!1),el=t,il=!0,tl=Ls(r)),r=t.pendingProps.children,null!==e||nl?tn(e,t,r,n):t.child=Al(t,null,r,n),ln(e,t),t.child;case 5:return null===e&&nl&&(Ks(t.type,t.pendingProps,Jo.current),(a=r=tl)&&(null!==(r=Us(r,t.type,t.pendingProps,il))?(t.stateNode=r,el=t,tl=Ls(r),il=!1,a=!0):a=!1),a||B(t)),F(t),a=t.type,o=t.pendingProps,l=null!==e?e.memoizedProps:null,r=o.children,Ta(a,o)?r=null:null!==l&&Ta(a,l)&&(t.flags|=32),null!==t.memoizedState&&(a=Oe(e,t,ze,null,null,n),Ra?Xa._currentValue=a:Xa._currentValue2=a),ln(e,t),tn(e,t,r,n),t.child;case 6:return null===e&&nl&&(Js(t.pendingProps,Jo.current),(e=n=tl)&&(null!==(n=Fs(n,t.pendingProps,il))?(t.stateNode=n,el=t,tl=null,e=!0):e=!1),e||B(t)),null;case 13:return mn(e,t,n);case 4:return O(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Al(t,null,r,n):tn(e,t,r,n),t.child;case 11:return nn(e,t,t.type,t.pendingProps,n);case 7:return tn(e,t,t.pendingProps,n),t.child;case 8:case 12:return tn(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,Tn(t,t.type,r.value),tn(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,Pn(t),r=r(a=Nn(a)),t.flags|=1,tn(e,t,r,n),t.child;case 14:return rn(e,t,t.type,t.pendingProps,n);case 15:return an(e,t,t.type,t.pendingProps,n);case 19:return Sn(e,t,n);case 22:return sn(e,t,n);case 24:return Pn(t),r=Nn(lc),null===e?(null===(a=Un())&&(a=Rc,o=Dn(),a.pooledCache=o,o.refCount++,null!==o&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:r,cache:a},se(t),Tn(t,lc,a)):(0!==(e.lanes&n)&&(oe(e,t),fe(t,null,null,n),de()),a=e.memoizedState,o=t.memoizedState,a.parent!==r?(a={parent:r,cache:r},t.memoizedState=a,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=a),Tn(t,lc,r)):(r=o.cache,Tn(t,lc,r),r!==a.cache&&An(t,[lc],n,!0))),tn(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Tn(e,t,n){Ra?(y(nc,t._currentValue),t._currentValue=n):(y(nc,t._currentValue2),t._currentValue2=n)}function Mn(e){var t=nc.current;Ra?e._currentValue=t:e._currentValue2=t,v(nc)}function Cn(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function An(e,t,n,r){var a=e.child;for(null!==a&&(a.return=e);null!==a;){var s=a.dependencies;if(null!==s){var o=a.child;s=s.firstContext;e:for(;null!==s;){var l=s;s=a;for(var c=0;c<t.length;c++)if(l.context===t[c]){s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Cn(s.return,n,e),r||(o=null);break e}s=l.next}}else if(18===a.tag){if(null===(o=a.return))throw Error(i(341));o.lanes|=n,null!==(s=o.alternate)&&(s.lanes|=n),Cn(o,n,e),o=null}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===e){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}}function In(e,t,n,r){e=null;for(var a=t,s=!1;null!==a;){if(!s)if(0!==(524288&a.flags))s=!0;else if(0!==(262144&a.flags))break;if(10===a.tag){var o=a.alternate;if(null===o)throw Error(i(387));if(null!==(o=o.memoizedProps)){var l=a.type;zo(a.pendingProps.value,o.value)||(null!==e?e.push(l):e=[l])}}else if(a===$o.current){if(null===(o=a.alternate))throw Error(i(387));o.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(null!==e?e.push(Xa):e=[Xa])}a=a.return}null!==e&&An(t,e,n,r),t.flags|=262144}function Rn(e){for(e=e.firstContext;null!==e;){var t=e.context;if(!zo(Ra?t._currentValue:t._currentValue2,e.memoizedValue))return!0;e=e.next}return!1}function Pn(e){rc=e,ic=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Nn(e){return Ln(rc,e)}function kn(e,t){return null===rc&&Pn(e),Ln(e,t)}function Ln(e,t){var n=Ra?t._currentValue:t._currentValue2;if(t={context:t,memoizedValue:n,next:null},null===ic){if(null===e)throw Error(i(308));ic=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ic=ic.next=t;return n}function Dn(){return{controller:new ac,data:new Map,refCount:0}}function On(e){e.refCount--,0===e.refCount&&sc(oc,function(){e.controller.abort()})}function Un(){var e=uc.current;return null!==e?e:Rc.pooledCache}function Fn(e,t){y(uc,null===t?uc.current:t.pool)}function zn(){var e=Un();return null===e?null:{parent:Ra?lc._currentValue:lc._currentValue2,pool:e}}function Bn(e){e.flags|=4}function Vn(e,t){if(null!==e&&e.child===t.child)return!1;if(0!==(16&t.flags))return!0;for(e=t.child;null!==e;){if(0!==(13878&e.flags)||0!==(13878&e.subtreeFlags))return!0;e=e.sibling}return!1}function Hn(e,t,n,r){if(Pa)for(n=t.child;null!==n;){if(5===n.tag||6===n.tag)wa(e,n.stateNode);else if(!(4===n.tag||ho&&27===n.tag)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else if(Na)for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;n&&r&&(a=Ts(a,i.type,i.memoizedProps)),wa(e,a)}else if(6===i.tag)a=i.stateNode,n&&r&&(a=Ms(a,i.memoizedProps)),wa(e,a);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),Hn(e,i,!0,!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function jn(e,t,n,r){if(Na)for(var i=t.child;null!==i;){if(5===i.tag){var a=i.stateNode;n&&r&&(a=Ts(a,i.type,i.memoizedProps)),xs(e,a)}else if(6===i.tag)a=i.stateNode,n&&r&&(a=Ms(a,i.memoizedProps)),xs(e,a);else if(4!==i.tag)if(22===i.tag&&null!==i.memoizedState)null!==(a=i.child)&&(a.return=i),jn(e,i,!(null!==i.memoizedProps&&"manual"===i.memoizedProps.mode),!0);else if(null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Gn(e,t){if(Na&&Vn(e,t)){var n=(e=t.stateNode).containerInfo,r=Ss();jn(r,t,!1,!1),e.pendingChildren=r,Bn(t),ws(n,r)}}function Wn(e,t,n,r){if(Pa)e.memoizedProps!==r&&Bn(t);else if(Na){var i=e.stateNode,a=e.memoizedProps;if((e=Vn(e,t))||a!==r){var s=Jo.current;(a=bs(i,n,a,r,!e,null))===i?t.stateNode=i:(Ea(a,n,r,s)&&Bn(t),t.stateNode=a,e?Hn(a,t,!1,!1):Bn(t))}else t.stateNode=i}}function qn(e,t,n){if(Va(t,n)){if(e.flags|=16777216,!Ha(t,n)){if(!ri())throw Tl=El,wl;e.flags|=8192}}else e.flags&=-16777217}function Xn(e,t){if(lo(t)){if(e.flags|=16777216,!co(t)){if(!ri())throw Tl=El,wl;e.flags|=8192}}else e.flags&=-16777217}function Yn(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?E():536870912,e.lanes|=t,Gc|=t)}function Kn(e,t){if(!nl)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Jn(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=31457280&i.subtreeFlags,r|=31457280&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qn(e,t,n){var r=t.pendingProps;switch(D(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return Jn(t),null;case 3:return n=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Mn(lc),U(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(j(t)?Bn(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rl&&(Yr(rl),rl=null))),Gn(e,t),Jn(t),null;case 26:if(Qs){n=t.type;var a=t.memoizedState;return null===e?(Bn(t),null!==a?(Jn(t),Xn(t,a)):(Jn(t),qn(t,n,r))):a?a!==e.memoizedState?(Bn(t),Jn(t),Xn(t,a)):(Jn(t),t.flags&=-16777217):(Pa?e.memoizedProps!==r&&Bn(t):Wn(e,t,n,r),Jn(t),qn(t,n,r)),null}case 27:if(ho){if(z(t),n=Zo.current,a=t.type,null!==e&&null!=t.stateNode)Pa?e.memoizedProps!==r&&Bn(t):Wn(e,t,a,r);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Jn(t),null}e=Jo.current,j(t)?V(t,e):(e=fo(a,r,n,e,!0),t.stateNode=e,Bn(t))}return Jn(t),null}case 5:if(z(t),n=t.type,null!==e&&null!=t.stateNode)Wn(e,t,n,r);else{if(!r){if(null===t.stateNode)throw Error(i(166));return Jn(t),null}e=Jo.current,j(t)?V(t,e):(Hn(a=xa(n,r,Zo.current,e,t),t,!1,!1),t.stateNode=a,Ea(a,n,r,e)&&Bn(t))}return Jn(t),qn(t,t.type,t.pendingProps),null;case 6:if(e&&null!=t.stateNode)n=e.memoizedProps,Pa?n!==r&&Bn(t):Na&&(n!==r?(t.stateNode=Ma(r,Zo.current,Jo.current,t),Bn(t)):t.stateNode=e.stateNode);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(e=Zo.current,n=Jo.current,j(t)){if(!ka)throw Error(i(176));if(e=t.stateNode,n=t.memoizedProps,r=null,null!==(a=el))switch(a.tag){case 27:case 5:r=a.memoizedProps}Vs(e,n,t,r)||B(t)}else t.stateNode=Ma(r,e,n,t)}return Jn(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(a=j(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(i(318));if(!ka)throw Error(i(344));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(i(317));Hs(a,t)}else G(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Jn(t),a=!1}else null!==rl&&(Yr(rl),rl=null),a=!0;if(!a)return 256&t.flags?(Ne(t),t):(Ne(t),null)}if(Ne(t),0!==(128&t.flags))return t.lanes=n,t;if(n=null!==r,e=null!==e&&null!==e.memoizedState,n){a=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(a=r.alternate.memoizedState.cachePool.pool);var s=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(s=r.memoizedState.cachePool.pool),s!==a&&(r.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Yn(t,t.updateQueue),Jn(t),null;case 4:return U(),Gn(e,t),null===e&&Da(t.stateNode.containerInfo),Jn(t),null;case 10:return Mn(t.type),Jn(t),null;case 19:if(v(Ll),null===(a=t.memoizedState))return Jn(t),null;if(r=0!==(128&t.flags),null===(s=a.rendering))if(r)Kn(a,!1);else{if(0!==zc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(s=ke(e))){for(t.flags|=128,Kn(a,!1),e=s.updateQueue,t.updateQueue=e,Yn(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)Ai(n,e),n=n.sibling;return y(Ll,1&Ll.current|2),t.child}e=e.sibling}null!==a.tail&&Ro()>Kc&&(t.flags|=128,r=!0,Kn(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ke(s))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Yn(t,e),Kn(a,!0),null===a.tail&&"hidden"===a.tailMode&&!s.alternate&&!nl)return Jn(t),null}else 2*Ro()-a.renderingStartTime>Kc&&536870912!==n&&(t.flags|=128,r=!0,Kn(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=a.last)?e.sibling=s:t.child=s,a.last=s)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ro(),t.sibling=null,e=Ll.current,y(Ll,r?1&e|2:1&e),t):(Jn(t),null);case 22:case 23:return Ne(t),Ae(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&n)&&0===(128&t.flags)&&(Jn(t),6&t.subtreeFlags&&(t.flags|=8192)):Jn(t),null!==(n=t.updateQueue)&&Yn(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),null!==e&&v(uc),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Mn(lc),Jn(t),null;case 25:return null}throw Error(i(156,t.tag))}function Zn(e,t){switch(D(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Mn(lc),U(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return z(t),null;case 13:if(Ne(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));G()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return v(Ll),null;case 4:return U(),null;case 10:return Mn(t.type),null;case 22:case 23:return Ne(t),Ae(),null!==e&&v(uc),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Mn(lc),null;default:return null}}function $n(e,t){switch(D(t),t.tag){case 3:Mn(lc),U();break;case 26:case 27:case 5:z(t);break;case 4:U();break;case 13:Ne(t);break;case 19:v(Ll);break;case 10:Mn(t.type);break;case 22:case 23:Ne(t),Ae(),null!==e&&v(uc);break;case 24:Mn(lc)}}function er(e,t){try{var n=t.updateQueue,r=null!==n?n.lastEffect:null;if(null!==r){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,s=n.inst;r=a(),s.destroy=r}n=n.next}while(n!==i)}}catch(ox){_i(t,t.return,ox)}}function tr(e,t,n){try{var r=t.updateQueue,i=null!==r?r.lastEffect:null;if(null!==i){var a=i.next;r=a;do{if((r.tag&e)===e){var s=r.inst,o=s.destroy;if(void 0!==o){s.destroy=void 0,i=t;var l=n;try{o()}catch(ox){_i(i,l,ox)}}}r=r.next}while(r!==a)}}catch(ox){_i(t,t.return,ox)}}function nr(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{me(t,n)}catch(ox){_i(e,e.return,ox)}}}function rr(e,t,n){n.props=Kt(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(ox){_i(e,t,ox)}}function ir(e,t){try{var n=e.ref;if(null!==n){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var i=va(r);break;default:i=r}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(ox){_i(e,t,ox)}}function ar(e,t){var n=e.ref,r=e.refCleanup;if(null!==n)if("function"===typeof r)try{r()}catch(ox){_i(e,t,ox)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(i){_i(e,t,i)}else n.current=null}function sr(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{ls(r,t,n,e)}catch(ox){_i(e,e.return,ox)}}function or(e,t,n){try{cs(e.stateNode,e.type,n,t,e)}catch(ox){_i(e,e.return,ox)}}function lr(e){return 5===e.tag||3===e.tag||!!Qs&&26===e.tag||!!ho&&27===e.tag||4===e.tag}function cr(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||lr(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&(!ho||27!==e.tag)&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ur(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?hs(n,e,t):ss(n,e);else if(!(4===r||ho&&27===r)&&null!==(e=e.child))for(ur(e,t,n),e=e.sibling;null!==e;)ur(e,t,n),e=e.sibling}function hr(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?us(n,e,t):as(n,e);else if(!(4===r||ho&&27===r)&&null!==(e=e.child))for(hr(e,t,n),e=e.sibling;null!==e;)hr(e,t,n),e=e.sibling}function dr(e,t,n){e=e.containerInfo;try{Es(e,n)}catch(ox){_i(t,t.return,ox)}}function fr(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:wr(e,n),4&r&&er(5,n);break;case 1:if(wr(e,n),4&r)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(ox){_i(n,n.return,ox)}else{var i=Kt(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(o){_i(n,n.return,o)}}64&r&&nr(n),512&r&&ir(n,n.return);break;case 3:if(wr(e,n),64&r&&null!==(r=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 27:case 5:e=va(n.child.stateNode);break;case 1:e=n.child.stateNode}try{me(r,e)}catch(ox){_i(n,n.return,ox)}}break;case 26:if(Qs){wr(e,n),512&r&&ir(n,n.return);break}case 27:case 5:wr(e,n),null===t&&4&r&&sr(n),512&r&&ir(n,n.return);break;case 12:wr(e,n);break;case 13:wr(e,n),4&r&&vr(e,n);break;case 22:if(!(i=null!==n.memoizedState||hc)){t=null!==t&&null!==t.memoizedState||dc;var a=hc,s=dc;hc=i,(dc=t)&&!s?Tr(e,n,0!==(8772&n.subtreeFlags)):wr(e,n),hc=a,dc=s}512&r&&("manual"===n.memoizedProps.mode?ir(n,n.return):ar(n,n.return));break;default:wr(e,n)}}function pr(e){var t=e.alternate;null!==t&&(e.alternate=null,pr(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ba(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function mr(e,t,n){for(n=n.child;null!==n;)gr(e,t,n),n=n.sibling}function gr(e,t,n){if(Fo&&"function"===typeof Fo.onCommitFiberUnmount)try{Fo.onCommitFiberUnmount(Uo,n)}catch(a){}switch(n.tag){case 26:if(Qs){dc||ar(n,t),mr(e,t,n),n.memoizedState?no(n.memoizedState):n.stateNode&&ao(n.stateNode);break}case 27:if(ho){dc||ar(n,t);var r=vc,i=yc;vc=n.stateNode,mr(e,t,n),go(n.stateNode),vc=r,yc=i;break}case 5:dc||ar(n,t);case 6:if(Pa){if(r=vc,i=yc,vc=null,mr(e,t,n),yc=i,null!==(vc=r))if(yc)try{fs(vc,n.stateNode)}catch(ox){_i(n,t,ox)}else try{ds(vc,n.stateNode)}catch(ox){_i(n,t,ox)}}else mr(e,t,n);break;case 18:Pa&&null!==vc&&(yc?Xs(vc,n.stateNode):qs(vc,n.stateNode));break;case 4:Pa?(r=vc,i=yc,vc=n.stateNode.containerInfo,yc=!0,mr(e,t,n),vc=r,yc=i):(Na&&dr(n.stateNode,n,Ss()),mr(e,t,n));break;case 0:case 11:case 14:case 15:dc||tr(2,n,t),dc||tr(4,n,t),mr(e,t,n);break;case 1:dc||(ar(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount&&rr(n,t,r)),mr(e,t,n);break;case 21:mr(e,t,n);break;case 22:dc||ar(n,t),dc=(r=dc)||null!==n.memoizedState,mr(e,t,n),dc=r;break;default:mr(e,t,n)}}function vr(e,t){if(ka&&null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Ws(e)}catch(ox){_i(t,t.return,ox)}}function yr(e,t){var n=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new pc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new pc),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var r=Ei.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}function _r(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r],s=e,o=t;if(Pa){var l=o;e:for(;null!==l;){switch(l.tag){case 27:case 5:vc=l.stateNode,yc=!1;break e;case 3:case 4:vc=l.stateNode.containerInfo,yc=!0;break e}l=l.return}if(null===vc)throw Error(i(160));gr(s,o,a),vc=null,yc=!1}else gr(s,o,a);null!==(s=a.alternate)&&(s.return=null),a.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)br(t,e),t=t.sibling}function br(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:_r(t,e),Sr(e),4&r&&(tr(3,e,e.return),er(3,e),tr(5,e,e.return));break;case 1:_r(t,e),Sr(e),512&r&&(dc||null===n||ar(n,n.return)),64&r&&hc&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?r:n.concat(r))));break;case 26:if(Qs){var a=_c;_r(t,e),Sr(e),512&r&&(dc||null===n||ar(n,n.return)),4&r&&(r=null!==n?n.memoizedState:null,t=e.memoizedState,null===n?null===t?null===e.stateNode?e.stateNode=ro(a,e.type,e.memoizedProps,e):io(a,e.type,e.stateNode):e.stateNode=to(a,t,e.memoizedProps):r!==t?(null===r?null!==n.stateNode&&ao(n.stateNode):no(r),null===t?io(a,e.type,e.stateNode):to(a,t,e.memoizedProps)):null===t&&null!==e.stateNode&&or(e,e.memoizedProps,n.memoizedProps));break}case 27:if(ho&&4&r&&null===e.alternate){a=e.stateNode;var s=e.memoizedProps;try{po(a),mo(e.type,s,a,e)}catch(ox){_i(e,e.return,ox)}}case 5:if(_r(t,e),Sr(e),512&r&&(dc||null===n||ar(n,n.return)),Pa){if(32&e.flags){t=e.stateNode;try{ps(t)}catch(ox){_i(e,e.return,ox)}}4&r&&null!=e.stateNode&&or(e,t=e.memoizedProps,null!==n?n.memoizedProps:t),1024&r&&(fc=!0)}break;case 6:if(_r(t,e),Sr(e),4&r&&Pa){if(null===e.stateNode)throw Error(i(162));r=e.memoizedProps,n=null!==n?n.memoizedProps:r,t=e.stateNode;try{os(t,n,r)}catch(ox){_i(e,e.return,ox)}}break;case 3:if(Qs?(oo(),a=_c,_c=$s(t.containerInfo),_r(t,e),_c=a):_r(t,e),Sr(e),4&r){if(Pa&&ka&&null!==n&&n.memoizedState.isDehydrated)try{Gs(t.containerInfo)}catch(ox){_i(e,e.return,ox)}if(Na){r=t.containerInfo,n=t.pendingChildren;try{Es(r,n)}catch(ox){_i(e,e.return,ox)}}}fc&&(fc=!1,xr(e));break;case 4:Qs?(n=_c,_c=$s(e.stateNode.containerInfo),_r(t,e),Sr(e),_c=n):(_r(t,e),Sr(e)),4&r&&Na&&dr(e.stateNode,e,e.stateNode.pendingChildren);break;case 12:_r(t,e),Sr(e);break;case 13:_r(t,e),Sr(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Yc=Ro()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,yr(e,r)));break;case 22:512&r&&(dc||null===n||ar(n,n.return)),a=null!==e.memoizedState;var o=null!==n&&null!==n.memoizedState,l=hc,c=dc;if(hc=l||a,dc=c||o,_r(t,e),dc=c,hc=l,Sr(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=a?-2&t._visibility:1|t._visibility,a&&(t=hc||dc,null===n||o||t||Er(e)),Pa&&(null===e.memoizedProps||"manual"!==e.memoizedProps.mode)))e:if(n=null,Pa)for(t=e;;){if(5===t.tag||Qs&&26===t.tag||ho&&27===t.tag){if(null===n){o=n=t;try{s=o.stateNode,a?ms(s):vs(o.stateNode,o.memoizedProps)}catch(ox){_i(o,o.return,ox)}}}else if(6===t.tag){if(null===n){o=t;try{var u=o.stateNode;a?gs(u):ys(u,o.memoizedProps)}catch(ox){_i(o,o.return,ox)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(n=r.retryQueue)&&(r.retryQueue=null,yr(e,n))));break;case 19:_r(t,e),Sr(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,yr(e,r)));break;case 21:break;default:_r(t,e),Sr(e)}}function Sr(e){var t=e.flags;if(2&t){try{if(Pa&&(!ho||27!==e.tag)){e:{for(var n=e.return;null!==n;){if(lr(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 27:if(ho){var a=r.stateNode;hr(e,cr(e),a);break}case 5:var s=r.stateNode;32&r.flags&&(ps(s),r.flags&=-33),hr(e,cr(e),s);break;case 3:case 4:var o=r.stateNode.containerInfo;ur(e,cr(e),o);break;default:throw Error(i(161))}}}catch(ox){_i(e,e.return,ox)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xr(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;xr(t),5===t.tag&&1024&t.flags&&Ya(t.stateNode),e=e.sibling}}function wr(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)fr(e,t.alternate,t),t=t.sibling}function Er(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:tr(4,t,t.return),Er(t);break;case 1:ar(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&rr(t,t.return,n),Er(t);break;case 26:case 27:case 5:ar(t,t.return),Er(t);break;case 22:ar(t,t.return),null===t.memoizedState&&Er(t);break;default:Er(t)}e=e.sibling}}function Tr(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,i=e,a=t,s=a.flags;switch(a.tag){case 0:case 11:case 15:Tr(i,a,n),er(4,a);break;case 1:if(Tr(i,a,n),"function"===typeof(i=(r=a).stateNode).componentDidMount)try{i.componentDidMount()}catch(ox){_i(r,r.return,ox)}if(null!==(i=(r=a).updateQueue)){var o=r.stateNode;try{var l=i.shared.hiddenCallbacks;if(null!==l)for(i.shared.hiddenCallbacks=null,i=0;i<l.length;i++)pe(l[i],o)}catch(ox){_i(r,r.return,ox)}}n&&64&s&&nr(a),ir(a,a.return);break;case 26:case 27:case 5:Tr(i,a,n),n&&null===r&&4&s&&sr(a),ir(a,a.return);break;case 12:default:Tr(i,a,n);break;case 13:Tr(i,a,n),n&&4&s&&vr(i,a);break;case 22:null===a.memoizedState&&Tr(i,a,n),ir(a,a.return)}t=t.sibling}}function Mr(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&On(n))}function Cr(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&On(e))}function Ar(e,t,n,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Ir(e,t,n,r),t=t.sibling}function Ir(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Ar(e,t,n,r),2048&i&&er(9,t);break;case 3:Ar(e,t,n,r),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&On(e)));break;case 12:if(2048&i){Ar(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,s=a.id,o=a.onPostCommit;"function"===typeof o&&o(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(ox){_i(t,t.return,ox)}}else Ar(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,null!==t.memoizedState?4&a._visibility?Ar(e,t,n,r):Pr(e,t):4&a._visibility?Ar(e,t,n,r):(a._visibility|=4,Rr(e,t,n,r,0!==(10256&t.subtreeFlags))),2048&i&&Mr(t.alternate,t);break;case 24:Ar(e,t,n,r),2048&i&&Cr(t.alternate,t);break;default:Ar(e,t,n,r)}}function Rr(e,t,n,r,i){for(i=i&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var a=e,s=t,o=n,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:Rr(a,s,o,l,i),er(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?4&u._visibility?Rr(a,s,o,l,i):Pr(a,s):(u._visibility|=4,Rr(a,s,o,l,i)),i&&2048&c&&Mr(s.alternate,s);break;case 24:Rr(a,s,o,l,i),i&&2048&c&&Cr(s.alternate,s);break;default:Rr(a,s,o,l,i)}t=t.sibling}}function Pr(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Pr(n,r),2048&i&&Mr(r.alternate,r);break;case 24:Pr(n,r),2048&i&&Cr(r.alternate,r);break;default:Pr(n,r)}t=t.sibling}}function Nr(e){if(e.subtreeFlags&bc)for(e=e.child;null!==e;)kr(e),e=e.sibling}function kr(e){switch(e.tag){case 26:Nr(e),e.flags&bc&&(null!==e.memoizedState?uo(_c,e.memoizedState,e.memoizedProps):Ga(e.type,e.memoizedProps));break;case 5:Nr(e),e.flags&bc&&Ga(e.type,e.memoizedProps);break;case 3:case 4:if(Qs){var t=_c;_c=$s(e.stateNode.containerInfo),Nr(e),_c=t}else Nr(e);break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=bc,bc=16777216,Nr(e),bc=t):Nr(e));break;default:Nr(e)}}function Lr(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Dr(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];mc=r,Fr(r,e)}Lr(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Or(e),e=e.sibling}function Or(e){switch(e.tag){case 0:case 11:case 15:Dr(e),2048&e.flags&&tr(9,e,e.return);break;case 3:case 12:default:Dr(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Ur(e)):Dr(e)}}function Ur(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var r=t[n];mc=r,Fr(r,e)}Lr(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:tr(8,t,t.return),Ur(t);break;case 22:4&(n=t.stateNode)._visibility&&(n._visibility&=-5,Ur(t));break;default:Ur(t)}e=e.sibling}}function Fr(e,t){for(;null!==mc;){var n=mc;switch(n.tag){case 0:case 11:case 15:tr(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var r=n.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:On(n.memoizedState.cache)}if(null!==(r=n.child))r.return=n,mc=r;else e:for(n=e;null!==mc;){var i=(r=mc).sibling,a=r.return;if(pr(r),r===n){mc=null;break e}if(null!==i){i.return=a,mc=i;break e}mc=a}}}function zr(e){var t=La(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(i(364));return t}if(null===(e=Za(e)))throw Error(i(362));return e.stateNode.current}function Br(e,t){var n=e.tag;switch(t.$$typeof){case xc:if(e.type===t.value)return!0;break;case wc:e:{for(t=t.value,e=[e,0],n=0;n<e.length;){var r=e[n++],a=r.tag,s=e[n++],o=t[s];if(5!==a&&26!==a&&27!==a||!ts(r)){for(;null!=o&&Br(r,o);)o=t[++s];if(s===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,s),r=r.sibling}}t=!1}return t;case Ec:if((5===n||26===n||27===n)&&ns(e.stateNode,t.value))return!0;break;case Mc:if((5===n||6===n||26===n||27===n)&&(null!==(e=es(e))&&0<=e.indexOf(t.value)))return!0;break;case Tc:if((5===n||26===n||27===n)&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Vr(e){switch(e.$$typeof){case xc:return"<"+(s(e.value)||"Unknown")+">";case wc:return":has("+(Vr(e)||"")+")";case Ec:return'[role="'+e.value+'"]';case Mc:return'"'+e.value+'"';case Tc:return'[data-testname="'+e.value+'"]';default:throw Error(i(365))}}function Hr(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var i=e[r++],a=i.tag,s=e[r++],o=t[s];if(5!==a&&26!==a&&27!==a||!ts(i)){for(;null!=o&&Br(i,o);)o=t[++s];if(s===t.length)n.push(i);else for(i=i.child;null!==i;)e.push(i,s),i=i.sibling}}return n}function jr(e,t){if(!Qa)throw Error(i(363));e=Hr(e=zr(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++],a=r.tag;if(5===a||26===a||27===a)ts(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}function Gr(){if(0!==(2&Ic)&&0!==Nc)return Nc&-Nc;if(null!==ha.T){return 0!==vl?vl:ie()}return Fa()}function Wr(){0===jc&&(jc=0===(536870912&Nc)||nl?w():536870912);var e=Nl.current;return null!==e&&(e.flags|=32),jc}function qr(e,t,n){(e===Rc&&2===kc||null!==e.cancelPendingCommit)&&(ei(e,0),Qr(e,Nc,jc,!1)),M(e,n),0!==(2&Ic)&&e===Rc||(e===Rc&&(0===(2&Ic)&&(Vc|=n),4===zc&&Qr(e,Nc,jc,!1)),Z(e))}function Xr(e,t,n){if(0!==(6&Ic))throw Error(i(327));for(var r=!n&&0===(60&t)&&0===(t&e.expiredLanes)||S(e,t),a=r?function(e,t){var n=Ic;Ic|=2;var r=ii(),a=ai();Rc!==e||Nc!==t?(Jc=null,Kc=Ro()+500,ei(e,t)):Oc=S(e,t);e:for(;;)try{if(0!==kc&&null!==Pc){t=Pc;var s=Lc;t:switch(kc){case 1:kc=0,Lc=null,di(e,t,s,1);break;case 2:if(ve(s)){kc=0,Lc=null,hi(t);break}t=function(){2===kc&&Rc===e&&(kc=7),Z(e)},s.then(t,t);break e;case 3:kc=7;break e;case 4:kc=5;break e;case 7:ve(s)?(kc=0,Lc=null,hi(t)):(kc=0,Lc=null,di(e,t,s,7));break;case 5:var o=null;switch(Pc.tag){case 26:o=Pc.memoizedState;case 5:case 27:var l=Pc,c=l.type,u=l.pendingProps;if(o?co(o):Ha(c,u)){kc=0,Lc=null;var h=l.sibling;if(null!==h)Pc=h;else{var d=l.return;null!==d?(Pc=d,fi(d)):Pc=null}break t}}kc=0,Lc=null,di(e,t,s,5);break;case 6:kc=0,Lc=null,di(e,t,s,6);break;case 8:$r(),zc=6;break e;default:throw Error(i(462))}}ci();break}catch(f){ti(e,f)}return ic=rc=null,ha.H=r,ha.A=a,Ic=n,null!==Pc?0:(Rc=null,Nc=0,q(),zc)}(e,t):oi(e,t,!0),s=r;;){if(0===a){Oc&&!r&&Qr(e,t,0,!1);break}if(6===a)Qr(e,t,0,!Dc);else{if(n=e.current.alternate,s&&!Jr(n)){a=oi(e,t,!1),s=!1;continue}if(2===a){if(s=t,e.errorRecoveryDisabledLanes&s)var o=0;else o=0!==(o=-536870913&e.pendingLanes)?o:536870912&o?536870912:0;if(0!==o){t=o;e:{var l=e;a=Wc;var c=ka&&l.current.memoizedState.isDehydrated;if(c&&(ei(l,o).flags|=256),2!==(o=oi(l,o,!1))){if(Uc&&!c){l.errorRecoveryDisabledLanes|=s,Vc|=s,a=4;break e}s=qc,qc=a,null!==s&&Yr(s)}a=o}if(s=!1,2!==a)continue}}if(1===a){ei(e,0),Qr(e,t,0,!0);break}e:{switch(r=e,a){case 0:case 1:throw Error(i(345));case 4:if((4194176&t)===t){Qr(r,t,jc,!Dc);break e}break;case 2:qc=null;break;case 3:case 5:break;default:throw Error(i(329))}if(r.finishedWork=n,r.finishedLanes=t,(62914560&t)===t&&10<(s=Yc+300-Ro())){if(Qr(r,t,jc,!Dc),0!==b(r,0))break e;r.timeoutHandle=Ca(Kr.bind(null,r,n,qc,Jc,Xc,t,jc,Vc,Gc,Dc,2,-0,0),s)}else Kr(r,n,qc,Jc,Xc,t,jc,Vc,Gc,Dc,0,-0,0)}}break}Z(e)}function Yr(e){null===qc?qc=e:qc.push.apply(qc,e)}function Kr(e,t,n,r,i,a,s,o,l,c,u,h,d){var f=t.subtreeFlags;if((8192&f||16785408===(16785408&f))&&(ja(),kr(t),null!==(t=Wa())))return e.cancelPendingCommit=t(mi.bind(null,e,n,r,i,s,o,l,1,h,d)),void Qr(e,a,s,!c);mi(e,n,r,i,s,o,l,u,h,d)}function Jr(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!zo(a(),i))return!1}catch(ox){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Qr(e,t,n,r){t&=~Hc,t&=~Vc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-So(i),s=1<<a;r[a]=-1,i&=~s}0!==n&&C(e,n,t)}function Zr(){return 0!==(6&Ic)||($(0,!1),!1)}function $r(){if(null!==Pc){if(0===kc)var e=Pc.return;else ic=rc=null,He(e=Pc),Ml=null,Cl=0,e=Pc;for(;null!==e;)$n(e.alternate,e),e=e.return;Pc=null}}function ei(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;n!==Ia&&(e.timeoutHandle=Ia,Aa(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),$r(),Rc=e,Pc=n=Ci(e.current,null),Nc=t,kc=0,Lc=null,Dc=!1,Oc=S(e,t),Uc=!1,Gc=jc=Hc=Vc=Bc=zc=0,qc=Wc=null,Xc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var i=31-So(r),a=1<<i;t|=e[i],r&=~a}return Fc=t,q(),n}function ti(e,t){Ol=null,ha.H=Xl,t===xl?(t=be(),kc=3):t===wl?(t=be(),kc=4):kc=t===$l?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,Lc=t,null===Pc&&(zc=1,Jt(e,P(t,e.current)))}function ri(){var e=Nl.current;return null===e||((4194176&Nc)===Nc?null===kl:((62914560&Nc)===Nc||0!==(536870912&Nc))&&e===kl)}function ii(){var e=ha.H;return ha.H=Xl,null===e?Xl:e}function ai(){var e=ha.A;return ha.A=Sc,e}function si(){zc=4,Dc||(4194176&Nc)!==Nc&&null!==Nl.current||(Oc=!0),0===(134217727&Bc)&&0===(134217727&Vc)||null===Rc||Qr(Rc,Nc,jc,!1)}function oi(e,t,n){var r=Ic;Ic|=2;var i=ii(),a=ai();Rc===e&&Nc===t||(Jc=null,ei(e,t)),t=!1;var s=zc;e:for(;;)try{if(0!==kc&&null!==Pc){var o=Pc,l=Lc;switch(kc){case 8:$r(),s=6;break e;case 3:case 2:case 6:null===Nl.current&&(t=!0);var c=kc;if(kc=0,Lc=null,di(e,o,l,c),n&&Oc){s=0;break e}break;default:c=kc,kc=0,Lc=null,di(e,o,l,c)}}li(),s=zc;break}catch(u){ti(e,u)}return t&&e.shellSuspendCounter++,ic=rc=null,Ic=r,ha.H=i,ha.A=a,null===Pc&&(Rc=null,Nc=0,q()),s}function li(){for(;null!==Pc;)ui(Pc)}function ci(){for(;null!==Pc&&!Ao();)ui(Pc)}function ui(e){var t=En(e.alternate,e,Fc);e.memoizedProps=e.pendingProps,null===t?fi(e):Pc=t}function hi(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=un(n,t,t.pendingProps,t.type,void 0,Nc);break;case 11:t=un(n,t,t.pendingProps,t.type.render,t.ref,Nc);break;case 5:He(t);default:$n(n,t),t=En(n,t=Pc=Ai(t,Fc),Fc)}e.memoizedProps=e.pendingProps,null===t?fi(e):Pc=t}function di(e,t,n,r){ic=rc=null,He(t),Ml=null,Cl=0;var a=t.return;try{if(function(e,t,n,r,a){if(n.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=n.alternate)&&In(t,n,a,!0),null!==(n=Nl.current)){switch(n.tag){case 13:return null===kl?si():null===n.alternate&&0===zc&&(zc=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===El?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([r]):t.add(r),bi(e,r,a)),!1;case 22:return n.flags|=65536,r===El?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([r]):n.add(r),bi(e,r,a)),!1}throw Error(i(435,n.tag))}return bi(e,r,a),si(),!1}if(nl)return null!==(t=Nl.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==al&&W(P(e=Error(i(422),{cause:r}),n))):(r!==al&&W(P(t=Error(i(423),{cause:r}),n)),(e=e.current.alternate).flags|=65536,a&=-a,e.lanes|=a,r=P(r,n),he(e,a=Zt(e.stateNode,r,a)),4!==zc&&(zc=2)),!1;var s=Error(i(520),{cause:r});if(s=P(s,n),null===Wc?Wc=[s]:Wc.push(s),4!==zc&&(zc=2),null===t)return!0;r=P(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,he(n,e=Zt(n.stateNode,r,e)),!1;case 1:if(t=n.type,s=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==s&&"function"===typeof s.componentDidCatch&&(null===Qc||!Qc.has(s))))return n.flags|=65536,a&=-a,n.lanes|=a,en(a=$t(a),e,n,r),he(n,a),!1}n=n.return}while(null!==n);return!1}(e,a,t,n,Nc))return zc=1,Jt(e,P(n,e.current)),void(Pc=null)}catch(ox){if(null!==a)throw Pc=a,ox;return zc=1,Jt(e,P(n,e.current)),void(Pc=null)}32768&t.flags?(nl||1===r?e=!0:Oc||0!==(536870912&Nc)?e=!1:(Dc=e=!0,(2===r||3===r||6===r)&&(null!==(r=Nl.current)&&13===r.tag&&(r.flags|=16384))),pi(t,e)):fi(t)}function fi(e){var t=e;do{if(0!==(32768&t.flags))return void pi(t,Dc);e=t.return;var n=Qn(t.alternate,t,Fc);if(null!==n)return void(Pc=n);if(null!==(t=t.sibling))return void(Pc=t);Pc=t=e}while(null!==t);0===zc&&(zc=5)}function pi(e,t){do{var n=Zn(e.alternate,e);if(null!==n)return n.flags&=32767,void(Pc=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(Pc=e);Pc=e=n}while(null!==e);zc=6,Pc=null}function mi(e,t,n,r,a,s,o,l,c,u){var h=ha.T,d=Ua();try{Oa(2),ha.T=null,function(e,t,n,r,a,s,o,l){do{vi()}while(null!==$c);if(0!==(6&Ic))throw Error(i(327));var c=e.finishedWork;if(r=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=c.lanes|c.childLanes;if(function(e,t,n,r,i,a){var s=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var o=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(n=s&~n;0<n;){var u=31-So(n),h=1<<u;o[u]=0,l[u]=-1;var d=c[u];if(null!==d)for(c[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}n&=~h}0!==r&&C(e,r,0),0!==a&&0===i&&0!==e.tag&&(e.suspendedLanes|=a&~(s&~t))}(e,r,u|=ll,s,o,l),e===Rc&&(Pc=Rc=null,Nc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||Zc||(Zc=!0,tu=u,nu=n,function(e,t){Mo(e,t)}(ko,function(){return vi(),null})),n=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||n?(n=ha.T,ha.T=null,s=Ua(),Oa(2),o=Ic,Ic|=4,function(e,t){for(ba(e.containerInfo),mc=t;null!==mc;)if(t=(e=mc).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,mc=t;else for(;null!==mc;){var n=(e=mc).alternate;switch(t=e.flags,e.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&t)&&null!==n){t=void 0;var r=e,a=n.memoizedProps;n=n.memoizedState;var s=r.stateNode;try{var o=Kt(r.type,a,(r.elementType,r.type));t=s.getSnapshotBeforeUpdate(o,n),s.__reactInternalSnapshotBeforeUpdate=t}catch(ox){_i(r,r.return,ox)}}break;case 3:0!==(1024&t)&&Pa&&_s(e.stateNode.containerInfo);break;default:if(0!==(1024&t))throw Error(i(163))}if(null!==(t=e.sibling)){t.return=e.return,mc=t;break}mc=e.return}o=gc,gc=!1}(e,c),br(c,e),Sa(e.containerInfo),e.current=c,fr(e,c.alternate,c),Io(),Ic=o,Oa(s),ha.T=n):e.current=c,Zc?(Zc=!1,$c=e,eu=r):gi(e,u),u=e.pendingLanes,0===u&&(Qc=null),function(e){if(Fo&&"function"===typeof Fo.onCommitFiberRoot)try{Fo.onCommitFiberRoot(Uo,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),Z(e),null!==t)for(a=e.onRecoverableError,c=0;c<t.length;c++)u=t[c],a(u.value,{componentStack:u.stack});0!==(3&eu)&&vi(),u=e.pendingLanes,0!==(4194218&r)&&0!==(42&u)?e===iu?ru++:(ru=0,iu=e):ru=0,$(0,!1)}(e,t,n,r,d,a,s,o)}finally{ha.T=h,Oa(d)}}function gi(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,On(t)))}function vi(){if(null!==$c){var e=$c,t=tu;tu=0;var n=I(eu),r=32>n?32:n;n=ha.T;var a=Ua();try{if(Oa(r),ha.T=null,null===$c)var s=!1;else{r=nu,nu=null;var o=$c,l=eu;if($c=null,eu=0,0!==(6&Ic))throw Error(i(331));var c=Ic;if(Ic|=4,Or(o.current),Ir(o,o.current,l,r),Ic=c,$(0,!1),Fo&&"function"===typeof Fo.onPostCommitFiberRoot)try{Fo.onPostCommitFiberRoot(Uo,o)}catch(u){}s=!0}return s}finally{Oa(a),ha.T=n,gi(e,t)}}return!1}function yi(e,t,n){t=P(n,t),null!==(e=ce(e,t=Zt(e.stateNode,t,2),2))&&(M(e,2),Z(e))}function _i(e,t,n){if(3===e.tag)yi(e,e,n);else for(;null!==t;){if(3===t.tag){yi(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Qc||!Qc.has(r))){e=P(n,e),null!==(r=ce(t,n=$t(2),2))&&(en(n,r,t,e),M(r,2),Z(r));break}}t=t.return}}function bi(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new Ac;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(Uc=!0,i.add(n),e=Si.bind(null,e,t,n),t.then(e,e))}function Si(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Rc===e&&(Nc&n)===n&&(4===zc||3===zc&&(62914560&Nc)===Nc&&300>Ro()-Yc?0===(2&Ic)&&ei(e,0):Hc|=n,Gc===Nc&&(Gc=0)),Z(e)}function xi(e,t){0===t&&(t=E()),null!==(e=K(e,t))&&(M(e,t),Z(e))}function wi(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),xi(e,n)}function Ei(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==r&&r.delete(t),xi(e,n)}function Ti(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ci(e,n){var r=e.alternate;return null===r?((r=t(e.tag,n,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=n,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=31457280&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,n=e.dependencies,r.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r.refCleanup=e.refCleanup,r}function Ai(e,t){e.flags&=31457282;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ii(e,n,r,a,s,o){var l=0;if(a=e,"function"===typeof e)Mi(e)&&(l=1);else if("string"===typeof e)l=Qs&&ho?Zs(e,r,Jo.current)?26:vo(e)?27:5:Qs?Zs(e,r,Jo.current)?26:5:ho&&vo(e)?27:5;else e:switch(e){case Yi:return Ri(r.children,s,o,n);case Ki:l=8,s|=24;break;case Ji:return(e=t(12,r,n,2|s)).elementType=Ji,e.lanes=o,e;case ta:return(e=t(13,r,n,s)).elementType=ta,e.lanes=o,e;case na:return(e=t(19,r,n,s)).elementType=na,e.lanes=o,e;case aa:return Pi(r,s,o,n);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case Qi:case $i:l=10;break e;case Zi:l=9;break e;case ea:l=11;break e;case ra:l=14;break e;case ia:l=16,a=null;break e}l=29,r=Error(i(130,null===e?"null":typeof e,"")),a=null}return(n=t(l,r,n,s)).elementType=e,n.type=a,n.lanes=o,n}function Ri(e,n,r,i){return(e=t(7,e,i,n)).lanes=r,e}function Pi(e,n,r,a){(e=t(22,e,a,n)).elementType=aa,e.lanes=r;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=s._current;if(null===e)throw Error(i(456));if(0===(2&s._pendingVisibility)){var t=K(e,2);null!==t&&(s._pendingVisibility|=2,qr(t,0,2))}},attach:function(){var e=s._current;if(null===e)throw Error(i(456));if(0!==(2&s._pendingVisibility)){var t=K(e,2);null!==t&&(s._pendingVisibility&=-3,qr(t,0,2))}}};return e.stateNode=s,e}function Ni(e,n,r){return(e=t(6,e,null,n)).lanes=r,e}function ki(e,n,r){return(n=t(4,null!==e.children?e.children:[],e.key,n)).lanes=r,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function Li(e,t,n,r,i,a,s,o){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Ia,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=T(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=T(0),this.hiddenUpdates=T(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function Di(e,n,r,i,a,s,o,l,c,u,h,d){return e=new Li(e,n,r,o,l,c,u,d),n=1,!0===s&&(n|=24),s=t(3,null,null,n),e.current=s,s.stateNode=e,(n=Dn()).refCount++,e.pooledCache=n,n.refCount++,s.memoizedState={element:i,isDehydrated:r,cache:n},se(s),e}function Oi(e){return e?e=bo:bo}function Ui(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return null===(e=null!==(e=f(t))?p(e):null)?null:va(e.stateNode)}function Fi(e,t,n,r,i,a){i=Oi(i),null===r.context?r.context=i:r.pendingContext=i,(r=le(t)).payload={element:n},null!==(a=void 0===a?null:a)&&(r.callback=a),null!==(n=ce(e,r,t))&&(qr(n,0,t),ue(n,e,t))}function zi(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Bi(e,t){zi(e,t),(e=e.alternate)&&zi(e,t)}var Vi={},Hi=n(43),ji=n(513),Gi=Object.assign,Wi=Symbol.for("react.element"),qi=Symbol.for("react.transitional.element"),Xi=Symbol.for("react.portal"),Yi=Symbol.for("react.fragment"),Ki=Symbol.for("react.strict_mode"),Ji=Symbol.for("react.profiler"),Qi=Symbol.for("react.provider"),Zi=Symbol.for("react.consumer"),$i=Symbol.for("react.context"),ea=Symbol.for("react.forward_ref"),ta=Symbol.for("react.suspense"),na=Symbol.for("react.suspense_list"),ra=Symbol.for("react.memo"),ia=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var aa=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var sa,oa,la=Symbol.for("react.memo_cache_sentinel"),ca=Symbol.iterator,ua=Symbol.for("react.client.reference"),ha=Hi.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,da=!1,fa=Array.isArray,pa=e.rendererVersion,ma=e.rendererPackageName,ga=e.extraDevToolsConfig,va=e.getPublicInstance,ya=e.getRootHostContext,_a=e.getChildHostContext,ba=e.prepareForCommit,Sa=e.resetAfterCommit,xa=e.createInstance,wa=e.appendInitialChild,Ea=e.finalizeInitialChildren,Ta=e.shouldSetTextContent,Ma=e.createTextInstance,Ca=e.scheduleTimeout,Aa=e.cancelTimeout,Ia=e.noTimeout,Ra=e.isPrimaryRenderer;e.warnsIfNotActing;var Pa=e.supportsMutation,Na=e.supportsPersistence,ka=e.supportsHydration,La=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Da=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Oa=e.setCurrentUpdatePriority,Ua=e.getCurrentUpdatePriority,Fa=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var za=e.shouldAttemptEagerTransition,Ba=e.detachDeletedInstance;e.requestPostPaintCallback;var Va=e.maySuspendCommit,Ha=e.preloadInstance,ja=e.startSuspendingCommit,Ga=e.suspendInstance,Wa=e.waitForCommitToBeReady,qa=e.NotPendingTransition,Xa=e.HostTransitionContext,Ya=e.resetFormInstance;e.bindToConsole;var Ka=e.supportsMicrotasks,Ja=e.scheduleMicrotask,Qa=e.supportsTestSelectors,Za=e.findFiberRoot,$a=e.getBoundingRect,es=e.getTextContent,ts=e.isHiddenSubtree,ns=e.matchAccessibilityRole,rs=e.setFocusIfFocusable,is=e.setupIntersectionObserver,as=e.appendChild,ss=e.appendChildToContainer,os=e.commitTextUpdate,ls=e.commitMount,cs=e.commitUpdate,us=e.insertBefore,hs=e.insertInContainerBefore,ds=e.removeChild,fs=e.removeChildFromContainer,ps=e.resetTextContent,ms=e.hideInstance,gs=e.hideTextInstance,vs=e.unhideInstance,ys=e.unhideTextInstance,_s=e.clearContainer,bs=e.cloneInstance,Ss=e.createContainerChildSet,xs=e.appendChildToContainerChildSet,ws=e.finalizeContainerChildren,Es=e.replaceContainerChildren,Ts=e.cloneHiddenInstance,Ms=e.cloneHiddenTextInstance,Cs=e.isSuspenseInstancePending,As=e.isSuspenseInstanceFallback,Is=e.getSuspenseInstanceFallbackErrorDetails,Rs=e.registerSuspenseInstanceRetry,Ps=e.canHydrateFormStateMarker,Ns=e.isFormStateMarkerMatching,ks=e.getNextHydratableSibling,Ls=e.getFirstHydratableChild,Ds=e.getFirstHydratableChildWithinContainer,Os=e.getFirstHydratableChildWithinSuspenseInstance,Us=e.canHydrateInstance,Fs=e.canHydrateTextInstance,zs=e.canHydrateSuspenseInstance,Bs=e.hydrateInstance,Vs=e.hydrateTextInstance,Hs=e.hydrateSuspenseInstance,js=e.getNextHydratableInstanceAfterSuspenseInstance,Gs=e.commitHydratedContainer,Ws=e.commitHydratedSuspenseInstance,qs=e.clearSuspenseBoundary,Xs=e.clearSuspenseBoundaryFromContainer,Ys=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Ks=e.validateHydratableInstance,Js=e.validateHydratableTextInstance,Qs=e.supportsResources,Zs=e.isHostHoistableType,$s=e.getHoistableRoot,eo=e.getResource,to=e.acquireResource,no=e.releaseResource,ro=e.hydrateHoistable,io=e.mountHoistable,ao=e.unmountHoistable,so=e.createHoistableInstance,oo=e.prepareToCommitHoistables,lo=e.mayResourceSuspendCommit,co=e.preloadResource,uo=e.suspendResource,ho=e.supportsSingletons,fo=e.resolveSingletonInstance,po=e.clearSingleton,mo=e.acquireSingletonInstance,go=e.releaseSingletonInstance,vo=e.isHostSingletonType,yo=[],_o=-1,bo={},So=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xo(e)/wo|0)|0},xo=Math.log,wo=Math.LN2,Eo=128,To=4194304,Mo=ji.unstable_scheduleCallback,Co=ji.unstable_cancelCallback,Ao=ji.unstable_shouldYield,Io=ji.unstable_requestPaint,Ro=ji.unstable_now,Po=ji.unstable_ImmediatePriority,No=ji.unstable_UserBlockingPriority,ko=ji.unstable_NormalPriority,Lo=ji.unstable_IdlePriority,Do=ji.log,Oo=ji.unstable_setDisableYieldValue,Uo=null,Fo=null,zo="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Bo=new WeakMap,Vo=[],Ho=0,jo=null,Go=0,Wo=[],qo=0,Xo=null,Yo=1,Ko="",Jo=g(null),Qo=g(null),Zo=g(null),$o=g(null),el=null,tl=null,nl=!1,rl=null,il=!1,al=Error(i(519)),sl=[],ol=0,ll=0,cl=null,ul=null,hl=!1,dl=!1,fl=!1,pl=0,ml=null,gl=0,vl=0,yl=null,_l=!1,bl=!1,Sl=Object.prototype.hasOwnProperty,xl=Error(i(460)),wl=Error(i(474)),El={then:function(){}},Tl=null,Ml=null,Cl=0,Al=Te(!0),Il=Te(!1),Rl=g(null),Pl=g(0),Nl=g(null),kl=null,Ll=g(0),Dl=0,Ol=null,Ul=null,Fl=null,zl=!1,Bl=!1,Vl=!1,Hl=0,jl=0,Gl=null,Wl=0,ql=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Xl={readContext:Nn,use:qe,useCallback:Le,useContext:Le,useEffect:Le,useImperativeHandle:Le,useLayoutEffect:Le,useInsertionEffect:Le,useMemo:Le,useReducer:Le,useRef:Le,useState:Le,useDebugValue:Le,useDeferredValue:Le,useTransition:Le,useSyncExternalStore:Le,useId:Le};Xl.useCacheRefresh=Le,Xl.useMemoCache=Le,Xl.useHostTransitionStatus=Le,Xl.useFormState=Le,Xl.useActionState=Le,Xl.useOptimistic=Le;var Yl={readContext:Nn,use:qe,useCallback:function(e,t){return je().memoizedState=[e,void 0===t?null:t],e},useContext:Nn,useEffect:xt,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,bt(4194308,4,Mt.bind(null,t,e),n)},useLayoutEffect:function(e,t){return bt(4194308,4,e,t)},useInsertionEffect:function(e,t){bt(4,2,e,t)},useMemo:function(e,t){var n=je();t=void 0===t?null:t;var r=e();if(Vl){R(!0);try{e()}finally{R(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=je();if(void 0!==n){var i=n(t);if(Vl){R(!0);try{n(t)}finally{R(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=zt.bind(null,Ol,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},je().memoizedState=e},useState:function(e){var t=(e=it(e)).queue,n=Bt.bind(null,Ol,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:At,useDeferredValue:function(e,t){return Pt(je(),e,t)},useTransition:function(){var e=it(!1);return e=kt.bind(null,Ol,e.queue,!0,!1),je().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=Ol,a=je();if(nl){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Rc)throw Error(i(349));0!==(60&Nc)||$e(r,t,n)}a.memoizedState=n;var s={value:n,getSnapshot:t};return a.queue=s,xt(tt.bind(null,r,s,e),[e]),r.flags|=2048,yt(9,et.bind(null,r,s,n,t),{destroy:void 0},null),n},useId:function(){var e=je(),t=Rc.identifierPrefix;if(nl){var n=Ko;t=":"+t+"R"+(n=(Yo&~(1<<32-So(Yo)-1)).toString(32)+n),0<(n=Hl++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=Wl++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return je().memoizedState=Ft.bind(null,Ol)}};Yl.useMemoCache=Xe,Yl.useHostTransitionStatus=Dt,Yl.useFormState=ft,Yl.useActionState=ft,Yl.useOptimistic=function(e){var t=je();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Ht.bind(null,Ol,!0,n),n.dispatch=t,[e,t]};var Kl={readContext:Nn,use:qe,useCallback:It,useContext:Nn,useEffect:wt,useImperativeHandle:Ct,useInsertionEffect:Et,useLayoutEffect:Tt,useMemo:Rt,useReducer:Ke,useRef:_t,useState:function(){return Ke(Ye)},useDebugValue:At,useDeferredValue:function(e,t){return Nt(Ge(),Ul.memoizedState,e,t)},useTransition:function(){var e=Ke(Ye)[0],t=Ge().memoizedState;return["boolean"===typeof e?e:We(e),t]},useSyncExternalStore:Ze,useId:Ot};Kl.useCacheRefresh=Ut,Kl.useMemoCache=Xe,Kl.useHostTransitionStatus=Dt,Kl.useFormState=pt,Kl.useActionState=pt,Kl.useOptimistic=function(e,t){return at(Ge(),0,e,t)};var Jl={readContext:Nn,use:qe,useCallback:It,useContext:Nn,useEffect:wt,useImperativeHandle:Ct,useInsertionEffect:Et,useLayoutEffect:Tt,useMemo:Rt,useReducer:Qe,useRef:_t,useState:function(){return Qe(Ye)},useDebugValue:At,useDeferredValue:function(e,t){var n=Ge();return null===Ul?Pt(n,e,t):Nt(n,Ul.memoizedState,e,t)},useTransition:function(){var e=Qe(Ye)[0],t=Ge().memoizedState;return["boolean"===typeof e?e:We(e),t]},useSyncExternalStore:Ze,useId:Ot};Jl.useCacheRefresh=Ut,Jl.useMemoCache=Xe,Jl.useHostTransitionStatus=Dt,Jl.useFormState=vt,Jl.useActionState=vt,Jl.useOptimistic=function(e,t){var n=Ge();return null!==Ul?at(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])};var Ql={isMounted:function(e){return!!(e=e._reactInternals)&&h(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Gr(),i=le(r);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ce(e,i,r))&&(qr(t,0,r),ue(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Gr(),i=le(r);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=ce(e,i,r))&&(qr(t,0,r),ue(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gr(),r=le(n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=ce(e,r,n))&&(qr(t,0,n),ue(t,e,n))}},Zl="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},$l=Error(i(461)),ec=!1,tc={dehydrated:null,treeContext:null,retryLane:0},nc=g(null),rc=null,ic=null,ac="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},sc=ji.unstable_scheduleCallback,oc=ji.unstable_NormalPriority,lc={$$typeof:$i,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},cc=ha.S;ha.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===ml){var n=ml=[];gl=0,vl=ie(),yl={status:"pending",value:void 0,then:function(e){n.push(e)}}}gl++,t.then(ae,ae)}(0,t),null!==cc&&cc(e,t)};var uc=g(null),hc=!1,dc=!1,fc=!1,pc="function"===typeof WeakSet?WeakSet:Set,mc=null,gc=!1,vc=null,yc=!1,_c=null,bc=8192,Sc={getCacheForType:function(e){var t=Nn(lc),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n}},xc=0,wc=1,Ec=2,Tc=3,Mc=4;if("function"===typeof Symbol&&Symbol.for){var Cc=Symbol.for;xc=Cc("selector.component"),wc=Cc("selector.has_pseudo_class"),Ec=Cc("selector.role"),Tc=Cc("selector.test_id"),Mc=Cc("selector.text")}var Ac="function"===typeof WeakMap?WeakMap:Map,Ic=0,Rc=null,Pc=null,Nc=0,kc=0,Lc=null,Dc=!1,Oc=!1,Uc=!1,Fc=0,zc=0,Bc=0,Vc=0,Hc=0,jc=0,Gc=0,Wc=null,qc=null,Xc=!1,Yc=0,Kc=1/0,Jc=null,Qc=null,Zc=!1,$c=null,eu=0,tu=0,nu=null,ru=0,iu=null;return Vi.attemptContinuousHydration=function(e){if(13===e.tag){var t=K(e,67108864);null!==t&&qr(t,0,67108864),Bi(e,67108864)}},Vi.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Gr(),n=K(e,t);null!==n&&qr(n,0,t),Bi(e,t)}},Vi.attemptSynchronousHydration=function(e){switch(e.tag){case 3:if((e=e.stateNode).current.memoizedState.isDehydrated){var t=_(e.pendingLanes);if(0!==t){for(e.pendingLanes|=2,e.entangledLanes|=2;t;){var n=1<<31-So(t);e.entanglements[1]|=n,t&=~n}Z(e),0===(6&Ic)&&(Kc=Ro()+500,$(0,!1))}}break;case 13:null!==(t=K(e,2))&&qr(t,0,2),Zr(),Bi(e,2)}},Vi.batchedUpdates=function(e,t){return e(t)},Vi.createComponentSelector=function(e){return{$$typeof:xc,value:e}},Vi.createContainer=function(e,t,n,r,i,a,s,o,l,c){return Di(e,t,!1,null,0,r,a,s,o,l,0,null)},Vi.createHasPseudoClassSelector=function(e){return{$$typeof:wc,value:e}},Vi.createHydrationContainer=function(e,t,n,r,i,a,s,o,l,c,u,h,d){return(e=Di(n,r,!0,e,0,a,o,l,c,u,0,d)).context=Oi(null),n=e.current,(i=le(r=Gr())).callback=void 0!==t&&null!==t?t:null,ce(n,i,r),e.current.lanes=r,M(e,r),Z(e),e},Vi.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Xi,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},Vi.createRoleSelector=function(e){return{$$typeof:Ec,value:e}},Vi.createTestNameSelector=function(e){return{$$typeof:Tc,value:e}},Vi.createTextSelector=function(e){return{$$typeof:Mc,value:e}},Vi.defaultOnCaughtError=function(e){console.error(e)},Vi.defaultOnRecoverableError=function(e){Zl(e)},Vi.defaultOnUncaughtError=function(e){Zl(e)},Vi.deferredUpdates=function(e){var t=ha.T,n=Ua();try{return Oa(32),ha.T=null,e()}finally{Oa(n),ha.T=t}},Vi.discreteUpdates=function(e,t,n,r,i){var a=ha.T,s=Ua();try{return Oa(2),ha.T=null,e(t,n,r,i)}finally{Oa(s),ha.T=a,0===Ic&&(Kc=Ro()+500)}},Vi.findAllNodes=jr,Vi.findBoundingRects=function(e,t){if(!Qa)throw Error(i(363));t=jr(e,t),e=[];for(var n=0;n<t.length;n++)e.push($a(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,a=r+n.width,s=n.y,o=s+n.height,l=t-1;0<=l;l--)if(t!==l){var c=e[l],u=c.x,h=u+c.width,d=c.y,f=d+c.height;if(r>=u&&s>=d&&a<=h&&o<=f){e.splice(t,1);break}if(!(r!==u||n.width!==c.width||f<s||d>o)){d>s&&(c.height+=d-s,c.y=s),f<o&&(c.height=o-d),e.splice(t,1);break}if(!(s!==d||n.height!==c.height||h<r||u>a)){u>r&&(c.width+=u-r,c.x=r),h<a&&(c.width=a-u),e.splice(t,1);break}}return e},Vi.findHostInstance=Ui,Vi.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=f(e))?m(e):null)?null:va(e.stateNode)},Vi.findHostInstanceWithWarning=function(e){return Ui(e)},Vi.flushPassiveEffects=vi,Vi.flushSyncFromReconciler=function(e){var t=Ic;Ic|=1;var n=ha.T,r=Ua();try{if(Oa(2),ha.T=null,e)return e()}finally{Oa(r),ha.T=n,0===(6&(Ic=t))&&$(0,!1)}},Vi.flushSyncWork=Zr,Vi.focusWithin=function(e,t){if(!Qa)throw Error(i(363));for(t=Hr(e=zr(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++],r=n.tag;if(!ts(n)){if((5===r||26===r||27===r)&&rs(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},Vi.getFindAllNodesFailureDescription=function(e,t){if(!Qa)throw Error(i(363));var n=0,r=[];e=[zr(e),0];for(var a=0;a<e.length;){var s=e[a++],o=s.tag,l=e[a++],c=t[l];if((5!==o&&26!==o&&27!==o||!ts(s))&&(Br(s,c)&&(r.push(Vr(c)),++l>n&&(n=l)),l<t.length))for(s=s.child;null!==s;)e.push(s,l),s=s.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Vr(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},Vi.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 27:case 5:return va(e.child.stateNode);default:return e.child.stateNode}},Vi.injectIntoDevTools=function(){var e={bundleType:0,version:pa,rendererPackageName:ma,currentDispatcherRef:ha,findFiberByHostInstance:La,reconcilerVersion:"19.0.0"};if(null!==ga&&(e.rendererConfig=ga),"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{Uo=t.inject(e),Fo=t}catch(n){}e=!!t.checkDCE}}return e},Vi.isAlreadyRendering=function(){return!1},Vi.observeVisibleRects=function(e,t,n,r){if(!Qa)throw Error(i(363));e=jr(e,t);var a=is(e,n,r).disconnect;return{disconnect:function(){a()}}},Vi.shouldError=function(){return null},Vi.shouldSuspend=function(){return!1},Vi.startHostTransition=function(e,t,n,a){if(5!==e.tag)throw Error(i(476));var s=Lt(e).queue;kt(e,s,t,qa,null===n?r:function(){var t=Lt(e).next.queue;return Vt(e,t,{},Gr()),n(a)})},Vi.updateContainer=function(e,t,n,r){var i=t.current,a=Gr();return Fi(i,a,e,t,n,r),a},Vi.updateContainerSync=function(e,t,n,r){return 0===t.tag&&vi(),Fi(t.current,2,e,t,n,r),2},Vi},e.exports.default=e.exports,Object.defineProperty(e.exports,"__esModule",{value:!0})},513:(e,t,n)=>{e.exports=n(388)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var r=n(43);function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var s={d:{f:a,r:function(){throw Error(i(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(i(299));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:o,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=l.T,n=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=n,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin),i="string"===typeof t.integrity?t.integrity:void 0,a="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:i,fetchPriority:a}):"script"===n&&s.d.X(e,{crossOrigin:r,integrity:i,fetchPriority:a,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,r=c(n,t.crossOrigin);s.d.L(e,n,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return l.H.useFormState(e,t,n)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.2.3"},717:(e,t,n)=>{var r=n(43),i=n(461);var a="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},s=i.useSyncExternalStore,o=r.useRef,l=r.useEffect,c=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var h=o(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=c(function(){function e(e){if(!l){if(l=!0,s=e,e=r(e),void 0!==i&&d.hasValue){var t=d.value;if(i(t,e))return o=t}return o=e}if(t=o,a(s,e))return t;var n=r(e);return void 0!==i&&i(t,n)?(s=e,t):(s=e,o=n)}var s,o,l=!1,c=void 0===n?null:n;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,n,r,i]);var f=s(e,h[0],h[1]);return l(function(){d.hasValue=!0,d.value=f},[f]),u(f),f}},784:(e,t,n)=>{e.exports=n(179)},799:(e,t)=>{var n=Symbol.for("react.transitional.element");function r(e,t,r){var i=null;if(void 0!==r&&(i=""+r),void 0!==t.key&&(i=""+t.key),"key"in t)for(var a in r={},t)"key"!==a&&(r[a]=t[a]);else r=t;return t=r.ref,{$$typeof:n,type:e,key:i,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,_="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function S(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,S(e),!m)if(null!==r(c))m=!0,E||(E=!0,w());else{var t=r(u);null!==t&&N(x,t.startTime-e)}}var w,E=!1,T=-1,M=5,C=-1;function A(){return!!v||!(t.unstable_now()-C<M)}function I(){if(v=!1,E){var e=t.unstable_now();C=e;var n=!0;try{e:{m=!1,g&&(g=!1,_(T),T=-1),p=!0;var a=f;try{t:{for(S(e),d=r(c);null!==d&&!(d.expirationTime>e&&A());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof o){d.callback=o,S(e),n=!0;break t}d===r(c)&&i(c),S(e)}else i(c);d=r(c)}if(null!==d)n=!0;else{var l=r(u);null!==l&&N(x,l.startTime-e),n=!1}}break e}finally{d=null,f=a,p=!1}n=void 0}}finally{n?w():E=!1}}}if("function"===typeof b)w=function(){b(I)};else if("undefined"!==typeof MessageChannel){var R=new MessageChannel,P=R.port2;R.port1.onmessage=I,w=function(){P.postMessage(null)}}else w=function(){y(I,0)};function N(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(_(T),T=-1):g=!0,N(x,a-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,E||(E=!0,w()))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>s[e]=()=>r[e]);return s.default=()=>r,n.d(a,s),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{ACESFilmicToneMapping:()=>i_,AddEquation:()=>wy,AddOperation:()=>$y,AdditiveAnimationBlendMode:()=>Wb,AdditiveBlending:()=>_y,AgXToneMapping:()=>s_,AlphaFormat:()=>H_,AlwaysCompare:()=>NS,AlwaysDepth:()=>Gy,AlwaysStencilFunc:()=>ES,AmbientLight:()=>eR,AnimationAction:()=>WR,AnimationClip:()=>TI,AnimationLoader:()=>LI,AnimationMixer:()=>XR,AnimationObjectGroup:()=>GR,AnimationUtils:()=>dI,ArcCurve:()=>UC,ArrayCamera:()=>SR,ArrowHelper:()=>YP,AttachedBindMode:()=>l_,Audio:()=>IR,AudioAnalyser:()=>DR,AudioContext:()=>mR,AudioListener:()=>AR,AudioLoader:()=>gR,AxesHelper:()=>KP,BackSide:()=>my,BasicDepthPacking:()=>Kb,BasicShadowMap:()=>uy,BatchedMesh:()=>qM,Bone:()=>rM,BooleanKeyframeTrack:()=>yI,Box2:()=>uP,Box3:()=>Kx,Box3Helper:()=>jP,BoxGeometry:()=>iT,BoxHelper:()=>HP,BufferAttribute:()=>CE,BufferGeometry:()=>GE,BufferGeometryLoader:()=>oR,ByteType:()=>R_,Cache:()=>CI,Camera:()=>uT,CameraHelper:()=>zP,CanvasTexture:()=>bC,CapsuleGeometry:()=>EC,CatmullRomCurve3:()=>jC,CineonToneMapping:()=>r_,CircleGeometry:()=>TC,ClampToEdgeWrapping:()=>v_,Clock:()=>xR,Color:()=>pE,ColorKeyframeTrack:()=>_I,ColorManagement:()=>Px,CompressedArrayTexture:()=>yC,CompressedCubeTexture:()=>_C,CompressedTexture:()=>vC,CompressedTextureLoader:()=>DI,ConeGeometry:()=>CC,ConstantAlphaFactor:()=>Vy,ConstantColorFactor:()=>zy,Controls:()=>QP,CubeCamera:()=>gT,CubeDepthTexture:()=>xC,CubeReflectionMapping:()=>h_,CubeRefractionMapping:()=>d_,CubeTexture:()=>vT,CubeTextureLoader:()=>FI,CubeUVReflectionMapping:()=>m_,CubicBezierCurve:()=>XC,CubicBezierCurve3:()=>YC,CubicInterpolant:()=>pI,CullFaceBack:()=>oy,CullFaceFront:()=>ly,CullFaceFrontBack:()=>cy,CullFaceNone:()=>sy,Curve:()=>DC,CurvePath:()=>tA,CustomBlending:()=>xy,CustomToneMapping:()=>a_,CylinderGeometry:()=>MC,Cylindrical:()=>oP,Data3DTexture:()=>Xx,DataArrayTexture:()=>Wx,DataTexture:()=>iM,DataTextureLoader:()=>zI,DataUtils:()=>wE,DecrementStencilOp:()=>fS,DecrementWrapStencilOp:()=>mS,DefaultLoadingManager:()=>II,DepthFormat:()=>W_,DepthStencilFormat:()=>q_,DepthTexture:()=>SC,DetachedBindMode:()=>c_,DirectionalLight:()=>$I,DirectionalLightHelper:()=>OP,DiscreteInterpolant:()=>gI,DodecahedronGeometry:()=>IC,DoubleSide:()=>gy,DstAlphaFactor:()=>Ly,DstColorFactor:()=>Oy,DynamicCopyUsage:()=>BS,DynamicDrawUsage:()=>LS,DynamicReadUsage:()=>US,EdgesGeometry:()=>LC,EllipseCurve:()=>OC,EqualCompare:()=>CS,EqualDepth:()=>Xy,EqualStencilFunc:()=>_S,EquirectangularReflectionMapping:()=>f_,EquirectangularRefractionMapping:()=>p_,Euler:()=>Nw,EventDispatcher:()=>cx,ExternalTexture:()=>wC,ExtrudeGeometry:()=>LA,FileLoader:()=>kI,Float16BufferAttribute:()=>DE,Float32BufferAttribute:()=>OE,FloatType:()=>D_,Fog:()=>wT,FogExp2:()=>xT,FramebufferTexture:()=>gC,FrontSide:()=>py,Frustum:()=>EM,FrustumArray:()=>CM,GLBufferAttribute:()=>$R,GLSL1:()=>HS,GLSL3:()=>jS,GreaterCompare:()=>IS,GreaterDepth:()=>Ky,GreaterEqualCompare:()=>PS,GreaterEqualDepth:()=>Yy,GreaterEqualStencilFunc:()=>wS,GreaterStencilFunc:()=>SS,GridHelper:()=>PP,Group:()=>_T,HalfFloatType:()=>O_,HemisphereLight:()=>HI,HemisphereLightHelper:()=>RP,IcosahedronGeometry:()=>OA,ImageBitmapLoader:()=>fR,ImageLoader:()=>UI,ImageUtils:()=>Dx,IncrementStencilOp:()=>dS,IncrementWrapStencilOp:()=>pS,InstancedBufferAttribute:()=>lM,InstancedBufferGeometry:()=>sR,InstancedInterleavedBuffer:()=>ZR,InstancedMesh:()=>gM,Int16BufferAttribute:()=>PE,Int32BufferAttribute:()=>kE,Int8BufferAttribute:()=>AE,IntType:()=>k_,InterleavedBuffer:()=>TT,InterleavedBufferAttribute:()=>CT,Interpolant:()=>fI,InterpolateDiscrete:()=>Fb,InterpolateLinear:()=>zb,InterpolateSmooth:()=>Bb,InterpolationSamplingMode:()=>YS,InterpolationSamplingType:()=>XS,InvertStencilOp:()=>gS,KeepStencilOp:()=>uS,KeyframeTrack:()=>vI,LOD:()=>qT,LatheGeometry:()=>UA,Layers:()=>kw,LessCompare:()=>MS,LessDepth:()=>Wy,LessEqualCompare:()=>AS,LessEqualDepth:()=>qy,LessEqualStencilFunc:()=>bS,LessStencilFunc:()=>yS,Light:()=>VI,LightProbe:()=>rR,Line:()=>tC,Line3:()=>yP,LineBasicMaterial:()=>XM,LineCurve:()=>KC,LineCurve3:()=>JC,LineDashedMaterial:()=>oI,LineLoop:()=>sC,LineSegments:()=>aC,LinearFilter:()=>E_,LinearInterpolant:()=>mI,LinearMipMapLinearFilter:()=>A_,LinearMipMapNearestFilter:()=>M_,LinearMipmapLinearFilter:()=>C_,LinearMipmapNearestFilter:()=>T_,LinearSRGBColorSpace:()=>rS,LinearToneMapping:()=>t_,LinearTransfer:()=>iS,Loader:()=>RI,LoaderUtils:()=>aR,LoadingManager:()=>AI,LoopOnce:()=>Db,LoopPingPong:()=>Ub,LoopRepeat:()=>Ob,MOUSE:()=>iy,Material:()=>vE,MaterialLoader:()=>iR,MathUtils:()=>bx,Matrix2:()=>lP,Matrix3:()=>Mx,Matrix4:()=>xw,MaxEquation:()=>Cy,Mesh:()=>nT,MeshBasicMaterial:()=>yE,MeshDepthMaterial:()=>iI,MeshDistanceMaterial:()=>aI,MeshLambertMaterial:()=>rI,MeshMatcapMaterial:()=>sI,MeshNormalMaterial:()=>nI,MeshPhongMaterial:()=>eI,MeshPhysicalMaterial:()=>$A,MeshStandardMaterial:()=>ZA,MeshToonMaterial:()=>tI,MinEquation:()=>My,MirroredRepeatWrapping:()=>y_,MixOperation:()=>Zy,MultiplyBlending:()=>Sy,MultiplyOperation:()=>Qy,NearestFilter:()=>__,NearestMipMapLinearFilter:()=>w_,NearestMipMapNearestFilter:()=>S_,NearestMipmapLinearFilter:()=>x_,NearestMipmapNearestFilter:()=>b_,NeutralToneMapping:()=>o_,NeverCompare:()=>TS,NeverDepth:()=>jy,NeverStencilFunc:()=>vS,NoBlending:()=>vy,NoColorSpace:()=>tS,NoNormalPacking:()=>sS,NoToneMapping:()=>e_,NormalAnimationBlendMode:()=>Gb,NormalBlending:()=>yy,NormalGAPacking:()=>lS,NormalRGPacking:()=>oS,NotEqualCompare:()=>RS,NotEqualDepth:()=>Jy,NotEqualStencilFunc:()=>xS,NumberKeyframeTrack:()=>bI,Object3D:()=>Kw,ObjectLoader:()=>lR,ObjectSpaceNormalMap:()=>eS,OctahedronGeometry:()=>FA,OneFactor:()=>Iy,OneMinusConstantAlphaFactor:()=>Hy,OneMinusConstantColorFactor:()=>By,OneMinusDstAlphaFactor:()=>Dy,OneMinusDstColorFactor:()=>Uy,OneMinusSrcAlphaFactor:()=>ky,OneMinusSrcColorFactor:()=>Py,OrthographicCamera:()=>QI,PCFShadowMap:()=>hy,PCFSoftShadowMap:()=>dy,PMREMGenerator:()=>wN,Path:()=>nA,PerspectiveCamera:()=>pT,Plane:()=>bM,PlaneGeometry:()=>zA,PlaneHelper:()=>GP,PointLight:()=>JI,PointLightHelper:()=>MP,Points:()=>dC,PointsMaterial:()=>oC,PolarGridHelper:()=>NP,PolyhedronGeometry:()=>AC,PositionalAudio:()=>LR,PropertyBinding:()=>jR,PropertyMixer:()=>OR,QuadraticBezierCurve:()=>QC,QuadraticBezierCurve3:()=>ZC,Quaternion:()=>xx,QuaternionKeyframeTrack:()=>xI,QuaternionLinearInterpolant:()=>SI,R11_EAC_Format:()=>ub,RED_GREEN_RGTC2_Format:()=>kb,RED_RGTC1_Format:()=>Pb,REVISION:()=>ry,RG11_EAC_Format:()=>db,RGBADepthPacking:()=>Jb,RGBAFormat:()=>G_,RGBAIntegerFormat:()=>Z_,RGBA_ASTC_10x10_Format:()=>Tb,RGBA_ASTC_10x5_Format:()=>xb,RGBA_ASTC_10x6_Format:()=>wb,RGBA_ASTC_10x8_Format:()=>Eb,RGBA_ASTC_12x10_Format:()=>Mb,RGBA_ASTC_12x12_Format:()=>Cb,RGBA_ASTC_4x4_Format:()=>pb,RGBA_ASTC_5x4_Format:()=>mb,RGBA_ASTC_5x5_Format:()=>gb,RGBA_ASTC_6x5_Format:()=>vb,RGBA_ASTC_6x6_Format:()=>yb,RGBA_ASTC_8x5_Format:()=>_b,RGBA_ASTC_8x6_Format:()=>bb,RGBA_ASTC_8x8_Format:()=>Sb,RGBA_BPTC_Format:()=>Ab,RGBA_ETC2_EAC_Format:()=>cb,RGBA_PVRTC_2BPPV1_Format:()=>sb,RGBA_PVRTC_4BPPV1_Format:()=>ab,RGBA_S3TC_DXT1_Format:()=>eb,RGBA_S3TC_DXT3_Format:()=>tb,RGBA_S3TC_DXT5_Format:()=>nb,RGBDepthPacking:()=>Qb,RGBFormat:()=>j_,RGBIntegerFormat:()=>Q_,RGB_BPTC_SIGNED_Format:()=>Ib,RGB_BPTC_UNSIGNED_Format:()=>Rb,RGB_ETC1_Format:()=>ob,RGB_ETC2_Format:()=>lb,RGB_PVRTC_2BPPV1_Format:()=>ib,RGB_PVRTC_4BPPV1_Format:()=>rb,RGB_S3TC_DXT1_Format:()=>$_,RGDepthPacking:()=>Zb,RGFormat:()=>K_,RGIntegerFormat:()=>J_,RawShaderMaterial:()=>QA,Ray:()=>Sw,Raycaster:()=>tP,RectAreaLight:()=>tR,RedFormat:()=>X_,RedIntegerFormat:()=>Y_,ReinhardToneMapping:()=>n_,RenderTarget:()=>jx,RenderTarget3D:()=>YR,RepeatWrapping:()=>g_,ReplaceStencilOp:()=>hS,ReverseSubtractEquation:()=>Ty,RingGeometry:()=>BA,SIGNED_R11_EAC_Format:()=>hb,SIGNED_RED_GREEN_RGTC2_Format:()=>Lb,SIGNED_RED_RGTC1_Format:()=>Nb,SIGNED_RG11_EAC_Format:()=>fb,SRGBColorSpace:()=>nS,SRGBTransfer:()=>aS,Scene:()=>ET,ShaderChunk:()=>nN,ShaderLib:()=>iN,ShaderMaterial:()=>cT,ShadowMaterial:()=>JA,Shape:()=>rA,ShapeGeometry:()=>VA,ShapePath:()=>JP,ShapeUtils:()=>PA,ShortType:()=>P_,Skeleton:()=>oM,SkeletonHelper:()=>EP,SkinnedMesh:()=>nM,Source:()=>Ux,Sphere:()=>fw,SphereGeometry:()=>HA,Spherical:()=>sP,SphericalHarmonics3:()=>nR,SplineCurve:()=>$C,SpotLight:()=>YI,SpotLightHelper:()=>bP,Sprite:()=>HT,SpriteMaterial:()=>AT,SrcAlphaFactor:()=>Ny,SrcAlphaSaturateFactor:()=>Fy,SrcColorFactor:()=>Ry,StaticCopyUsage:()=>zS,StaticDrawUsage:()=>kS,StaticReadUsage:()=>OS,StereoCamera:()=>bR,StreamCopyUsage:()=>VS,StreamDrawUsage:()=>DS,StreamReadUsage:()=>FS,StringKeyframeTrack:()=>wI,SubtractEquation:()=>Ey,SubtractiveBlending:()=>by,TOUCH:()=>ay,TangentSpaceNormalMap:()=>$b,TetrahedronGeometry:()=>jA,Texture:()=>Vx,TextureLoader:()=>BI,TextureUtils:()=>$P,Timer:()=>iP,TimestampQuery:()=>qS,TorusGeometry:()=>GA,TorusKnotGeometry:()=>WA,Triangle:()=>cE,TriangleFanDrawMode:()=>Yb,TriangleStripDrawMode:()=>Xb,TrianglesDrawMode:()=>qb,TubeGeometry:()=>qA,UVMapping:()=>u_,Uint16BufferAttribute:()=>NE,Uint32BufferAttribute:()=>LE,Uint8BufferAttribute:()=>IE,Uint8ClampedBufferAttribute:()=>RE,Uniform:()=>KR,UniformsGroup:()=>QR,UniformsLib:()=>rN,UniformsUtils:()=>lT,UnsignedByteType:()=>I_,UnsignedInt101111Type:()=>V_,UnsignedInt248Type:()=>z_,UnsignedInt5999Type:()=>B_,UnsignedIntType:()=>L_,UnsignedShort4444Type:()=>U_,UnsignedShort5551Type:()=>F_,UnsignedShortType:()=>N_,VSMShadowMap:()=>fy,Vector2:()=>Sx,Vector3:()=>wx,Vector4:()=>Hx,VectorKeyframeTrack:()=>EI,VideoFrameTexture:()=>mC,VideoTexture:()=>pC,WebGL3DRenderTarget:()=>Yx,WebGLArrayRenderTarget:()=>qx,WebGLCoordinateSystem:()=>GS,WebGLCubeRenderTarget:()=>yT,WebGLRenderTarget:()=>Gx,WebGLRenderer:()=>qL,WebGLUtils:()=>UL,WebGPUCoordinateSystem:()=>WS,WebXRController:()=>ST,WireframeGeometry:()=>XA,WrapAroundEnding:()=>jb,ZeroCurvatureEnding:()=>Vb,ZeroFactor:()=>Ay,ZeroSlopeEnding:()=>Hb,ZeroStencilOp:()=>cS,createCanvasElement:()=>ex,error:()=>ox,getConsoleFunction:()=>ix,log:()=>ax,setConsoleFunction:()=>rx,warn:()=>sx,warnOnce:()=>lx});var i=n(43),a=n.t(i,2),s=n(391);function o(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}function u(e,t,n){return(t=c(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const f=["sri"],p=["page"],m=["page","matches"],g=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],v=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],y=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var _="popstate";function b(){return C(function(e,t){let{pathname:n,search:r,hash:i}=e.location;return E("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:T(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function S(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function x(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function w(e,t){return{usr:e.state,key:e.key,idx:t}}function E(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return d(d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?M(t):t),{},{state:n,key:t&&t.key||r||Math.random().toString(36).substring(2,10)})}function T(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function M(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function C(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:i=document.defaultView,v5Compat:a=!1}=r,s=i.history,o="POP",l=null,c=u();function u(){return(s.state||{idx:null}).idx}function h(){o="POP";let e=u(),t=null==e?null:e-c;c=e,l&&l({action:o,location:p.location,delta:t})}function f(e){return A(e)}null==c&&(c=0,s.replaceState(d(d({},s.state),{},{idx:c}),""));let p={get action(){return o},get location(){return e(i,s)},listen(e){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(_,h),l=e,()=>{i.removeEventListener(_,h),l=null}},createHref:e=>t(i,e),createURL:f,encodeLocation(e){let t=f(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o="PUSH";let r=E(p.location,e,t);n&&n(r,e),c=u()+1;let h=w(r,c),d=p.createHref(r);try{s.pushState(h,"",d)}catch(ox){if(ox instanceof DOMException&&"DataCloneError"===ox.name)throw ox;i.location.assign(d)}a&&l&&l({action:o,location:p.location,delta:1})},replace:function(e,t){o="REPLACE";let r=E(p.location,e,t);n&&n(r,e),c=u();let i=w(r,c),h=p.createHref(r);s.replaceState(i,"",h),a&&l&&l({action:o,location:p.location,delta:0})},go:e=>s.go(e)};return p}function A(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),S(n,"No window.location.(origin|href) available to create URL");let r="string"===typeof e?e:T(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}new WeakMap;function I(e,t){return R(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function R(e,t,n,r){let i=W(("string"===typeof t?M(t):t).pathname||"/",n);if(null==i)return null;let a=P(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(a);let s=null;for(let o=0;null==s&&o<a.length;++o){let e=G(i);s=V(a[o],e,r)}return s}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=function(e,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,o=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===o?e.path||"":o,caseSensitive:!0===e.caseSensitive,childrenIndex:a,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(r)&&s)return;S(l.relativePath.startsWith(r),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(r,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(r.length)}let c=$([r,l.relativePath]),u=n.concat(l);e.children&&e.children.length>0&&(S(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),P(e.children,t,u,c,s)),(null!=e.path||e.index)&&t.push({path:c,score:B(c,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let r of N(e.path))a(e,t,!0,r);else a(e,t)}),t}function N(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return i?[a,""]:[a];let s=N(r.join("/")),o=[];return o.push(...s.map(e=>""===e?a:[a,e].join("/"))),i&&o.push(...s),o.map(t=>e.startsWith("/")&&""===t?"/":t)}var k=/^:[\w-]+$/,L=3,D=2,O=1,U=10,F=-2,z=e=>"*"===e;function B(e,t){let n=e.split("/"),r=n.length;return n.some(z)&&(r+=F),t&&(r+=D),n.filter(e=>!z(e)).reduce((e,t)=>e+(k.test(t)?L:""===t?O:U),r)}function V(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:r}=e,i={},a="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===a?t:t.slice(a.length)||"/",u=H({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=H({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),s.push({params:i,pathname:$([a,u.pathname]),pathnameBase:ee($([a,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(a=$([a,u.pathnameBase]))}return s}function H(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=j(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";s=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:a,pathnameBase:s,pattern:e}}function j(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];x("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function G(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(ox){return x(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(ox,").")),e}}function W(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}var q=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X=e=>q.test(e);function Y(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}function K(e,t,n,r){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(r),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function J(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function Q(e){let t=J(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Z(e,t,n){let r,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?r=M(e):(r=d({},e),S(!r.pathname||!r.pathname.includes("?"),K("?","pathname","search",r)),S(!r.pathname||!r.pathname.includes("#"),K("#","pathname","hash",r)),S(!r.search||!r.search.includes("#"),K("#","search","hash",r)));let a,s=""===e||""===r.pathname,o=s?"/":r.pathname;if(null==o)a=n;else{let e=t.length-1;if(!i&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;r.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:i="",hash:a=""}="string"===typeof e?M(e):e;if(r)if(X(r))t=r;else{if(r.includes("//")){let e=r;r=r.replace(/\/\/+/g,"/"),x(!1,"Pathnames cannot have embedded double slashes - normalizing ".concat(e," -> ").concat(r))}t=r.startsWith("/")?Y(r.substring(1),"/"):Y(r,n)}else t=n;return{pathname:t,search:te(i),hash:ne(a)}}(r,a),c=o&&"/"!==o&&o.endsWith("/"),u=(s||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!c&&!u||(l.pathname+="/"),l}var $=e=>e.join("/").replace(/\/\/+/g,"/"),ee=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),te=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",ne=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function re(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}function ie(e){return e.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Symbol("Uninstrumented");Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var ae=["POST","PUT","PATCH","DELETE"],se=(new Set(ae),["GET",...ae]);new Set(se),Symbol("ResetLoaderData");var oe=i.createContext(null);oe.displayName="DataRouter";var le=i.createContext(null);le.displayName="DataRouterState";var ce=i.createContext(!1);var ue=i.createContext({isTransitioning:!1});ue.displayName="ViewTransition";var he=i.createContext(new Map);he.displayName="Fetchers";var de=i.createContext(null);de.displayName="Await";var fe=i.createContext(null);fe.displayName="Navigation";var pe=i.createContext(null);pe.displayName="Location";var me=i.createContext({outlet:null,matches:[],isDataRoute:!1});me.displayName="Route";var ge=i.createContext(null);ge.displayName="RouteError";function ve(){return null!=i.useContext(pe)}function ye(){return S(ve(),"useLocation() may be used only in the context of a <Router> component."),i.useContext(pe).location}var _e="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function be(e){i.useContext(fe).static||i.useLayoutEffect(e)}function Se(){let{isDataRoute:e}=i.useContext(me);return e?function(){let{router:e}=Pe("useNavigate"),t=ke("useNavigate"),n=i.useRef(!1);be(()=>{n.current=!0});let r=i.useCallback(async function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};x(n.current,_e),n.current&&("number"===typeof r?await e.navigate(r):await e.navigate(r,d({fromRouteId:t},i)))},[e,t]);return r}():function(){S(ve(),"useNavigate() may be used only in the context of a <Router> component.");let e=i.useContext(oe),{basename:t,navigator:n}=i.useContext(fe),{matches:r}=i.useContext(me),{pathname:a}=ye(),s=JSON.stringify(Q(r)),o=i.useRef(!1);be(()=>{o.current=!0});let l=i.useCallback(function(r){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(x(o.current,_e),!o.current)return;if("number"===typeof r)return void n.go(r);let l=Z(r,JSON.parse(s),a,"path"===i.relative);null==e&&"/"!==t&&(l.pathname="/"===l.pathname?t:$([t,l.pathname])),(i.replace?n.replace:n.push)(l,i.state,i)},[t,n,s,a,e]);return l}()}i.createContext(null);function xe(){let{matches:e}=i.useContext(me),t=e[e.length-1];return t?t.params:{}}function we(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=i.useContext(me),{pathname:r}=ye(),a=JSON.stringify(Q(n));return i.useMemo(()=>Z(e,JSON.parse(a),r,"path"===t),[e,a,r,t])}function Ee(e,t,n,r,a){S(ve(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=i.useContext(fe),{matches:o}=i.useContext(me),l=o[o.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",f=l&&l.route;{let e=f&&f.path||"";Oe(u,!f||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let p,m=ye();if(t){var g;let e="string"===typeof t?M(t):t;S("/"===h||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),p=e}else p=m;let v=p.pathname||"/",y=v;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let _=I(e,{pathname:y});x(f||null!=_,'No routes matched location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" ')),x(null==_||void 0!==_[_.length-1].route.element||void 0!==_[_.length-1].route.Component||void 0!==_[_.length-1].route.lazy,'Matched leaf route at location "'.concat(p.pathname).concat(p.search).concat(p.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let b=Ie(_&&_.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:$([h,s.encodeLocation?s.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:$([h,s.encodeLocation?s.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),o,n,r,a);return t&&b?i.createElement(pe.Provider,{value:{location:d({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:"POP"}},b):b}function Te(){let e=Le(),t=re(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=i.createElement(i.Fragment,null,i.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),i.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",i.createElement("code",{style:s},"ErrorBoundary")," or"," ",i.createElement("code",{style:s},"errorElement")," prop on your route.")),i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:a},n):null,o)}var Me=i.createElement(Te,null),Ce=class extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?i.createElement(me.Provider,{value:this.props.routeContext},i.createElement(ge.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ae(e){let{routeContext:t,match:n,children:r}=e,a=i.useContext(oe);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(me.Provider,{value:t},r)}function Ie(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let a=e,s=null===n||void 0===n?void 0:n.errors;if(null!=s){let e=a.findIndex(e=>e.route.id&&void 0!==(null===s||void 0===s?void 0:s[e.route.id]));S(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(s).join(","))),a=a.slice(0,Math.min(a.length,e+1))}let o=!1,l=-1;if(n)for(let i=0;i<a.length;i++){let e=a[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(l=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){o=!0,a=l>=0?a.slice(0,l+1):[a[0]];break}}}let c=n&&r?(e,t)=>{var i,a;r(e,{location:n.location,params:null!==(i=null===(a=n.matches)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.params)&&void 0!==i?i:{},unstable_pattern:ie(n.matches),errorInfo:t})}:void 0;return a.reduceRight((e,r,u)=>{let h,d=!1,f=null,p=null;n&&(h=s&&r.route.id?s[r.route.id]:void 0,f=r.route.errorElement||Me,o&&(l<0&&0===u?(Oe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):l===u&&(d=!0,p=r.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),g=()=>{let t;return t=h?f:d?p:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(Ae,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===u)?i.createElement(Ce,{location:n.location,revalidation:n.revalidation,component:f,error:h,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},onError:c}):g()},null)}function Re(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Pe(e){let t=i.useContext(oe);return S(t,Re(e)),t}function Ne(e){let t=i.useContext(le);return S(t,Re(e)),t}function ke(e){let t=function(e){let t=i.useContext(me);return S(t,Re(e)),t}(e),n=t.matches[t.matches.length-1];return S(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Le(){var e;let t=i.useContext(ge),n=Ne("useRouteError"),r=ke("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[r]}var De={};function Oe(e,t,n){t||De[e]||(De[e]=!0,x(!1,n))}var Ue={};function Fe(e,t){e||Ue[t]||(Ue[t]=!0,console.warn(t))}a.useOptimistic;i.memo(function(e){let{routes:t,future:n,state:r,unstable_onError:i}=e;return Ee(t,void 0,r,i,n)});function ze(e){let{to:t,replace:n,state:r,relative:a}=e;S(ve(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=i.useContext(fe);x(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=i.useContext(me),{pathname:l}=ye(),c=Se(),u=Z(t,Q(o),l,"path"===a),h=JSON.stringify(u);return i.useEffect(()=>{c(JSON.parse(h),{replace:n,state:r,relative:a})},[c,h,a,n,r]),null}function Be(e){S(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ve(e){let{basename:t="/",children:n=null,location:r,navigationType:a="POP",navigator:s,static:o=!1,unstable_useTransitions:l}=e;S(!ve(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=i.useMemo(()=>({basename:c,navigator:s,static:o,unstable_useTransitions:l,future:{}}),[c,s,o,l]);"string"===typeof r&&(r=M(r));let{pathname:h="/",search:d="",hash:f="",state:p=null,key:m="default"}=r,g=i.useMemo(()=>{let e=W(h,c);return null==e?null:{location:{pathname:e,search:d,hash:f,state:p,key:m},navigationType:a}},[c,h,d,f,p,m,a]);return x(null!=g,'<Router basename="'.concat(c,'"> is not able to match the URL "').concat(h).concat(d).concat(f,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==g?null:i.createElement(fe.Provider,{value:u},i.createElement(pe.Provider,{children:n,value:g}))}function He(e){let{children:t,location:n}=e;return Ee(je(t),n)}i.Component;function je(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return i.Children.forEach(e,(e,r)=>{if(!i.isValidElement(e))return;let a=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,je(e.props.children,a));S(e.type===Be,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),S(!e.props.index||!e.props.children,"An index route cannot have child routes.");let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=je(e.props.children,a)),n.push(s)}),n}var Ge="get",We="application/x-www-form-urlencoded";function qe(e){return"undefined"!==typeof HTMLElement&&e instanceof HTMLElement}var Xe=null;var Ye=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ke(e){return null==e||Ye.has(e)?e:(x(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(We,'"')),null)}function Je(e,t){let n,r,i,a,s;if(qe(o=e)&&"form"===o.tagName.toLowerCase()){let s=e.getAttribute("action");r=s?W(s,t):null,n=e.getAttribute("method")||Ge,i=Ke(e.getAttribute("enctype"))||We,a=new FormData(e)}else if(function(e){return qe(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return qe(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let s=e.form;if(null==s)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let o=e.getAttribute("formaction")||s.getAttribute("action");if(r=o?W(o,t):null,n=e.getAttribute("formmethod")||s.getAttribute("method")||Ge,i=Ke(e.getAttribute("formenctype"))||Ke(s.getAttribute("enctype"))||We,a=new FormData(s,e),!function(){if(null===Xe)try{new FormData(document.createElement("form"),0),Xe=!1}catch(e){Xe=!0}return Xe}()){let{name:t,type:n,value:r}=e;if("image"===n){let e=t?"".concat(t,"."):"";a.append("".concat(e,"x"),"0"),a.append("".concat(e,"y"),"0")}else t&&a.append(t,r)}}else{if(qe(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ge,r=null,i=We,s=e}var o;return a&&"text/plain"===i&&(s=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function Qe(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ze(e,t,n){let r="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===r.pathname?r.pathname="_root.".concat(n):t&&"/"===W(r.pathname,t)?r.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):r.pathname="".concat(r.pathname.replace(/\/$/,""),".").concat(n),r}async function $e(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(ox){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(ox),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function et(e){return null!=e&&"string"===typeof e.page}function tt(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function nt(e,t,n,r,i,a){let s=(e,t)=>!n[t]||e.route.id!==n[t].route.id,o=(e,t)=>{var r;return n[t].pathname!==e.pathname||(null===(r=n[t].route.path)||void 0===r?void 0:r.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===a?t.filter((e,t)=>s(e,t)||o(e,t)):"data"===a?t.filter((t,a)=>{let l=r.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(s(t,a)||o(t,a))return!0;if(t.route.shouldRevalidate){var c;let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:(null===(c=n[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof r)return r}return!0}):[]}function rt(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1),[...new Set(r)];var r}function it(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!et(i)&&"script"===i.as&&i.href&&r.has(i.href))return e;let a=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}(i));return n.has(a)||(n.add(a),e.push({key:a,link:i})),e},[])}function at(e,t){return"lazy"===e.mode&&!0===t}function st(){let e=i.useContext(oe);return Qe(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function ot(){let e=i.useContext(le);return Qe(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var lt=i.createContext(void 0);function ct(){let e=i.useContext(lt);return Qe(e,"You must render this element inside a <HydratedRouter> element"),e}function ut(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ht(e,t,n){if(n&&!mt)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}lt.displayName="FrameworkContext";function dt(e){let{page:t}=e,n=o(e,p),{router:r}=st(),a=i.useMemo(()=>I(r.routes,t,r.basename),[r.routes,t,r.basename]);return a?i.createElement(pt,d({page:t,matches:a},n)):null}function ft(e){let{manifest:t,routeModules:n}=ct(),[r,a]=i.useState([]);return i.useEffect(()=>{let r=!1;return async function(e,t,n){return it((await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await $e(r,n);return e.links?e.links():[]}return[]}))).flat(1).filter(tt).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?d(d({},e),{},{rel:"prefetch",as:"style"}):d(d({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{r||a(e)}),()=>{r=!0}},[e,t,n]),r}function pt(e){let{page:t,matches:n}=e,r=o(e,m),a=ye(),{manifest:s,routeModules:l}=ct(),{basename:c}=st(),{loaderData:u,matches:h}=ot(),f=i.useMemo(()=>nt(t,n,h,s,a,"data"),[t,n,h,s,a]),p=i.useMemo(()=>nt(t,n,h,s,a,"assets"),[t,n,h,s,a]),g=i.useMemo(()=>{if(t===a.pathname+a.search+a.hash)return[];let e=new Set,r=!1;if(n.forEach(t=>{var n;let i=s.routes[t.route.id];i&&i.hasLoader&&(!f.some(e=>e.route.id===t.route.id)&&t.route.id in u&&null!==(n=l[t.route.id])&&void 0!==n&&n.shouldRevalidate||i.hasClientLoader?r=!0:e.add(t.route.id))}),0===e.size)return[];let i=Ze(t,c,"data");return r&&e.size>0&&i.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[i.pathname+i.search]},[c,u,a,s,f,n,t,l]),v=i.useMemo(()=>rt(p,s),[p,s]),y=ft(p);return i.createElement(i.Fragment,null,g.map(e=>i.createElement("link",d({key:e,rel:"prefetch",as:"fetch",href:e},r))),v.map(e=>i.createElement("link",d({key:e,rel:"modulepreload",href:e},r))),y.map(e=>{let{key:t,link:n}=e;return i.createElement("link",d({key:t,nonce:r.nonce},n))}))}var mt=!1;function gt(e){let{manifest:t,serverHandoffString:n,isSpaMode:r,renderMeta:a,routeDiscovery:s,ssr:l}=ct(),{router:c,static:u,staticContext:h}=st(),{matches:p}=ot(),m=i.useContext(ce),g=at(s,l);a&&(a.didRenderScripts=!0);let v=ht(p,null,r);i.useEffect(()=>{mt=!0},[]);let y=i.useMemo(()=>{var r;if(m)return null;let a=h?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",s=u?"".concat(null!==(r=t.hmr)&&void 0!==r&&r.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let r="route".concat(n),i=t.routes[e.route.id];Qe(i,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:a,clientLoaderModule:s,clientMiddlewareModule:o,hydrateFallbackModule:l,module:c}=i,u=[...a?[{module:a,varName:"".concat(r,"_clientAction")}]:[],...s?[{module:s,varName:"".concat(r,"_clientLoader")}]:[],...o?[{module:o,varName:"".concat(r,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(r,"_HydrateFallback")}]:[],{module:c,varName:"".concat(r,"_main")}];return 1===u.length?"import * as ".concat(r," from ").concat(JSON.stringify(c),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(r," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,r=o(e,f),i=new Set(t.state.matches.map(e=>e.route.id)),a=t.state.location.pathname.split("/").filter(Boolean),s=["/"];for(a.pop();a.length>0;)s.push("/".concat(a.join("/"))),a.pop();s.forEach(e=>{let n=I(t.routes,e,t.basename);n&&n.forEach(e=>i.add(e.route.id))});let l=[...i].reduce((e,t)=>Object.assign(e,{[t]:r.routes[t]}),{});return d(d({},r),{},{routes:l,sri:!!n||void 0})}(t,c),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return i.createElement(i.Fragment,null,i.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:void 0})),i.createElement("script",d(d({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:s},type:"module",async:!0})))},[]),_=mt||m?[]:(b=t.entry.imports.concat(rt(v,t,{includeHydrateFallback:!0})),[...new Set(b)]);var b;let S="object"===typeof t.sri?t.sri:{};return Fe(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),mt||m?null:i.createElement(i.Fragment,null,"object"===typeof t.sri?i.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:S})}}):null,g?null:i.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:S[t.url],suppressHydrationWarning:!0}),i.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:S[t.entry.module],suppressHydrationWarning:!0}),_.map(t=>i.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:S[t],suppressHydrationWarning:!0})),y)}function vt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}i.Component;function yt(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let r,a=i.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(re(t))return i.createElement(_t,{title:"Unhandled Thrown Response!"},i.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),a);if(t instanceof Error)r=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);r=new Error(e)}return i.createElement(_t,{title:"Application Error!",isOutsideRemixApp:n},i.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),i.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},r.stack),a)}function _t(e){var t;let{title:n,renderScripts:r,isOutsideRemixApp:a,children:s}=e,{routeModules:o}=ct();return null!==(t=o.root)&&void 0!==t&&t.Layout&&!a?s:i.createElement("html",{lang:"en"},i.createElement("head",null,i.createElement("meta",{charSet:"utf-8"}),i.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),i.createElement("title",null,n)),i.createElement("body",null,i.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},s,r?i.createElement(gt,null):null)))}var bt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{bt&&(window.__reactRouterVersion="7.10.1")}catch(cU){}function St(e){let{basename:t,children:n,unstable_useTransitions:r,window:a}=e,s=i.useRef();null==s.current&&(s.current=b({window:a,v5Compat:!0}));let o=s.current,[l,c]=i.useState({action:o.action,location:o.location}),u=i.useCallback(e=>{!1===r?c(e):i.startTransition(()=>c(e))},[r]);return i.useLayoutEffect(()=>o.listen(u),[o,u]),i.createElement(Ve,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,unstable_useTransitions:!0===r})}var xt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wt=i.forwardRef(function(e,t){let n,{onClick:r,discover:a="render",prefetch:s="none",relative:l,reloadDocument:c,replace:u,state:h,target:f,to:p,preventScrollReset:m,viewTransition:v}=e,y=o(e,g),{basename:_,unstable_useTransitions:b}=i.useContext(fe),w="string"===typeof p&&xt.test(p),E=!1;if("string"===typeof p&&w&&(n=p,bt))try{let e=new URL(window.location.href),t=p.startsWith("//")?new URL(e.protocol+p):new URL(p),n=W(t.pathname,_);t.origin===e.origin&&null!=n?p=n+t.search+t.hash:E=!0}catch(cU){x(!1,'<Link to="'.concat(p,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let M=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(ve(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=i.useContext(fe),{hash:a,pathname:s,search:o}=we(e,{relative:t}),l=s;return"/"!==n&&(l="/"===s?n:$([n,s])),r.createHref({pathname:l,search:o,hash:a})}(p,{relative:l}),[C,A,I]=function(e,t){let n=i.useContext(lt),[r,a]=i.useState(!1),[s,o]=i.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:d}=t,f=i.useRef(null);i.useEffect(()=>{if("render"===e&&o(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),i.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let p=()=>{a(!0)},m=()=>{a(!1),o(!1)};return n?"intent"!==e?[s,f,{}]:[s,f,{onFocus:ut(l,p),onBlur:ut(c,m),onMouseEnter:ut(u,p),onMouseLeave:ut(h,m),onTouchStart:ut(d,p)}]:[!1,f,{}]}(s,y),R=function(e){let{target:t,replace:n,state:r,preventScrollReset:a,relative:s,viewTransition:o,unstable_useTransitions:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=Se(),u=ye(),h=we(e,{relative:s});return i.useCallback(d=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(d,t)){d.preventDefault();let t=void 0!==n?n:T(u)===T(h),f=()=>c(e,{replace:t,state:r,preventScrollReset:a,relative:s,viewTransition:o});l?i.startTransition(()=>f()):f()}},[u,c,h,n,r,t,e,a,s,o,l])}(p,{replace:u,state:h,target:f,preventScrollReset:m,relative:l,viewTransition:v,unstable_useTransitions:b});let P=i.createElement("a",d(d(d({},y),I),{},{href:n||M,onClick:E||c?r:function(e){r&&r(e),e.defaultPrevented||R(e)},ref:vt(t,A),target:f,"data-discover":w||"render"!==a?void 0:"true"}));return C&&!w?i.createElement(i.Fragment,null,P,i.createElement(dt,{page:M})):P});wt.displayName="Link";var Et=i.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:s=!1,style:l,to:c,viewTransition:u,children:h}=e,f=o(e,v),p=we(c,{relative:f.relative}),m=ye(),g=i.useContext(le),{navigator:y,basename:_}=i.useContext(fe),b=null!=g&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.useContext(ue);S(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ct("useViewTransitionState"),a=we(e,{relative:t});if(!n.isTransitioning)return!1;let s=W(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=W(n.nextLocation.pathname,r)||n.nextLocation.pathname;return null!=H(a.pathname,o)||null!=H(a.pathname,s)}(p)&&!0===u,x=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,w=m.pathname,E=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(w=w.toLowerCase(),E=E?E.toLowerCase():null,x=x.toLowerCase()),E&&_&&(E=W(E,_)||E);const T="/"!==x&&x.endsWith("/")?x.length-1:x.length;let M,C=w===x||!s&&w.startsWith(x)&&"/"===w.charAt(T),A=null!=E&&(E===x||!s&&E.startsWith(x)&&"/"===E.charAt(x.length)),I={isActive:C,isPending:A,isTransitioning:b},R=C?n:void 0;M="function"===typeof a?a(I):[a,C?"active":null,A?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let P="function"===typeof l?l(I):l;return i.createElement(wt,d(d({},f),{},{"aria-current":R,className:M,ref:t,style:P,to:c,viewTransition:u}),"function"===typeof h?h(I):h)});Et.displayName="NavLink";var Tt=i.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:r,navigate:a,reloadDocument:s,replace:l,state:c,method:u=Ge,action:h,onSubmit:f,relative:p,preventScrollReset:m,viewTransition:g}=e,v=o(e,y),{unstable_useTransitions:_}=i.useContext(fe),b=Rt(),x=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=i.useContext(fe),r=i.useContext(me);S(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s=d({},we(e||".",{relative:t})),o=ye();if(null==e){s.search=o.search;let e=new URLSearchParams(s.search),t=e.getAll("index"),n=t.some(e=>""===e);if(n){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();s.search=n?"?".concat(n):""}}e&&"."!==e||!a.route.index||(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(s.pathname="/"===s.pathname?n:$([n,s.pathname]));return T(s)}(h,{relative:p}),w="get"===u.toLowerCase()?"get":"post",E="string"===typeof h&&xt.test(h);return i.createElement("form",d(d({ref:t,method:w,action:x,onSubmit:s?f:e=>{if(f&&f(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u,s=()=>b(t||e.currentTarget,{fetcherKey:r,method:n,navigate:a,replace:l,state:c,relative:p,preventScrollReset:m,viewTransition:g});_&&!1!==a?i.startTransition(()=>s()):s()}},v),{},{"data-discover":E||"render"!==n?void 0:"true"}))});function Mt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Ct(e){let t=i.useContext(oe);return S(t,Mt(e)),t}Tt.displayName="Form";var At=0,It=()=>"__".concat(String(++At),"__");function Rt(){let{router:e}=Ct("useSubmit"),{basename:t}=i.useContext(fe),n=ke("useRouteId"),r=e.fetch,a=e.navigate;return i.useCallback(async function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:o,encType:l,formData:c,body:u}=Je(e,t);if(!1===i.navigate){let e=i.fetcherKey||It();await r(e,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:c,body:u,formMethod:i.method||o,formEncType:i.encType||l,flushSync:i.flushSync})}else await a(i.action||s,{preventScrollReset:i.preventScrollReset,formData:c,body:u,formMethod:i.method||o,formEncType:i.encType||l,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[r,a,t,n])}const Pt=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Nt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],a=i+1<e.length,s=a?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;o||(d=64,a||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Pt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){const a=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==s||null==o)throw new kt;const l=t<<2|a>>4;if(r.push(l),64!==s){const e=a<<4&240|s>>2;if(r.push(e),64!==o){const e=s<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class kt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Lt=function(e){return function(e){const t=Pt(e);return Nt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Dt=function(e){try{return Nt.decodeString(e,!0)}catch(cU){console.error("base64Decode failed: ",cU)}return null};function Ot(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const Ut=()=>{try{return Ot().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/collectors-compendium",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"11961554828",REACT_APP_FIREBASE_MEASUREMENT_ID:"G-5W4DXY4J8H",REACT_APP_FIREBASE_STORAGE_BUCKET:"collection-a2525.firebasestorage.app",REACT_APP_FIREBASE_AUTH_DOMAIN:"collection-a2525.firebaseapp.co",REACT_APP_FIREBASE_PROJECT_ID:"collection-a2525",REACT_APP_FIREBASE_APP_ID:"1:11961554828:web:f37a862bc4b92fa11868a",REACT_APP_FIREBASE_API_KEY:"AIzaSyCNxbwocYoNVIJ3IrxJoXMi5rwveL2MsKE"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(cU){return}const t=e&&Dt(e[1]);return t&&JSON.parse(t)})()}catch(cU){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(cU))}},Ft=e=>{var t;return null===(t=Ut())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},zt=e=>{const t=Ft(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Bt=()=>{var e;return null===(e=Ut())||void 0===e?void 0:e.config},Vt=e=>{var t;return null===(t=Ut())||void 0===t?void 0:t["_".concat(e)]};class Ht{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function jt(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function Gt(e){return(await fetch(e,{credentials:"include"})).ok}function Wt(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=d({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Lt(JSON.stringify({alg:"none",type:"JWT"})),Lt(JSON.stringify(a)),""].join(".")}const qt={};let Xt=!1;function Yt(e,t){if("undefined"===typeof window||"undefined"===typeof document||!jt(window.location.host)||qt[e]===t||qt[e]||Xt)return;function n(e){return"__firebase__banner__".concat(e)}qt[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(qt))qt[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function a(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Xt=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function s(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),s=document.getElementById(t)||document.createElement("span"),o=n("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const n=a();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,s,l,n),document.body.appendChild(t)}i?(s.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',s.innerText="Preview backend running in this workspace."),s.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",s):s()}function Kt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Jt(){var e;const t=null===(e=Ut())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(cU){return!1}}function Qt(){return!Jt()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zt(){try{return"object"===typeof indexedDB}catch(cU){return!1}}class $t extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,$t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,en.prototype.create)}}class en{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(tn,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new $t(n,a,t)}}const tn=/\{\$([^}]+)}/g;function nn(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],a=t[i];if(rn(n)&&rn(a)){if(!nn(n,a))return!1}else if(n!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function rn(e){return null!==e&&"object"===typeof e}function an(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function sn(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function on(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ln{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=cn),void 0===r.error&&(r.error=cn),void 0===r.complete&&(r.complete=cn);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(cU){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(cU){"undefined"!==typeof console&&console.error&&console.error(cU)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function cn(){}function un(e){return e&&e._delegate?e._delegate:e}class hn{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const dn="[DEFAULT]";class fn{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ht;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(cU){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(cU){if(r)return null;throw cU}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:dn})}catch(cU){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(cU){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===dn?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dn;return this.component?this.component.multipleInstances?e:dn:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class pn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new fn(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const mn=[];var gn;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(gn||(gn={}));const vn={debug:gn.DEBUG,verbose:gn.VERBOSE,info:gn.INFO,warn:gn.WARN,error:gn.ERROR,silent:gn.SILENT},yn=gn.INFO,_n={[gn.DEBUG]:"log",[gn.VERBOSE]:"log",[gn.INFO]:"info",[gn.WARN]:"warn",[gn.ERROR]:"error"},bn=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=_n[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];console[r]("[".concat(n,"]  ").concat(e.name,":"),...a)};class Sn{constructor(e){this.name=e,this._logLevel=yn,this._logHandler=bn,this._userLogHandler=null,mn.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gn))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?vn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,gn.DEBUG,...t),this._logHandler(this,gn.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,gn.VERBOSE,...t),this._logHandler(this,gn.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,gn.INFO,...t),this._logHandler(this,gn.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,gn.WARN,...t),this._logHandler(this,gn.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,gn.ERROR,...t),this._logHandler(this,gn.ERROR,...t)}}let xn,wn;const En=new WeakMap,Tn=new WeakMap,Mn=new WeakMap,Cn=new WeakMap,An=new WeakMap;let In={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Tn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Mn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Rn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(wn||(wn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(kn(this),n),Nn(En.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Nn(e.apply(kn(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const a=e.call(kn(this),t,...r);return Mn.set(a,t.sort?t.sort():[t]),Nn(a)}}function Pn(e){return"function"===typeof e?Rn(e):(e instanceof IDBTransaction&&function(e){if(Tn.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)});Tn.set(e,t)}(e),t=e,(xn||(xn=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,In):e);var t}function Nn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(Nn(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&En.set(t,e)}).catch(()=>{}),An.set(t,e),t}(e);if(Cn.has(e))return Cn.get(e);const t=Pn(e);return t!==e&&(Cn.set(e,t),An.set(t,e)),t}const kn=e=>An.get(e);const Ln=["get","getKey","getAll","getAllKeys","count"],Dn=["put","add","delete","clear"],On=new Map;function Un(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(On.get(t))return On.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Dn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ln.includes(n))return;const a=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let a=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),i&&t.done]))[0]};return On.set(t,a),a}In=(e=>d(d({},e),{},{get:(t,n,r)=>Un(t,n)||e.get(t,n,r),has:(t,n)=>!!Un(t,n)||e.has(t,n)}))(In);class Fn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const zn="@firebase/app",Bn="0.14.6",Vn=new Sn("@firebase/app"),Hn="@firebase/app-compat",jn="@firebase/analytics-compat",Gn="@firebase/analytics",Wn="@firebase/app-check-compat",qn="@firebase/app-check",Xn="@firebase/auth",Yn="@firebase/auth-compat",Kn="@firebase/database",Jn="@firebase/data-connect",Qn="@firebase/database-compat",Zn="@firebase/functions",$n="@firebase/functions-compat",er="@firebase/installations",tr="@firebase/installations-compat",nr="@firebase/messaging",rr="@firebase/messaging-compat",ir="@firebase/performance",ar="@firebase/performance-compat",sr="@firebase/remote-config",or="@firebase/remote-config-compat",lr="@firebase/storage",cr="@firebase/storage-compat",ur="@firebase/firestore",hr="@firebase/ai",dr="@firebase/firestore-compat",fr="firebase",pr="[DEFAULT]",mr={[zn]:"fire-core",[Hn]:"fire-core-compat",[Gn]:"fire-analytics",[jn]:"fire-analytics-compat",[qn]:"fire-app-check",[Wn]:"fire-app-check-compat",[Xn]:"fire-auth",[Yn]:"fire-auth-compat",[Kn]:"fire-rtdb",[Jn]:"fire-data-connect",[Qn]:"fire-rtdb-compat",[Zn]:"fire-fn",[$n]:"fire-fn-compat",[er]:"fire-iid",[tr]:"fire-iid-compat",[nr]:"fire-fcm",[rr]:"fire-fcm-compat",[ir]:"fire-perf",[ar]:"fire-perf-compat",[sr]:"fire-rc",[or]:"fire-rc-compat",[lr]:"fire-gcs",[cr]:"fire-gcs-compat",[ur]:"fire-fst",[dr]:"fire-fst-compat",[hr]:"fire-vertex","fire-js":"fire-js",[fr]:"fire-js-all"},gr=new Map,vr=new Map,yr=new Map;function _r(e,t){try{e.container.addComponent(t)}catch(cU){Vn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),cU)}}function br(e){const t=e.name;if(yr.has(t))return Vn.debug("There were multiple attempts to register component ".concat(t,".")),!1;yr.set(t,e);for(const n of gr.values())_r(n,e);for(const n of vr.values())_r(n,e);return!0}function Sr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function xr(e){return null!==e&&void 0!==e&&void 0!==e.settings}const wr=new en("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Er{constructor(e,t,n){this._isDeleted=!1,this._options=d({},e),this._config=d({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw wr.create("app-deleted",{appName:this._name})}}const Tr="12.6.0";function Mr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=d({name:pr,automaticDataCollectionEnabled:!0},t),i=r.name;if("string"!==typeof i||!i)throw wr.create("bad-app-name",{appName:String(i)});if(n||(n=Bt()),!n)throw wr.create("no-options");const a=gr.get(i);if(a){if(nn(n,a.options)&&nn(r,a.config))return a;throw wr.create("duplicate-app",{appName:i})}const s=new pn(i);for(const l of yr.values())s.addComponent(l);const o=new Er(n,r,s);return gr.set(i,o),o}function Cr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pr;const t=gr.get(e);if(!t&&e===pr&&Bt())return Mr();if(!t)throw wr.create("no-app",{appName:e});return t}function Ar(e,t,n){var r;let i=null!==(r=mr[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Vn.warn(e.join(" "))}br(new hn("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const Ir="firebase-heartbeat-store";let Rr=null;function Pr(){return Rr||(Rr=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=Nn(s);return r&&s.addEventListener("upgradeneeded",e=>{r(Nn(s.result),e.oldVersion,e.newVersion,Nn(s.transaction),e)}),n&&s.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),o.then(e=>{a&&e.addEventListener("close",()=>a()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Ir)}catch(cU){console.warn(cU)}}}).catch(e=>{throw wr.create("idb-open",{originalErrorMessage:e.message})})),Rr}async function Nr(e,t){try{const n=(await Pr()).transaction(Ir,"readwrite"),r=n.objectStore(Ir);await r.put(t,kr(e)),await n.done}catch(cU){if(cU instanceof $t)Vn.warn(cU.message);else{const t=wr.create("idb-set",{originalErrorMessage:null===cU||void 0===cU?void 0:cU.message});Vn.warn(t.message)}}}function kr(e){return"".concat(e.name,"!").concat(e.options.appId)}class Lr{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Or(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Dr();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(e=>e.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(cU){Vn.warn(cU)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Dr(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),Ur(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ur(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Lt(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(cU){return Vn.warn(cU),""}}}function Dr(){return(new Date).toISOString().substring(0,10)}class Or{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Zt()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(ox){t(ox)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Pr()).transaction(Ir),n=await t.objectStore(Ir).get(kr(e));return await t.done,n}catch(cU){if(cU instanceof $t)Vn.warn(cU.message);else{const t=wr.create("idb-get",{originalErrorMessage:null===cU||void 0===cU?void 0:cU.message});Vn.warn(t.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return Nr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const n=await this.read();return Nr(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ur(e){return Lt(JSON.stringify({version:2,heartbeats:e})).length}var Fr;Fr="",br(new hn("platform-logger",e=>new Fn(e),"PRIVATE")),br(new hn("heartbeat",e=>new Lr(e),"PRIVATE")),Ar(zn,Bn,Fr),Ar(zn,Bn,"esm2020"),Ar("fire-js","");Ar("firebase","12.6.0","app");var zr,Br,Vr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Hr={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let a,s=e.g[3];a=t+(s^n&(i^s))+r[0]+3614090360&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[1]+3905402710&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(n^s&(t^n))+r[2]+606105819&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[3]+3250441966&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[4]+4118548399&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[5]+1200080426&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(n^s&(t^n))+r[6]+2821735955&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[7]+4249261313&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[8]+1770035416&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[9]+2336552879&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(n^s&(t^n))+r[10]+4294925233&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[11]+2304563134&4294967295,a=t+(s^(n=i+(a<<22&4294967295|a>>>10))&(i^s))+r[12]+1804603682&4294967295,a=s+(i^(t=n+(a<<7&4294967295|a>>>25))&(n^i))+r[13]+4254626195&4294967295,s=t+(a<<12&4294967295|a>>>20),a=i+(n^s&(t^n))+r[14]+2792965006&4294967295,a=n+(t^(i=s+(a<<17&4294967295|a>>>15))&(s^t))+r[15]+1236535329&4294967295,a=t+(i^s&((n=i+(a<<22&4294967295|a>>>10))^i))+r[1]+4129170786&4294967295,a=s+(n^i&((t=n+(a<<5&4294967295|a>>>27))^n))+r[6]+3225465664&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[11]+643717713&4294967295,a=n+(s^t&((i=s+(a<<14&4294967295|a>>>18))^s))+r[0]+3921069994&4294967295,a=t+(i^s&((n=i+(a<<20&4294967295|a>>>12))^i))+r[5]+3593408605&4294967295,a=s+(n^i&((t=n+(a<<5&4294967295|a>>>27))^n))+r[10]+38016083&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[15]+3634488961&4294967295,a=n+(s^t&((i=s+(a<<14&4294967295|a>>>18))^s))+r[4]+3889429448&4294967295,a=t+(i^s&((n=i+(a<<20&4294967295|a>>>12))^i))+r[9]+568446438&4294967295,a=s+(n^i&((t=n+(a<<5&4294967295|a>>>27))^n))+r[14]+3275163606&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[3]+4107603335&4294967295,a=n+(s^t&((i=s+(a<<14&4294967295|a>>>18))^s))+r[8]+1163531501&4294967295,a=t+(i^s&((n=i+(a<<20&4294967295|a>>>12))^i))+r[13]+2850285829&4294967295,a=s+(n^i&((t=n+(a<<5&4294967295|a>>>27))^n))+r[2]+4243563512&4294967295,s=t+(a<<9&4294967295|a>>>23),a=i+(t^n&(s^t))+r[7]+1735328473&4294967295,a=n+(s^t&((i=s+(a<<14&4294967295|a>>>18))^s))+r[12]+2368359562&4294967295,a=t+((n=i+(a<<20&4294967295|a>>>12))^i^s)+r[5]+4294588738&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[8]+2272392833&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^n)+r[11]+1839030562&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[14]+4259657740&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[1]+2763975236&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[4]+1272893353&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^n)+r[7]+4139469664&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[10]+3200236656&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[13]+681279174&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[0]+3936430074&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^n)+r[3]+3572445317&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[6]+76029189&4294967295,a=t+((n=i+(a<<23&4294967295|a>>>9))^i^s)+r[9]+3654602809&4294967295,a=s+((t=n+(a<<4&4294967295|a>>>28))^n^i)+r[12]+3873151461&4294967295,s=t+(a<<11&4294967295|a>>>21),a=i+(s^t^n)+r[15]+530742520&4294967295,a=n+((i=s+(a<<16&4294967295|a>>>16))^s^t)+r[2]+3299628645&4294967295,a=t+(i^((n=i+(a<<23&4294967295|a>>>9))|~s))+r[0]+4096336452&4294967295,a=s+(n^((t=n+(a<<6&4294967295|a>>>26))|~i))+r[7]+1126891415&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[14]+2878612391&4294967295,a=n+(s^((i=s+(a<<15&4294967295|a>>>17))|~t))+r[5]+4237533241&4294967295,a=t+(i^((n=i+(a<<21&4294967295|a>>>11))|~s))+r[12]+1700485571&4294967295,a=s+(n^((t=n+(a<<6&4294967295|a>>>26))|~i))+r[3]+2399980690&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[10]+4293915773&4294967295,a=n+(s^((i=s+(a<<15&4294967295|a>>>17))|~t))+r[1]+2240044497&4294967295,a=t+(i^((n=i+(a<<21&4294967295|a>>>11))|~s))+r[8]+1873313359&4294967295,a=s+(n^((t=n+(a<<6&4294967295|a>>>26))|~i))+r[15]+4264355552&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[6]+2734768916&4294967295,a=n+(s^((i=s+(a<<15&4294967295|a>>>17))|~t))+r[13]+1309151649&4294967295,a=t+(i^((n=i+(a<<21&4294967295|a>>>11))|~s))+r[4]+4149444226&4294967295,a=s+(n^((t=n+(a<<6&4294967295|a>>>26))|~i))+r[11]+3174756917&4294967295,s=t+(a<<10&4294967295|a>>>22),a=i+(t^(s|~n))+r[2]+718787259&4294967295,a=n+(s^((i=s+(a<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let a=this.h,s=0;for(;s<t;){if(0==a)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[a++]=e.charCodeAt(s++),a==this.blockSize){n(this,i),a=0;break}}else for(;s<t;)if(i[a++]=e[s++],a==this.blockSize){n(this,i),a=0;break}}this.h=a,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function a(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(e<0)return d(s(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var o=a(0),l=a(1),c=a(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=v(n),r=v(r);var i=y(n,1),a=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=a.add(r);c.l(e)<=0&&(i=i.add(n),a=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=o;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(a=s(n)).j(t);h(c)||c.l(e)>0;)c=(a=s(n-=r)).j(t);u(a)&&(a=l),i=i.add(a),e=f(e,c)}return new m(i,e)}function v(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function y(e,t){const n=t>>5;t%=32;const i=e.g.length-n,a=[];for(let r=0;r<i;r++)a[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(a,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=s(Math.pow(e,6));var n=this;let r="";for(;;){const i=g(n,t).g;let a=(((n=f(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return a+r;for(;a.length<6;)a="0"+a;r=a+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),a=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=a>>>16,t&=65535,a&=65535,n[r]=a<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(c)<0&&e.l(c)<0)return s(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,a=65535&this.i(i),s=e.i(t)>>>16,o=65535&e.i(t);n[2*i+2*t]+=a*o,p(n,2*i+2*t),n[2*i+2*t+1]+=r*o,p(n,2*i+2*t+1),n[2*i+2*t+1]+=a*s,p(n,2*i+2*t+1),n[2*i+2*t+2]+=r*s,p(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,Br=Hr.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=s(Math.pow(n,8));let i=o;for(let o=0;o<t.length;o+=8){var a=Math.min(8,t.length-o);const e=parseInt(t.substring(o,o+a),n);a<8?(a=s(Math.pow(n,a)),i=i.j(a).add(s(e))):(i=i.j(r),i=i.add(s(e)))}return i},zr=Hr.Integer=r}).apply("undefined"!==typeof Vr?Vr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var jr,Gr,Wr,qr,Xr,Yr,Kr,Jr,Qr="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},Zr={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Qr&&Qr];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in i))break e;i=i[s]}(r=r(a=i[e=e[e.length-1]]))!=a&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},a=this||self;function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=o).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){a.setTimeout(()=>{throw e},0)}function m(){var e=b;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new v,e=>e.reset());class v{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let y,_=!1,b=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},S=()=>{const e=Promise.resolve(void 0);y=()=>{e.then(x)}};function x(){for(var e;e=m();){try{e.h.call(e.g)}catch(lD){p(lD)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}_=!1}function w(){this.u=this.u,this.C=this.C}function E(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},E.prototype.h=function(){this.defaultPrevented=!0};var T=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};a.addEventListener("test",e,t),a.removeEventListener("test",e,t)}catch(lD){}return e}();function M(e){return/^[\s\xa0]*$/.test(e)}function C(e,t){E.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(C,E),C.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&C.Z.h.call(this)},C.prototype.h=function(){C.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var A="closure_listenable_"+(1e6*Math.random()|0),I=0;function R(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++I,this.da=this.fa=!1}function P(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function N(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function k(e){const t={};for(const n in e)t[n]=e[n];return t}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<L.length;t++)n=L[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function O(e){this.src=e,this.g={},this.h=0}function U(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],a=Array.prototype.indexOf.call(i,t,void 0);(r=a>=0)&&Array.prototype.splice.call(i,a,1),r&&(P(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function F(e,t,n,r){for(let i=0;i<e.length;++i){const a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}O.prototype.add=function(e,t,n,r,i){const a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);const s=F(e,t,r,i);return s>-1?(t=e[s],n||(t.fa=!1)):((t=new R(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var z="closure_lm_"+(1e6*Math.random()|0),B={};function V(e,t,n,r,i){if(r&&r.once)return j(e,t,n,r,i);if(Array.isArray(t)){for(let a=0;a<t.length;a++)V(e,t[a],n,r,i);return null}return n=J(n),e&&e[A]?e.J(t,n,s(r)?!!r.capture:!!r,i):H(e,t,n,!1,r,i)}function H(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");const o=s(i)?!!i.capture:!!i;let l=Y(e);if(l||(e[z]=l=new O(e)),(n=l.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)T||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function j(e,t,n,r,i){if(Array.isArray(t)){for(let a=0;a<t.length;a++)j(e,t[a],n,r,i);return null}return n=J(n),e&&e[A]?e.K(t,n,s(r)?!!r.capture:!!r,i):H(e,t,n,!0,r,i)}function G(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)G(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=J(n),e&&e[A]?(e=e.i,(a=String(t).toString())in e.g&&((n=F(t=e.g[a],n,r,i))>-1&&(P(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[a],e.h--)))):e&&(e=Y(e))&&(t=e.g[t.toString()],e=-1,t&&(e=F(t,n,r,i)),(n=e>-1?t[e]:null)&&W(n))}function W(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[A])U(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Y(t))?(U(n,e),0==n.h&&(n.src=null,t[z]=null)):P(e)}}}function q(e){return e in B?B[e]:B[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new C(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&W(e),e=n.call(r,t)}return e}function Y(e){return(e=e[z])instanceof O?e:null}var K="__closure_events_fn_"+(1e9*Math.random()>>>0);function J(e){return"function"===typeof e?e:(e[K]||(e[K]=function(t){return e.handleEvent(t)}),e[K])}function Q(){w.call(this),this.i=new O(this),this.M=this,this.G=null}function Z(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new E(t,e);else if(t instanceof E)t.target=t.target||e;else{var i=t;D(t=new E(r,e),i)}let a,s;if(i=!0,n)for(s=n.length-1;s>=0;s--)a=t.g=n[s],i=$(a,r,!0,t)&&i;if(a=t.g=e,i=$(a,r,!0,t)&&i,i=$(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)a=t.g=n[s],i=$(a,r,!1,t)&&i}function $(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let a=0;a<t.length;++a){const s=t[a];if(s&&!s.da&&s.capture==n){const t=s.listener,n=s.ha||s.src;s.fa&&U(e.i,s),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:a.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(Q,w),Q.prototype[A]=!0,Q.prototype.removeEventListener=function(e,t,n,r){G(this,e,t,n,r)},Q.prototype.N=function(){if(Q.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)P(n[e]);delete e.g[t],e.h--}}this.G=null},Q.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Q.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends w{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){w.call(this),this.h=e,this.g={}}u(ne,w);var re=[];function ie(e){N(e.g,function(e,t){this.g.hasOwnProperty(t)&&W(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ae=a.JSON.stringify,se=a.JSON.parse,oe=class{stringify(e){return a.JSON.stringify(e,void 0)}parse(e){return a.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){E.call(this,"d")}function de(){E.call(this,"c")}u(he,E),u(de,E);var fe={},pe=null;function me(){return pe=pe||new Q}function ge(e){E.call(this,fe.Ia,e)}function ve(e){const t=me();Z(t,new ge(t))}function ye(e,t){E.call(this,fe.STAT_EVENT,e),this.stat=t}function _e(e){const t=me();Z(t,new ye(t,e))}function be(e,t){E.call(this,fe.Ja,e),this.size=t}function Se(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){e()},t)}function xe(){this.g=!0}function we(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const a=JSON.parse(t);if(a)for(e=0;e<a.length;e++)if(Array.isArray(a[e])){var n=a[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return ae(a)}catch(a){return t}}(e,n)+(r?" "+r:"")})}fe.Ia="serverreachability",u(ge,E),fe.STAT_EVENT="statevent",u(ye,E),fe.Ja="timingevent",u(be,E),xe.prototype.ua=function(){this.g=!1},xe.prototype.info=function(){};var Ee,Te={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Me={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ce(){}function Ae(e){return encodeURIComponent(String(e))}function Ie(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Re(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Pe}function Pe(){this.i=null,this.g="",this.h=!1}u(Ce,le),Ce.prototype.g=function(){return new XMLHttpRequest},Ee=new Ce;var Ne={},ke={};function Le(e,t,n){e.M=1,e.A=at(et(t)),e.u=n,e.R=!0,De(e,null)}function De(e,t){e.F=Date.now(),Fe(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),_t(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Pe,e.g=sn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let a=0;a<i.length;a++){const e=V(n,i[a],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?k(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ve(),function(e,t,n,r,i,a){e.info(function(){if(e.g)if(a){var s="",o=a.split("&");for(let e=0;e<o.length;e++){var l=o[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");s=t.length>=2&&"type"==t[1]?s+(e+"=")+l+"&":s+(e+"=redacted&")}}}else s=null;else s=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Oe(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Ue(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ke:(n=Number(t.substring(n,r)),isNaN(n)?Ne:(r+=1)+n>t.length?ke:(t=t.slice(r,r+n),e.C=r+n,t))}function Fe(e){e.T=Date.now()+e.H,ze(e,e.H)}function ze(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Se(l(e.aa,e),t)}function Be(e){e.D&&(a.clearTimeout(e.D),e.D=null)}function Ve(e){0==e.j.I||e.K||en(e.j,e)}function He(e){Be(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function je(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Ye(n.h,e)))if(!e.L&&Ye(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(oD){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;$t(n),jt(n)}Jt(n),_e(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Se(l(n.Va,n),6e3));Xe(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&$t(n),!M(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(Ke(a,a.h),a.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var s=e;if((r=n).na=an(r,r.L?r.ba:null,r.W),s.L){Je(r.h,s);var o=s,c=r.O;c&&(o.H=c),o.D&&(Be(o),Fe(o)),r.g=s}else Kt(r);n.i.length>0&&Wt(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):Ht(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ve()}catch(oD){}}Re.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Ft(e)?t.j():this.Y(e)},Re.prototype.Y=function(e){try{if(e==this.g)e:{const l=Ft(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||zt(this.g)))){this.K||4!=l||7==c||ve(),Be(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Oe(e))return e.g.la();const t=zt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Ft(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return He(e),Ve(e),"";e.h.i=new a.TextDecoder}for(let a=0;a<r;a++)e.h.h=!0,n+=e.h.i.decode(t[a],{stream:!(i&&a==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,a,s){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+s})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(r)){var s=r;break t}}s=null}if(!(e=s)){this.o=!1,this.m=3,_e(12),He(this),Ve(this);break e}we(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,je(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Ue(this,n),t==ke){4==l&&(this.m=4,_e(14),e=!1),we(this.i,this.l,null,"[Incomplete Response]");break}if(t==Ne){this.m=4,_e(15),we(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}we(this.i,this.l,t,null),je(this,t)}if(Oe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,_e(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qt(o),o.P=!0,_e(11))}}else we(this.i,this.l,n,"[Invalid Chunked Response]"),He(this),Ve(this)}else we(this.i,this.l,n,null),je(this,n);4==l&&He(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,Fe(this)))}else(function(e){const t={};e=(e.g&&Ft(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(M(e[r]))continue;var n=Ie(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[i]||[];t[i]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,_e(12)):(this.m=0,_e(13)),He(this),Ve(this)}}}catch(Ni){}},Re.prototype.cancel=function(){this.K=!0,He(this)},Re.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ve(),_e(17)),He(this),this.m=2,Ve(this)):ze(this,this.T-e)};var Ge=class{constructor(e,t){this.g=e,this.map=t}};function We(e){this.l=e||10,a.PerformanceNavigationTiming?e=(e=a.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ye(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ke(e,t){e.g?e.g.add(t):e.h=t}function Je(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Qe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}We.prototype.cancel=function(){if(this.i=Qe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ze=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function $e(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof $e?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,bt(e.i)),this.m=e.m):e&&(t=String(e).match(Ze))?(this.l=!1,tt(this,t[1]||"",!0),this.o=st(t[2]||""),this.g=st(t[3]||"",!0),nt(this,t[4]),this.h=st(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=st(t[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}function et(e){return new $e(e)}function tt(e,t,n){e.j=n?st(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),_t(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=ot(t,dt)),e.i=new pt(t,e.l))}function it(e,t,n){e.i.set(t,n)}function at(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function st(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ot(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}$e.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(ot(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ot(t,ct,!0),"@"),e.push(Ae(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ot(n,"/"==n.charAt(0)?ht:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ot(n,ft)),e.join("")},$e.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,bt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,ht=/[#\?]/g,dt=/[#\?@]/g,ft=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,a=null;r>=0?(i=e[n].substring(0,r),a=e[n].substring(r+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=St(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function vt(e,t){return mt(e),t=St(e,t),e.g.has(t)}function yt(e,t){mt(e);let n=[];if("string"===typeof t)vt(e,t)&&(n=n.concat(e.g.get(St(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function _t(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(St(e,t),d(n)),e.h+=n.length)}function bt(e){const t=new pt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function St(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function xt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(a){}}function wt(){this.g=new oe}function Et(e){this.i=e.Sb||null,this.h=e.ab||!1}function Tt(e,t){Q.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Mt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Ct(e){e.readyState=4,e.l=null,e.j=null,e.B=null,At(e)}function At(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function It(e){let t="";return N(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Rt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=It(n),"string"===typeof e?null!=n&&Ae(n):it(e,t,n))}function Pt(e){Q.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=pt.prototype).add=function(e,t){mt(this),this.i=null,e=St(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,vt(this,e=St(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=yt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ae(n);n=yt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ae(n[t])),e.push(r)}}return this.i=e.join("&")},u(Et,le),Et.prototype.g=function(){return new Tt(this.i,this.h)},u(Tt,Q),(e=Tt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,At(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||a).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ct(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,At(this)),this.g&&(this.readyState=3,At(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof a.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Mt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ct(this):At(this),3==this.readyState&&Mt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Ct(this))},e.Na=function(e){this.g&&(this.response=e,Ct(this))},e.ga=function(){this.g&&Ct(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Tt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Pt,Q);var Nt=/^https?$/i,kt=["POST","PUT"];function Lt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Dt(e),Ut(e)}function Dt(e){e.A||(e.A=!0,Z(e,"complete"),Z(e,"error"))}function Ot(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Ft(e))setTimeout(e.Ca.bind(e),0);else if(Z(e,"readystatechange"),4==Ft(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(Ze)[1]||null;!t&&a.self&&a.self.location&&(t=a.self.location.protocol.slice(0,-1)),r=!Nt.test(t?t.toLowerCase():"")}n=r}if(n)Z(e,"complete"),Z(e,"success");else{e.o=6;try{var s=Ft(e)>2?e.g.statusText:""}catch(zO){s=""}e.l=s+" ["+e.ca()+"]",Dt(e)}}finally{Ut(e)}}}function Ut(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||Z(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Ft(e){return e.g?e.g.readyState:0}function zt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(uD){return null}}function Bt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Vt(e){this.za=0,this.i=[],this.j=new xe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bt("baseRetryDelayMs",5e3,e),this.Za=Bt("retryDelaySeedMs",1e4,e),this.Ta=Bt("forwardChannelMaxRetries",2,e),this.va=Bt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new We(e&&e.concurrentRequestLimit),this.Ba=new wt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Ht(e){if(Gt(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),Xt(e,n),(t=new Re(e,e.j,t)).M=2,t.A=at(et(n)),n=!1,a.navigator&&a.navigator.sendBeacon)try{n=a.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&a.Image&&((new Image).src=t.A,n=!0),n||(t.g=sn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Fe(t)}rn(e)}function jt(e){e.g&&(Qt(e),e.g.cancel(),e.g=null)}function Gt(e){jt(e),e.v&&(a.clearTimeout(e.v),e.v=null),$t(e),e.h.cancel(),e.m&&("number"===typeof e.m&&a.clearTimeout(e.m),e.m=null)}function Wt(e){if(!qe(e.h)&&!e.m){e.m=!0;var t=e.Ea;y||S(),_||(y(),_=!0),b.add(t,e),e.D=0}}function qt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),Xt(e,r),e.u&&e.o&&Rt(r,e.u,e.o),n=new Re(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Yt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Ke(e.h,n),Le(n,r,t)}function Xt(e,t){e.H&&N(e.H,function(e,n){it(t,n,e)}),e.l&&N({},function(e,n){it(t,n,e)})}function Yt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var a=i[c].g;const n=i[c].map;if((a-=t)<0)t=Math.max(0,i[c].g-100),l=!1;else try{a="req"+a+"_"||0;try{var o=n instanceof Map?n:Object.entries(n);for(const[t,n]of o){let r=n;s(n)&&(r=ae(n)),e.push(a+t+"="+encodeURIComponent(r))}}catch(ei){throw e.push(a+"type="+encodeURIComponent("_badmap")),ei}}catch(ei){r&&r(n)}}if(l){o=e.join("&");break e}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Kt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;y||S(),_||(y(),_=!0),b.add(t,e),e.A=0}}function Jt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Se(l(e.Da,e),tn(e,e.A)),e.A++,!0)}function Qt(e){null!=e.B&&(a.clearTimeout(e.B),e.B=null)}function Zt(e){e.g=new Re(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),Xt(e,t),e.u&&e.o&&Rt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=at(et(t)),n.u=null,n.R=!0,De(n,e)}function $t(e){null!=e.C&&(a.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){$t(e),Qt(e),e.g=null;var r=2}else{if(!Ye(e.h,t))return;n=t.G,Je(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;Z(r=me(),new be(r,n)),Wt(e)}else Kt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Se(l(e.Ea,e,t),tn(e,e.D)),e.D++,!0))}(e,t)||2==r&&Jt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new $e(r||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||tt(r,"https"),at(r),t?function(e,t){const n=new xe;if(a.Image){const r=new Image;r.onload=c(xt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(xt,n,"TestLoadImage: error",!1,t,r),r.onabort=c(xt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(xt,n,"TestLoadImage: timeout",!1,t,r),a.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new xe;const n=new AbortController,r=setTimeout(()=>{n.abort(),xt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?xt(0,0,!0,t):xt(0,0,!1,t)}).catch(()=>{clearTimeout(r),xt(0,0,!1,t)})}(r.toString(),n)}else _e(2);e.I=0,e.l&&e.l.pa(t),rn(e),Gt(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Qe(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function an(e,t,n){var r=n instanceof $e?et(n):new $e(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=a.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new $e(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),Xt(e,r),r}function sn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Pt(new Et({ab:n})):new Pt(e.ma)).Fa(e.L),t}function on(){}function ln(){}function cn(e,t){Q.call(this),this.g=new Vt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!M(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!M(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new dn(this)}function un(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hn(){de.call(this),this.status=1}function dn(e){this.g=e}(e=Pt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ee.g(),this.g.onreadystatechange=h(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Lt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=a.FormData&&e instanceof a.FormData,!(Array.prototype.indexOf.call(kt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,o]of n)this.g.setRequestHeader(a,o);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(s){Lt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Z(this,"complete"),Z(this,"abort"),Ut(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ut(this,!0)),Pt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Ot(this):this.Xa())},e.Xa=function(){Ot(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Ft(this)>2?this.g.status:-1}catch(sD){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(sD){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),se(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Vt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){_e(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=an(this,null,this.W),Wt(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Re(this,this.j,e);let a=this.o;if(this.U&&(a?(a=k(a),D(a,this.U)):a=this.U),null!==this.u||this.R||(i.J=a,a=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Yt(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),Xt(this,n),a&&(this.R?t="headers="+Ae(It(a))+"&"+t:this.u&&Rt(n,this.u,a)),Ke(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,Le(i,n,null)):Le(i,n,t),this.I=2}}else 3==this.I&&(e?qt(this,e):0==this.i.length||qe(this.h)||qt(this))},e.Da=function(){if(this.v=null,Zt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Se(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,_e(10),jt(this),Zt(this))},e.Va=function(){null!=this.C&&(this.C=null,jt(this),Jt(this),_e(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),_e(2)):(this.j.info("Failed to ping google.com"),_e(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=on.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new cn(e,t)},u(cn,Q),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Ht(this.g)},cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ae(e),e=n);t.i.push(new Ge(t.Ya++,e)),3==t.I&&Wt(t)},cn.prototype.N=function(){this.g.l=null,delete this.j,Ht(this.g),delete this.g,cn.Z.N.call(this)},u(un,he),u(hn,de),u(dn,on),dn.prototype.ra=function(){Z(this.g,"a")},dn.prototype.qa=function(e){Z(this.g,new un(e))},dn.prototype.pa=function(e){Z(this.g,new hn)},dn.prototype.oa=function(){Z(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Jr=Zr.createWebChannelTransport=function(){return new ln},Kr=Zr.getStatEventTarget=function(){return me()},Yr=Zr.Event=fe,Xr=Zr.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,qr=Zr.ErrorCode=Te,Me.COMPLETE="complete",Wr=Zr.EventType=Me,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",Q.prototype.listen=Q.prototype.J,Gr=Zr.WebChannel=ce,Zr.FetchXmlHttpFactory=Et,Pt.prototype.listenOnce=Pt.prototype.K,Pt.prototype.getLastError=Pt.prototype.Ha,Pt.prototype.getLastErrorCode=Pt.prototype.ya,Pt.prototype.getStatus=Pt.prototype.ca,Pt.prototype.getResponseJson=Pt.prototype.La,Pt.prototype.getResponseText=Pt.prototype.la,Pt.prototype.send=Pt.prototype.ea,Pt.prototype.setWithCredentials=Pt.prototype.Fa,jr=Zr.XhrIo=Pt}).apply("undefined"!==typeof Qr?Qr:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const $r="@firebase/firestore",ei="4.9.2";class ti{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ti.UNAUTHENTICATED=new ti(null),ti.GOOGLE_CREDENTIALS=new ti("google-credentials-uid"),ti.FIRST_PARTY=new ti("first-party-uid"),ti.MOCK_USER=new ti("mock-user");let ni="12.3.0";const ri=new Sn("@firebase/firestore");function ii(){return ri.logLevel}function ai(e){if(ri.logLevel<=gn.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(li);ri.debug("Firestore (".concat(ni,"): ").concat(e),...i)}}function si(e){if(ri.logLevel<=gn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(li);ri.error("Firestore (".concat(ni,"): ").concat(e),...i)}}function oi(e){if(ri.logLevel<=gn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(li);ri.warn("Firestore (".concat(ni,"): ").concat(e),...i)}}function li(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function ci(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ui(e,r,n)}function ui(e,t,n){let r="FIRESTORE (".concat(ni,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw si(r),new Error(r)}function hi(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||ui(t,i,r)}function di(e,t){return e}const fi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pi extends $t{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class mi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class gi{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class vi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ti.UNAUTHENTICATED))}shutdown(){}}class yi{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _i{constructor(e){this.t=e,this.currentUser=ti.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){hi(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new mi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mi,e.enqueueRetryable(()=>r(this.currentUser))};const a=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},s=e=>{ai("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(e=>s(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(ai("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mi)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(ai("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(hi("string"==typeof t.accessToken,31837,{l:t}),new gi(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return hi(null===e||"string"==typeof e,2055,{h:e}),new ti(e)}}class bi{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=ti.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Si{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new bi(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(ti.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class xi{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class wi{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){hi(void 0===this.o,3512);const n=e=>{null!=e.error&&ai("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.m;return this.m=e.token,ai("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{ai("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):ai("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new xi(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(hi("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new xi(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ei(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Ti{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=Ei(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function Mi(e,t){return e<t?-1:e>t?1:0}function Ci(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Ri(n)===Ri(i)?Mi(n,i):Ri(n)?1:-1}return Mi(e.length,t.length)}const Ai=55296,Ii=57343;function Ri(e){const t=e.charCodeAt(0);return t>=Ai&&t<=Ii}function Pi(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ni="__name__";class ki{constructor(e,t,n){void 0===t?t=0:t>e.length&&ci(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&ci(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ki.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ki?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ki.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return Mi(e.length,t.length)}static compareSegments(e,t){const n=ki.isNumericId(e),r=ki.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ki.extractNumericId(e).compare(ki.extractNumericId(t)):Ci(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return zr.fromString(e.substring(4,e.length-2))}}class Li extends ki{construct(e,t,n){return new Li(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new pi(fi.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new Li(e)}static emptyPath(){return new Li([])}}const Di=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Oi extends ki{construct(e,t,n){return new Oi(e,t,n)}static isValidIdentifier(e){return Di.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Oi.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ni}static keyField(){return new Oi([Ni])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new pi(fi.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new pi(fi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(i(),r++)}if(i(),a)throw new pi(fi.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Oi(t)}static emptyPath(){return new Oi([])}}class Ui{constructor(e){this.path=e}static fromPath(e){return new Ui(Li.fromString(e))}static fromName(e){return new Ui(Li.fromString(e).popFirst(5))}static empty(){return new Ui(Li.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Li.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Li.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ui(new Li(e.slice()))}}function Fi(e,t,n){if(!n)throw new pi(fi.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function zi(e){if(!Ui.isDocumentKey(e))throw new pi(fi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Bi(e){if(Ui.isDocumentKey(e))throw new pi(fi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Vi(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Hi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":ci(12329,{type:typeof e})}function ji(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new pi(fi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Hi(e);throw new pi(fi.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Gi(e,t){if(t<=0)throw new pi(fi.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function Wi(e,t){const n={typeString:e};return t&&(n.value=t),n}function qi(e,t){if(!Vi(e))throw new pi(fi.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,a="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n="JSON missing required field: '".concat(r,"'");break}const s=e[r];if(i&&typeof s!==i){n="JSON field '".concat(r,"' must be a ").concat(i,".");break}if(void 0!==a&&s!==a.value){n="Expected '".concat(r,"' field to equal '").concat(a.value,"'");break}}if(n)throw new pi(fi.INVALID_ARGUMENT,n);return!0}const Xi=-62135596800,Yi=1e6;class Ki{static now(){return Ki.fromMillis(Date.now())}static fromDate(e){return Ki.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Yi);return new Ki(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new pi(fi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Xi)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pi(fi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yi}_compareTo(e){return this.seconds===e.seconds?Mi(this.nanoseconds,e.nanoseconds):Mi(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ki._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qi(e,Ki._jsonSchema))return new Ki(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Xi;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ki._jsonSchemaVersion="firestore/timestamp/1.0",Ki._jsonSchema={type:Wi("string",Ki._jsonSchemaVersion),seconds:Wi("number"),nanoseconds:Wi("number")};class Ji{static fromTimestamp(e){return new Ji(e)}static min(){return new Ji(new Ki(0,0))}static max(){return new Ji(new Ki(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Qi=-1;class Zi{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Zi.UNKNOWN_ID=-1;function $i(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ji.fromTimestamp(1e9===r?new Ki(n+1,0):new Ki(n,r));return new ta(i,Ui.empty(),t)}function ea(e){return new ta(e.readTime,e.key,Qi)}class ta{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ta(Ji.min(),Ui.empty(),Qi)}static max(){return new ta(Ji.max(),Ui.empty(),Qi)}}function na(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Ui.comparator(e.documentKey,t.documentKey),0!==n?n:Mi(e.largestBatchId,t.largestBatchId))}const ra="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ia{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function aa(e){if(e.code!==fi.FAILED_PRECONDITION||e.message!==ra)throw e;ai("LocalStore","Unexpectedly lost primary lease")}class sa{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ci(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new sa((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof sa?t:sa.resolve(t)}catch(e){return sa.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):sa.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):sa.reject(t)}static resolve(e){return new sa((t,n)=>{t(e)})}static reject(e){return new sa((t,n)=>{n(e)})}static waitFor(e){return new sa((t,n)=>{let r=0,i=0,a=!1;e.forEach(e=>{++r,e.next(()=>{++i,a&&i===r&&t()},e=>n(e))}),a=!0,i===r&&t()})}static or(e){let t=sa.resolve(!1);for(const n of e)t=t.next(e=>e?sa.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new sa((n,r)=>{const i=e.length,a=new Array(i);let s=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next(e=>{a[l]=e,++s,s===i&&n(a)},e=>r(e))}})}static doWhile(e,t){return new sa((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function oa(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function la(e){return"IndexedDbTransactionError"===e.name}class ca{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ca.ce=-1;const ua=-1;function ha(e){return null==e}function da(e){return 0===e&&1/e==-1/0}function fa(e){return"number"==typeof e&&Number.isInteger(e)&&!da(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const pa="\x01";function ma(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=va(t)),t=ga(e.get(n),t);return va(t)}function ga(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case pa:n+="\x01\x11";break;default:n+=t}}return n}function va(e){return e+pa+"\x01"}const ya="remoteDocuments",_a="owner",ba="mutationQueues",Sa="mutations";const xa="documentMutations",wa="remoteDocumentsV14",Ea="remoteDocumentGlobal",Ta="targets",Ma="targetDocuments",Ca="targetGlobal",Aa="collectionParents",Ia="clientMetadata",Ra="bundles",Pa="namedQueries",Na="indexConfiguration",ka="indexState",La="indexEntries",Da="documentOverlays",Oa="globals",Ua=[ba,Sa,xa,ya,Ta,_a,Ca,Ma,Ia,Ea,Aa,Ra,Pa],Fa=[ba,Sa,xa,wa,Ta,_a,Ca,Ma,Ia,Ea,Aa,Ra,Pa,Da],za=Fa,Ba=[...za,Na,ka,La];function Va(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ha(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ja(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ga{constructor(e,t){this.comparator=e,this.root=t||qa.EMPTY}insert(e,t){return new Ga(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qa.BLACK,null,null))}remove(e){return new Ga(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wa(this.root,e,this.comparator,!0)}}class Wa{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qa{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:qa.RED,this.left=null!=r?r:qa.EMPTY,this.right=null!=i?i:qa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new qa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return qa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return qa.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ci(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ci(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ci(27949);return e+(this.isRed()?0:1)}}qa.EMPTY=null,qa.RED=!0,qa.BLACK=!1,qa.EMPTY=new class{constructor(){this.size=0}get key(){throw ci(57766)}get value(){throw ci(16141)}get color(){throw ci(16727)}get left(){throw ci(29726)}get right(){throw ci(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new qa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Xa{constructor(e){this.comparator=e,this.data=new Ga(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ya(this.data.getIterator())}getIteratorFrom(e){return new Ya(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Xa))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Xa(this.comparator);return t.data=e,t}}class Ya{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ka{constructor(e){this.fields=e,e.sort(Oi.comparator)}static empty(){return new Ka([])}unionWith(e){let t=new Xa(Oi.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ka(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Pi(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Ja extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Qa{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ja("Invalid base64 string: "+e):e}}(e);return new Qa(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Qa(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Mi(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Qa.EMPTY_BYTE_STRING=new Qa("");const Za=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $a(e){if(hi(!!e,39018),"string"==typeof e){let t=0;const n=Za.exec(e);if(hi(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:es(e.seconds),nanos:es(e.nanos)}}function es(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ts(e){return"string"==typeof e?Qa.fromBase64String(e):Qa.fromUint8Array(e)}const ns="server_timestamp",rs="__type__",is="__previous_value__",as="__local_write_time__";function ss(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[rs])||void 0===t?void 0:t.stringValue)===ns}function os(e){const t=e.mapValue.fields[is];return ss(t)?os(t):t}function ls(e){const t=$a(e.mapValue.fields[as].timestampValue);return new Ki(t.seconds,t.nanos)}class cs{constructor(e,t,n,r,i,a,s,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const us="(default)";class hs{constructor(e,t){this.projectId=e,this.database=t||us}static empty(){return new hs("","")}get isDefaultDatabase(){return this.database===us}isEqual(e){return e instanceof hs&&e.projectId===this.projectId&&e.database===this.database}}const ds="__type__",fs="__max__",ps={mapValue:{fields:{__type__:{stringValue:fs}}}},ms="__vector__",gs="value";function vs(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ss(e)?4:Ls(e)?9007199254740991:Ns(e)?10:11:ci(28295,{value:e})}function ys(e,t){if(e===t)return!0;const n=vs(e);if(n!==vs(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ls(e).isEqual(ls(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=$a(e.timestampValue),r=$a(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ts(e.bytesValue).isEqual(ts(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return es(e.geoPointValue.latitude)===es(t.geoPointValue.latitude)&&es(e.geoPointValue.longitude)===es(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return es(e.integerValue)===es(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=es(e.doubleValue),r=es(t.doubleValue);return n===r?da(n)===da(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Pi(e.arrayValue.values||[],t.arrayValue.values||[],ys);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Va(n)!==Va(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ys(n[i],r[i])))return!1;return!0}(e,t);default:return ci(52216,{left:e})}}function _s(e,t){return void 0!==(e.values||[]).find(e=>ys(e,t))}function bs(e,t){if(e===t)return 0;const n=vs(e),r=vs(t);if(n!==r)return Mi(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Mi(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=es(e.integerValue||e.doubleValue),r=es(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ss(e.timestampValue,t.timestampValue);case 4:return Ss(ls(e),ls(t));case 5:return Ci(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ts(e),r=ts(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Mi(n[i],r[i]);if(0!==e)return e}return Mi(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Mi(es(e.latitude),es(t.latitude));return 0!==n?n:Mi(es(e.longitude),es(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return xs(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,a;const s=e.fields||{},o=t.fields||{},l=null===(n=s[gs])||void 0===n?void 0:n.arrayValue,c=null===(r=o[gs])||void 0===r?void 0:r.arrayValue,u=Mi((null===l||void 0===l||null===(i=l.values)||void 0===i?void 0:i.length)||0,(null===c||void 0===c||null===(a=c.values)||void 0===a?void 0:a.length)||0);return 0!==u?u:xs(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ps.mapValue&&t===ps.mapValue)return 0;if(e===ps.mapValue)return 1;if(t===ps.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let s=0;s<r.length&&s<a.length;++s){const e=Ci(r[s],a[s]);if(0!==e)return e;const t=bs(n[r[s]],i[a[s]]);if(0!==t)return t}return Mi(r.length,a.length)}(e.mapValue,t.mapValue);default:throw ci(23264,{he:n})}}function Ss(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Mi(e,t);const n=$a(e),r=$a(t),i=Mi(n.seconds,r.seconds);return 0!==i?i:Mi(n.nanos,r.nanos)}function xs(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=bs(n[i],r[i]);if(e)return e}return Mi(n.length,r.length)}function ws(e){return Es(e)}function Es(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=$a(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ts(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Ui.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Es(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Es(e.fields[i]));return n+"}"}(e.mapValue):ci(61005,{value:e})}function Ts(e){switch(vs(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=os(e);return t?16+Ts(t):16;case 5:return 2*e.stringValue.length;case 6:return ts(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Ts(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return Ha(e.fields,(e,n)=>{t+=e.length+Ts(n)}),t}(e.mapValue);default:throw ci(13486,{value:e})}}function Ms(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Cs(e){return!!e&&"integerValue"in e}function As(e){return!!e&&"arrayValue"in e}function Is(e){return!!e&&"nullValue"in e}function Rs(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ps(e){return!!e&&"mapValue"in e}function Ns(e){var t,n;return(null===(t=((null===e||void 0===e||null===(n=e.mapValue)||void 0===n?void 0:n.fields)||{})[ds])||void 0===t?void 0:t.stringValue)===ms}function ks(e){if(e.geoPointValue)return{geoPointValue:d({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:d({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ha(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=ks(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ks(e.arrayValue.values[n]);return t}return d({},e)}function Ls(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===fs}class Ds{constructor(e){this.value=e}static empty(){return new Ds({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ps(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ks(t)}setAll(e){let t=Oi.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=ks(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Ps(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ys(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ps(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ha(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Ds(ks(this.value))}}function Os(e){const t=[];return Ha(e.fields,(e,n)=>{const r=new Oi([e]);if(Ps(n)){const e=Os(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Ka(t)}class Us{constructor(e,t,n,r,i,a,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=s}static newInvalidDocument(e){return new Us(e,0,Ji.min(),Ji.min(),Ji.min(),Ds.empty(),0)}static newFoundDocument(e,t,n,r){return new Us(e,1,t,Ji.min(),n,r,0)}static newNoDocument(e,t){return new Us(e,2,t,Ji.min(),Ji.min(),Ds.empty(),0)}static newUnknownDocument(e,t){return new Us(e,3,t,Ji.min(),Ji.min(),Ds.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ji.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ds.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ds.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ji.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Us&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Us(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Fs{constructor(e,t){this.position=e,this.inclusive=t}}function zs(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const a=t[i],s=e.position[i];if(r=a.field.isKeyField()?Ui.comparator(Ui.fromName(s.referenceValue),n.key):bs(s,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function Bs(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ys(e.position[n],t.position[n]))return!1;return!0}class Vs{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Hs(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class js{}class Gs extends js{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Zs(e,t,n):"array-contains"===t?new no(e,n):"in"===t?new ro(e,n):"not-in"===t?new io(e,n):"array-contains-any"===t?new ao(e,n):new Gs(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new $s(e,n):new eo(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(bs(t,this.value)):null!==t&&vs(this.value)===vs(t)&&this.matchesComparison(bs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ci(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ws extends js{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ws(e,t)}matches(e){return qs(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qs(e){return"and"===e.op}function Xs(e){return Ys(e)&&qs(e)}function Ys(e){for(const t of e.filters)if(t instanceof Ws)return!1;return!0}function Ks(e){if(e instanceof Gs)return e.field.canonicalString()+e.op.toString()+ws(e.value);if(Xs(e))return e.filters.map(e=>Ks(e)).join(",");{const t=e.filters.map(e=>Ks(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Js(e,t){return e instanceof Gs?function(e,t){return t instanceof Gs&&e.op===t.op&&e.field.isEqual(t.field)&&ys(e.value,t.value)}(e,t):e instanceof Ws?function(e,t){return t instanceof Ws&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Js(n,t.filters[r]),!0)}(e,t):void ci(19439)}function Qs(e){return e instanceof Gs?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ws(e.value))}(e):e instanceof Ws?function(e){return e.op.toString()+" {"+e.getFilters().map(Qs).join(" ,")+"}"}(e):"Filter"}class Zs extends Gs{constructor(e,t,n){super(e,t,n),this.key=Ui.fromName(n.referenceValue)}matches(e){const t=Ui.comparator(e.key,this.key);return this.matchesComparison(t)}}class $s extends Gs{constructor(e,t){super(e,"in",t),this.keys=to("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class eo extends Gs{constructor(e,t){super(e,"not-in",t),this.keys=to("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function to(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>Ui.fromName(e.referenceValue))}class no extends Gs{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return As(t)&&_s(t.arrayValue,this.value)}}class ro extends Gs{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&_s(this.value.arrayValue,t)}}class io extends Gs{constructor(e,t){super(e,"not-in",t)}matches(e){if(_s(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!_s(this.value.arrayValue,t)}}class ao extends Gs{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!As(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>_s(this.value.arrayValue,e))}}class so{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=s,this.Te=null}}function oo(e){return new so(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function lo(e){const t=di(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Ks(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),ha(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>ws(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>ws(e)).join(",")),t.Te=e}return t.Te}function co(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Hs(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Js(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Bs(e.startAt,t.startAt)&&Bs(e.endAt,t.endAt)}function uo(e){return Ui.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class ho{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=s,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function fo(e,t,n,r,i,a,s,o){return new ho(e,t,n,r,i,a,s,o)}function po(e){return new ho(e)}function mo(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function go(e){return null!==e.collectionGroup}function vo(e){const t=di(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Xa(Oi.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Vs(r,n))}),e.has(Oi.keyField().canonicalString())||t.Ie.push(new Vs(Oi.keyField(),n))}return t.Ie}function yo(e){const t=di(e);return t.Ee||(t.Ee=_o(t,vo(e))),t.Ee}function _o(e,t){if("F"===e.limitType)return oo(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Vs(e.field,t)});const n=e.endAt?new Fs(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Fs(e.startAt.position,e.startAt.inclusive):null;return oo(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function bo(e,t){const n=e.filters.concat([t]);return new ho(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function So(e,t,n){return new ho(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function xo(e,t){return co(yo(e),yo(t))&&e.limitType===t.limitType}function wo(e){return"".concat(lo(yo(e)),"|lt:").concat(e.limitType)}function Eo(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Qs(e)).join(", "),"]")),ha(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>ws(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>ws(e)).join(",")),"Target(".concat(t,")")}(yo(e)),"; limitType=").concat(e.limitType,")")}function To(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ui.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of vo(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=zs(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,vo(e),t))&&!(e.endAt&&!function(e,t,n){const r=zs(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,vo(e),t))}(e,t)}function Mo(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Co(e){return(t,n)=>{let r=!1;for(const i of vo(e)){const e=Ao(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Ao(e,t,n){const r=e.field.isKeyField()?Ui.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?bs(r,i):ci(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ci(19790,{direction:e.dir})}}class Io{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ha(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return ja(this.inner)}size(){return this.innerSize}}const Ro=new Ga(Ui.comparator);function Po(){return Ro}const No=new Ga(Ui.comparator);function ko(){let e=No;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Lo(e){let t=No;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Do(){return Uo()}function Oo(){return Uo()}function Uo(){return new Io(e=>e.toString(),(e,t)=>e.isEqual(t))}const Fo=new Ga(Ui.comparator),zo=new Xa(Ui.comparator);function Bo(){let e=zo;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Vo=new Xa(Mi);function Ho(){return Vo}function jo(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:da(t)?"-0":t}}function Go(e){return{integerValue:""+e}}function Wo(e,t){return fa(t)?Go(t):jo(e,t)}class qo{constructor(){this._=void 0}}function Xo(e,t,n){return e instanceof Jo?function(e,t){const n={fields:{[rs]:{stringValue:ns},[as]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ss(t)&&(t=os(t)),t&&(n.fields[is]=t),{mapValue:n}}(n,t):e instanceof Qo?Zo(e,t):e instanceof $o?el(e,t):function(e,t){const n=Ko(e,t),r=nl(n)+nl(e.Ae);return Cs(n)&&Cs(e.Ae)?Go(r):jo(e.serializer,r)}(e,t)}function Yo(e,t,n){return e instanceof Qo?Zo(e,t):e instanceof $o?el(e,t):n}function Ko(e,t){return e instanceof tl?function(e){return Cs(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Jo extends qo{}class Qo extends qo{constructor(e){super(),this.elements=e}}function Zo(e,t){const n=rl(t);for(const r of e.elements)n.some(e=>ys(e,r))||n.push(r);return{arrayValue:{values:n}}}class $o extends qo{constructor(e){super(),this.elements=e}}function el(e,t){let n=rl(t);for(const r of e.elements)n=n.filter(e=>!ys(e,r));return{arrayValue:{values:n}}}class tl extends qo{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function nl(e){return es(e.integerValue||e.doubleValue)}function rl(e){return As(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class il{constructor(e,t){this.version=e,this.transformResults=t}}class al{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new al}static exists(e){return new al(void 0,e)}static updateTime(e){return new al(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sl(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class ol{}function ll(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new yl(e.key,al.none()):new fl(e.key,e.data,al.none());{const n=e.data,r=Ds.empty();let i=new Xa(Oi.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new pl(e.key,r,new Ka(i.toArray()),al.none())}}function cl(e,t,n){e instanceof fl?function(e,t,n){const r=e.value.clone(),i=gl(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof pl?function(e,t,n){if(!sl(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=gl(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(ml(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ul(e,t,n,r){return e instanceof fl?function(e,t,n,r){if(!sl(e.precondition,t))return n;const i=e.value.clone(),a=vl(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof pl?function(e,t,n,r){if(!sl(e.precondition,t))return n;const i=vl(e.fieldTransforms,r,t),a=t.data;return a.setAll(ml(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return sl(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function hl(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ko(r.transform,e||null);null!=i&&(null===n&&(n=Ds.empty()),n.set(r.field,i))}return n||null}function dl(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Pi(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Qo&&t instanceof Qo||e instanceof $o&&t instanceof $o?Pi(e.elements,t.elements,ys):e instanceof tl&&t instanceof tl?ys(e.Ae,t.Ae):e instanceof Jo&&t instanceof Jo}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class fl extends ol{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class pl extends ol{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ml(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function gl(e,t,n){const r=new Map;hi(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const a=e[i],s=a.transform,o=t.data.field(a.field);r.set(a.field,Yo(s,o,n[i]))}return r}function vl(e,t,n){const r=new Map;for(const i of e){const e=i.transform,a=n.data.field(i.field);r.set(i.field,Xo(e,a,t))}return r}class yl extends ol{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _l extends ol{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class bl{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&cl(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ul(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ul(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Oo();return this.mutations.forEach(r=>{const i=e.get(r.key),a=i.overlayedDocument;let s=this.applyToLocalView(a,i.mutatedFields);s=t.has(r.key)?null:s;const o=ll(a,s);null!==o&&n.set(r.key,o),a.isValidDocument()||a.convertToNoDocument(Ji.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Bo())}isEqual(e){return this.batchId===e.batchId&&Pi(this.mutations,e.mutations,(e,t)=>dl(e,t))&&Pi(this.baseMutations,e.baseMutations,(e,t)=>dl(e,t))}}class Sl{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){hi(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Fo;const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,n[a].version);return new Sl(e,t,n,r)}}class xl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class wl{constructor(e,t){this.count=e,this.unchangedNames=t}}var El,Tl;function Ml(e){switch(e){case fi.OK:return ci(64938);case fi.CANCELLED:case fi.UNKNOWN:case fi.DEADLINE_EXCEEDED:case fi.RESOURCE_EXHAUSTED:case fi.INTERNAL:case fi.UNAVAILABLE:case fi.UNAUTHENTICATED:return!1;case fi.INVALID_ARGUMENT:case fi.NOT_FOUND:case fi.ALREADY_EXISTS:case fi.PERMISSION_DENIED:case fi.FAILED_PRECONDITION:case fi.ABORTED:case fi.OUT_OF_RANGE:case fi.UNIMPLEMENTED:case fi.DATA_LOSS:return!0;default:return ci(15467,{code:e})}}function Cl(e){if(void 0===e)return si("GRPC error has no .code"),fi.UNKNOWN;switch(e){case El.OK:return fi.OK;case El.CANCELLED:return fi.CANCELLED;case El.UNKNOWN:return fi.UNKNOWN;case El.DEADLINE_EXCEEDED:return fi.DEADLINE_EXCEEDED;case El.RESOURCE_EXHAUSTED:return fi.RESOURCE_EXHAUSTED;case El.INTERNAL:return fi.INTERNAL;case El.UNAVAILABLE:return fi.UNAVAILABLE;case El.UNAUTHENTICATED:return fi.UNAUTHENTICATED;case El.INVALID_ARGUMENT:return fi.INVALID_ARGUMENT;case El.NOT_FOUND:return fi.NOT_FOUND;case El.ALREADY_EXISTS:return fi.ALREADY_EXISTS;case El.PERMISSION_DENIED:return fi.PERMISSION_DENIED;case El.FAILED_PRECONDITION:return fi.FAILED_PRECONDITION;case El.ABORTED:return fi.ABORTED;case El.OUT_OF_RANGE:return fi.OUT_OF_RANGE;case El.UNIMPLEMENTED:return fi.UNIMPLEMENTED;case El.DATA_LOSS:return fi.DATA_LOSS;default:return ci(39323,{code:e})}}(Tl=El||(El={}))[Tl.OK=0]="OK",Tl[Tl.CANCELLED=1]="CANCELLED",Tl[Tl.UNKNOWN=2]="UNKNOWN",Tl[Tl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Tl[Tl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Tl[Tl.NOT_FOUND=5]="NOT_FOUND",Tl[Tl.ALREADY_EXISTS=6]="ALREADY_EXISTS",Tl[Tl.PERMISSION_DENIED=7]="PERMISSION_DENIED",Tl[Tl.UNAUTHENTICATED=16]="UNAUTHENTICATED",Tl[Tl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Tl[Tl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Tl[Tl.ABORTED=10]="ABORTED",Tl[Tl.OUT_OF_RANGE=11]="OUT_OF_RANGE",Tl[Tl.UNIMPLEMENTED=12]="UNIMPLEMENTED",Tl[Tl.INTERNAL=13]="INTERNAL",Tl[Tl.UNAVAILABLE=14]="UNAVAILABLE",Tl[Tl.DATA_LOSS=15]="DATA_LOSS";let Al=null;function Il(){return new TextEncoder}const Rl=new zr([4294967295,4294967295],0);function Pl(e){const t=Il().encode(e),n=new Br;return n.update(t),new Uint8Array(n.digest())}function Nl(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new zr([n,r],0),new zr([i,a],0)]}class kl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ll("Invalid padding: ".concat(t));if(n<0)throw new Ll("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Ll("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Ll("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=zr.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(zr.fromNumber(n)));return 1===r.compare(Rl)&&(r=new zr([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Pl(e),[n,r]=Nl(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new kl(i,r,t);return n.forEach(e=>a.insert(e)),a}insert(e){if(0===this.ge)return;const t=Pl(e),[n,r]=Nl(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ll extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Dl{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Ol.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Dl(Ji.min(),r,new Ga(Mi),Po(),Bo())}}class Ol{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Ol(n,t,Bo(),Bo(),Bo())}}class Ul{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Fl{constructor(e,t){this.targetId=e,this.Ce=t}}class zl{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qa.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Bl{constructor(){this.ve=0,this.Fe=jl(),this.Me=Qa.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Bo(),t=Bo(),n=Bo();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ci(38017,{changeType:i})}}),new Ol(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=jl()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,hi(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Vl{constructor(e){this.Ge=e,this.ze=new Map,this.je=Po(),this.Je=Hl(),this.He=Hl(),this.Ye=new Ga(Mi)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:ci(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const a=r.target;if(uo(a))if(0===n){const e=new Ui(a.path);this.et(t,e,Us.newNoDocument(e,Ji.min()))}else hi(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){var i;const n=this.ut(e),a=n?this.ct(n,e,r):1;if(0!==a){this.it(t);const e=2===a?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(i=Al)||void 0===i||i.lt(function(e,t,n,r,i){var a,s,o,l,c;const u={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(u.bloomFilter={applied:0===i,hashCount:null!==(a=null===h||void 0===h?void 0:h.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(s=null===h||void 0===h||null===(o=h.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==s?s:0,padding:null!==(l=null===h||void 0===h||null===(c=h.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===r||void 0===r?void 0:r.mightContain(e))&&void 0!==t&&t}}),u}(r,e.Ce,this.Ge.ht(),n,a))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let a,s;try{a=ts(n).toUint8Array()}catch(e){if(e instanceof Ja)return oi("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new kl(a,r,i)}catch(e){return oi(e instanceof Ll?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.ge?null:s}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),a="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(a)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&uo(i.target)){const t=new Ui(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Us.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Bo();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Dl(e,t,this.Ye,this.je,n);return this.je=Po(),this.Je=Hl(),this.He=Hl(),this.Ye=new Ga(Mi),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Bl,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Xa(Mi),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Xa(Mi),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||ai("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Bl),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Hl(){return new Ga(Ui.comparator)}function jl(){return new Ga(Ui.comparator)}const Gl={asc:"ASCENDING",desc:"DESCENDING"},Wl={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ql={and:"AND",or:"OR"};class Xl{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Yl(e,t){return e.useProto3Json||ha(t)?t:{value:t}}function Kl(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Jl(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ql(e,t){return Kl(e,t.toTimestamp())}function Zl(e){return hi(!!e,49232),Ji.fromTimestamp(function(e){const t=$a(e);return new Ki(t.seconds,t.nanos)}(e))}function $l(e,t){return ec(e,t).canonicalString()}function ec(e,t){const n=function(e){return new Li(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function tc(e){const t=Li.fromString(e);return hi(Sc(t),10190,{key:t.toString()}),t}function nc(e,t){return $l(e.databaseId,t.path)}function rc(e,t){const n=tc(t);if(n.get(1)!==e.databaseId.projectId)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new pi(fi.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ui(oc(n))}function ic(e,t){return $l(e.databaseId,t)}function ac(e){const t=tc(e);return 4===t.length?Li.emptyPath():oc(t)}function sc(e){return new Li(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function oc(e){return hi(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function lc(e,t,n){return{name:nc(e,t),fields:n.value.mapValue.fields}}function cc(e,t){let n;if(t instanceof fl)n={update:lc(e,t.key,t.value)};else if(t instanceof yl)n={delete:nc(e,t.key)};else if(t instanceof pl)n={update:lc(e,t.key,t.data),updateMask:bc(t.fieldMask)};else{if(!(t instanceof _l))return ci(16599,{Vt:t.type});n={verify:nc(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Jo)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Qo)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof $o)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof tl)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw ci(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ql(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ci(27497)}(e,t.precondition)),n}function uc(e,t){return{documents:[ic(e,t.path)]}}function hc(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ic(e,i);const a=function(e){if(0!==e.length)return _c(Ws.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const s=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:vc(e.field),direction:pc(e.dir)}}(e))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Yl(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function dc(e){let t=ac(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){hi(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=fc(e);return t instanceof Ws&&Xs(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map(e=>function(e){return new Vs(yc(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,ha(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Fs(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Fs(n,t)}(n.endAt)),fo(t,i,s,a,o,"F",l,c)}function fc(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=yc(e.unaryFilter.field);return Gs.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=yc(e.unaryFilter.field);return Gs.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=yc(e.unaryFilter.field);return Gs.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=yc(e.unaryFilter.field);return Gs.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ci(61313);default:return ci(60726)}}(e):void 0!==e.fieldFilter?function(e){return Gs.create(yc(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ci(58110);default:return ci(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ws.create(e.compositeFilter.filters.map(e=>fc(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ci(1026)}}(e.compositeFilter.op))}(e):ci(30097,{filter:e})}function pc(e){return Gl[e]}function mc(e){return Wl[e]}function gc(e){return ql[e]}function vc(e){return{fieldPath:e.canonicalString()}}function yc(e){return Oi.fromServerFormat(e.fieldPath)}function _c(e){return e instanceof Gs?function(e){if("=="===e.op){if(Rs(e.value))return{unaryFilter:{field:vc(e.field),op:"IS_NAN"}};if(Is(e.value))return{unaryFilter:{field:vc(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Rs(e.value))return{unaryFilter:{field:vc(e.field),op:"IS_NOT_NAN"}};if(Is(e.value))return{unaryFilter:{field:vc(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vc(e.field),op:mc(e.op),value:e.value}}}(e):e instanceof Ws?function(e){const t=e.getFilters().map(e=>_c(e));return 1===t.length?t[0]:{compositeFilter:{op:gc(e.op),filters:t}}}(e):ci(54877,{filter:e})}function bc(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function Sc(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class xc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ji.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ji.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Qa.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new xc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class wc{constructor(e){this.yt=e}}function Ec(e){const t=dc({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?So(t,t.limit,"L"):t}class Tc{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(es(e.integerValue));else if("doubleValue"in e){const n=es(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),da(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=$a(n)),t.xt("".concat(n.seconds||"")),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(ts(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Ls(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Ns(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ci(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){var n;const r=e.fields||{};this.Ft(t,53);const i=gs,a=(null===(n=r[i].arrayValue)||void 0===n||null===(n=n.values)||void 0===n?void 0:n.length)||0;this.Ft(t,15),t.Mt(es(a)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ui.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Tc.Kt=new Tc;class Mc{constructor(){this.Cn=new Cc}addToCollectionParentIndex(e,t){return this.Cn.add(t),sa.resolve()}getCollectionParents(e,t){return sa.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return sa.resolve()}deleteFieldIndex(e,t){return sa.resolve()}deleteAllFieldIndexes(e){return sa.resolve()}createTargetIndexes(e,t){return sa.resolve()}getDocumentsMatchingTarget(e,t){return sa.resolve(null)}getIndexType(e,t){return sa.resolve(0)}getFieldIndexes(e,t){return sa.resolve([])}getNextCollectionGroupToUpdate(e){return sa.resolve(null)}getMinOffset(e,t){return sa.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return sa.resolve(ta.min())}updateCollectionGroup(e,t,n){return sa.resolve()}updateIndexEntries(e,t){return sa.resolve()}}class Cc{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Xa(Li.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Xa(Li.comparator)).toArray()}}new Uint8Array(0);const Ac={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ic=41943040;class Rc{static withCacheSize(e){return new Rc(e,Rc.DEFAULT_COLLECTION_PERCENTILE,Rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Rc.DEFAULT_COLLECTION_PERCENTILE=10,Rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rc.DEFAULT=new Rc(Ic,Rc.DEFAULT_COLLECTION_PERCENTILE,Rc.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rc.DISABLED=new Rc(-1,0,0);class Pc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Pc(0)}static cr(){return new Pc(-1)}}const Nc="LruGarbageCollector",kc=1048576;function Lc(e,t){let[n,r]=e,[i,a]=t;const s=Mi(n,i);return 0===s?Mi(r,a):s}class Dc{constructor(e){this.Ir=e,this.buffer=new Xa(Lc),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Lc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Oc{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){ai(Nc,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){la(e)?ai(Nc,"Ignoring IndexedDB error during garbage collection: ",e):await aa(e)}await this.Vr(3e5)})}}class Uc{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return sa.resolve(ca.ce);const n=new Dc(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ai("LruGarbageCollector","Garbage collection skipped; disabled"),sa.resolve(Ac)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ai("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(n," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),Ac):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,a,s,o,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(ai("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,s=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,o=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ii()<=gn.DEBUG&&ai("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(a-c,"ms\n\tDetermined least recently used ").concat(r," in ")+(s-a)+"ms\n"+"\tRemoved ".concat(i," targets in ")+(o-s)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(l-o)+"ms\n"+"Total Duration: ".concat(l-c,"ms")),sa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function Fc(e,t){return new Uc(e,t)}class zc{constructor(){this.changes=new Io(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Us.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?sa.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Bc{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vc{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&ul(n.mutation,e,Ka.empty(),Ki.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Bo()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bo();const r=Do();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=ko();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Do();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Bo()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Po();const a=Uo(),s=Uo();return t.forEach((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof pl)?i=i.insert(t.key,t):void 0!==s?(a.set(t.key,s.mutation.getFieldMask()),ul(s.mutation,t,s.mutation.getFieldMask(),Ki.now())):a.set(t.key,Ka.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>a.set(e,t)),t.forEach((e,t)=>{var n;return s.set(e,new Bc(t,null!==(n=a.get(e))&&void 0!==n?n:null))}),s))}recalculateAndSaveOverlays(e,t){const n=Uo();let r=new Ga((e,t)=>e-t),i=Bo();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const a=t.get(e);if(null===a)return;let s=n.get(e)||Ka.empty();s=i.applyToLocalView(a,s),n.set(e,s);const o=(r.get(i.batchId)||Bo()).add(e);r=r.insert(i.batchId,o)})}).next(()=>{const a=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=Oo();l.forEach(e=>{if(!i.has(e)){const r=ll(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),a.push(this.documentOverlayCache.saveOverlays(e,o,c))}return sa.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Ui.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):go(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):sa.resolve(Do());let s=Qi,o=i;return a.next(t=>sa.forEach(t,(t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?sa.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,o,t,Bo())).next(e=>({batchId:s,changes:Lo(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ui(t)).next(e=>{let t=ko();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let a=ko();return this.indexManager.getCollectionParents(e,i).next(s=>sa.forEach(s,s=>{const o=function(e,t){return new ho(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next(e=>{e.forEach((e,t)=>{a=a.insert(e,t)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Us.newInvalidDocument(r)))});let n=ko();return e.forEach((e,r)=>{const a=i.get(e);void 0!==a&&ul(a.mutation,r,Ka.empty(),Ki.now()),To(t,r)&&(n=n.insert(e,r))}),n})}}class Hc{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return sa.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Zl(e.createTime)}}(t)),sa.resolve()}getNamedQuery(e,t){return sa.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Ec(e.bundledQuery),readTime:Zl(e.readTime)}}(t)),sa.resolve()}}class jc{constructor(){this.overlays=new Ga(Ui.comparator),this.qr=new Map}getOverlay(e,t){return sa.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Do();return sa.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),sa.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),sa.resolve()}getOverlaysForCollection(e,t,n){const r=Do(),i=t.length+1,a=new Ui(t.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const e=s.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return sa.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ga((e,t)=>e-t);const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Do(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=Do(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>s.set(e,t)),!(s.size()>=r)););return sa.resolve(s)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new xl(t,n));let i=this.qr.get(t);void 0===i&&(i=Bo(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Gc{constructor(){this.sessionToken=Qa.EMPTY_BYTE_STRING}getSessionToken(e){return sa.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,sa.resolve()}}class Wc{constructor(){this.Qr=new Xa(qc.$r),this.Ur=new Xa(qc.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new qc(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new qc(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Ui(new Li([])),n=new qc(t,e),r=new qc(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ui(new Li([])),n=new qc(t,e),r=new qc(t,e+1);let i=Bo();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new qc(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class qc{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ui.comparator(e.key,t.key)||Mi(e.Yr,t.Yr)}static Kr(e,t){return Mi(e.Yr,t.Yr)||Ui.comparator(e.key,t.key)}}class Xc{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Xa(qc.$r)}checkEmpty(e){return sa.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new bl(i,t,n,r);this.mutationQueue.push(a);for(const s of r)this.Zr=this.Zr.add(new qc(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return sa.resolve(a)}lookupMutationBatch(e,t){return sa.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return sa.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return sa.resolve(0===this.mutationQueue.length?ua:this.tr-1)}getAllMutationBatches(e){return sa.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new qc(t,0),r=new qc(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),sa.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Xa(Mi);return t.forEach(e=>{const t=new qc(e,0),r=new qc(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),sa.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Ui.isDocumentKey(i)||(i=i.child(""));const a=new qc(new Ui(i),0);let s=new Xa(Mi);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.Yr)),!0)},a),sa.resolve(this.ti(s))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){hi(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return sa.forEach(t.mutations,r=>{const i=new qc(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new qc(t,0),r=this.Zr.firstAfterOrEqual(n);return sa.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,sa.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Yc{constructor(e){this.ri=e,this.docs=new Ga(Ui.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return sa.resolve(n?n.document.mutableCopy():Us.newInvalidDocument(t))}getEntries(e,t){let n=Po();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Us.newInvalidDocument(e))}),sa.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Po();const a=t.path,s=new Ui(a.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||na(ea(s),n)<=0||(r.has(s.key)||To(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return sa.resolve(i)}getAllFromCollectionGroup(e,t,n,r){ci(9500)}ii(e,t){return sa.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Kc(this)}getSize(e){return sa.resolve(this.size)}}class Kc extends zc{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),sa.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Jc{constructor(e){this.persistence=e,this.si=new Io(e=>lo(e),co),this.lastRemoteSnapshotVersion=Ji.min(),this.highestTargetId=0,this.oi=0,this._i=new Wc,this.targetCount=0,this.ai=Pc.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),sa.resolve()}getLastRemoteSnapshotVersion(e){return sa.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return sa.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),sa.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),sa.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Pc(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,sa.resolve()}updateTargetData(e,t){return this.Pr(t),sa.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,sa.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((a,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)}),sa.waitFor(i).next(()=>r)}getTargetCount(e){return sa.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return sa.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),sa.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),sa.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),sa.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return sa.resolve(n)}containsKey(e,t){return sa.resolve(this._i.containsKey(t))}}class Qc{constructor(e,t){this.ui={},this.overlays={},this.ci=new ca(0),this.li=!1,this.li=!0,this.hi=new Gc,this.referenceDelegate=e(this),this.Pi=new Jc(this),this.indexManager=new Mc,this.remoteDocumentCache=function(e){return new Yc(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new wc(t),this.Ii=new Hc(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new jc,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Xc(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){ai("MemoryPersistence","Starting transaction:",e);const r=new Zc(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return sa.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Zc extends ia{constructor(e){super(),this.currentSequenceNumber=e}}class $c{constructor(e){this.persistence=e,this.Ri=new Wc,this.Vi=null}static mi(e){return new $c(e)}get fi(){if(this.Vi)return this.Vi;throw ci(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),sa.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),sa.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),sa.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return sa.forEach(this.fi,n=>{const r=Ui.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Ji.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return sa.or([()=>sa.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class eu{constructor(e,t){this.persistence=e,this.pi=new Io(e=>ma(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Fc(this,t)}static mi(e,t){return new eu(e,t)}Ei(){}di(e){return sa.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return sa.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?sa.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,Ji.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),sa.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),sa.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),sa.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),sa.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ts(e.data.value)),t}br(e,t,n){return sa.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return sa.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tu{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Bo(),r=Bo();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new tu(e,t.fromCache,n,r)}}class nu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ru{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=Qt()?8:oa(Kt())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new nu;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(ii()<=gn.DEBUG&&ai("QueryEngine","SDK will not create cache indexes for query:",Eo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),sa.resolve()):(ii()<=gn.DEBUG&&ai("QueryEngine","Query:",Eo(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(ii()<=gn.DEBUG&&ai("QueryEngine","The SDK decides to create cache indexes for query:",Eo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yo(t))):sa.resolve())}ys(e,t){if(mo(t))return sa.resolve(null);let n=yo(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=So(t,null,"F"),n=yo(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Bo(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const a=this.Ds(t,r);return this.Cs(t,a,i,n.readTime)?this.ys(e,So(t,null,"F")):this.vs(e,a,t,n)}))})))}ws(e,t,n,r){return mo(t)||r.isEqual(Ji.min())?sa.resolve(null):this.ps.getDocuments(e,n).next(i=>{const a=this.Ds(t,i);return this.Cs(t,a,n,r)?sa.resolve(null):(ii()<=gn.DEBUG&&ai("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Eo(t)),this.vs(e,a,t,$i(r,Qi)).next(e=>e))})}Ds(e,t){let n=new Xa(Co(e));return t.forEach((t,r)=>{To(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return ii()<=gn.DEBUG&&ai("QueryEngine","Using full collection scan to execute query:",Eo(t)),this.ps.getDocumentsMatchingQuery(e,t,ta.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const iu="LocalStore";class au{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Ga(Mi),this.xs=new Io(e=>lo(e),co),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vc(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function su(e,t,n,r){return new au(e,t,n,r)}async function ou(e,t){const n=di(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],a=[];let s=Bo();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:a}))})})}function lu(e){const t=di(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function cu(e,t,n){let r=Bo(),i=Bo();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Po();return n.forEach((n,a)=>{const s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Ji.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):ai(iu,"Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)}),{ks:r,qs:i}})}function uu(e,t){const n=di(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=ua),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function hu(e,t){const n=di(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,sa.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new xc(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function du(e,t,n){const r=di(e),i=r.Ms.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!la(e))throw e;ai(iu,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function fu(e,t,n){const r=di(e);let i=Ji.min(),a=Bo();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=di(e),i=r.xs.get(n);return void 0!==i?sa.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,yo(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{a=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:Ji.min(),n?a:Bo())).next(e=>(pu(r,Mo(t),e),{documents:e,Qs:a})))}function pu(e,t,n){let r=e.Os.get(t)||Ji.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class mu{constructor(){this.activeTargetIds=Ho()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gu{constructor(){this.Mo=new mu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new mu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vu{Oo(e){}shutdown(){}}const yu="ConnectivityMonitor";class _u{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ai(yu,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ai(yu,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let bu=null;function Su(){return null===bu?bu=268435456+Math.round(2147483648*Math.random()):bu++,"0x"+bu.toString(16)}const xu="RestConnection",wu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Eu{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(n,"/databases/").concat(r),this.Wo=this.databaseId.database===us?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}Go(e,t,n,r,i){const a=Su(),s=this.zo(e,t.toUriEncodedString());ai(xu,"Sending RPC '".concat(e,"' ").concat(a,":"),s,n);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,r,i);const{host:l}=new URL(s),c=jt(l);return this.Jo(e,s,o,n,c).then(t=>(ai(xu,"Received RPC '".concat(e,"' ").concat(a,": "),t),t),t=>{throw oi(xu,"RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",s,"request:",n),t})}Ho(e,t,n,r,i,a){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ni,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=wu[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(n)}terminate(){}}class Tu{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Mu="WebChannelConnection";class Cu extends Eu{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const a=Su();return new Promise((i,s)=>{const o=new jr;o.setWithCredentials(!0),o.listenOnce(Wr.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case qr.NO_ERROR:const n=o.getResponseJson();ai(Mu,"XHR for RPC '".concat(e,"' ").concat(a," received:"),JSON.stringify(n)),i(n);break;case qr.TIMEOUT:ai(Mu,"RPC '".concat(e,"' ").concat(a," timed out")),s(new pi(fi.DEADLINE_EXCEEDED,"Request time out"));break;case qr.HTTP_ERROR:const r=o.getStatus();if(ai(Mu,"RPC '".concat(e,"' ").concat(a," failed with status:"),r,"response text:",o.getResponseText()),r>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(fi).indexOf(t)>=0?t:fi.UNKNOWN}(n.status);s(new pi(e,n.message))}else s(new pi(fi.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new pi(fi.UNAVAILABLE,"Connection failed."));break;default:ci(9055,{l_:e,streamId:a,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{ai(Mu,"RPC '".concat(e,"' ").concat(a," completed."))}});const l=JSON.stringify(r);ai(Mu,"RPC '".concat(e,"' ").concat(a," sending request:"),r),o.send(t,"POST",l,n,15)})}T_(e,t,n){const r=Su(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Jr(),s=Kr(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");ai(Mu,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=a.createWebChannel(c,o);this.I_(u);let h=!1,d=!1;const f=new Tu({Yo:t=>{d?ai(Mu,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(ai(Mu,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),ai(Mu,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Gr.EventType.OPEN,()=>{d||(ai(Mu,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.o_())}),p(u,Gr.EventType.CLOSE,()=>{d||(d=!0,ai(Mu,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.a_(),this.E_(u))}),p(u,Gr.EventType.ERROR,t=>{d||(d=!0,oi(Mu,"RPC '".concat(e,"' stream ").concat(r," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new pi(fi.UNAVAILABLE,"The operation could not be completed")))}),p(u,Gr.EventType.MESSAGE,t=>{if(!d){var n;const i=t.data[0];hi(!!i,16349);const a=i,s=(null===a||void 0===a?void 0:a.error)||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){ai(Mu,"RPC '".concat(e,"' stream ").concat(r," received error:"),s);const t=s.status;let n=function(e){const t=El[e];if(void 0!==t)return Cl(t)}(t),i=s.message;void 0===n&&(n=fi.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),d=!0,f.a_(new pi(n,i)),u.close()}else ai(Mu,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.u_(i)}}),p(s,Yr.STAT_EVENT,t=>{t.stat===Xr.PROXY?ai(Mu,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Xr.NOPROXY&&ai(Mu,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Au(){return"undefined"!=typeof document?document:null}function Iu(e){return new Xl(e,!0)}class Ru{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&ai("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Pu="PersistentStream";class Nu{constructor(e,t,n,r,i,a,s,o){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ru(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===fi.RESOURCE_EXHAUSTED?(si(t.toString()),si("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===fi.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new pi(fi.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ai(Pu,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ai(Pu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class ku extends Nu{constructor(e,t,n,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:ci(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(hi(void 0===t||"string"==typeof t,58123),Qa.fromBase64String(t||"")):(hi(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Qa.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?fi.UNKNOWN:Cl(e.code);return new pi(t,e.message||"")}(s);n=new zl(r,i,a,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=rc(e,r.document.name),a=Zl(r.document.updateTime),s=r.document.createTime?Zl(r.document.createTime):Ji.min(),o=new Ds({mapValue:{fields:r.document.fields}}),l=Us.newFoundDocument(i,a,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Ul(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=rc(e,r.document),a=r.readTime?Zl(r.readTime):Ji.min(),s=Us.newNoDocument(i,a),o=r.removedTargetIds||[];n=new Ul([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=rc(e,r.document),a=r.removedTargetIds||[];n=new Ul([],a,i,null)}else{if(!("filter"in t))return ci(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,a=new wl(r,i),s=e.targetId;n=new Fl(s,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ji.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ji.min():t.readTime?Zl(t.readTime):Ji.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=sc(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=uo(r)?{documents:uc(e,r)}:{query:hc(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Jl(e,t.resumeToken);const r=Yl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ji.min())>0){n.readTime=Kl(e,t.snapshotVersion.toTimestamp());const r=Yl(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ci(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=sc(this.serializer),t.removeTarget=e,this.q_(t)}}class Lu extends Nu{constructor(e,t,n,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return hi(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,hi(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){hi(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(hi(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Zl(e.updateTime):Zl(t);return n.isEqual(Ji.min())&&(n=Zl(t)),new il(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Zl(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=sc(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>cc(this.serializer,e))};this.q_(t)}}class Du{}class Ou extends Du{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[a,s]=i;return this.connection.Go(e,ec(t,n),r,a,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===fi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new pi(fi.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(a=>{let[s,o]=a;return this.connection.Ho(e,ec(t,n),r,s,o,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===fi.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new pi(fi.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Uu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(si(t),this.aa=!1):ai("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Fu="RemoteStore";class zu{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Yu(this)&&(ai(Fu,"Restarting streams for network reachability change."),await async function(e){const t=di(e);t.Ea.add(4),await Vu(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Bu(t)}(this))})}),this.Ra=new Uu(n,r)}}async function Bu(e){if(Yu(e))for(const t of e.da)await t(!0)}async function Vu(e){for(const t of e.da)await t(!1)}function Hu(e,t){const n=di(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Xu(n)?qu(n):fh(n).O_()&&Gu(n,t))}function ju(e,t){const n=di(e),r=fh(n);n.Ia.delete(t),r.O_()&&Wu(n,t),0===n.Ia.size&&(r.O_()?r.L_():Yu(n)&&n.Ra.set("Unknown"))}function Gu(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ji.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}fh(e).Y_(t)}function Wu(e,t){e.Va.Ue(t),fh(e).Z_(t)}function qu(e){e.Va=new Vl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),fh(e).start(),e.Ra.ua()}function Xu(e){return Yu(e)&&!fh(e).x_()&&e.Ia.size>0}function Yu(e){return 0===di(e).Ea.size}function Ku(e){e.Va=void 0}async function Ju(e){e.Ra.set("Online")}async function Qu(e){e.Ia.forEach((t,n)=>{Gu(e,t)})}async function Zu(e,t){Ku(e),Xu(e)?(e.Ra.ha(t),qu(e)):e.Ra.set("Unknown")}async function $u(e,t,n){if(e.Ra.set("Online"),t instanceof zl&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){ai(Fu,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await eh(e,n)}else if(t instanceof Ul?e.Va.Ze(t):t instanceof Fl?e.Va.st(t):e.Va.tt(t),!n.isEqual(Ji.min()))try{const t=await lu(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Qa.EMPTY_BYTE_STRING,r.snapshotVersion)),Wu(e,t);const i=new xc(r.target,t,n,r.sequenceNumber);Gu(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){ai(Fu,"Failed to raise snapshot:",t),await eh(e,t)}}async function eh(e,t,n){if(!la(t))throw t;e.Ea.add(1),await Vu(e),e.Ra.set("Offline"),n||(n=()=>lu(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{ai(Fu,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Bu(e)})}function th(e,t){return t().catch(n=>eh(e,n,t))}async function nh(e){const t=di(e),n=ph(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ua;for(;rh(t);)try{const e=await uu(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,ih(t,e)}catch(e){await eh(t,e)}ah(t)&&sh(t)}function rh(e){return Yu(e)&&e.Ta.length<10}function ih(e,t){e.Ta.push(t);const n=ph(e);n.O_()&&n.X_&&n.ea(t.mutations)}function ah(e){return Yu(e)&&!ph(e).x_()&&e.Ta.length>0}function sh(e){ph(e).start()}async function oh(e){ph(e).ra()}async function lh(e){const t=ph(e);for(const n of e.Ta)t.ea(n.mutations)}async function ch(e,t,n){const r=e.Ta.shift(),i=Sl.from(r,t,n);await th(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await nh(e)}async function uh(e,t){t&&ph(e).X_&&await async function(e,t){if(function(e){return Ml(e)&&e!==fi.ABORTED}(t.code)){const n=e.Ta.shift();ph(e).B_(),await th(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await nh(e)}}(e,t),ah(e)&&sh(e)}async function hh(e,t){const n=di(e);n.asyncQueue.verifyOperationInProgress(),ai(Fu,"RemoteStore received new credentials");const r=Yu(n);n.Ea.add(3),await Vu(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Bu(n)}async function dh(e,t){const n=di(e);t?(n.Ea.delete(2),await Bu(n)):t||(n.Ea.add(2),await Vu(n),n.Ra.set("Unknown"))}function fh(e){return e.ma||(e.ma=function(e,t,n){const r=di(e);return r.sa(),new ku(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Ju.bind(null,e),t_:Qu.bind(null,e),r_:Zu.bind(null,e),H_:$u.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Xu(e)?qu(e):e.Ra.set("Unknown")):(await e.ma.stop(),Ku(e))})),e.ma}function ph(e){return e.fa||(e.fa=function(e,t,n){const r=di(e);return r.sa(),new Lu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:oh.bind(null,e),r_:uh.bind(null,e),ta:lh.bind(null,e),na:ch.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await nh(e)):(await e.fa.stop(),e.Ta.length>0&&(ai(Fu,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class mh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new mi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const a=Date.now()+n,s=new mh(e,t,a,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new pi(fi.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gh(e,t){if(si("AsyncQueue","".concat(t,": ").concat(e)),la(e))return new pi(fi.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class vh{static emptySet(e){return new vh(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ui.comparator(t.key,n.key):(e,t)=>Ui.comparator(e.key,t.key),this.keyedMap=ko(),this.sortedSet=new Ga(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof vh))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new vh;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class yh{constructor(){this.ga=new Ga(Ui.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ci(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class _h{constructor(e,t,n,r,i,a,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const a=[];return t.forEach(e=>{a.push({type:0,doc:e})}),new _h(e,t,vh.emptySet(t),a,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class bh{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Sh{constructor(){this.queries=xh(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=di(e),r=n.queries;n.queries=xh(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new pi(fi.ABORTED,"Firestore shutting down"))}}function xh(){return new Io(e=>wo(e),xo)}async function wh(e,t){const n=di(e);let r=3;const i=t.query;let a=n.queries.get(i);a?!a.ba()&&t.Da()&&(r=2):(a=new bh,r=t.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=gh(e,"Initialization of query '".concat(Eo(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,a),a.Sa.push(t),t.va(n.onlineState),a.wa&&t.Fa(a.wa)&&Ch(n)}async function Eh(e,t){const n=di(e),r=t.query;let i=3;const a=n.queries.get(r);if(a){const e=a.Sa.indexOf(t);e>=0&&(a.Sa.splice(e,1),0===a.Sa.length?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Th(e,t){const n=di(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Ch(n)}function Mh(e,t,n){const r=di(e),i=r.queries.get(t);if(i)for(const a of i.Sa)a.onError(n);r.queries.delete(t)}function Ch(e){e.Ca.forEach(e=>{e.next()})}var Ah,Ih;(Ih=Ah||(Ah={})).Ma="default",Ih.Cache="cache";class Rh{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new _h(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=_h.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ah.Cache}}class Ph{constructor(e){this.key=e}}class Nh{constructor(e){this.key=e}}class kh{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Bo(),this.mutatedKeys=Bo(),this.eu=Co(e),this.tu=new vh(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new yh,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=To(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.eu(u,o)>0||l&&this.eu(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(s=!0)),f&&(u?(a=a.add(u),i=d?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:a,iu:n,Cs:s,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const a=e.iu.ya();a.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ci(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=null!==r&&void 0!==r&&r;const s=t&&!r?this._u():[],o=0===this.Xa.size&&this.current&&!r?1:0,l=o!==this.Za;return this.Za=o,0!==a.length||l?{snapshot:new _h(this.query,e.tu,i,a,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:s}:{au:s}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new yh,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Bo(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Nh(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new Ph(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Bo();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return _h.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Lh="SyncEngine";class Dh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Oh{constructor(e){this.key=e,this.hu=!1}}class Uh{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new Io(e=>wo(e),xo),this.Iu=new Map,this.Eu=new Set,this.du=new Ga(Ui.comparator),this.Au=new Map,this.Ru=new Wc,this.Vu={},this.mu=new Map,this.fu=Pc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Fh(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ad(e);let i;const a=r.Tu.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await Bh(r,t,n,!0),i}async function zh(e,t){const n=ad(e);await Bh(n,t,!0,!1)}async function Bh(e,t,n,r){const i=await hu(e.localStore,yo(t)),a=i.targetId,s=e.sharedClientState.addLocalQueryTarget(a,n);let o;return r&&(o=await Vh(e,t,a,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&Hu(e.remoteStore,i),o}async function Vh(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await fu(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const a=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,a,s);return $h(e,t.targetId,o.au),o.snapshot}(e,t,n,r);const a=await fu(e.localStore,t,!0),s=new kh(t,a.Qs),o=s.ru(a.documents),l=Ol.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(o,e.isPrimaryClient,l);$h(e,n,c.au);const u=new Dh(t,n,s);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function Hh(e,t,n){const r=di(e),i=r.Tu.get(t),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter(e=>!xo(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await du(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ju(r.remoteStore,i.targetId),Qh(r,i.targetId)}).catch(aa)):(Qh(r,i.targetId),await du(r.localStore,i.targetId,!0))}async function jh(e,t){const n=di(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ju(n.remoteStore,r.targetId))}async function Gh(e,t){const n=di(e);try{const e=await function(e,t){const n=di(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const s=[];t.targetChanges.forEach((a,o)=>{const l=i.get(o);if(!l)return;s.push(n.Pi.removeMatchingKeys(e,a.removedDocuments,o).next(()=>n.Pi.addMatchingKeys(e,a.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Qa.EMPTY_BYTE_STRING,Ji.min()).withLastLimboFreeSnapshotVersion(Ji.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,a)&&s.push(n.Pi.updateTargetData(e,c))});let o=Po(),l=Bo();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),s.push(cu(e,a,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!r.isEqual(Ji.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));s.push(t)}return sa.waitFor(s).next(()=>a.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(hi(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?hi(r.hu,14607):e.removedDocuments.size>0&&(hi(r.hu,42227),r.hu=!1))}),await nd(n,e,t)}catch(e){await aa(e)}}function Wh(e,t,n){const r=di(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=di(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&Ch(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function qh(e,t,n){const r=di(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),a=i&&i.key;if(a){let e=new Ga(Ui.comparator);e=e.insert(a,Us.newNoDocument(a,Ji.min()));const n=Bo().add(a),i=new Dl(Ji.min(),new Map,new Ga(Mi),e,n);await Gh(r,i),r.du=r.du.remove(a),r.Au.delete(t),td(r)}else await du(r.localStore,t,!1).then(()=>Qh(r,t,n)).catch(aa)}async function Xh(e,t){const n=di(e),r=t.batch.batchId;try{const e=await function(e,t){const n=di(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,a=i.keys();let s=sa.resolve();return a.forEach(e=>{s=s.next(()=>r.getEntry(t,e)).next(t=>{const a=n.docVersions.get(e);hi(null!==a,48541),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),s.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Bo();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Jh(n,r,null),Kh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await nd(n,e)}catch(e){await aa(e)}}async function Yh(e,t,n){const r=di(e);try{const e=await function(e,t){const n=di(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(hi(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Jh(r,t,n),Kh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await nd(r,e)}catch(n){await aa(n)}}function Kh(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Jh(e,t,n){const r=di(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function Qh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Zh(e,t)})}function Zh(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(ju(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),td(e))}function $h(e,t,n){for(const r of n)r instanceof Ph?(e.Ru.addReference(r.key,t),ed(e,r)):r instanceof Nh?(ai(Lh,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Zh(e,r.key)):ci(19791,{wu:r})}function ed(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(ai(Lh,"New document in limbo: "+n),e.Eu.add(r),td(e))}function td(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Ui(Li.fromString(t)),r=e.fu.next();e.Au.set(r,new Oh(n)),e.du=e.du.insert(n,r),Hu(e.remoteStore,new xc(yo(po(n.path)),r,"TargetPurposeLimboResolution",ca.ce))}}async function nd(e,t,n){const r=di(e),i=[],a=[],s=[];r.Tu.isEmpty()||(r.Tu.forEach((e,o)=>{s.push(r.pu(o,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){var t;const i=e?!e.fromCache:null===n||void 0===n||null===(t=n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=tu.As(o.targetId,e);a.push(t)}}))}),await Promise.all(s),r.Pu.H_(i),await async function(e,t){const n=di(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>sa.forEach(t,t=>sa.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>sa.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!la(e))throw e;ai(iu,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,a))}async function rd(e,t){const n=di(e);if(!n.currentUser.isEqual(t)){ai(Lh,"User change. New user:",t.toKey());const e=await ou(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new pi(fi.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await nd(n,e.Ls)}}function id(e,t){const n=di(e),r=n.Au.get(t);if(r&&r.hu)return Bo().add(r.key);{let e=Bo();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function ad(e){const t=di(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Gh.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=id.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qh.bind(null,t),t.Pu.H_=Th.bind(null,t.eventManager),t.Pu.yu=Mh.bind(null,t.eventManager),t}function sd(e){const t=di(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Xh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Yh.bind(null,t),t}class od{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Iu(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return su(this.persistence,new ru,e.initialUser,this.serializer)}Cu(e){return new Qc($c.mi,this.serializer)}Du(e){return new gu}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}od.provider={build:()=>new od};class ld extends od{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){hi(this.persistence.referenceDelegate instanceof eu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Oc(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Rc.withCacheSize(this.cacheSizeBytes):Rc.DEFAULT;return new Qc(e=>eu.mi(e,t),this.serializer)}}class cd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Wh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=rd.bind(null,this.syncEngine),await dh(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Sh}createDatastore(e){const t=Iu(e.databaseInfo.databaseId),n=function(e){return new Cu(e)}(e.databaseInfo);return function(e,t,n,r){return new Ou(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new zu(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>Wh(this.syncEngine,e,0),_u.v()?new _u:new vu)}createSyncEngine(e,t){return function(e,t,n,r,i,a,s){const o=new Uh(e,t,n,r,i,a);return s&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=di(e);ai(Fu,"RemoteStore shutting down."),t.Ea.add(5),await Vu(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}cd.provider={build:()=>new cd};class ud{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):si("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const hd="FirestoreClient";class dd{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=ti.UNAUTHENTICATED,this.clientId=Ti.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{ai(hd,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(ai(hd,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=gh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function fd(e,t){e.asyncQueue.verifyOperationInProgress(),ai(hd,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await ou(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function pd(e,t){e.asyncQueue.verifyOperationInProgress();const n=await md(e);ai(hd,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>hh(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>hh(t.remoteStore,n)),e._onlineComponents=t}async function md(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ai(hd,"Using user provided OfflineComponentProvider");try{await fd(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===fi.FAILED_PRECONDITION||e.code===fi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;oi("Error using user provided cache. Falling back to memory cache: "+n),await fd(e,new od)}}else ai(hd,"Using default OfflineComponentProvider"),await fd(e,new ld(void 0));return e._offlineComponents}async function gd(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ai(hd,"Using user provided OnlineComponentProvider"),await pd(e,e._uninitializedComponentsProvider._online)):(ai(hd,"Using default OnlineComponentProvider"),await pd(e,new cd))),e._onlineComponents}function vd(e){return gd(e).then(e=>e.syncEngine)}async function yd(e){const t=await gd(e),n=t.eventManager;return n.onListen=Fh.bind(null,t.syncEngine),n.onUnlisten=Hh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=zh.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=jh.bind(null,t.syncEngine),n}function _d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new mi;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const a=new ud({next:n=>{a.Nu(),t.enqueueAndForget(()=>Eh(e,s)),n.fromCache&&"server"===r.source?i.reject(new pi(fi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Rh(n,a,{includeMetadataChanges:!0,qa:!0});return wh(e,s)}(await yd(e),e.asyncQueue,t,n,r)),r.promise}function bd(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Sd=new Map,xd="firestore.googleapis.com",wd=!0;class Ed{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new pi(fi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=xd,this.ssl=wd}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:wd;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Ic;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<kc)throw new pi(fi.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new pi(fi.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bd(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new pi(fi.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new pi(fi.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new pi(fi.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Td{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ed({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pi(fi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new pi(fi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ed(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new vi;switch(e.type){case"firstParty":return new Si(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new pi(fi.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Sd.get(e);t&&(ai("ComponentProvider","Removing Datastore"),Sd.delete(e),t.terminate())}(this),Promise.resolve()}}class Md{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Md(this.firestore,e,this._query)}}class Cd{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ad(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cd(this.firestore,e,this._key)}toJSON(){return{type:Cd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(qi(t,Cd._jsonSchema))return new Cd(e,n||null,new Ui(Li.fromString(t.referencePath)))}}Cd._jsonSchemaVersion="firestore/documentReference/1.0",Cd._jsonSchema={type:Wi("string",Cd._jsonSchemaVersion),referencePath:Wi("string")};class Ad extends Md{constructor(e,t,n){super(e,t,po(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cd(this.firestore,null,new Ui(e))}withConverter(e){return new Ad(this.firestore,e,this._path)}}function Id(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=un(e),Fi("collection","path",t),e instanceof Td){const n=Li.fromString(t,...r);return Bi(n),new Ad(e,null,n)}{if(!(e instanceof Cd||e instanceof Ad))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Li.fromString(t,...r));return Bi(n),new Ad(e.firestore,null,n)}}function Rd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=un(e),1===arguments.length&&(t=Ti.newId()),Fi("doc","path",t),e instanceof Td){const n=Li.fromString(t,...r);return zi(n),new Cd(e,null,new Ui(n))}{if(!(e instanceof Cd||e instanceof Ad))throw new pi(fi.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Li.fromString(t,...r));return zi(n),new Cd(e.firestore,e instanceof Ad?e.converter:null,new Ui(n))}}const Pd="AsyncQueue";class Nd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ru(this,"async_queue_retry"),this._c=()=>{const e=Au();e&&ai(Pd,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Au();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Au();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new mi;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(cU){if(!la(cU))throw cU;ai(Pd,"Operation failed with retryable error: "+cU)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,si("INTERNAL UNHANDLED ERROR: ",kd(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=mh.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&ci(47125,{Pc:kd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function kd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class Ld extends Td{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Nd,this._persistenceKey=(null===r||void 0===r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nd(e),this._firestoreClient=void 0,await e}}}function Dd(e){if(e._terminated)throw new pi(fi.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Od(e),e._firestoreClient}function Od(e){var t,n,r;const i=e._freezeSettings(),a=function(e,t,n,r){return new cs(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bd(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||null!==(n=i.localCache)&&void 0!==n&&n._offlineComponentProvider&&null!==(r=i.localCache)&&void 0!==r&&r._onlineComponentProvider&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new dd(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Ud{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ud(Qa.fromBase64String(e))}catch(e){throw new pi(fi.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ud(Qa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Ud._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qi(e,Ud._jsonSchema))return Ud.fromBase64String(e.bytes)}}Ud._jsonSchemaVersion="firestore/bytes/1.0",Ud._jsonSchema={type:Wi("string",Ud._jsonSchemaVersion),bytes:Wi("string")};class Fd{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new pi(fi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oi(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zd{constructor(e){this._methodName=e}}class Bd{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new pi(fi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new pi(fi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Mi(this._lat,e._lat)||Mi(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Bd._jsonSchemaVersion}}static fromJSON(e){if(qi(e,Bd._jsonSchema))return new Bd(e.latitude,e.longitude)}}Bd._jsonSchemaVersion="firestore/geoPoint/1.0",Bd._jsonSchema={type:Wi("string",Bd._jsonSchemaVersion),latitude:Wi("number"),longitude:Wi("number")};class Vd{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Vd._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qi(e,Vd._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Vd(e.vectorValues);throw new pi(fi.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vd._jsonSchemaVersion="firestore/vectorValue/1.0",Vd._jsonSchema={type:Wi("string",Vd._jsonSchemaVersion),vectorValues:Wi("object")};const Hd=/^__.*__$/;class jd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new pl(e,this.data,this.fieldMask,t,this.fieldTransforms):new fl(e,this.data,t,this.fieldTransforms)}}class Gd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new pl(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Wd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ci(40011,{Ac:e})}}class qd{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qd(d(d({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.gc(e),r}yc(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Vc({path:n,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return lf(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Wd(this.Ac)&&Hd.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Xd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Iu(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new qd({Ac:e,methodName:t,Dc:n,path:Oi.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yd(e){const t=e._freezeSettings(),n=Iu(e._databaseId);return new Xd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Kd(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Cc(a.merge||a.mergeFields?2:0,t,n,i);rf("Data must be an object, but it was:",s,r);const o=tf(r,s);let l,c;if(a.merge)l=new Ka(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const i=af(t,r,n);if(!s.contains(i))throw new pi(fi.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));cf(e,i)||e.push(i)}l=new Ka(e),c=s.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=s.fieldTransforms;return new jd(new Ds(o),l,c)}class Jd extends zd{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Jd}}function Qd(e,t,n,r){const i=e.Cc(1,t,n);rf("Data must be an object, but it was:",i,r);const a=[],s=Ds.empty();Ha(r,(e,r)=>{const o=of(t,e,n);r=un(r);const l=i.yc(o);if(r instanceof Jd)a.push(o);else{const e=ef(r,l);null!=e&&(a.push(o),s.set(o,e))}});const o=new Ka(a);return new Gd(s,o,i.fieldTransforms)}function Zd(e,t,n,r,i,a){const s=e.Cc(1,t,n),o=[af(t,r,n)],l=[i];if(a.length%2!=0)throw new pi(fi.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<a.length;d+=2)o.push(af(t,a[d])),l.push(a[d+1]);const c=[],u=Ds.empty();for(let d=o.length-1;d>=0;--d)if(!cf(c,o[d])){const e=o[d];let t=l[d];t=un(t);const n=s.yc(e);if(t instanceof Jd)c.push(e);else{const r=ef(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Ka(c);return new Gd(u,h,s.fieldTransforms)}function $d(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return ef(n,e.Cc(r?4:3,t))}function ef(e,t){if(nf(e=un(e)))return rf("Unsupported field value:",t,e),tf(e,t);if(e instanceof zd)return function(e,t){if(!Wd(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=ef(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=un(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Wo(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ki.fromDate(e);return{timestampValue:Kl(t.serializer,n)}}if(e instanceof Ki){const n=new Ki(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Kl(t.serializer,n)}}if(e instanceof Bd)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ud)return{bytesValue:Jl(t.serializer,e._byteString)};if(e instanceof Cd){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:$l(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Vd)return function(e,t){return{mapValue:{fields:{[ds]:{stringValue:ms},[gs]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return jo(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(Hi(e)))}(e,t)}function tf(e,t){const n={};return ja(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ha(e,(e,r)=>{const i=ef(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function nf(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ki||e instanceof Bd||e instanceof Ud||e instanceof Cd||e instanceof zd||e instanceof Vd)}function rf(e,t,n){if(!nf(n)||!Vi(n)){const r=Hi(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function af(e,t,n){if((t=un(t))instanceof Fd)return t._internalPath;if("string"==typeof t)return of(e,t);throw lf("Field path arguments must be of type string or ",e,!1,void 0,n)}const sf=new RegExp("[~\\*/\\[\\]]");function of(e,t,n){if(t.search(sf)>=0)throw lf("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Fd(...t.split("."))._internalPath}catch(r){throw lf("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function lf(e,t,n,r,i){const a=r&&!r.isEmpty(),s=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=" in field ".concat(r)),s&&(l+=" in document ".concat(i)),l+=")"),new pi(fi.INVALID_ARGUMENT,o+e+l)}function cf(e,t){return e.some(e=>e.isEqual(t))}class uf{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Cd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new hf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(df("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class hf extends uf{data(){return super.data()}}function df(e,t){return"string"==typeof t?of(e,t):t instanceof Fd?t._internalPath:t._delegate._internalPath}function ff(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new pi(fi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class pf{}class mf extends pf{}function gf(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof pf&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof _f).length,n=e.filter(e=>e instanceof vf).length;if(t>1||t>0&&n>0)throw new pi(fi.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class vf extends mf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new vf(e,t,n)}_apply(e){const t=this._parse(e);return Ef(e._query,t),new Md(e.firestore,e.converter,bo(e._query,t))}_parse(e){const t=Yd(e.firestore),n=function(e,t,n,r,i,a,s){let o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){wf(s,a);const t=[];for(const n of s)t.push(xf(r,e,n));o={arrayValue:{values:t}}}else o=xf(r,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||wf(s,a),o=$d(n,t,s,"in"===a||"not-in"===a);return Gs.create(i,a,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function yf(e,t,n){const r=t,i=df("where",e);return vf._create(i,r,n)}class _f extends pf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _f(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Ws.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Ef(n,i),n=bo(n,i)}(e._query,t),new Md(e.firestore,e.converter,bo(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class bf extends mf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new bf(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vs(t,n)}(e._query,this._field,this._direction);return new Md(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ho(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Sf extends mf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Sf(e,t,n)}_apply(e){return new Md(e.firestore,e.converter,So(e._query,this._limit,this._limitType))}}function xf(e,t,n){if("string"==typeof(n=un(n))){if(""===n)throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!go(t)&&-1!==n.indexOf("/"))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(Li.fromString(n));if(!Ui.isDocumentKey(r))throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ms(e,new Ui(r))}if(n instanceof Cd)return Ms(e,n._key);throw new pi(fi.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Hi(n),"."))}function wf(e,t){if(!Array.isArray(e)||0===e.length)throw new pi(fi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Ef(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new pi(fi.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Tf{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(vs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return es(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ts(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ci(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Ha(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){var t;const n=null===(t=e.fields)||void 0===t||null===(t=t[gs].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>es(e.doubleValue));return new Vd(n)}convertGeoPoint(e){return new Bd(es(e.latitude),es(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=os(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ls(e));default:return null}}convertTimestamp(e){const t=$a(e);return new Ki(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Li.fromString(e);hi(Sc(n),9688,{name:e});const r=new hs(n.get(1),n.get(3)),i=new Ui(n.popFirst(5));return r.isEqual(t)||si("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Mf(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Cf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Af extends uf{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new If(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(df("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new pi(fi.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Af._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Af._jsonSchemaVersion="firestore/documentSnapshot/1.0",Af._jsonSchema={type:Wi("string",Af._jsonSchemaVersion),bundleSource:Wi("string","DocumentSnapshot"),bundleName:Wi("string"),bundle:Wi("string")};class If extends Af{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Rf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Cf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new If(this._firestore,this._userDataWriter,n.key,n,new Cf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new pi(fi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new If(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Cf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new If(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Cf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,a=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Pf(t.type),doc:r,oldIndex:i,newIndex:a}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new pi(fi.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Rf._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ti.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Pf(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ci(61501,{type:e})}}Rf._jsonSchemaVersion="firestore/querySnapshot/1.0",Rf._jsonSchema={type:Wi("string",Rf._jsonSchemaVersion),bundleSource:Wi("string","QuerySnapshot"),bundleName:Wi("string"),bundle:Wi("string")};class Nf extends Tf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ud(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Cd(this.firestore,null,t)}}function kf(e){e=ji(e,Md);const t=ji(e.firestore,Ld),n=Dd(t),r=new Nf(t);return ff(e._query),_d(n,e._query).then(n=>new Rf(t,r,e,n))}function Lf(e,t,n){e=ji(e,Cd);const r=ji(e.firestore,Ld),i=Yd(r);let a;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return a="string"==typeof(t=un(t))||t instanceof Fd?Zd(i,"updateDoc",e._key,t,n,o):Qd(i,"updateDoc",e._key,t),Uf(r,[a.toMutation(e._key,al.exists(!0))])}function Df(e){return Uf(ji(e.firestore,Ld),[new yl(e._key,al.none())])}function Of(e,t){const n=ji(e.firestore,Ld),r=Rd(e),i=Mf(e.converter,t);return Uf(n,[Kd(Yd(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,al.exists(!1))]).then(()=>r)}function Uf(e,t){return function(e,t){const n=new mi;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=sd(e);try{const e=await function(e,t){const n=di(e),r=Ki.now(),i=t.reduce((e,t)=>e.add(t.key),Bo());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=Po(),l=Bo();return n.Ns.getEntries(e,i).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{a=i;const s=[];for(const e of t){const t=hl(e,a.get(e.key).overlayedDocument);null!=t&&s.push(new pl(e.key,t,Os(t.value.mapValue),al.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)}).next(t=>{s=t;const r=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:s.batchId,changes:Lo(a)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Ga(Mi)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await nd(r,e.changes),await nh(r.remoteStore)}catch(e){const t=gh(e,"Failed to persist write");n.reject(t)}}(await vd(e),t,n)),n.promise}(Dd(e),t)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ni=e}(Tr),br(new hn("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const a=e.getProvider("app").getImmediate(),s=new Ld(new _i(e.getProvider("auth-internal")),new wi(a,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new pi(fi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(e.options.projectId,t)}(a,r),a);return i=d({useFetchStreams:t},i),s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),Ar($r,ei,e),Ar($r,ei,"esm2020")}();const Ff="firebasestorage.googleapis.com",zf="storageBucket";class Bf extends $t{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(jf(e),"Firebase Storage: ".concat(t," (").concat(jf(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Bf.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var Vf,Hf;function jf(e){return"storage/"+e}function Gf(){return new Bf(Vf.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function Wf(){return new Bf(Vf.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function qf(){return new Bf(Vf.CANCELED,"User canceled the upload/download.")}function Xf(e){return new Bf(Vf.INVALID_ARGUMENT,e)}function Yf(){return new Bf(Vf.APP_DELETED,"The Firebase app was deleted.")}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Vf||(Vf={}));class Kf{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Kf.makeFromUrl(e,t)}catch(cU){return new Kf(e,"")}if(""===n.path)return n;throw r=e,new Bf(Vf.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}const s=t.replace(/[.]/g,"\\."),o=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://".concat(t===Ff?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:a}];for(let l=0;l<o.length;l++){const t=o[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new Kf(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new Bf(Vf.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class Jf{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function Qf(e,t,n,r){if(r<t)throw Xf("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Xf("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function Zf(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function $f(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Hf||(Hf={}));class ep{constructor(e,t,n,r,i,a,s,o,l,c,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],d=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=s,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=u,this.retry=h,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new tp(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Hf.NO_ERROR,i=n.getStatus();if(!t||$f(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Hf.ABORT;return void e(!1,new tp(!1,null,t))}const a=-1!==this.successCodes_.indexOf(i);e(!0,new tp(a,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());!function(e){return void 0!==e}(e)?n():n(e)}catch(cU){r(cU)}else if(null!==i){const e=Gf();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?Yf():qf())}else{r(Wf())}};this.canceled_?t(0,new tp(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,a=null,s=!1,o=0;function l(){return 2===o}let c=!1;function u(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout(()=>{i=null,e(f,l())},t)}function d(){a&&clearTimeout(a)}function f(e){if(c)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void u.call(null,e,...n);if(l()||s)return d(),void u.call(null,e,...n);let a;r<64&&(r*=2),1===o?(o=2,a=0):a=1e3*(r+Math.random()),h(a)}let p=!1;function m(e){p||(p=!0,d(),c||(null!==i?(e||(o=2),clearTimeout(i),h(0)):e||(o=1)))}return h(0),a=setTimeout(()=>{s=!0,m(!0)},n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class tp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function np(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}class rp{constructor(e,t){this._service=e,this._location=t instanceof Kf?t:Kf.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new rp(e,t)}get root(){const e=new Kf(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return np(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new Kf(this._location.bucket,e);return new rp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Bf(Vf.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function ip(e,t){const n=null===t||void 0===t?void 0:t[zf];return null==n?null:Kf.makeFromBucketSpec(n,e)}class ap{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=a,this._bucket=null,this._host=Ff,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Kf.makeFromBucketSpec(r,this._host):ip(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Kf.makeFromBucketSpec(this._url,e):this._bucket=ip(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Qf("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Qf("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if(xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rp(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new Jf(Yf());{const a=function(e,t,n,r,i,a){let s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=Zf(e.urlParams),c=e.url+l,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(u,a),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new ep(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,s,o)}(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const sp="@firebase/storage",op="0.14.0",lp="storage";function cp(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),a=e.getProvider("app-check-internal");return new ap(r,i,a,n,Tr)}br(new hn(lp,cp,"PUBLIC").setMultipleInstances(!0)),Ar(sp,op,""),Ar(sp,op,"esm2020");const up=["providerId"],hp=["uid","auth","stsTokenManager"],dp=["providerId","signInMethod"];function fp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const pp=fp,mp=new en("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),gp=new Sn("@firebase/auth");function vp(e){if(gp.logLevel<=gn.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gp.error("Auth (".concat(Tr,"): ").concat(e),...n)}}function yp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw xp(e,...n)}function _p(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return xp(e,...n)}function bp(e,t,n){const r=d(d({},pp()),{},{[t]:n});return new en("auth","Firebase",r).create(t,{appName:e.name})}function Sp(e){return bp(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xp(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return mp.create(e,...n)}function wp(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw xp(t,...r)}}function Ep(e){const t="INTERNAL ASSERTION FAILED: "+e;throw vp(t),new Error(t)}function Tp(e,t){e||Ep(t)}function Mp(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Cp(){return"http:"===Ap()||"https:"===Ap()}function Ap(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Ip(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Cp()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Rp{constructor(e,t){this.shortDelay=e,this.longDelay=t,Tp(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Kt())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return Ip()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Pp(e,t){Tp(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class Np{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Ep("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Ep("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Ep("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const kp={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Lp=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Dp=new Rp(3e4,6e4);function Op(e,t){return e.tenantId&&!t.tenantId?d(d({},t),{},{tenantId:e.tenantId}):t}async function Up(e,t,n,r){return Fp(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},a={};r&&("GET"===t?a=r:i={body:JSON.stringify(r)});const s=an(d({key:e.config.apiKey},a)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=d({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&jt(e.emulatorConfig.host)&&(l.credentials="include"),Np.fetch()(await Bp(e,e.config.apiHost,n,s),l)})}async function Fp(e,t,n){e._canInitEmulator=!1;const r=d(d({},kp),t);try{const t=new Hp(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw jp(e,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const t=i.ok?a.errorMessage:a.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw jp(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw jp(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw jp(e,"user-disabled",a);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw bp(e,o,s);yp(e,o)}}catch(cU){if(cU instanceof $t)throw cU;yp(e,"network-request-failed",{message:String(cU)})}}async function zp(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await Up(e,t,n,r,i);return"mfaPendingCredential"in a&&yp(e,"multi-factor-auth-required",{_serverResponse:a}),a}async function Bp(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r),a=e,s=a.config.emulator?Pp(e.config,i):"".concat(e.config.apiScheme,"://").concat(i);if(Lp.includes(n)&&(await a._persistenceManagerAvailable,"COOKIE"===a._getPersistenceType())){return a._getPersistence()._getFinalTarget(s).toString()}return s}function Vp(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Hp{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_p(this.auth,"network-request-failed")),Dp.get())})}}function jp(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=_p(e,t,r);return i.customData._tokenResponse=n,i}function Gp(e){return void 0!==e&&void 0!==e.enterprise}class Wp{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Vp(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function qp(e,t){return Up(e,"GET","/v2/recaptchaConfig",Op(e,t))}async function Xp(e,t){return Up(e,"POST","/v1/accounts:lookup",t)}function Yp(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(cU){}}function Kp(e){return 1e3*Number(e)}function Jp(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return vp("JWT malformed, contained fewer than 3 sections"),null;try{const e=Dt(n);return e?JSON.parse(e):(vp("Failed to decode base64 JWT payload"),null)}catch(cU){return vp("Caught error parsing JWT payload as JSON",null===cU||void 0===cU?void 0:cU.toString()),null}}function Qp(e){const t=Jp(e);return wp(t,"internal-error"),wp("undefined"!==typeof t.exp,"internal-error"),wp("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Zp(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(cU){throw cU instanceof $t&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(cU)&&e.auth.currentUser===e&&await e.auth.signOut(),cU}}class $p{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(cU){return void((null===cU||void 0===cU?void 0:cU.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class em{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yp(this.lastLoginAt),this.creationTime=Yp(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tm(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Zp(e,Xp(n,{idToken:r}));wp(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const a=i.users[0];e._notifyReloadListener(a);const s=null!==(t=a.providerUserInfo)&&void 0!==t&&t.length?nm(a.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&a.passwordHash)&&!(null!==o&&void 0!==o&&o.length),d=!!u&&h,f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new em(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function nm(e){return e.map(e=>{let{providerId:t}=e,n=o(e,up);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class rm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){wp(e.idToken,"internal-error"),wp("undefined"!==typeof e.idToken,"internal-error"),wp("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Qp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){wp(0!==e.length,"internal-error");const t=Qp(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(wp(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Fp(e,{},async()=>{const n=an({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=await Bp(e,r,"/v1/token","key=".concat(i)),s=await e._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const o={method:"POST",headers:s,body:n};return e.emulatorConfig&&jt(e.emulatorConfig.host)&&(o.credentials="include"),Np.fetch()(a,o)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,a=new rm;return n&&(wp("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(wp("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),i&&(wp("number"===typeof i,"internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rm,this.toJSON())}_performRefresh(){return Ep("not implemented")}}function im(e,t){wp("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class am{constructor(e){let{uid:t,auth:n,stsTokenManager:r}=e,i=o(e,hp);this.providerId="firebase",this.proactiveRefresh=new $p(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new em(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Zp(this,this.stsTokenManager.getToken(this.auth,e));return wp(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=un(e),r=await n.getIdToken(t),i=Jp(r);wp(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a="object"===typeof i.firebase?i.firebase:void 0,s=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:Yp(Kp(i.auth_time)),issuedAtTime:Yp(Kp(i.iat)),expirationTime:Yp(Kp(i.exp)),signInProvider:s||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=un(e);await tm(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(wp(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>d({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new am(d(d({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){wp(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await tm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xr(this.auth.app))return Promise.reject(Sp(this.auth));const e=await this.getIdToken();return await Zp(this,async function(e,t){return Up(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return d(d({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>d({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,a,s,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,f=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,p=null!==(a=t.photoURL)&&void 0!==a?a:void 0,m=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,v=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:_,emailVerified:b,isAnonymous:S,providerData:x,stsTokenManager:w}=t;wp(_&&w,e,"internal-error");const E=rm.fromJSON(this.name,w);wp("string"===typeof _,e,"internal-error"),im(u,e.name),im(h,e.name),wp("boolean"===typeof b,e,"internal-error"),wp("boolean"===typeof S,e,"internal-error"),im(f,e.name),im(p,e.name),im(m,e.name),im(g,e.name),im(v,e.name),im(y,e.name);const T=new am({uid:_,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:S,photoURL:p,phoneNumber:f,tenantId:m,stsTokenManager:E,createdAt:v,lastLoginAt:y});return x&&Array.isArray(x)&&(T.providerData=x.map(e=>d({},e))),g&&(T._redirectEventId=g),T}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new rm;r.updateFromServerResponse(t);const i=new am({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await tm(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];wp(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?nm(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length),s=new rm;s.updateFromIdToken(n);const o=new am({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:a}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new em(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null!==i&&void 0!==i&&i.length)};return Object.assign(o,l),o}}const sm=new Map;function om(e){Tp(e instanceof Function,"Expected a class definition");let t=sm.get(e);return t?(Tp(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,sm.set(e,t),t)}class lm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}lm.type="NONE";const cm=lm;function um(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class hm{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=um(this.userKey,r.apiKey,i),this.fullPersistenceKey=um("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Xp(this.auth,{idToken:e}).catch(()=>{});return t?am._fromGetAccountInfoResponse(this.auth,t,e):null}return am._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new hm(om(cm),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||om(cm);const a=um(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(a);if(t){let n;if("string"===typeof t){const r=await Xp(e,{idToken:t}).catch(()=>{});if(!r)break;n=await am._fromGetAccountInfoResponse(e,r,t)}else n=am._fromJSON(e,t);c!==i&&(s=n),i=c;break}}catch(l){}const o=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&o.length?(i=o[0],s&&await i._set(a,s.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(a)}catch(t){}})),new hm(i,e,n)):new hm(i,e,n)}}function dm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gm(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fm(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ym(t))return"Blackberry";if(_m(t))return"Webos";if(pm(t))return"Safari";if((t.includes("chrome/")||mm(t))&&!t.includes("edge/"))return"Chrome";if(vm(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function fm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/firefox\//i.test(e)}function pm(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/crios\//i.test(e)}function gm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/iemobile/i.test(e)}function vm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/android/i.test(e)}function ym(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/blackberry/i.test(e)}function _m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/webos/i.test(e)}function bm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Sm(){return function(){const e=Kt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function xm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt();return bm(e)||vm(e)||_m(e)||ym(e)||/windows phone/i.test(e)||gm(e)}function wm(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=dm(Kt());break;case"Worker":t="".concat(dm(Kt()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Tr,"/").concat(r)}class Em{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(cU){r(cU)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(cU){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===cU||void 0===cU?void 0:cU.message})}}}class Tm{constructor(e){var t,n,r,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(n=null===(r=e.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==n?n:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,a,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNumericCharacter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Mm{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Am(this),this.idTokenSubscription=new Am(this),this.beforeStateQueue=new Em(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=om(t)),this._initializationPromise=this.queue(async()=>{var n,r,i;if(!this._deleted&&(this.persistenceManager=await hm.create(this,e),null===(n=this._resolvePersistenceManagerAvailable)||void 0===n||n.call(this),!this._deleted)){if(null!==(r=this._popupRedirectResolver)&&void 0!==r&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(cU){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Xp(this,{idToken:e}),n=await am._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xr(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){var i,a;await this.getOrInitRedirectPersistenceManager();const t=null===(i=this.redirectUser)||void 0===i?void 0:i._redirectEventId,s=null===(a=n)||void 0===a?void 0:a._redirectEventId,o=await this.tryRedirectSignIn(e);t&&t!==s||null===o||void 0===o||!o.user||(n=o.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(cU){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(cU))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return wp(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(cU){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tm(e)}catch(cU){if((null===cU||void 0===cU?void 0:cU.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xr(this.app))return Promise.reject(Sp(this));const t=e?un(e):null;return t&&wp(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&wp(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xr(this.app)?Promise.reject(Sp(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xr(this.app)?Promise.reject(Sp(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(om(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Up(e,"GET","/v2/passwordPolicy",Op(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Tm(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new en("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Up(e,"POST","/v2/accounts:revokeToken",Op(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&om(e)||this._popupRedirectResolver;wp(t,this,"argument-error"),this.redirectPersistenceManager=await hm.create(this,[om(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(wp(s,this,"internal-error"),s.then(()=>{a||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{a=!0,i()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return wp(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;if(xr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(gp.logLevel<=gn.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gp.warn("Auth (".concat(Tr,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Cm(e){return un(e)}class Am{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new ln(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return wp(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Im={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Rm(e){return Im.loadJS(e)}function Pm(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Nm{constructor(){this.enterprise=new km}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class km{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Lm="NO_RECAPTCHA";class Dm{constructor(e){this.type="recaptcha-enterprise",this.auth=Cm(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Gp(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Lm)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Nm).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{qp(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new Wp(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&Gp(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Im.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Rm(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Om(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const a=new Dm(e);let s;if(i)s=Lm;else try{s=await a.verify(n)}catch(ox){s=await a.verify(n,!0)}const o=d({},t);if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in o){const e=o.phoneEnrollmentInfo.phoneNumber,t=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const e=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Um(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){var a;if(null!==(a=e._getRecaptchaConfig())&&void 0!==a&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Om(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Om(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){var s;if(null!==(s=e._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("PHONE_PROVIDER")){const i=await Om(e,t,n);return r(e,i).catch(async i=>{var a;if("AUDIT"===(null===(a=e._getRecaptchaConfig())||void 0===a?void 0:a.getProviderEnforcementState("PHONE_PROVIDER"))&&(i.code==="auth/".concat("missing-recaptcha-token")||i.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(n," flow."));const i=await Om(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await Om(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function Fm(e){const t=Cm(e),n=await qp(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new Wp(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Dm(t).verify()}}function zm(e,t,n){const r=Cm(e);wp(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!(null===n||void 0===n||!n.disableWarnings),a=Bm(t),{host:s,port:o}=function(e){const t=Bm(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Vm(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Vm(t)}}}(t),l=null===o?"":":".concat(o),c={url:"".concat(a,"//").concat(s).concat(l,"/")},u=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return wp(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void wp(nn(c,r.config.emulator)&&nn(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,jt(s)?(Gt("".concat(a,"//").concat(s).concat(l)),Yt("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Bm(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Vm(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Hm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ep("not implemented")}_getIdTokenResponse(e){return Ep("not implemented")}_linkToIdToken(e,t){return Ep("not implemented")}_getReauthenticationResolver(e){return Ep("not implemented")}}async function jm(e,t){return Up(e,"POST","/v1/accounts:signUp",t)}async function Gm(e,t){return zp(e,"POST","/v1/accounts:signInWithPassword",Op(e,t))}async function Wm(e,t){return Up(e,"POST","/v1/accounts:sendOobCode",Op(e,t))}async function qm(e,t){return Wm(e,t)}class Xm extends Hm{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Xm(e,t,"password")}static _fromEmailAndCode(e,t){return new Xm(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Um(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Gm,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return zp(e,"POST","/v1/accounts:signInWithEmailLink",Op(e,t))}(e,{email:this._email,oobCode:this._password});default:yp(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Um(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jm,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return zp(e,"POST","/v1/accounts:signInWithEmailLink",Op(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:yp(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ym(e,t){return zp(e,"POST","/v1/accounts:signInWithIdp",Op(e,t))}class Km extends Hm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Km(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):yp("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=o(t,dp);if(!n||!r)return null;const a=new Km(n,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){return Ym(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ym(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ym(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=an(t)}return e}}async function Jm(e,t){return Up(e,"POST","/v1/accounts:sendVerificationCode",Op(e,t))}const Qm={USER_NOT_FOUND:"user-not-found"};class Zm extends Hm{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Zm({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Zm({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return zp(e,"POST","/v1/accounts:signInWithPhoneNumber",Op(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await zp(e,"POST","/v1/accounts:signInWithPhoneNumber",Op(e,t));if(n.temporaryProof)throw jp(e,"account-exists-with-different-credential",n);return n}(e,d({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return zp(e,"POST","/v1/accounts:signInWithPhoneNumber",Op(e,d(d({},t),{},{operation:"REAUTH"})),Qm)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Zm({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class $m{constructor(e){var t,n,r,i,a,s;const o=sn(on(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);wp(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=o.lang)&&void 0!==a?a:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=sn(on(e)).link,n=t?sn(on(t)).deep_link_id:null,r=sn(on(e)).deep_link_id;return(r?sn(on(r)).link:null)||r||n||t||e}(e);try{return new $m(t)}catch(n){return null}}}class eg{constructor(){this.providerId=eg.PROVIDER_ID}static credential(e,t){return Xm._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=$m.parseLink(t);return wp(n,"argument-error"),Xm._fromEmailAndCode(e,n.code,n.tenantId)}}eg.PROVIDER_ID="password",eg.EMAIL_PASSWORD_SIGN_IN_METHOD="password",eg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class tg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ng extends tg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class rg extends ng{constructor(){super("facebook.com")}static credential(e){return Km._fromParams({providerId:rg.PROVIDER_ID,signInMethod:rg.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rg.credentialFromTaggedObject(e)}static credentialFromError(e){return rg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return rg.credential(t.oauthAccessToken)}catch(n){return null}}}rg.FACEBOOK_SIGN_IN_METHOD="facebook.com",rg.PROVIDER_ID="facebook.com";class ig extends ng{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Km._fromParams({providerId:ig.PROVIDER_ID,signInMethod:ig.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ig.credentialFromTaggedObject(e)}static credentialFromError(e){return ig.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return ig.credential(n,r)}catch(i){return null}}}ig.GOOGLE_SIGN_IN_METHOD="google.com",ig.PROVIDER_ID="google.com";class ag extends ng{constructor(){super("github.com")}static credential(e){return Km._fromParams({providerId:ag.PROVIDER_ID,signInMethod:ag.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ag.credentialFromTaggedObject(e)}static credentialFromError(e){return ag.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ag.credential(t.oauthAccessToken)}catch(n){return null}}}ag.GITHUB_SIGN_IN_METHOD="github.com",ag.PROVIDER_ID="github.com";class sg extends ng{constructor(){super("twitter.com")}static credential(e,t){return Km._fromParams({providerId:sg.PROVIDER_ID,signInMethod:sg.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sg.credentialFromTaggedObject(e)}static credentialFromError(e){return sg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return sg.credential(n,r)}catch(i){return null}}}async function og(e,t){return zp(e,"POST","/v1/accounts:signUp",Op(e,t))}sg.TWITTER_SIGN_IN_METHOD="twitter.com",sg.PROVIDER_ID="twitter.com";class lg{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await am._fromIdTokenResponse(e,n,r),a=cg(n);return new lg({user:i,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=cg(n);return new lg({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function cg(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class ug extends $t{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,ug.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new ug(e,t,n,r)}}function hg(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw ug._fromErrorAndOperation(e,n,t,r);throw n})}async function dg(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Zp(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return lg._forOperation(e,"link",r)}async function fg(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(xr(r.app))return Promise.reject(Sp(r));const i="reauthenticate";try{const a=await Zp(e,hg(r,i,t,e),n);wp(a.idToken,r,"internal-error");const s=Jp(a.idToken);wp(s,r,"internal-error");const{sub:o}=s;return wp(e.uid===o,r,"user-mismatch"),lg._forOperation(e,i,a)}catch(cU){throw(null===cU||void 0===cU?void 0:cU.code)==="auth/".concat("user-not-found")&&yp(r,"user-mismatch"),cU}}async function pg(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(xr(e.app))return Promise.reject(Sp(e));const r="signIn",i=await hg(e,r,t),a=await lg._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}async function mg(e,t){return pg(Cm(e),t)}function gg(e,t,n){var r;wp((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),wp("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),wp("undefined"===typeof n.linkDomain||n.linkDomain.length>0,e,"invalid-hosting-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.linkDomain=n.linkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(wp(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(wp(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function vg(e){const t=Cm(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function yg(e){return un(e).signOut()}function _g(e,t){return Up(e,"POST","/v2/accounts/mfaEnrollment:start",Op(e,t))}new WeakMap;const bg="__sak";class Sg{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bg,"1"),this.storage.removeItem(bg),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class xg extends Sg{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=xm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Sm()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xg.type="LOCAL";const wg=xg;function Eg(e){var t,n;const r=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),i=RegExp("".concat(r,"=([^;]+)"));return null!==(t=null===(n=document.cookie.match(i))||void 0===n?void 0:n[1])&&void 0!==t?t:null}function Tg(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class Mg{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Tg(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return Eg(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Tg(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Tg(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=Eg(n);const i=setInterval(()=>{const e=Eg(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}Mg.type="COOKIE";class Cg extends Sg{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Cg.type="SESSION";const Ag=Cg;class Ig{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ig(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(null===a||void 0===a||!a.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(a).map(async e=>e(t.origin,i)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Rg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Ig.receivers=[];class Pg{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise((s,o)=>{const l=Rg("",20);r.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}function Ng(){return window}function kg(){return"undefined"!==typeof Ng().WorkerGlobalScope&&"function"===typeof Ng().importScripts}const Lg="firebaseLocalStorageDb",Dg="firebaseLocalStorage",Og="fbase_key";class Ug{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fg(e,t){return e.transaction([Dg],t?"readwrite":"readonly").objectStore(Dg)}function zg(){const e=indexedDB.open(Lg,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Dg,{keyPath:Og})}catch(cU){n(cU)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Dg)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Lg);return new Ug(e).toPromise()}(),t(await zg()))})})}async function Bg(e,t,n){const r=Fg(e,!0).put({[Og]:t,value:n});return new Ug(r).toPromise()}function Vg(e,t){const n=Fg(e,!0).delete(t);return new Ug(n).toPromise()}class Hg{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await zg()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(cU){if(t++>3)throw cU;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return kg()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ig._getInstance(kg()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new Pg(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&null!==(e=n[0])&&void 0!==e&&e.fulfilled&&null!==(t=n[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zg();return await Bg(e,bg,"1"),await Vg(e,bg),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Bg(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Fg(e,!1).get(t),r=await new Ug(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Vg(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Fg(e,!1).getAll();return new Ug(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Hg.type="LOCAL";const jg=Hg;function Gg(e,t){return Up(e,"POST","/v2/accounts/mfaSignIn:start",Op(e,t))}Pm("rcb"),new Rp(3e4,6e4);const Wg="recaptcha";async function qg(e,t,n){if(!e._getRecaptchaConfig())try{await Fm(e)}catch(ox){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let i;if(i="string"===typeof t?{phoneNumber:t}:t,"session"in i){const t=i.session;if("phoneNumber"in i){wp("enroll"===t.type,e,"internal-error");const r={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},a=Um(e,r,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Lm){wp((null===n||void 0===n?void 0:n.type)===Wg,e,"argument-error");return _g(e,await Xg(e,t,n))}return _g(e,t)},"PHONE_PROVIDER"),s=await a.catch(e=>Promise.reject(e));return s.phoneSessionInfo.sessionInfo}{var r;wp("signin"===t.type,e,"internal-error");const a=(null===(r=i.multiFactorHint)||void 0===r?void 0:r.uid)||i.multiFactorUid;wp(a,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:a,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Um(e,s,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Lm){wp((null===n||void 0===n?void 0:n.type)===Wg,e,"argument-error");return Gg(e,await Xg(e,t,n))}return Gg(e,t)},"PHONE_PROVIDER"),l=await o.catch(e=>Promise.reject(e));return l.phoneResponseInfo.sessionInfo}}{const t={phoneNumber:i.phoneNumber,clientType:"CLIENT_TYPE_WEB"},r=Um(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Lm){wp((null===n||void 0===n?void 0:n.type)===Wg,e,"argument-error");return Jm(e,await Xg(e,t,n))}return Jm(e,t)},"PHONE_PROVIDER"),a=await r.catch(e=>Promise.reject(e));return a.sessionInfo}}finally{null===n||void 0===n||n._reset()}}async function Xg(e,t,n){wp(n.type===Wg,e,"argument-error");const r=await n.verify();wp("string"===typeof r,e,"argument-error");const i=d({},t);if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,a=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Yg{constructor(e){this.providerId=Yg.PROVIDER_ID,this.auth=Cm(e)}verifyPhoneNumber(e,t){return qg(this.auth,e,un(t))}static credential(e,t){return Zm._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Yg.credentialFromTaggedObject(t)}static credentialFromError(e){return Yg.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Zm._fromTokenResponse(n,r):null}}function Kg(e,t){return t?om(t):(wp(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Yg.PROVIDER_ID="phone",Yg.PHONE_SIGN_IN_METHOD="phone";class Jg extends Hm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ym(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ym(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ym(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Qg(e){return pg(e.auth,new Jg(e),e.bypassAuthState)}function Zg(e){const{auth:t,user:n}=e;return wp(n,t,"internal-error"),fg(n,new Jg(e),e.bypassAuthState)}async function $g(e){const{auth:t,user:n}=e;return wp(n,t,"internal-error"),dg(n,new Jg(e),e.bypassAuthState)}class ev{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(cU){this.reject(cU)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:a,type:s}=e;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(cU){this.reject(cU)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Qg;case"linkViaPopup":case"linkViaRedirect":return $g;case"reauthViaPopup":case"reauthViaRedirect":return Zg;default:yp(this.auth,"internal-error")}}resolve(e){Tp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Tp(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const tv=new Rp(2e3,1e4);class nv extends ev{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,nv.currentPopupAction&&nv.currentPopupAction.cancel(),nv.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return wp(e,this.auth,"internal-error"),e}async onExecution(){Tp(1===this.filter.length,"Popup operations only handle one event");const e=Rg();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_p(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(_p(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nv.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_p(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,tv.get())};e()}}nv.currentPopupAction=null;const rv=new Map;class iv extends ev{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=rv.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ov(t),r=sv(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(cU){e=()=>Promise.reject(cU)}rv.set(this.auth._key(),e)}return this.bypassAuthState||rv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function av(e,t){rv.set(e._key(),t)}function sv(e){return om(e._redirectPersistence)}function ov(e){return um("pendingRedirect",e.config.apiKey,e.name)}async function lv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(xr(e.app))return Promise.reject(Sp(e));const r=Cm(e),i=Kg(r,t),a=new iv(r,i,n),s=await a.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class cv{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return hv(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!hv(e)){var n;const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(_p(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(uv(e))}saveEventToCache(e){this.cachedEventUids.add(uv(e)),this.lastProcessedEventTime=Date.now()}}function uv(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function hv(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const dv=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fv=/^https?/;async function pv(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Up(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(mv(r))return}catch(n){}yp(e,"unauthorized-domain")}function mv(e){const t=Mp(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!fv.test(n))return!1;if(dv.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const gv=new Rp(3e4,6e4);function vv(){const e=Ng().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function yv(e){return new Promise((t,n)=>{var r,i;function a(){vv(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{vv(),n(_p(e,"network-request-failed"))},timeout:gv.get()})}if(null!==(r=Ng().gapi)&&void 0!==r&&null!==(r=r.iframes)&&void 0!==r&&r.Iframe)t(gapi.iframes.getContext());else{if(null===(i=Ng().gapi)||void 0===i||!i.load){const t=Pm("iframefcb");return Ng()[t]=()=>{gapi.load?a():n(_p(e,"network-request-failed"))},Rm("".concat(Im.gapiScript,"?onload=").concat(t)).catch(e=>n(e))}a()}}).catch(e=>{throw _v=null,e})}let _v=null;const bv=new Rp(5e3,15e3),Sv={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},xv=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wv(e){const t=e.config;wp(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Pp(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:Tr},i=xv.get(e.config.apiHost);i&&(r.eid=i);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(an(r).slice(1))}async function Ev(e){const t=await function(e){return _v=_v||yv(e),_v}(e),n=Ng().gapi;return wp(n,e,"internal-error"),t.open({where:document.body,url:wv(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sv,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=_p(e,"network-request-failed"),a=Ng().setTimeout(()=>{r(i)},bv.get());function s(){Ng().clearTimeout(a),n(t)}t.ping(s).then(s,()=>{r(i)})}))}const Tv={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Mv{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(cU){}}}function Cv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=d(d({},Tv),{},{width:r.toString(),height:i.toString(),top:a,left:s}),c=Kt().toLowerCase();n&&(o=mm(c)?"_blank":n),fm(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")},"");if(function(){var e;return bm(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kt())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new Mv(null);const h=window.open(t||"",o,u);wp(h,e,"popup-blocked");try{h.focus()}catch(cU){}return new Mv(h)}const Av="__/auth/handler",Iv="emulator/auth/handler",Rv=encodeURIComponent("fac");async function Pv(e,t,n,r,i,a){wp(e.config.authDomain,e,"auth-domain-config-required"),wp(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Tr,eventId:i};if(t instanceof tg){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))s[e]=t}if(t instanceof ng){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(Rv,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Av);return Pp(t,Iv)}(e),"?").concat(an(o).slice(1)).concat(c)}const Nv="webStorageSupport";const kv=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ag,this._completeRedirectFn=lv,this._overrideRedirectResult=av}async _openPopup(e,t,n,r){var i;Tp(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Cv(e,await Pv(e,t,n,Mp(),r),Rg())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Ng().location.href=e}(await Pv(e,t,n,Mp(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Tp(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await Ev(e),n=new cv(e);return t.register("authEvent",t=>{wp(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Nv,{type:Nv},n=>{var r;const i=null===n||void 0===n||null===(r=n[0])||void 0===r?void 0:r[Nv];void 0!==i&&t(!!i),yp(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pv(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xm()||pm()||bm()}};var Lv="@firebase/auth",Dv="1.11.1";class Ov{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){wp(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Uv=Vt("authIdTokenMaxAge")||300;let Fv=null;var zv;!function(e){Im=e}({loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=_p("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),zv="Browser",br(new hn("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;wp(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:o,clientPlatform:zv,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wm(zv)},c=new Mm(r,i,a,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(om);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),br(new hn("auth-internal",e=>(e=>new Ov(e))(Cm(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),Ar(Lv,Dv,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(zv)),Ar(Lv,Dv,"esm2020");const Bv=Mr({apiKey:"AIzaSyCNxbwocYoNVIJ3IrxJoXMi5rwveL2MsKE",authDomain:"collection-a2525.firebaseapp.co",projectId:"collection-a2525",storageBucket:"collection-a2525.firebasestorage.app",messagingSenderId:"11961554828",appId:"1:11961554828:web:f37a862bc4b92fa11868a",measurementId:"G-5W4DXY4J8H"}),Vv=function(e,t){const n="object"==typeof e?e:Cr(),r="string"==typeof e?e:t||us,i=Sr(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=zt("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=ji(e,Td);const i=jt(t),a=e._getSettings(),s=d(d({},a),{},{emulatorOptions:e._getEmulatorOptions()}),o="".concat(t,":").concat(n);i&&(Gt("https://".concat(o)),Yt("Firestore",!0)),a.host!==xd&&a.host!==o&&oi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l=d(d({},a),{},{host:o,ssl:i,emulatorOptions:r});if(!nn(l,s)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=ti.MOCK_USER;else{var c;t=Wt(r.mockUserToken,null===(c=e._app)||void 0===c?void 0:c.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new pi(fi.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new ti(i)}e._authCredentials=new yi(new gi(t,n))}}(i,...e)}return i}(Bv),Hv=(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr(),t=arguments.length>1?arguments[1]:void 0;e=un(e);const n=Sr(e,lp).getImmediate({identifier:t}),r=zt("storage");r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n);const i=jt(t);i&&(Gt("https://".concat(e.host,"/b")),Yt("Storage",!0)),e._isUsingEmulator=!0,e._protocol=i?"https":"http";const{mockUserToken:a}=r;a&&(e._overrideAuthToken="string"===typeof a?a:Wt(a,e.app.options.projectId))}(e,t,n,r)}(n,...r)}(Bv),function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cr();const t=Sr(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Sr(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(nn(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;yp(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:kv,persistence:[jg,wg,Ag]}),r=Vt("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Uv)return;const r=null===t||void 0===t?void 0:t.token;Fv!==r&&(Fv=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){un(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){un(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const a=Ft("auth");return a&&zm(n,"http://".concat(a)),n}(Bv)),jv=async e=>{try{const t=gf(Id(Vv,"collections"),yf("userId","==",e)),n=(await kf(t)).docs.map(e=>d({id:e.id},e.data()));return n}catch(cU){throw console.error("Error getting collections: ",cU),cU}},Gv=async(e,t)=>{try{const r=gf(Id(Vv,"items"),yf("userId","==",e),yf("collectionId","==",t),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=df("orderBy",e);return bf._create(n,t)}("createdAt","asc"),(Gi("limit",n=1),Sf._create("limit",n,"F"))),i=await kf(r);if(!i.empty){return i.docs[0].data().imageData}return null}catch(n){throw console.error("Error getting first item image: ",n),n}var n};var Wv=n(579);const qv=(0,i.createContext)();function Xv(){return(0,i.useContext)(qv)}function Yv(e){let{children:t}=e;const[n,r]=(0,i.useState)(null),[a,s]=(0,i.useState)(!0);(0,i.useEffect)(()=>{const e=function(e,t,n,r){return un(e).onAuthStateChanged(t,n,r)}(Hv,e=>{r(e),s(!1)});return e},[]);const o={currentUser:n};return(0,Wv.jsx)(qv.Provider,{value:o,children:!a&&t})}const Kv=function(e){let{isOpen:t,onClose:n,currentUser:r,onCollectionSaved:a,collectionToEdit:s}=e;const[o,l]=(0,i.useState)(""),[c,u]=(0,i.useState)(null);return(0,i.useEffect)(()=>{t&&(l(s?s.name:""),u(null))},[t,s]),t?(0,Wv.jsx)("div",{className:"modal-overlay",children:(0,Wv.jsxs)("div",{className:"modal-content",children:[(0,Wv.jsx)("button",{className:"modal-close-button",onClick:n,children:"\xd7"}),(0,Wv.jsx)("h2",{children:s?"Edit Collection":"Add New Collection"}),(0,Wv.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u(null),o.trim())if(r)try{s?await(async(t,n)=>{try{const e=Rd(Vv,"collections",t);await Lf(e,{name:n})}catch(e){throw console.error("Error updating collection: ",e),e}})(s.id,o):await(async(t,n)=>{try{return(await Of(Id(Vv,"collections"),{userId:t,name:n,createdAt:new Date})).id}catch(e){throw console.error("Error adding collection: ",e),e}})(r.uid,o),a(),n()}catch(t){u("Failed to ".concat(s?"update":"add"," collection.")),console.error(t)}else u("User not authenticated.");else u("Collection name cannot be empty.")},children:[(0,Wv.jsx)("input",{type:"text",placeholder:"Collection Name",value:o,onChange:e=>l(e.target.value),required:!0}),(0,Wv.jsx)("button",{type:"submit",children:s?"Update Collection":"Add Collection"}),c&&(0,Wv.jsx)("p",{className:"error",children:c})]})]})}):null};const Jv=function(){const[e,t]=(0,i.useState)([]),[n,r]=(0,i.useState)({}),[a,s]=(0,i.useState)(!0),[o,l]=(0,i.useState)(null),{currentUser:c}=Xv(),[u,h]=(0,i.useState)(!1),[d,f]=(0,i.useState)(null),p=(0,i.useCallback)(async()=>{if(c)try{s(!0);const e=await jv(c.uid);t(e);const n={};for(const t of e){const e=await Gv(c.uid,t.id);n[t.id]=e}r(n)}catch(e){l("Failed to fetch collections."),console.error(e)}finally{s(!1)}},[c]);(0,i.useEffect)(()=>{c&&p()},[c,p]);const m=async e=>{if(c)try{await(async(e,t)=>{try{const n=gf(Id(Vv,"items"),yf("userId","==",e),yf("collectionId","==",t)),r=(await kf(n)).docs.map(async e=>{await Df(Rd(Vv,"items",e.id))});await Promise.all(r);const i=Rd(Vv,"collections",t);await Df(i)}catch(cU){throw console.error("Error deleting collection: ",cU),cU}})(c.uid,e),p()}catch(t){l("Failed to delete collection."),console.error(t)}};return a?(0,Wv.jsx)("p",{children:"Loading collections..."}):o?(0,Wv.jsx)("p",{className:"error",children:o}):(0,Wv.jsxs)("div",{className:"collection-list-container",children:[(0,Wv.jsx)("h2",{children:"Your Collections"}),(0,Wv.jsx)("button",{type:"button",className:"add-collection-button",onClick:()=>{f(null),h(!0)},children:"+ Add Collection"}),0===e.length?(0,Wv.jsx)("p",{className:"no-collections",children:"No collections yet. Add one above!"}):(0,Wv.jsx)("ul",{className:"collection-list",children:e.map(e=>(0,Wv.jsxs)("li",{className:"collection-item",children:[(0,Wv.jsxs)(wt,{to:"/collections/".concat(e.id),children:[n[e.id]&&(0,Wv.jsx)("img",{src:n[e.id],alt:e.name,className:"collection-display-image"}),(0,Wv.jsx)("span",{children:e.name})]}),(0,Wv.jsxs)("div",{className:"collection-actions",children:[(0,Wv.jsx)("button",{type:"button",onClick:()=>(e=>{f(e),h(!0)})(e),children:"Edit"}),(0,Wv.jsx)("button",{type:"button",onClick:()=>m(e.id),className:"delete",children:"Delete"})]})]},e.id))}),(0,Wv.jsx)(Kv,{isOpen:u,onClose:()=>{h(!1),f(null)},currentUser:c,onCollectionSaved:()=>{p()},collectionToEdit:d})]})};const Qv=function(e){let{isOpen:t,onClose:n,collectionId:r,currentUser:a,onItemSaved:s,itemToEdit:o}=e;const[l,c]=(0,i.useState)(""),[u,h]=(0,i.useState)(""),[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(null),[g,v]=(0,i.useState)(null),[y,_]=(0,i.useState)(!1),b=(0,i.useRef)(null),S=(0,i.useRef)(null),x=(0,i.useRef)(null),[w,E]=(0,i.useState)([]),[T,M]=(0,i.useState)(0);(0,i.useEffect)(()=>{t&&(o?(c(o.name),h(o.description),m(o.imageData)):(c(""),h(""),m(null)),f(null),v(null),_(!1))},[t,o]),(0,i.useEffect)(()=>{t&&async function(){try{const e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"videoinput"===e.kind);E(e),console.log("Detected video devices:",e)}catch(e){console.error("Error enumerating devices: ",e)}}()},[t]);const C=()=>{x.current&&(x.current.getTracks().forEach(e=>e.stop()),x.current=null)},A=(0,i.useCallback)(async e=>{C();try{const t={video:{deviceId:e?{exact:e}:void 0}},n=await navigator.mediaDevices.getUserMedia(t);x.current=n,b.current&&(b.current.srcObject=n)}catch(t){console.error("Error accessing camera: ",t),v("Could not access camera. Please ensure permissions are granted."),_(!1)}},[]);return(0,i.useEffect)(()=>{if(y&&t){const e=w[T];A(e?e.deviceId:null)}else C();return()=>{C()}},[y,T,w,t,A]),t?(0,Wv.jsx)("div",{className:"modal-overlay",children:(0,Wv.jsxs)("div",{className:"modal-content",children:[(0,Wv.jsx)("button",{className:"modal-close-button",onClick:n,children:"\xd7"}),(0,Wv.jsx)("h2",{children:o?"Edit Item":"Add New Item"}),(0,Wv.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),v(null),!l.trim())return void v("Item name cannot be empty.");if(!a)return void v("User not authenticated.");let t="";if(d)try{t=await(i=d,new Promise((e,t)=>{const n=new FileReader;n.readAsDataURL(i),n.onload=n=>{const r=new Image;r.src=n.target.result,r.onload=()=>{const t=document.createElement("canvas");let n=r.width,i=r.height;n>i?n>224&&(i*=224/n,n=224):i>224&&(n*=224/i,i=224),t.width=n,t.height=i,t.getContext("2d").drawImage(r,0,0,n,i);const a=t.toDataURL("image/png");e(a)},r.onerror=e=>t(e)},n.onerror=e=>t(e)}))}catch(c){return v("Failed to process image from file input."),void console.error(c)}else p?t=p:o&&o.imageData&&(t=o.imageData);var i;try{o?await(async(t,n,r,i)=>{try{const e=Rd(Vv,"items",t);await Lf(e,{name:n,description:r,imageData:i})}catch(e){throw console.error("Error updating item: ",e),e}})(o.id,l,u,t):await(async(t,n,r,i,a)=>{try{return(await Of(Id(Vv,"items"),{userId:t,collectionId:n,name:r,description:i,imageData:a,createdAt:new Date})).id}catch(e){throw console.error("Error adding item: ",e),e}})(a.uid,r,l,u,t),s(),n()}catch(h){v("Failed to ".concat(o?"update":"add"," item.")),console.error(h)}},children:[(0,Wv.jsx)("input",{type:"text",placeholder:"Item Name",value:l,onChange:e=>c(e.target.value),required:!0}),(0,Wv.jsx)("textarea",{placeholder:"Item Description",value:u,onChange:e=>h(e.target.value)}),(0,Wv.jsxs)("div",{children:[(0,Wv.jsx)("button",{type:"button",onClick:()=>_(!y),children:y?"Hide Camera":"Take Photo"}),!y&&(0,Wv.jsx)("input",{type:"file",id:"itemImageInput",accept:"image/*",onChange:e=>{f(e.target.files[0]),m(null)}})]}),y&&(0,Wv.jsxs)("div",{className:"video-container",children:[(0,Wv.jsx)("video",{ref:b,autoPlay:!0,playsInline:!0,muted:!0}),(0,Wv.jsxs)("div",{className:"camera-actions",children:[(0,Wv.jsx)("button",{type:"button",onClick:async()=>{const e=b.current,t=S.current;if(e&&t){t.width=224,t.height=224;const n=t.getContext("2d");let r,i,a,s,o,l,c,u;e.videoWidth/e.videoHeight>1?(s=e.videoHeight,a=s*(t.width/t.height),r=(e.videoWidth-a)/2,i=0):(a=e.videoWidth,s=a/(t.width/t.height),r=0,i=(e.videoHeight-s)/2),c=t.width,u=t.height,o=0,l=0,n.drawImage(e,r,i,a,s,o,l,c,u);const h=t.toDataURL("image/png");m(h),C(),_(!1)}},children:"Capture Photo"}),w.length>1&&(0,Wv.jsx)("button",{type:"button",onClick:()=>{const e=(T+1)%w.length;M(e)},className:"flip-camera-button",children:"Flip Camera"})]}),(0,Wv.jsx)("canvas",{ref:S,style:{display:"none"}})]}),(p||o&&o.imageData&&!d&&!p)&&(0,Wv.jsxs)("div",{className:"image-preview",children:[(0,Wv.jsx)("h4",{children:"Image Preview:"}),(0,Wv.jsx)("img",{src:p||o.imageData,alt:"Preview"}),(0,Wv.jsx)("button",{type:"button",onClick:()=>m(null),children:"Remove Image"})]}),(0,Wv.jsx)("button",{type:"submit",children:o?"Update Item":"Add Item"}),g&&(0,Wv.jsx)("p",{className:"error",children:g})]})]})}):null};const Zv=function(){const{id:e}=xe(),t=Se(),[n,r]=(0,i.useState)(""),[a,s]=(0,i.useState)([]),[o,l]=(0,i.useState)(!0),[c,u]=(0,i.useState)(null),{currentUser:h}=Xv(),[f,p]=(0,i.useState)(!1),[m,g]=(0,i.useState)(null),v=(0,i.useCallback)(async()=>{if(h)try{l(!0);const t=(await jv(h.uid)).find(t=>t.id===e);if(!t)return u("Collection not found or not owned by you."),void l(!1);r(t.name);const n=await(async(e,t)=>{try{const n=gf(Id(Vv,"items"),yf("userId","==",e),yf("collectionId","==",t)),r=(await kf(n)).docs.map(e=>d({id:e.id},e.data()));return r}catch(cU){throw console.error("Error getting items: ",cU),cU}})(h.uid,e);s(n)}catch(t){u("Failed to fetch collection details or items."),console.error(t)}finally{l(!1)}},[h,e]);(0,i.useEffect)(()=>{h&&v()},[h,v]);const y=async e=>{if(h)try{await(async e=>{try{await Df(Rd(Vv,"items",e))}catch(cU){throw console.error("Error deleting item: ",cU),cU}})(e),v()}catch(t){u("Failed to delete item."),console.error(t)}};return o?(0,Wv.jsx)("p",{children:"Loading collection details..."}):c?(0,Wv.jsx)("p",{className:"error",children:c}):(0,Wv.jsxs)("div",{className:"collection-detail-container",children:[(0,Wv.jsx)("button",{type:"button",onClick:()=>{t("/")},className:"back-button",children:"< Back to Collections"}),(0,Wv.jsx)("h2",{children:n}),(0,Wv.jsx)("button",{type:"button",className:"add-item-button",onClick:()=>{g(null),p(!0)},children:"+ Add Item"}),0===a.length?(0,Wv.jsx)("p",{children:"No items in this collection yet. Add one above!"}):(0,Wv.jsx)("ul",{className:"item-list",children:a.map(e=>(0,Wv.jsxs)("li",{className:"item-card",children:[(0,Wv.jsx)("h4",{children:e.name}),(0,Wv.jsx)("p",{children:e.description}),e.imageData&&(0,Wv.jsx)("img",{src:e.imageData,alt:e.name}),(0,Wv.jsxs)("div",{className:"item-actions",children:[(0,Wv.jsx)("button",{type:"button",onClick:()=>(e=>{g(e),p(!0)})(e),children:"Edit"}),(0,Wv.jsx)("button",{type:"button",onClick:()=>y(e.id),className:"delete",children:"Delete"})]})]},e.id))}),(0,Wv.jsx)(Qv,{isOpen:f,onClose:()=>{p(!1),g(null)},collectionId:e,currentUser:h,onItemSaved:()=>{v()},itemToEdit:m})]})};const $v=function(){const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[a,s]=(0,i.useState)(null),o=Se(),{currentUser:l}=Xv();return(0,Wv.jsx)("div",{className:"signin-container",children:l?(0,Wv.jsxs)("div",{className:"welcome-message",children:[(0,Wv.jsxs)("h2",{children:["Welcome, ",l.email]}),(0,Wv.jsx)("button",{onClick:async()=>{try{await yg(Hv),s(null)}catch(e){s(e.message)}},children:"Sign Out"})]}):(0,Wv.jsxs)("div",{children:[(0,Wv.jsx)("h2",{children:"Sign Up / Sign In"}),(0,Wv.jsxs)("form",{children:[(0,Wv.jsx)("input",{type:"email",placeholder:"Email",value:e,onChange:e=>t(e.target.value)}),(0,Wv.jsx)("input",{type:"password",placeholder:"Password",value:n,onChange:e=>r(e.target.value)}),(0,Wv.jsx)("button",{type:"submit",onClick:async t=>{t.preventDefault();try{await function(e,t,n){return xr(e.app)?Promise.reject(Sp(e)):mg(un(e),eg.credential(t,n)).catch(async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&vg(e),t})}(Hv,e,n),o("/")}catch(r){s(r.message)}},children:"Sign In"}),(0,Wv.jsx)("button",{type:"submit",onClick:async t=>{t.preventDefault();try{await async function(e,t,n){if(xr(e.app))return Promise.reject(Sp(e));const r=Cm(e),i=Um(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",og,"EMAIL_PASSWORD_PROVIDER"),a=await i.catch(t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&vg(e),t}),s=await lg._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(s.user),s}(Hv,e,n),o("/")}catch(r){s(r.message)}},children:"Sign Up"})]}),(0,Wv.jsxs)("div",{className:"forgot-password-link",children:[" ",(0,Wv.jsx)(wt,{to:"/forgot-password",children:"Forgot Password?"})]}),a&&(0,Wv.jsx)("p",{className:"error",children:a})]})})};const ey=function(){const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[a,s]=(0,i.useState)(null);return(0,Wv.jsxs)("div",{className:"forgot-password-container",children:[(0,Wv.jsx)("h2",{children:"Forgot Password"}),(0,Wv.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),s(null),r("");try{await async function(e,t,n){const r=Cm(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&gg(r,i,n),await Um(r,i,"getOobCode",qm,"EMAIL_PASSWORD_PROVIDER")}(Hv,e),r("Password reset email sent! Check your inbox.")}catch(n){s(n.message),console.error("Error sending password reset email: ",n)}},children:[(0,Wv.jsx)("input",{type:"email",placeholder:"Enter your email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,Wv.jsx)("button",{type:"submit",children:"Send Reset Email"})]}),n&&(0,Wv.jsx)("p",{className:"success-message",children:n}),a&&(0,Wv.jsx)("p",{className:"error",children:a}),(0,Wv.jsx)("div",{className:"back-to-signin",children:(0,Wv.jsx)(wt,{to:"/signin",children:"Back to Sign In"})})]})};const ty=function(e){let{children:t}=e;const{currentUser:n,loading:r}=Xv();return r?(0,Wv.jsx)("p",{children:"Loading authentication..."}):n?t:(0,Wv.jsx)(ze,{to:"/signin"})};var ny=n(205);const ry="182",iy={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ay={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},sy=0,oy=1,ly=2,cy=3,uy=0,hy=1,dy=2,fy=3,py=0,my=1,gy=2,vy=0,yy=1,_y=2,by=3,Sy=4,xy=5,wy=100,Ey=101,Ty=102,My=103,Cy=104,Ay=200,Iy=201,Ry=202,Py=203,Ny=204,ky=205,Ly=206,Dy=207,Oy=208,Uy=209,Fy=210,zy=211,By=212,Vy=213,Hy=214,jy=0,Gy=1,Wy=2,qy=3,Xy=4,Yy=5,Ky=6,Jy=7,Qy=0,Zy=1,$y=2,e_=0,t_=1,n_=2,r_=3,i_=4,a_=5,s_=6,o_=7,l_="attached",c_="detached",u_=300,h_=301,d_=302,f_=303,p_=304,m_=306,g_=1e3,v_=1001,y_=1002,__=1003,b_=1004,S_=1004,x_=1005,w_=1005,E_=1006,T_=1007,M_=1007,C_=1008,A_=1008,I_=1009,R_=1010,P_=1011,N_=1012,k_=1013,L_=1014,D_=1015,O_=1016,U_=1017,F_=1018,z_=1020,B_=35902,V_=35899,H_=1021,j_=1022,G_=1023,W_=1026,q_=1027,X_=1028,Y_=1029,K_=1030,J_=1031,Q_=1032,Z_=1033,$_=33776,eb=33777,tb=33778,nb=33779,rb=35840,ib=35841,ab=35842,sb=35843,ob=36196,lb=37492,cb=37496,ub=37488,hb=37489,db=37490,fb=37491,pb=37808,mb=37809,gb=37810,vb=37811,yb=37812,_b=37813,bb=37814,Sb=37815,xb=37816,wb=37817,Eb=37818,Tb=37819,Mb=37820,Cb=37821,Ab=36492,Ib=36494,Rb=36495,Pb=36283,Nb=36284,kb=36285,Lb=36286,Db=2200,Ob=2201,Ub=2202,Fb=2300,zb=2301,Bb=2302,Vb=2400,Hb=2401,jb=2402,Gb=2500,Wb=2501,qb=0,Xb=1,Yb=2,Kb=3200,Jb=3201,Qb=3202,Zb=3203,$b=0,eS=1,tS="",nS="srgb",rS="srgb-linear",iS="linear",aS="srgb",sS="",oS="rg",lS="ga",cS=0,uS=7680,hS=7681,dS=7682,fS=7683,pS=34055,mS=34056,gS=5386,vS=512,yS=513,_S=514,bS=515,SS=516,xS=517,wS=518,ES=519,TS=512,MS=513,CS=514,AS=515,IS=516,RS=517,PS=518,NS=519,kS=35044,LS=35048,DS=35040,OS=35045,US=35049,FS=35041,zS=35046,BS=35050,VS=35042,HS="100",jS="300 es",GS=2e3,WS=2001,qS={COMPUTE:"compute",RENDER:"render"},XS={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},YS={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function KS(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}const JS={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function QS(e,t){return new JS[e](t)}function ZS(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $S(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function ex(){const e=$S("canvas");return e.style.display="block",e}const tx={};let nx=null;function rx(e){nx=e}function ix(){return nx}function ax(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r="THREE."+t.shift();nx?nx("log",r,...t):console.log(r,...t)}function sx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r="THREE."+t.shift();nx?nx("warn",r,...t):console.warn(r,...t)}function ox(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r="THREE."+t.shift();nx?nx("error",r,...t):console.error(r,...t)}function lx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=t.join(" ");r in tx||(tx[r]=!0,sx(...t))}class cx{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return void 0!==n&&(void 0!==n[e]&&-1!==n[e].indexOf(t))}removeEventListener(e,t){const n=this._listeners;if(void 0===n)return;const r=n[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){const t=this._listeners;if(void 0===t)return;const n=t[e.type];if(void 0!==n){e.target=this;const t=n.slice(0);for(let n=0,r=t.length;n<r;n++)t[n].call(this,e);e.target=null}}}const ux=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let hx=1234567;const dx=Math.PI/180,fx=180/Math.PI;function px(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(ux[255&e]+ux[e>>8&255]+ux[e>>16&255]+ux[e>>24&255]+"-"+ux[255&t]+ux[t>>8&255]+"-"+ux[t>>16&15|64]+ux[t>>24&255]+"-"+ux[63&n|128]+ux[n>>8&255]+"-"+ux[n>>16&255]+ux[n>>24&255]+ux[255&r]+ux[r>>8&255]+ux[r>>16&255]+ux[r>>24&255]).toLowerCase()}function mx(e,t,n){return Math.max(t,Math.min(n,e))}function gx(e,t){return(e%t+t)%t}function vx(e,t,n){return(1-n)*e+n*t}function yx(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function _x(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}const bx={DEG2RAD:dx,RAD2DEG:fx,generateUUID:px,clamp:mx,euclideanModulo:gx,mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:vx,damp:function(e,t,n,r){return vx(e,t,1-Math.exp(-n*r))},pingpong:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(gx(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(hx=e);let t=hx+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*dx},radToDeg:function(e){return e*fx},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){const a=Math.cos,s=Math.sin,o=a(n/2),l=s(n/2),c=a((t+r)/2),u=s((t+r)/2),h=a((t-r)/2),d=s((t-r)/2),f=a((r-t)/2),p=s((r-t)/2);switch(i){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*p,l*f,o*c);break;case"YXY":e.set(l*f,o*u,l*p,o*c);break;case"ZYZ":e.set(l*p,l*f,o*u,o*c);break;default:sx("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}},normalize:_x,denormalize:yx};class Sx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Sx.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=mx(this.x,e.x,t.x),this.y=mx(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=mx(this.x,e,t),this.y=mx(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mx(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(mx(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*n-a*r+e.x,this.y=i*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class xx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,i,a,s){let o=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],h=i[a+0],d=i[a+1],f=i[a+2],p=i[a+3];if(s<=0)return e[t+0]=o,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(s>=1)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||o!==h||l!==d||c!==f){let e=o*h+l*d+c*f+u*p;e<0&&(h=-h,d=-d,f=-f,p=-p,e=-e);let t=1-s;if(e<.9995){const n=Math.acos(e),r=Math.sin(n);t=Math.sin(t*n)/r,o=o*t+h*(s=Math.sin(s*n)/r),l=l*t+d*s,c=c*t+f*s,u=u*t+p*s}else{o=o*t+h*s,l=l*t+d*s,c=c*t+f*s,u=u*t+p*s;const e=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=e,l*=e,c*=e,u*=e}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,n,r,i,a){const s=n[r],o=n[r+1],l=n[r+2],c=n[r+3],u=i[a],h=i[a+1],d=i[a+2],f=i[a+3];return e[t]=s*f+c*u+o*d-l*h,e[t+1]=o*f+c*h+l*u-s*d,e[t+2]=l*f+c*d+s*h-o*u,e[t+3]=c*f-s*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const n=e._x,r=e._y,i=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(n/2),c=s(r/2),u=s(i/2),h=o(n/2),d=o(r/2),f=o(i/2);switch(a){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:sx("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],i=t[8],a=t[1],s=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=n+s+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-o)*e,this._y=(i-l)*e,this._z=(a-r)*e}else if(n>s&&n>u){const e=2*Math.sqrt(1+n-s-u);this._w=(c-o)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(i+l)/e}else if(s>u){const e=2*Math.sqrt(1+s-n-u);this._w=(i-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(o+c)/e}else{const e=2*Math.sqrt(1+u-n-s);this._w=(a-r)/e,this._x=(i+l)/e,this._y=(o+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(mx(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,i=e._z,a=e._w,s=t._x,o=t._y,l=t._z,c=t._w;return this._x=n*c+a*s+r*l-i*o,this._y=r*c+a*o+i*s-n*l,this._z=i*c+a*l+n*o-r*s,this._w=a*c-n*s-r*o-i*l,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,i=e._z,a=e._w,s=this.dot(e);s<0&&(n=-n,r=-r,i=-i,a=-a,s=-s);let o=1-t;if(s<.9995){const e=Math.acos(s),l=Math.sin(e);o=Math.sin(o*e)/l,t=Math.sin(t*e)/l,this._x=this._x*o+n*t,this._y=this._y*o+r*t,this._z=this._z*o+i*t,this._w=this._w*o+a*t,this._onChangeCallback()}else this._x=this._x*o+n*t,this._y=this._y*o+r*t,this._z=this._z*o+i*t,this._w=this._w*o+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),i=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),i*Math.sin(t),i*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class wx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;wx.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(Tx.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(Tx.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=e.elements,a=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*a,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*a,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,i=e.x,a=e.y,s=e.z,o=e.w,l=2*(a*r-s*n),c=2*(s*t-i*r),u=2*(i*n-a*t);return this.x=t+o*l+a*u-s*c,this.y=n+o*c+s*l-i*u,this.z=r+o*u+i*c-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=mx(this.x,e.x,t.x),this.y=mx(this.y,e.y,t.y),this.z=mx(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=mx(this.x,e,t),this.y=mx(this.y,e,t),this.z=mx(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mx(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,i=e.z,a=t.x,s=t.y,o=t.z;return this.x=r*o-i*s,this.y=i*a-n*o,this.z=n*s-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Ex.copy(this).projectOnVector(e),this.sub(Ex)}reflect(e){return this.sub(Ex.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(mx(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=2*Math.random()-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Ex=new wx,Tx=new xx;class Mx{constructor(e,t,n,r,i,a,s,o,l){Mx.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l)}set(e,t,n,r,i,a,s,o,l){const c=this.elements;return c[0]=e,c[1]=r,c[2]=s,c[3]=t,c[4]=i,c[5]=o,c[6]=n,c[7]=a,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[3],o=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],f=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],S=r[5],x=r[8];return i[0]=a*p+s*v+o*b,i[3]=a*m+s*y+o*S,i[6]=a*g+s*_+o*x,i[1]=l*p+c*v+u*b,i[4]=l*m+c*y+u*S,i[7]=l*g+c*_+u*x,i[2]=h*p+d*v+f*b,i[5]=h*m+d*y+f*S,i[8]=h*g+d*_+f*x,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8];return t*a*c-t*s*l-n*i*c+n*s*o+r*i*l-r*a*o}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=c*a-s*l,h=s*o-c*i,d=l*i-a*o,f=t*u+n*h+r*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(r*l-c*n)*p,e[2]=(s*n-r*a)*p,e[3]=h*p,e[4]=(c*t-r*o)*p,e[5]=(r*i-s*t)*p,e[6]=d*p,e[7]=(n*o-l*t)*p,e[8]=(a*t-n*i)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,i,a,s){const o=Math.cos(i),l=Math.sin(i);return this.set(n*o,n*l,-n*(o*a+l*s)+a+e,-r*l,r*o,-r*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(Cx.makeScale(e,t)),this}rotate(e){return this.premultiply(Cx.makeRotation(-e)),this}translate(e,t){return this.premultiply(Cx.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}const Cx=new Mx,Ax=(new Mx).set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Ix=(new Mx).set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Rx(){const e={enabled:!0,workingColorSpace:rS,spaces:{},convert:function(e,t,n){return!1!==this.enabled&&t!==n&&t&&n?(this.spaces[t].transfer===aS&&(e.r=Nx(e.r),e.g=Nx(e.g),e.b=Nx(e.b)),this.spaces[t].primaries!==this.spaces[n].primaries&&(e.applyMatrix3(this.spaces[t].toXYZ),e.applyMatrix3(this.spaces[n].fromXYZ)),this.spaces[n].transfer===aS&&(e.r=kx(e.r),e.g=kx(e.g),e.b=kx(e.b)),e):e},workingToColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},colorSpaceToWorking:function(e,t){return this.convert(e,t,this.workingColorSpace)},getPrimaries:function(e){return this.spaces[e].primaries},getTransfer:function(e){return e===tS?iS:this.spaces[e].transfer},getToneMappingMode:function(e){return this.spaces[e].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.workingColorSpace;return e.fromArray(this.spaces[t].luminanceCoefficients)},define:function(e){Object.assign(this.spaces,e)},_getMatrix:function(e,t,n){return e.copy(this.spaces[t].toXYZ).multiply(this.spaces[n].fromXYZ)},_getDrawingBufferColorSpace:function(e){return this.spaces[e].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.workingColorSpace;return this.spaces[e].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(t,n){return lx("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),e.workingToColorSpace(t,n)},toWorkingColorSpace:function(t,n){return lx("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),e.colorSpaceToWorking(t,n)}},t=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],r=[.3127,.329];return e.define({[rS]:{primaries:t,whitePoint:r,transfer:iS,toXYZ:Ax,fromXYZ:Ix,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:nS},outputColorSpaceConfig:{drawingBufferColorSpace:nS}},[nS]:{primaries:t,whitePoint:r,transfer:aS,toXYZ:Ax,fromXYZ:Ix,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:nS}}}),e}const Px=Rx();function Nx(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function kx(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let Lx;class Dx{static getDataURL(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/png";if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Lx&&(Lx=$S("canvas")),Lx.width=e.width,Lx.height=e.height;const n=Lx.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Lx}return t.toDataURL(n)}static sRGBToLinear(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){const t=$S("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),i=r.data;for(let e=0;e<i.length;e++)i[e]=255*Nx(i[e]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*Nx(t[e]/255)):t[e]=Nx(t[e]);return{data:t,width:e.width,height:e.height}}return sx("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Ox=0;class Ux{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.isSource=!0,Object.defineProperty(this,"id",{value:Ox++}),this.uuid=px(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):"undefined"!==typeof VideoFrame&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):null!==t?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,n=r.length;t<n;t++)r[t].isDataTexture?e.push(Fx(r[t].image)):e.push(Fx(r[t]))}else e=Fx(r);n.url=e}return t||(e.images[this.uuid]=n),n}}function Fx(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?Dx.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(sx("Texture: Unable to serialize Texture."),{})}let zx=0;const Bx=new wx;class Vx extends cx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vx.DEFAULT_IMAGE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vx.DEFAULT_MAPPING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v_,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:v_,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:E_,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:C_,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:G_,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:I_,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:Vx.DEFAULT_ANISOTROPY,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:tS;super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:zx++}),this.uuid=px(),this.name="",this.source=new Ux(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=i,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new Sx(0,0),this.repeat=new Sx(1,1),this.center=new Sx(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mx,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Bx).x}get height(){return this.source.getSize(Bx).y}get depth(){return this.source.getSize(Bx).z}get image(){return this.source.data}set image(e){void 0===e&&(e=null),this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(void 0===n){sx("Texture.setValues(): parameter '".concat(t,"' has value of undefined."));continue}const r=this[t];void 0!==r?r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n:sx("Texture.setValues(): property '".concat(t,"' does not exist."))}}toJSON(e){const t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==u_)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case g_:e.x=e.x-Math.floor(e.x);break;case v_:e.x=e.x<0?0:1;break;case y_:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case g_:e.y=e.y-Math.floor(e.y);break;case v_:e.y=e.y<0?0:1;break;case y_:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}}Vx.DEFAULT_IMAGE=null,Vx.DEFAULT_MAPPING=u_,Vx.DEFAULT_ANISOTROPY=1;class Hx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Hx.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*i,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*i,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*i,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*i,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,i;const a=.01,s=.1,o=e.elements,l=o[0],c=o[4],u=o[8],h=o[1],d=o[5],f=o[9],p=o[2],m=o[6],g=o[10];if(Math.abs(c-h)<a&&Math.abs(u-p)<a&&Math.abs(f-m)<a){if(Math.abs(c+h)<s&&Math.abs(u+p)<s&&Math.abs(f+m)<s&&Math.abs(l+d+g-3)<s)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,o=(d+1)/2,v=(g+1)/2,y=(c+h)/4,_=(u+p)/4,b=(f+m)/4;return e>o&&e>v?e<a?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(e),r=y/n,i=_/n):o>v?o<a?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(o),n=y/r,i=b/r):v<a?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=b/i),this.set(n,r,i,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=mx(this.x,e.x,t.x),this.y=mx(this.y,e.y,t.y),this.z=mx(this.z,e.z,t.z),this.w=mx(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=mx(this.x,e,t),this.y=mx(this.y,e,t),this.z=mx(this.z,e,t),this.w=mx(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(mx(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class jx extends cx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:E_,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new Hx(0,0,e,t),this.scissorTest=!1,this.viewport=new Hx(0,0,e,t);const r={width:e,height:t,depth:n.depth},i=new Vx(r);this.textures=[];const a=n.count;for(let s=0;s<a;s++)this.textures[s]=i.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={minFilter:E_,generateMipmaps:!1,flipY:!1,internalFormat:null};void 0!==e.mapping&&(t.mapping=e.mapping),void 0!==e.wrapS&&(t.wrapS=e.wrapS),void 0!==e.wrapT&&(t.wrapT=e.wrapT),void 0!==e.wrapR&&(t.wrapR=e.wrapR),void 0!==e.magFilter&&(t.magFilter=e.magFilter),void 0!==e.minFilter&&(t.minFilter=e.minFilter),void 0!==e.format&&(t.format=e.format),void 0!==e.type&&(t.type=e.type),void 0!==e.anisotropy&&(t.anisotropy=e.anisotropy),void 0!==e.colorSpace&&(t.colorSpace=e.colorSpace),void 0!==e.flipY&&(t.flipY=e.flipY),void 0!==e.generateMipmaps&&(t.generateMipmaps=e.generateMipmaps),void 0!==e.internalFormat&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++){this.textures[n].setValues(t)}}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){null!==this._depthTexture&&(this._depthTexture.renderTarget=null),null!==e&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,i=this.textures.length;r<i;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,!0!==this.textures[r].isData3DTexture&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const n=Object.assign({},e.textures[t].image);this.textures[t].source=new Ux(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Gx extends jx{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),this.isWebGLRenderTarget=!0}}class Wx extends Vx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=__,this.minFilter=__,this.wrapR=v_,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class qx extends Gx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new Wx(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Xx extends Vx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=__,this.minFilter=__,this.wrapR=v_,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Yx extends Gx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new Xx(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Kx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx(1/0,1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx(-1/0,-1/0,-1/0);this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Qx.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Qx.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Qx.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n){const r=n.getAttribute("position");if(!0===t&&void 0!==r&&!0!==e.isInstancedMesh)for(let t=0,n=r.count;t<n;t++)!0===e.isMesh?e.getVertexPosition(t,Qx):Qx.fromBufferAttribute(r,t),Qx.applyMatrix4(e.matrixWorld),this.expandByPoint(Qx);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),Zx.copy(e.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),Zx.copy(n.boundingBox)),Zx.applyMatrix4(e.matrixWorld),this.union(Zx)}const r=e.children;for(let i=0,a=r.length;i<a;i++)this.expandByObject(r[i],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Qx),Qx.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(aw),sw.subVectors(this.max,aw),$x.subVectors(e.a,aw),ew.subVectors(e.b,aw),tw.subVectors(e.c,aw),nw.subVectors(ew,$x),rw.subVectors(tw,ew),iw.subVectors($x,tw);let t=[0,-nw.z,nw.y,0,-rw.z,rw.y,0,-iw.z,iw.y,nw.z,0,-nw.x,rw.z,0,-rw.x,iw.z,0,-iw.x,-nw.y,nw.x,0,-rw.y,rw.x,0,-iw.y,iw.x,0];return!!cw(t,$x,ew,tw,sw)&&(t=[1,0,0,0,1,0,0,0,1],!!cw(t,$x,ew,tw,sw)&&(ow.crossVectors(nw,rw),t=[ow.x,ow.y,ow.z],cw(t,$x,ew,tw,sw)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Qx).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(Qx).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Jx[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Jx[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Jx[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Jx[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Jx[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Jx[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Jx[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Jx[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Jx)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Jx=[new wx,new wx,new wx,new wx,new wx,new wx,new wx,new wx],Qx=new wx,Zx=new Kx,$x=new wx,ew=new wx,tw=new wx,nw=new wx,rw=new wx,iw=new wx,aw=new wx,sw=new wx,ow=new wx,lw=new wx;function cw(e,t,n,r,i){for(let a=0,s=e.length-3;a<=s;a+=3){lw.fromArray(e,a);const s=i.x*Math.abs(lw.x)+i.y*Math.abs(lw.y)+i.z*Math.abs(lw.z),o=t.dot(lw),l=n.dot(lw),c=r.dot(lw);if(Math.max(-Math.max(o,l,c),Math.min(o,l,c))>s)return!1}return!0}const uw=new Kx,hw=new wx,dw=new wx;class fw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):uw.setFromPoints(e).getCenter(n);let r=0;for(let i=0,a=e.length;i<a;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;hw.subVectors(e,this.center);const t=hw.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),n=.5*(e-this.radius);this.center.addScaledVector(hw,n/e),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(dw.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(hw.copy(e.center).add(dw)),this.expandByPoint(hw.copy(e.center).sub(dw))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const pw=new wx,mw=new wx,gw=new wx,vw=new wx,yw=new wx,_w=new wx,bw=new wx;class Sw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx(0,0,-1);this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,pw)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=pw.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(pw.copy(this.origin).addScaledVector(this.direction,t),pw.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){mw.copy(e).add(t).multiplyScalar(.5),gw.copy(t).sub(e).normalize(),vw.copy(this.origin).sub(mw);const i=.5*e.distanceTo(t),a=-this.direction.dot(gw),s=vw.dot(this.direction),o=-vw.dot(gw),l=vw.lengthSq(),c=Math.abs(1-a*a);let u,h,d,f;if(c>0)if(u=a*o-s,h=a*s-o,f=i*c,u>=0)if(h>=-f)if(h<=f){const e=1/c;u*=e,h*=e,d=u*(u+a*h+2*s)+h*(a*u+h+2*o)+l}else h=i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h=-i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;else h<=-f?(u=Math.max(0,-(-a*i+s)),h=u>0?-i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l):h<=f?(u=0,h=Math.min(Math.max(-i,-o),i),d=h*(h+2*o)+l):(u=Math.max(0,-(a*i+s)),h=u>0?i:Math.min(Math.max(-i,-o),i),d=-u*u+h*(h+2*o)+l);else h=a>0?-i:i,u=Math.max(0,-(a*h+s)),d=-u*u+h*(h+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(mw).addScaledVector(gw,h),d}intersectSphere(e,t){pw.subVectors(e.center,this.origin);const n=pw.dot(this.direction),r=pw.dot(pw)-n*n,i=e.radius*e.radius;if(r>i)return null;const a=Math.sqrt(i-r),s=n-a,o=n+a;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return!(e.radius<0)&&this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,i,a,s,o;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,r=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,r=(e.min.x-h.x)*l),c>=0?(i=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(i=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),n>a||i>r?null:((i>n||isNaN(n))&&(n=i),(a<r||isNaN(r))&&(r=a),u>=0?(s=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(s=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),n>o||s>r?null:((s>n||n!==n)&&(n=s),(o<r||r!==r)&&(r=o),r<0?null:this.at(n>=0?n:r,t)))}intersectsBox(e){return null!==this.intersectBox(e,pw)}intersectTriangle(e,t,n,r,i){yw.subVectors(t,e),_w.subVectors(n,e),bw.crossVectors(yw,_w);let a,s=this.direction.dot(bw);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}vw.subVectors(this.origin,e);const o=a*this.direction.dot(_w.crossVectors(vw,_w));if(o<0)return null;const l=a*this.direction.dot(yw.cross(vw));if(l<0)return null;if(o+l>s)return null;const c=-a*vw.dot(bw);return c<0?null:this.at(c/s,i)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class xw{constructor(e,t,n,r,i,a,s,o,l,c,u,h,d,f,p,m){xw.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,n,r,i,a,s,o,l,c,u,h,d,f,p,m)}set(e,t,n,r,i,a,s,o,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=r,g[1]=i,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new xw).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return 0===this.determinant()?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(0===e.determinant())return this.identity();const t=this.elements,n=e.elements,r=1/ww.setFromMatrixColumn(e,0).length(),i=1/ww.setFromMatrixColumn(e,1).length(),a=1/ww.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,i=e.z,a=Math.cos(n),s=Math.sin(n),o=Math.cos(r),l=Math.sin(r),c=Math.cos(i),u=Math.sin(i);if("XYZ"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=n+r*l,t[5]=e-i*l,t[9]=-s*o,t[2]=i-e*l,t[6]=r+n*l,t[10]=a*o}else if("YXZ"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e+i*s,t[4]=r*s-n,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-s,t[2]=n*s-r,t[6]=i+e*s,t[10]=a*o}else if("ZXY"===e.order){const e=o*c,n=o*u,r=l*c,i=l*u;t[0]=e-i*s,t[4]=-a*u,t[8]=r+n*s,t[1]=n+r*s,t[5]=a*c,t[9]=i-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){const e=a*c,n=a*u,r=s*c,i=s*u;t[0]=o*c,t[4]=r*l-n,t[8]=e*l+i,t[1]=o*u,t[5]=i*l+e,t[9]=n*l-r,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=i-e*u,t[8]=r*u+n,t[1]=u,t[5]=a*c,t[9]=-s*c,t[2]=-l*c,t[6]=n*u+r,t[10]=e-i*u}else if("XZY"===e.order){const e=a*o,n=a*l,r=s*o,i=s*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=e*u+i,t[5]=a*c,t[9]=n*u-r,t[2]=r*u-n,t[6]=s*c,t[10]=i*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Tw,e,Mw)}lookAt(e,t,n){const r=this.elements;return Iw.subVectors(e,t),0===Iw.lengthSq()&&(Iw.z=1),Iw.normalize(),Cw.crossVectors(n,Iw),0===Cw.lengthSq()&&(1===Math.abs(n.z)?Iw.x+=1e-4:Iw.z+=1e-4,Iw.normalize(),Cw.crossVectors(n,Iw)),Cw.normalize(),Aw.crossVectors(Iw,Cw),r[0]=Cw.x,r[4]=Aw.x,r[8]=Iw.x,r[1]=Cw.y,r[5]=Aw.y,r[9]=Iw.y,r[2]=Cw.z,r[6]=Aw.z,r[10]=Iw.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,i=this.elements,a=n[0],s=n[4],o=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],f=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],S=r[0],x=r[4],w=r[8],E=r[12],T=r[1],M=r[5],C=r[9],A=r[13],I=r[2],R=r[6],P=r[10],N=r[14],k=r[3],L=r[7],D=r[11],O=r[15];return i[0]=a*S+s*T+o*I+l*k,i[4]=a*x+s*M+o*R+l*L,i[8]=a*w+s*C+o*P+l*D,i[12]=a*E+s*A+o*N+l*O,i[1]=c*S+u*T+h*I+d*k,i[5]=c*x+u*M+h*R+d*L,i[9]=c*w+u*C+h*P+d*D,i[13]=c*E+u*A+h*N+d*O,i[2]=f*S+p*T+m*I+g*k,i[6]=f*x+p*M+m*R+g*L,i[10]=f*w+p*C+m*P+g*D,i[14]=f*E+p*A+m*N+g*O,i[3]=v*S+y*T+_*I+b*k,i[7]=v*x+y*M+_*R+b*L,i[11]=v*w+y*C+_*P+b*D,i[15]=v*E+y*A+_*N+b*O,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],a=e[1],s=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14],f=e[3],p=e[7],m=e[11],g=e[15],v=o*d-l*h,y=s*d-l*u,_=s*h-o*u,b=a*d-l*c,S=a*h-o*c,x=a*u-s*c;return t*(p*v-m*y+g*_)-n*(f*v-m*b+g*S)+r*(f*y-p*b+g*x)-i*(f*_-p*S+m*x)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],a=e[4],s=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*o*d-s*m*d-u*o*g+s*h*g,y=f*h*l-c*m*l-f*o*d+a*m*d+c*o*g-a*h*g,_=c*p*l-f*u*l+f*s*d-a*p*d-c*s*g+a*u*g,b=f*u*o-c*p*o-f*s*h+a*p*h+c*s*m-a*u*m,S=t*v+n*y+r*_+i*b;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const x=1/S;return e[0]=v*x,e[1]=(p*h*i-u*m*i-p*r*d+n*m*d+u*r*g-n*h*g)*x,e[2]=(s*m*i-p*o*i+p*r*l-n*m*l-s*r*g+n*o*g)*x,e[3]=(u*o*i-s*h*i-u*r*l+n*h*l+s*r*d-n*o*d)*x,e[4]=y*x,e[5]=(c*m*i-f*h*i+f*r*d-t*m*d-c*r*g+t*h*g)*x,e[6]=(f*o*i-a*m*i-f*r*l+t*m*l+a*r*g-t*o*g)*x,e[7]=(a*h*i-c*o*i+c*r*l-t*h*l-a*r*d+t*o*d)*x,e[8]=_*x,e[9]=(f*u*i-c*p*i-f*n*d+t*p*d+c*n*g-t*u*g)*x,e[10]=(a*p*i-f*s*i+f*n*l-t*p*l-a*n*g+t*s*g)*x,e[11]=(c*s*i-a*u*i-c*n*l+t*u*l+a*n*d-t*s*d)*x,e[12]=b*x,e[13]=(c*p*r-f*u*r+f*n*h-t*p*h-c*n*m+t*u*m)*x,e[14]=(f*s*r-a*p*r-f*n*o+t*p*o+a*n*m-t*s*m)*x,e[15]=(a*u*r-c*s*r+c*n*o-t*u*o-a*n*h+t*s*h)*x,this}scale(e){const t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),i=1-n,a=e.x,s=e.y,o=e.z,l=i*a,c=i*s;return this.set(l*a+n,l*s-r*o,l*o+r*s,0,l*s+r*o,c*s+n,c*o-r*a,0,l*o-r*s,c*o+r*a,i*o*o+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,i,a){return this.set(1,n,i,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,i=t._x,a=t._y,s=t._z,o=t._w,l=i+i,c=a+a,u=s+s,h=i*l,d=i*c,f=i*u,p=a*c,m=a*u,g=s*u,v=o*l,y=o*c,_=o*u,b=n.x,S=n.y,x=n.z;return r[0]=(1-(p+g))*b,r[1]=(d+_)*b,r[2]=(f-y)*b,r[3]=0,r[4]=(d-_)*S,r[5]=(1-(h+g))*S,r[6]=(m+v)*S,r[7]=0,r[8]=(f+y)*x,r[9]=(m-v)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],0===this.determinant())return n.set(1,1,1),t.identity(),this;let i=ww.set(r[0],r[1],r[2]).length();const a=ww.set(r[4],r[5],r[6]).length(),s=ww.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),Ew.copy(this);const o=1/i,l=1/a,c=1/s;return Ew.elements[0]*=o,Ew.elements[1]*=o,Ew.elements[2]*=o,Ew.elements[4]*=l,Ew.elements[5]*=l,Ew.elements[6]*=l,Ew.elements[8]*=c,Ew.elements[9]*=c,Ew.elements[10]*=c,t.setFromRotationMatrix(Ew),n.x=i,n.y=a,n.z=s,this}makePerspective(e,t,n,r,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:GS,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2*i/(t-e),u=2*i/(n-r),h=(t+e)/(t-e),d=(n+r)/(n-r);let f,p;if(o)f=i/(a-i),p=a*i/(a-i);else if(s===GS)f=-(a+i)/(a-i),p=-2*a*i/(a-i);else{if(s!==WS)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);f=-a/(a-i),p=-a*i/(a-i)}return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,n,r,i,a){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:GS,o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=this.elements,c=2/(t-e),u=2/(n-r),h=-(t+e)/(t-e),d=-(n+r)/(n-r);let f,p;if(o)f=1/(a-i),p=a/(a-i);else if(s===GS)f=-2/(a-i),p=-(a+i)/(a-i);else{if(s!==WS)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);f=-1/(a-i),p=-i/(a-i)}return l[0]=c,l[4]=0,l[8]=0,l[12]=h,l[1]=0,l[5]=u,l[9]=0,l[13]=d,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const ww=new wx,Ew=new xw,Tw=new wx(0,0,0),Mw=new wx(1,1,1),Cw=new wx,Aw=new wx,Iw=new wx,Rw=new xw,Pw=new xx;class Nw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Nw.DEFAULT_ORDER;this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=e.elements,i=r[0],a=r[4],s=r[8],o=r[1],l=r[5],c=r[9],u=r[2],h=r[6],d=r[10];switch(t){case"XYZ":this._y=Math.asin(mx(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-a,i)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-mx(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,i),this._z=0);break;case"ZXY":this._x=Math.asin(mx(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,i));break;case"ZYX":this._y=Math.asin(-mx(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,i)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(mx(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,i)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-mx(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-c,d),this._y=0);break;default:sx("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return Rw.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Rw,t,n)}setFromVector3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}reorder(e){return Pw.setFromEuler(this),this.setFromQuaternion(Pw,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Nw.DEFAULT_ORDER="XYZ";class kw{constructor(){this.mask=1}set(e){this.mask=1<<e>>>0}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return 0!==(this.mask&e.mask)}isEnabled(e){return 0!==(this.mask&1<<e)}}let Lw=0;const Dw=new wx,Ow=new xx,Uw=new xw,Fw=new wx,zw=new wx,Bw=new wx,Vw=new xx,Hw=new wx(1,0,0),jw=new wx(0,1,0),Gw=new wx(0,0,1),Ww={type:"added"},qw={type:"removed"},Xw={type:"childadded",child:null},Yw={type:"childremoved",child:null};class Kw extends cx{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Lw++}),this.uuid=px(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kw.DEFAULT_UP.clone();const e=new wx,t=new Nw,n=new xx,r=new wx(1,1,1);t._onChange(function(){n.setFromEuler(t,!1)}),n._onChange(function(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new xw},normalMatrix:{value:new Mx}}),this.matrix=new xw,this.matrixWorld=new xw,this.matrixAutoUpdate=Kw.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Kw.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new kw,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ow.setFromAxisAngle(e,t),this.quaternion.multiply(Ow),this}rotateOnWorldAxis(e,t){return Ow.setFromAxisAngle(e,t),this.quaternion.premultiply(Ow),this}rotateX(e){return this.rotateOnAxis(Hw,e)}rotateY(e){return this.rotateOnAxis(jw,e)}rotateZ(e){return this.rotateOnAxis(Gw,e)}translateOnAxis(e,t){return Dw.copy(e).applyQuaternion(this.quaternion),this.position.add(Dw.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Hw,e)}translateY(e){return this.translateOnAxis(jw,e)}translateZ(e){return this.translateOnAxis(Gw,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Uw.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Fw.copy(e):Fw.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),zw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Uw.lookAt(zw,Fw,this.up):Uw.lookAt(Fw,zw,this.up),this.quaternion.setFromRotationMatrix(Uw),r&&(Uw.extractRotation(r.matrixWorld),Ow.setFromRotationMatrix(Uw),this.quaternion.premultiply(Ow.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(ox("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Ww),Xw.child=e,this.dispatchEvent(Xw),Xw.child=null):ox("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(qw),Yw.child=e,this.dispatchEvent(Yw),Yw.child=null),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Uw.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Uw.multiply(e.parent.matrixWorld)),e.applyMatrix4(Uw),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Ww),Xw.child=e,this.dispatchEvent(Xw),Xw.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const r=this.children[n].getObjectByProperty(e,t);if(void 0!==r)return r}}getObjectsByProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this[e]===t&&n.push(this);const r=this.children;for(let i=0,a=r.length;i<a;i++)r[i].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zw,e,Bw),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(zw,Vw,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++){t[n].updateMatrixWorld(e)}}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===t){const e=this.children;for(let t=0,n=e.length;t<n;t++){e[t].updateWorldMatrix(!1,!0)}}}toJSON(e){const t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(e=>d(d({},e),{},{boundingBox:e.boundingBox?e.boundingBox.toJSON():void 0,boundingSphere:e.boundingSphere?e.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(e=>d({},e)),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),null!==this._colorsTexture&&(r.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(r.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(r.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const n=t.shapes;if(Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const r=n[t];i(e.shapes,r)}else i(e.shapes,n)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(i(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let n=0,r=this.material.length;n<r;n++)t.push(i(e.materials,this.material[n]));r.material=t}else r.material=i(e.materials,this.material);if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){const n=this.animations[t];r.animations.push(i(e.animations,n))}}if(t){const t=a(e.geometries),r=a(e.materials),i=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),c=a(e.animations),u=a(e.nodes);t.length>0&&(n.geometries=t),r.length>0&&(n.materials=r),i.length>0&&(n.textures=i),s.length>0&&(n.images=s),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c),u.length>0&&(n.nodes=u)}return n.object=r,n;function a(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++){const t=e.children[n];this.add(t.clone())}return this}}Kw.DEFAULT_UP=new wx(0,1,0),Kw.DEFAULT_MATRIX_AUTO_UPDATE=!0,Kw.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Jw=new wx,Qw=new wx,Zw=new wx,$w=new wx,eE=new wx,tE=new wx,nE=new wx,rE=new wx,iE=new wx,aE=new wx,sE=new Hx,oE=new Hx,lE=new Hx;class cE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new wx;this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Jw.subVectors(e,t),r.cross(Jw);const i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)}static getBarycoord(e,t,n,r,i){Jw.subVectors(r,t),Qw.subVectors(n,t),Zw.subVectors(e,t);const a=Jw.dot(Jw),s=Jw.dot(Qw),o=Jw.dot(Zw),l=Qw.dot(Qw),c=Qw.dot(Zw),u=a*l-s*s;if(0===u)return i.set(0,0,0),null;const h=1/u,d=(l*o-s*c)*h,f=(a*c-s*o)*h;return i.set(1-d-f,f,d)}static containsPoint(e,t,n,r){return null!==this.getBarycoord(e,t,n,r,$w)&&($w.x>=0&&$w.y>=0&&$w.x+$w.y<=1)}static getInterpolation(e,t,n,r,i,a,s,o){return null===this.getBarycoord(e,t,n,r,$w)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(i,$w.x),o.addScaledVector(a,$w.y),o.addScaledVector(s,$w.z),o)}static getInterpolatedAttribute(e,t,n,r,i,a){return sE.setScalar(0),oE.setScalar(0),lE.setScalar(0),sE.fromBufferAttribute(e,t),oE.fromBufferAttribute(e,n),lE.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(sE,i.x),a.addScaledVector(oE,i.y),a.addScaledVector(lE,i.z),a}static isFrontFacing(e,t,n,r){return Jw.subVectors(n,t),Qw.subVectors(e,t),Jw.cross(Qw).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Jw.subVectors(this.c,this.b),Qw.subVectors(this.a,this.b),.5*Jw.cross(Qw).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return cE.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return cE.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,i){return cE.getInterpolation(e,this.a,this.b,this.c,t,n,r,i)}containsPoint(e){return cE.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return cE.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,i=this.c;let a,s;eE.subVectors(r,n),tE.subVectors(i,n),rE.subVectors(e,n);const o=eE.dot(rE),l=tE.dot(rE);if(o<=0&&l<=0)return t.copy(n);iE.subVectors(e,r);const c=eE.dot(iE),u=tE.dot(iE);if(c>=0&&u<=c)return t.copy(r);const h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return a=o/(o-c),t.copy(n).addScaledVector(eE,a);aE.subVectors(e,i);const d=eE.dot(aE),f=tE.dot(aE);if(f>=0&&d<=f)return t.copy(i);const p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return s=l/(l-f),t.copy(n).addScaledVector(tE,s);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return nE.subVectors(i,r),s=(u-c)/(u-c+(d-f)),t.copy(r).addScaledVector(nE,s);const g=1/(m+p+h);return a=p*g,s=h*g,t.copy(n).addScaledVector(eE,a).addScaledVector(tE,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const uE={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hE={h:0,s:0,l:0},dE={h:0,s:0,l:0};function fE(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}class pE{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(void 0===t&&void 0===n){const t=e;t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nS;return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Px.colorSpaceToWorking(this,t),this}setRGB(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Px.workingColorSpace;return this.r=e,this.g=t,this.b=n,Px.colorSpaceToWorking(this,r),this}setHSL(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Px.workingColorSpace;if(e=gx(e,1),t=mx(t,0,1),n=mx(n,0,1),0===t)this.r=this.g=this.b=n;else{const r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=fE(i,r,e+1/3),this.g=fE(i,r,e),this.b=fE(i,r,e-1/3)}return Px.colorSpaceToWorking(this,r),this}setStyle(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nS;function r(t){void 0!==t&&parseFloat(t)<1&&sx("Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){let i;const a=t[1],s=t[2];switch(a){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(i[4]),this.setRGB(Math.min(255,parseInt(i[1],10))/255,Math.min(255,parseInt(i[2],10))/255,Math.min(255,parseInt(i[3],10))/255,n);if(i=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(i[4]),this.setRGB(Math.min(100,parseInt(i[1],10))/100,Math.min(100,parseInt(i[2],10))/100,Math.min(100,parseInt(i[3],10))/100,n);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(i[4]),this.setHSL(parseFloat(i[1])/360,parseFloat(i[2])/100,parseFloat(i[3])/100,n);break;default:sx("Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=t[1],i=r.length;if(3===i)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,n);if(6===i)return this.setHex(parseInt(r,16),n);sx("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nS;const n=uE[e.toLowerCase()];return void 0!==n?this.setHex(n,t):sx("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Nx(e.r),this.g=Nx(e.g),this.b=Nx(e.b),this}copyLinearToSRGB(e){return this.r=kx(e.r),this.g=kx(e.g),this.b=kx(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nS;return Px.workingToColorSpace(mE.copy(this),e),65536*Math.round(mx(255*mE.r,0,255))+256*Math.round(mx(255*mE.g,0,255))+Math.round(mx(255*mE.b,0,255))}getHexString(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nS;return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Px.workingColorSpace;Px.workingToColorSpace(mE.copy(this),t);const n=mE.r,r=mE.g,i=mE.b,a=Math.max(n,r,i),s=Math.min(n,r,i);let o,l;const c=(s+a)/2;if(s===a)o=0,l=0;else{const e=a-s;switch(l=c<=.5?e/(a+s):e/(2-a-s),a){case n:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-n)/e+2;break;case i:o=(n-r)/e+4}o/=6}return e.h=o,e.s=l,e.l=c,e}getRGB(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Px.workingColorSpace;return Px.workingToColorSpace(mE.copy(this),t),e.r=mE.r,e.g=mE.g,e.b=mE.b,e}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nS;Px.workingToColorSpace(mE.copy(this),e);const t=mE.r,n=mE.g,r=mE.b;return e!==nS?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}offsetHSL(e,t,n){return this.getHSL(hE),this.setHSL(hE.h+e,hE.s+t,hE.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(hE),e.getHSL(dE);const n=vx(hE.h,dE.h,t),r=vx(hE.s,dE.s,t),i=vx(hE.l,dE.l,t);return this.setHSL(n,r,i),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,i=e.elements;return this.r=i[0]*t+i[3]*n+i[6]*r,this.g=i[1]*t+i[4]*n+i[7]*r,this.b=i[2]*t+i[5]*n+i[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const mE=new pE;pE.NAMES=uE;let gE=0;class vE extends cx{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:gE++}),this.uuid=px(),this.name="",this.type="Material",this.blending=yy,this.side=py,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Ny,this.blendDst=ky,this.blendEquation=wy,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new pE(0,0,0),this.blendAlpha=0,this.depthFunc=qy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ES,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=uS,this.stencilZFail=uS,this.stencilZPass=uS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const n=e[t];if(void 0===n){sx("Material: parameter '".concat(t,"' has value of undefined."));continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:sx("Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}}toJSON(e){const t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};function r(e){const t=[];for(const n in e){const r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),void 0!==this.dispersion&&(n.dispersion=this.dispersion),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapRotation&&(n.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==yy&&(n.blending=this.blending),this.side!==py&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),this.blendSrc!==Ny&&(n.blendSrc=this.blendSrc),this.blendDst!==ky&&(n.blendDst=this.blendDst),this.blendEquation!==wy&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==qy&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==ES&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==uS&&(n.stencilFail=this.stencilFail),this.stencilZFail!==uS&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==uS&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!1===this.allowOverride&&(n.allowOverride=!1),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){const t=r(e.textures),i=r(e.images);t.length>0&&(n.textures=t),i.length>0&&(n.images=i)}return n}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(null!==t){const e=t.length;n=new Array(e);for(let r=0;r!==e;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class yE extends vE{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pE(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nw,this.combine=Qy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _E=bE();function bE(){const e=new ArrayBuffer(4),t=new Float32Array(e),n=new Uint32Array(e),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const e=l-127;e<-27?(r[l]=0,r[256|l]=32768,i[l]=24,i[256|l]=24):e<-14?(r[l]=1024>>-e-14,r[256|l]=1024>>-e-14|32768,i[l]=-e-1,i[256|l]=-e-1):e<=15?(r[l]=e+15<<10,r[256|l]=e+15<<10|32768,i[l]=13,i[256|l]=13):e<128?(r[l]=31744,r[256|l]=64512,i[l]=24,i[256|l]=24):(r[l]=31744,r[256|l]=64512,i[l]=13,i[256|l]=13)}const a=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let e=l<<13,t=0;for(;0===(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,a[l]=e|t}for(let l=1024;l<2048;++l)a[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)s[l]=l<<23;s[31]=1199570944,s[32]=2147483648;for(let l=33;l<63;++l)s[l]=2147483648+(l-32<<23);s[63]=3347054592;for(let l=1;l<64;++l)32!==l&&(o[l]=1024);return{floatView:t,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:a,exponentTable:s,offsetTable:o}}function SE(e){Math.abs(e)>65504&&sx("DataUtils.toHalfFloat(): Value out of range."),e=mx(e,-65504,65504),_E.floatView[0]=e;const t=_E.uint32View[0],n=t>>23&511;return _E.baseTable[n]+((8388607&t)>>_E.shiftTable[n])}function xE(e){const t=e>>10;return _E.uint32View[0]=_E.mantissaTable[_E.offsetTable[t]+(1023&e)]+_E.exponentTable[t],_E.floatView[0]}class wE{static toHalfFloat(e){return SE(e)}static fromHalfFloat(e){return xE(e)}}const EE=new wx,TE=new Sx;let ME=0;class CE{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:ME++}),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=n,this.usage=kS,this.updateRanges=[],this.gpuType=D_,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)TE.fromBufferAttribute(this,t),TE.applyMatrix3(e),this.setXY(t,TE.x,TE.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)EE.fromBufferAttribute(this,t),EE.applyMatrix3(e),this.setXYZ(t,EE.x,EE.y,EE.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)EE.fromBufferAttribute(this,t),EE.applyMatrix4(e),this.setXYZ(t,EE.x,EE.y,EE.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)EE.fromBufferAttribute(this,t),EE.applyNormalMatrix(e),this.setXYZ(t,EE.x,EE.y,EE.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)EE.fromBufferAttribute(this,t),EE.transformDirection(e),this.setXYZ(t,EE.x,EE.y,EE.z);return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=yx(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=_x(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=yx(t,this.array)),t}setX(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=yx(t,this.array)),t}setY(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=yx(t,this.array)),t}setZ(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=yx(t,this.array)),t}setW(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array),i=_x(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==kS&&(e.usage=this.usage),e}}class AE extends CE{constructor(e,t,n){super(new Int8Array(e),t,n)}}class IE extends CE{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class RE extends CE{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class PE extends CE{constructor(e,t,n){super(new Int16Array(e),t,n)}}class NE extends CE{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class kE extends CE{constructor(e,t,n){super(new Int32Array(e),t,n)}}class LE extends CE{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class DE extends CE{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=xE(this.array[e*this.itemSize]);return this.normalized&&(t=yx(t,this.array)),t}setX(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize]=SE(t),this}getY(e){let t=xE(this.array[e*this.itemSize+1]);return this.normalized&&(t=yx(t,this.array)),t}setY(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+1]=SE(t),this}getZ(e){let t=xE(this.array[e*this.itemSize+2]);return this.normalized&&(t=yx(t,this.array)),t}setZ(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+2]=SE(t),this}getW(e){let t=xE(this.array[e*this.itemSize+3]);return this.normalized&&(t=yx(t,this.array)),t}setW(e,t){return this.normalized&&(t=_x(t,this.array)),this.array[e*this.itemSize+3]=SE(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array)),this.array[e+0]=SE(t),this.array[e+1]=SE(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array)),this.array[e+0]=SE(t),this.array[e+1]=SE(n),this.array[e+2]=SE(r),this}setXYZW(e,t,n,r,i){return e*=this.itemSize,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array),i=_x(i,this.array)),this.array[e+0]=SE(t),this.array[e+1]=SE(n),this.array[e+2]=SE(r),this.array[e+3]=SE(i),this}}class OE extends CE{constructor(e,t,n){super(new Float32Array(e),t,n)}}let UE=0;const FE=new xw,zE=new Kw,BE=new wx,VE=new Kx,HE=new Kx,jE=new wx;class GE extends cx{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:UE++}),this.uuid=px(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(KS(e)?LE:NE)(e,1):this.index=e,this}setIndirect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const t=(new Mx).getNormalMatrix(e);n.applyNormalMatrix(t),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return FE.makeRotationFromQuaternion(e),this.applyMatrix4(FE),this}rotateX(e){return FE.makeRotationX(e),this.applyMatrix4(FE),this}rotateY(e){return FE.makeRotationY(e),this.applyMatrix4(FE),this}rotateZ(e){return FE.makeRotationZ(e),this.applyMatrix4(FE),this}translate(e,t,n){return FE.makeTranslation(e,t,n),this.applyMatrix4(FE),this}scale(e,t,n){return FE.makeScale(e,t,n),this.applyMatrix4(FE),this}lookAt(e){return zE.lookAt(e),zE.updateMatrix(),this.applyMatrix4(zE.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(BE).negate(),this.translate(BE.x,BE.y,BE.z),this}setFromPoints(e){const t=this.getAttribute("position");if(void 0===t){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n];t.push(r.x,r.y,r.z||0)}this.setAttribute("position",new OE(t,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const n=e[r];t.setXYZ(r,n.x,n.y,n.z||0)}e.length>t.count&&sx("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Kx);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return ox("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),void this.boundingBox.set(new wx(-1/0,-1/0,-1/0),new wx(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const e=t[n];VE.setFromBufferAttribute(e),this.morphTargetsRelative?(jE.addVectors(this.boundingBox.min,VE.min),this.boundingBox.expandByPoint(jE),jE.addVectors(this.boundingBox.max,VE.max),this.boundingBox.expandByPoint(jE)):(this.boundingBox.expandByPoint(VE.min),this.boundingBox.expandByPoint(VE.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&ox('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new fw);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return ox("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),void this.boundingSphere.set(new wx,1/0);if(e){const n=this.boundingSphere.center;if(VE.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){const n=t[e];HE.setFromBufferAttribute(n),this.morphTargetsRelative?(jE.addVectors(VE.min,HE.min),VE.expandByPoint(jE),jE.addVectors(VE.max,HE.max),VE.expandByPoint(jE)):(VE.expandByPoint(HE.min),VE.expandByPoint(HE.max))}VE.getCenter(n);let r=0;for(let t=0,i=e.count;t<i;t++)jE.fromBufferAttribute(e,t),r=Math.max(r,n.distanceToSquared(jE));if(t)for(let i=0,a=t.length;i<a;i++){const a=t[i],s=this.morphTargetsRelative;for(let t=0,i=a.count;t<i;t++)jE.fromBufferAttribute(a,t),s&&(BE.fromBufferAttribute(e,t),jE.add(BE)),r=Math.max(r,n.distanceToSquared(jE))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&ox('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void ox("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.position,r=t.normal,i=t.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new CE(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),s=[],o=[];for(let w=0;w<n.count;w++)s[w]=new wx,o[w]=new wx;const l=new wx,c=new wx,u=new wx,h=new Sx,d=new Sx,f=new Sx,p=new wx,m=new wx;function g(e,t,r){l.fromBufferAttribute(n,e),c.fromBufferAttribute(n,t),u.fromBufferAttribute(n,r),h.fromBufferAttribute(i,e),d.fromBufferAttribute(i,t),f.fromBufferAttribute(i,r),c.sub(l),u.sub(l),d.sub(h),f.sub(h);const a=1/(d.x*f.y-f.x*d.y);isFinite(a)&&(p.copy(c).multiplyScalar(f.y).addScaledVector(u,-d.y).multiplyScalar(a),m.copy(u).multiplyScalar(d.x).addScaledVector(c,-f.x).multiplyScalar(a),s[e].add(p),s[t].add(p),s[r].add(p),o[e].add(m),o[t].add(m),o[r].add(m))}let v=this.groups;0===v.length&&(v=[{start:0,count:e.count}]);for(let w=0,E=v.length;w<E;++w){const t=v[w],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)g(e.getX(r+0),e.getX(r+1),e.getX(r+2))}const y=new wx,_=new wx,b=new wx,S=new wx;function x(e){b.fromBufferAttribute(r,e),S.copy(b);const t=s[e];y.copy(t),y.sub(b.multiplyScalar(b.dot(t))).normalize(),_.crossVectors(S,t);const n=_.dot(o[e])<0?-1:1;a.setXYZW(e,y.x,y.y,y.z,n)}for(let w=0,E=v.length;w<E;++w){const t=v[w],n=t.start;for(let r=n,i=n+t.count;r<i;r+=3)x(e.getX(r+0)),x(e.getX(r+1)),x(e.getX(r+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new CE(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let e=0,t=n.count;e<t;e++)n.setXYZ(e,0,0,0);const r=new wx,i=new wx,a=new wx,s=new wx,o=new wx,l=new wx,c=new wx,u=new wx;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);r.fromBufferAttribute(t,d),i.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),s.fromBufferAttribute(n,d),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,p),s.add(c),o.add(c),l.add(c),n.setXYZ(d,s.x,s.y,s.z),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,h=t.count;e<h;e+=3)r.fromBufferAttribute(t,e+0),i.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),c.subVectors(a,i),u.subVectors(r,i),c.cross(u),n.setXYZ(e+0,c.x,c.y,c.z),n.setXYZ(e+1,c.x,c.y,c.z),n.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)jE.fromBufferAttribute(e,t),jE.normalize(),e.setXYZ(t,jE.x,jE.y,jE.z)}toNonIndexed(){function e(e,t){const n=e.array,r=e.itemSize,i=e.normalized,a=new n.constructor(t.length*r);let s=0,o=0;for(let l=0,c=t.length;l<c;l++){s=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(let e=0;e<r;e++)a[o++]=n[s++]}return new CE(a,r,i)}if(null===this.index)return sx("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new GE,n=this.index.array,r=this.attributes;for(const s in r){const i=e(r[s],n);t.setAttribute(s,i)}const i=this.morphAttributes;for(const s in i){const r=[],a=i[s];for(let t=0,i=a.length;t<i;t++){const i=e(a[t],n);r.push(i)}t.morphAttributes[s]=r}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let s=0,o=a.length;s<o;s++){const e=a[s];t.addGroup(e.start,e.count,e.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const o in n){const t=n[o];e.data.attributes[o]=t.toJSON(e.data)}const r={};let i=!1;for(const o in this.morphAttributes){const t=this.morphAttributes[o],n=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];n.push(i.toJSON(e.data))}n.length>0&&(r[o]=n,i=!0)}i&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const s=this.boundingSphere;return null!==s&&(e.data.boundingSphere=s.toJSON()),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone());const r=e.attributes;for(const l in r){const e=r[l];this.setAttribute(l,e.clone(t))}const i=e.morphAttributes;for(const l in i){const e=[],n=i[l];for(let r=0,i=n.length;r<i;r++)e.push(n[r].clone(t));this.morphAttributes[l]=e}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,c=a.length;l<c;l++){const e=a[l];this.addGroup(e.start,e.count,e.materialIndex)}const s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());const o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const WE=new xw,qE=new Sw,XE=new fw,YE=new wx,KE=new wx,JE=new wx,QE=new wx,ZE=new wx,$E=new wx,eT=new wx,tT=new wx;class nT extends Kw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new GE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new yE;super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,i=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const s=this.morphTargetInfluences;if(i&&s){$E.set(0,0,0);for(let n=0,r=i.length;n<r;n++){const r=s[n],o=i[n];0!==r&&(ZE.fromBufferAttribute(o,e),a?$E.addScaledVector(ZE,r):$E.addScaledVector(ZE.sub(t),r))}t.add($E)}return t}raycast(e,t){const n=this.geometry,r=this.material,i=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),XE.copy(n.boundingSphere),XE.applyMatrix4(i),qE.copy(e.ray).recast(e.near),!1===XE.containsPoint(qE.origin)){if(null===qE.intersectSphere(XE,YE))return;if(qE.origin.distanceToSquared(YE)>(e.far-e.near)**2)return}WE.copy(i).invert(),qE.copy(e.ray).applyMatrix4(WE),null!==n.boundingBox&&!1===qE.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,qE)}}_computeIntersections(e,t,n){let r;const i=this.geometry,a=this.material,s=i.index,o=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv1,u=i.attributes.normal,h=i.groups,d=i.drawRange;if(null!==s)if(Array.isArray(a))for(let f=0,p=h.length;f<p;f++){const i=h[f],o=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(s.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=rT(this,o,e,n,l,c,u,s.getX(a),s.getX(a+1),s.getX(a+2)),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),o=Math.min(s.count,d.start+d.count);i<o;i+=3){r=rT(this,a,e,n,l,c,u,s.getX(i),s.getX(i+1),s.getX(i+2)),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}else if(void 0!==o)if(Array.isArray(a))for(let f=0,p=h.length;f<p;f++){const i=h[f],s=a[i.materialIndex];for(let a=Math.max(i.start,d.start),h=Math.min(o.count,Math.min(i.start+i.count,d.start+d.count));a<h;a+=3){r=rT(this,s,e,n,l,c,u,a,a+1,a+2),r&&(r.faceIndex=Math.floor(a/3),r.face.materialIndex=i.materialIndex,t.push(r))}}else{for(let i=Math.max(0,d.start),s=Math.min(o.count,d.start+d.count);i<s;i+=3){r=rT(this,a,e,n,l,c,u,i,i+1,i+2),r&&(r.faceIndex=Math.floor(i/3),t.push(r))}}}}function rT(e,t,n,r,i,a,s,o,l,c){e.getVertexPosition(o,KE),e.getVertexPosition(l,JE),e.getVertexPosition(c,QE);const u=function(e,t,n,r,i,a,s,o){let l;if(l=t.side===my?r.intersectTriangle(s,a,i,!0,o):r.intersectTriangle(i,a,s,t.side===py,o),null===l)return null;tT.copy(o),tT.applyMatrix4(e.matrixWorld);const c=n.ray.origin.distanceTo(tT);return c<n.near||c>n.far?null:{distance:c,point:tT.clone(),object:e}}(e,t,n,r,KE,JE,QE,eT);if(u){const e=new wx;cE.getBarycoord(eT,KE,JE,QE,e),i&&(u.uv=cE.getInterpolatedAttribute(i,o,l,c,e,new Sx)),a&&(u.uv1=cE.getInterpolatedAttribute(a,o,l,c,e,new Sx)),s&&(u.normal=cE.getInterpolatedAttribute(s,o,l,c,e,new wx),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const t={a:o,b:l,c:c,normal:new wx,materialIndex:0};cE.getNormal(KE,JE,QE,t.normal),u.face=t,u.barycoord=e}return u}class iT extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:i,depthSegments:a};const s=this;r=Math.floor(r),i=Math.floor(i),a=Math.floor(a);const o=[],l=[],c=[],u=[];let h=0,d=0;function f(e,t,n,r,i,a,f,p,m,g,v){const y=a/m,_=f/g,b=a/2,S=f/2,x=p/2,w=m+1,E=g+1;let T=0,M=0;const C=new wx;for(let s=0;s<E;s++){const a=s*_-S;for(let o=0;o<w;o++){const h=o*y-b;C[e]=h*r,C[t]=a*i,C[n]=x,l.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=p>0?1:-1,c.push(C.x,C.y,C.z),u.push(o/m),u.push(1-s/g),T+=1}}for(let s=0;s<g;s++)for(let e=0;e<m;e++){const t=h+e+w*s,n=h+e+w*(s+1),r=h+(e+1)+w*(s+1),i=h+(e+1)+w*s;o.push(t,n,i),o.push(n,r,i),M+=6}s.addGroup(d,M,v),d+=M,h+=T}f("z","y","x",-1,-1,n,t,e,a,i,0),f("z","y","x",1,-1,n,t,-e,a,i,1),f("x","z","y",1,1,e,n,t,r,a,2),f("x","z","y",1,-1,e,n,-t,r,a,3),f("x","y","z",1,-1,e,t,n,r,i,4),f("x","y","z",-1,-1,e,t,-n,r,i,5),this.setIndex(o),this.setAttribute("position",new OE(l,3)),this.setAttribute("normal",new OE(c,3)),this.setAttribute("uv",new OE(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iT(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function aT(e){const t={};for(const n in e){t[n]={};for(const r in e[n]){const i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(sx("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}}return t}function sT(e){const t={};for(let n=0;n<e.length;n++){const r=aT(e[n]);for(const e in r)t[e]=r[e]}return t}function oT(e){const t=e.getRenderTarget();return null===t?e.outputColorSpace:!0===t.isXRRenderTarget?t.texture.colorSpace:Px.workingColorSpace}const lT={clone:aT,merge:sT};class cT extends vE{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=aT(e.uniforms),this.uniformsGroups=function(e){const t=[];for(let n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const n=this.uniforms[r].value;n&&n.isTexture?t.uniforms[r]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[r]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[r]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[r]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[r]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[r]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[r]={type:"m4",value:n.toArray()}:t.uniforms[r]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class uT extends Kw{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new xw,this.projectionMatrix=new xw,this.projectionMatrixInverse=new xw,this.coordinateSystem=GS,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const hT=new wx,dT=new Sx,fT=new Sx;class pT extends uT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*fx*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*dx*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*fx*Math.atan(Math.tan(.5*dx*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){hT.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(hT.x,hT.y).multiplyScalar(-e/hT.z),hT.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(hT.x,hT.y).multiplyScalar(-e/hT.z)}getViewSize(e,t){return this.getViewBounds(e,dT,fT),t.subVectors(fT,dT)}setViewOffset(e,t,n,r,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*dx*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const e=a.fullWidth,s=a.fullHeight;i+=a.offsetX*r/e,t-=a.offsetY*n/s,r*=a.width/e,n*=a.height/s}const s=this.filmOffset;0!==s&&(i+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const mT=-90;class gT extends Kw{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new pT(mT,1,e,t);r.layers=this.layers,this.add(r);const i=new pT(mT,1,e,t);i.layers=this.layers,this.add(i);const a=new pT(mT,1,e,t);a.layers=this.layers,this.add(a);const s=new pT(mT,1,e,t);s.layers=this.layers,this.add(s);const o=new pT(mT,1,e,t);o.layers=this.layers,this.add(o);const l=new pT(mT,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,i,a,s,o]=t;for(const l of t)this.remove(l);if(e===GS)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),i.up.set(0,0,-1),i.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(e!==WS)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),i.up.set(0,0,1),i.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of t)this.add(l),l.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[i,a,s,o,l,c]=this.children,u=e.getRenderTarget(),h=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,i),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,s),e.setRenderTarget(n,3,r),e.render(t,o),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=p,e.setRenderTarget(n,5,r),e.render(t,c),e.setRenderTarget(u,h,d),e.xr.enabled=f,n.texture.needsPMREMUpdate=!0}}class vT extends Vx{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:h_,arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0,arguments.length>9?arguments[9]:void 0),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class yT extends Gx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new vT(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new iT(5,5,5),s=new cT({name:"CubemapFromEquirect",uniforms:aT(n),vertexShader:r,fragmentShader:i,side:my,blending:vy});s.uniforms.tEquirect.value=t;const o=new nT(a,s),l=t.minFilter;t.minFilter===C_&&(t.minFilter=E_);return new gT(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(i)}}class _T extends Kw{constructor(){super(),this.isGroup=!0,this.type="Group"}}const bT={type:"move"};class ST{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new _T,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new _T,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new wx,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new wx),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new _T,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new wx,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new wx),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,i=null,a=null;const s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){a=!0;for(const a of e.hand.values()){const e=t.getJointPose(a,n),r=this._getHandJoint(l,a);null!==e&&(r.matrix.fromArray(e.transform.matrix),r.matrix.decompose(r.position,r.rotation,r.scale),r.matrixWorldNeedsUpdate=!0,r.jointRadius=e.radius),r.visible=null!==e}const r=l.joints["index-finger-tip"],i=l.joints["thumb-tip"],s=r.position.distanceTo(i.position),o=.02,c=.005;l.inputState.pinching&&s>o+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=o-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&(i=t.getPose(e.gripSpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1));null!==s&&(r=t.getPose(e.targetRaySpace,n),null===r&&null!==i&&(r=i),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(bT)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==i),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){const n=new _T;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class xT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;this.isFogExp2=!0,this.name="",this.color=new pE(e),this.density=t}clone(){return new xT(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class wT{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.isFog=!0,this.name="",this.color=new pE(e),this.near=t,this.far=n}clone(){return new wT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class ET extends Kw{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Nw,this.environmentIntensity=1,this.environmentRotation=new Nw,this.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),1!==this.environmentIntensity&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class TT{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=kS,this.updateRanges=[],this.version=0,this.uuid=px()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,i=this.stride;r<i;r++)this.array[e+r]=t.array[n+r];return this}set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=px()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=px()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const MT=new wx;class CT{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)MT.fromBufferAttribute(this,t),MT.applyMatrix4(e),this.setXYZ(t,MT.x,MT.y,MT.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)MT.fromBufferAttribute(this,t),MT.applyNormalMatrix(e),this.setXYZ(t,MT.x,MT.y,MT.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)MT.fromBufferAttribute(this,t),MT.transformDirection(e),this.setXYZ(t,MT.x,MT.y,MT.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=yx(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=_x(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=_x(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=_x(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=_x(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=_x(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=yx(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=yx(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=yx(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=yx(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=_x(t,this.array),n=_x(n,this.array),r=_x(r,this.array),i=_x(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=i,this}clone(e){if(void 0===e){ax("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return new CE(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new CT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){ax("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const n=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[n+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class AT extends vE{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new pE(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let IT;const RT=new wx,PT=new wx,NT=new wx,kT=new Sx,LT=new Sx,DT=new xw,OT=new wx,UT=new wx,FT=new wx,zT=new Sx,BT=new Sx,VT=new Sx;class HT extends Kw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new AT;if(super(),this.isSprite=!0,this.type="Sprite",void 0===IT){IT=new GE;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new TT(e,5);IT.setIndex([0,1,2,0,2,3]),IT.setAttribute("position",new CT(t,3,0,!1)),IT.setAttribute("uv",new CT(t,2,3,!1))}this.geometry=IT,this.material=e,this.center=new Sx(.5,.5),this.count=1}raycast(e,t){null===e.camera&&ox('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),PT.setFromMatrixScale(this.matrixWorld),DT.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),NT.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&PT.multiplyScalar(-NT.z);const n=this.material.rotation;let r,i;0!==n&&(i=Math.cos(n),r=Math.sin(n));const a=this.center;jT(OT.set(-.5,-.5,0),NT,a,PT,r,i),jT(UT.set(.5,-.5,0),NT,a,PT,r,i),jT(FT.set(.5,.5,0),NT,a,PT,r,i),zT.set(0,0),BT.set(1,0),VT.set(1,1);let s=e.ray.intersectTriangle(OT,UT,FT,!1,RT);if(null===s&&(jT(UT.set(-.5,.5,0),NT,a,PT,r,i),BT.set(0,1),s=e.ray.intersectTriangle(OT,FT,UT,!1,RT),null===s))return;const o=e.ray.origin.distanceTo(RT);o<e.near||o>e.far||t.push({distance:o,point:RT.clone(),uv:cE.getInterpolation(RT,OT,UT,FT,zT,BT,VT,new Sx),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function jT(e,t,n,r,i,a){kT.subVectors(e,n).addScalar(.5).multiply(r),void 0!==i?(LT.x=a*kT.x-i*kT.y,LT.y=i*kT.x+a*kT.y):LT.copy(kT),e.copy(t),e.x+=LT.x,e.y+=LT.y,e.applyMatrix4(DT)}const GT=new wx,WT=new wx;class qT extends Kw{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const e=t[n];this.addLevel(e.object.clone(),e.distance,e.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const e=t.splice(n,1);return this.remove(e[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let r=t[n].distance;if(t[n].object.visible&&(r-=r*t[n].hysteresis),e<r)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){GT.setFromMatrixPosition(this.matrixWorld);const n=e.ray.origin.distanceTo(GT);this.getObjectForDistance(n).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){GT.setFromMatrixPosition(e.matrixWorld),WT.setFromMatrixPosition(this.matrixWorld);const n=GT.distanceTo(WT)/e.zoom;let r,i;for(t[0].object.visible=!0,r=1,i=t.length;r<i;r++){let e=t[r].distance;if(t[r].object.visible&&(e-=e*t[r].hysteresis),!(n>=e))break;t[r-1].object.visible=!1,t[r].object.visible=!0}for(this._currentLevel=r-1;r<i;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,i=n.length;r<i;r++){const e=n[r];t.object.levels.push({object:e.object.uuid,distance:e.distance,hysteresis:e.hysteresis})}return t}}const XT=new wx,YT=new Hx,KT=new Hx,JT=new wx,QT=new xw,ZT=new wx,$T=new fw,eM=new xw,tM=new Sw;class nM extends nT{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=l_,this.bindMatrix=new xw,this.bindMatrixInverse=new xw,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;null===this.boundingBox&&(this.boundingBox=new Kx),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ZT),this.boundingBox.expandByPoint(ZT)}computeBoundingSphere(){const e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new fw),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ZT),this.boundingSphere.expandByPoint(ZT)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;void 0!==n&&(null===this.boundingSphere&&this.computeBoundingSphere(),$T.copy(this.boundingSphere),$T.applyMatrix4(r),!1!==e.ray.intersectsSphere($T)&&(eM.copy(r).invert(),tM.copy(e.ray).applyMatrix4(eM),null!==this.boundingBox&&!1===tM.intersectsBox(this.boundingBox)||this._computeIntersections(e,t,tM)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hx,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===l_?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===c_?this.bindMatrixInverse.copy(this.bindMatrix).invert():sx("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;YT.fromBufferAttribute(r.attributes.skinIndex,e),KT.fromBufferAttribute(r.attributes.skinWeight,e),XT.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let i=0;i<4;i++){const e=KT.getComponent(i);if(0!==e){const r=YT.getComponent(i);QT.multiplyMatrices(n.bones[r].matrixWorld,n.boneInverses[r]),t.addScaledVector(JT.copy(XT).applyMatrix4(QT),e)}}return t.applyMatrix4(this.bindMatrixInverse)}}class rM extends Kw{constructor(){super(),this.isBone=!0,this.type="Bone"}}class iM extends Vx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(null,arguments.length>5?arguments[5]:void 0,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:__,arguments.length>9&&void 0!==arguments[9]?arguments[9]:__,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>10?arguments[10]:void 0,arguments.length>11?arguments[11]:void 0),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const aM=new xw,sM=new xw;class oM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.uuid=px(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){sx("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new xw)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new xw;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let i=0,a=e.length;i<a;i++){const r=e[i]?e[i].matrixWorld:sM;aM.multiplyMatrices(r,t[i]),aM.toArray(n,16*i)}null!==r&&(r.needsUpdate=!0)}clone(){return new oM(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new iM(t,e,e,G_,D_);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const r=e.bones[n];let i=t[r];void 0===i&&(sx("Skeleton: No bone found with UUID:",r),i=new rM),this.bones.push(i),this.boneInverses.push((new xw).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,i=t.length;r<i;r++){const i=t[r];e.bones.push(i.uuid);const a=n[r];e.boneInverses.push(a.toArray())}return e}}class lM extends CE{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const cM=new xw,uM=new xw,hM=[],dM=new Kx,fM=new xw,pM=new nT,mM=new fw;class gM extends nT{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new lM(new Float32Array(16*n),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,fM)}computeBoundingBox(){const e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new Kx),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,cM),dM.copy(e.boundingBox).applyMatrix4(cM),this.boundingBox.union(dM)}computeBoundingSphere(){const e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new fw),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,cM),mM.copy(e.boundingSphere).applyMatrix4(cM),this.boundingSphere.union(mM)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,i=e*(n.length+1)+1;for(let a=0;a<n.length;a++)n[a]=r[i+a]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(pM.geometry=this.geometry,pM.material=this.material,void 0!==pM.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),mM.copy(this.boundingSphere),mM.applyMatrix4(n),!1!==e.ray.intersectsSphere(mM)))for(let i=0;i<r;i++){this.getMatrixAt(i,cM),uM.multiplyMatrices(n,cM),pM.matrixWorld=uM,pM.raycast(e,hM);for(let e=0,n=hM.length;e<n;e++){const n=hM[e];n.instanceId=i,n.object=this,t.push(n)}hM.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new lM(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;null===this.morphTexture&&(this.morphTexture=new iM(new Float32Array(r*this.count),r,this.count,X_,D_));const i=this.morphTexture.source.data.data;let a=0;for(let l=0;l<n.length;l++)a+=n[l];const s=this.geometry.morphTargetsRelative?1:1-a,o=r*e;i[o]=s,i.set(n,o+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null)}}const vM=new wx,yM=new wx,_M=new Mx;class bM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx(1,0,0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=vM.subVectors(n,t).cross(yM.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(vM),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?null:t.copy(e.start).addScaledVector(n,i)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||_M.getNormalMatrix(e),r=this.coplanarPoint(vM).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const SM=new fw,xM=new Sx(.5,.5),wM=new wx;class EM{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new bM,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new bM,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new bM,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new bM,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new bM,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new bM;this.planes=[e,t,n,r,i,a]}set(e,t,n,r,i,a){const s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(n),s[3].copy(r),s[4].copy(i),s[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GS,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.planes,i=e.elements,a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],f=i[8],p=i[9],m=i[10],g=i[11],v=i[12],y=i[13],_=i[14],b=i[15];if(r[0].setComponents(l-a,d-c,g-f,b-v).normalize(),r[1].setComponents(l+a,d+c,g+f,b+v).normalize(),r[2].setComponents(l+s,d+u,g+p,b+y).normalize(),r[3].setComponents(l-s,d-u,g-p,b-y).normalize(),n)r[4].setComponents(o,h,m,_).normalize(),r[5].setComponents(l-o,d-h,g-m,b-_).normalize();else if(r[4].setComponents(l-o,d-h,g-m,b-_).normalize(),t===GS)r[5].setComponents(l+o,d+h,g+m,b+_).normalize();else{if(t!==WS)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);r[5].setComponents(o,h,m,_).normalize()}return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),SM.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),SM.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(SM)}intersectsSprite(e){SM.center.set(0,0,0);const t=xM.distanceTo(e.center);return SM.radius=.7071067811865476+t,SM.applyMatrix4(e.matrixWorld),this.intersectsSphere(SM)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let i=0;i<6;i++){if(t[i].distanceToPoint(n)<r)return!1}return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(wM.x=r.normal.x>0?e.max.x:e.min.x,wM.y=r.normal.y>0?e.max.y:e.min.y,wM.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(wM)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}const TM=new xw,MM=new EM;class CM{constructor(){this.coordinateSystem=GS}intersectsObject(e,t){if(!t.isArrayCamera||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(TM.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),MM.setFromProjectionMatrix(TM,r.coordinateSystem,r.reversedDepth),MM.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(TM.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),MM.setFromProjectionMatrix(TM,r.coordinateSystem,r.reversedDepth),MM.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(TM.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),MM.setFromProjectionMatrix(TM,r.coordinateSystem,r.reversedDepth),MM.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(TM.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),MM.setFromProjectionMatrix(TM,r.coordinateSystem,r.reversedDepth),MM.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||0===t.cameras.length)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(TM.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),MM.setFromProjectionMatrix(TM,r.coordinateSystem,r.reversedDepth),MM.containsPoint(e))return!0}return!1}clone(){return new CM}}function AM(e,t){return e-t}function IM(e,t){return e.z-t.z}function RM(e,t){return t.z-e.z}class PM{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const i=this.pool,a=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const s=i[this.index];a.push(s),this.index++,s.start=e,s.count=t,s.z=n,s.index=r}reset(){this.list.length=0,this.index=0}}const NM=new xw,kM=new pE(1,1,1),LM=new EM,DM=new CM,OM=new Kx,UM=new fw,FM=new wx,zM=new wx,BM=new wx,VM=new PM,HM=new nT,jM=[];function GM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=t.itemSize;if(e.isInterleavedBufferAttribute||e.array.constructor!==t.array.constructor){const i=e.count;for(let a=0;a<i;a++)for(let i=0;i<r;i++)t.setComponent(a+n,i,e.getComponent(a,i))}else t.array.set(e.array,n*r);t.needsUpdate=!0}function WM(e,t){if(e.constructor!==t.constructor){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++)t[r]=e[r]}else{const n=Math.min(e.length,t.length);t.set(new e.constructor(e.buffer,0,n))}}class qM extends nT{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*t,r=arguments.length>3?arguments[3]:void 0;super(new GE,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(4*this._maxInstanceCount);e=4*Math.ceil(e/4),e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new iM(t,e,e,G_,D_);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new iM(t,e,e,Y_,L_);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new iM(t,e,e,G_,D_);n.colorSpace=Px.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(!1===this._geometryInitialized){for(const r in e.attributes){const i=e.getAttribute(r),{array:a,itemSize:s,normalized:o}=i,l=new a.constructor(n*s),c=new CE(l,s,o);t.setAttribute(r,c)}if(null!==e.getIndex()){const e=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new CE(e,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(Boolean(e.getIndex())!==Boolean(t.getIndex()))throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error('THREE.BatchedMesh: Added geometry missing "'.concat(n,'". All geometries must have consistent attributes.'));const r=e.getAttribute(n),i=t.getAttribute(n);if(r.itemSize!==i.itemSize||r.normalized!==i.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid instanceId ".concat(e,". Instance is either out of range or has been deleted."))}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||!1===t[e].active)throw new Error("THREE.BatchedMesh: Invalid geometryId ".concat(e,". Geometry is either out of range or has been deleted."))}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Kx);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,NM),this.getBoundingBoxAt(r,OM).applyMatrix4(NM),e.union(OM)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new fw);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(!1===t[n].active)continue;const r=t[n].geometryIndex;this.getMatrixAt(n,NM),this.getBoundingSphereAt(r,UM).applyMatrix4(NM),e.union(UM)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&0===this._availableInstanceIds.length)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const t={visible:!0,active:!0,geometryIndex:e};let n=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(AM),n=this._availableInstanceIds.shift(),this._instanceInfo[n]=t):(n=this._instanceInfo.length,this._instanceInfo.push(t));const r=this._matricesTexture;NM.identity().toArray(r.image.data,16*n),r.needsUpdate=!0;const i=this._colorsTexture;return i&&(kM.toArray(i.image.data,4*n),i.needsUpdate=!0),this._visibilityChanged=!0,n}addGeometry(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},i=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=-1===t?e.getAttribute("position").count:t;const a=e.getIndex();if(null!==a&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=-1===n?a.count:n),-1!==r.indexStart&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let s;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(AM),s=this._availableGeometryIds.shift(),i[s]=r):(s=this._geometryCount,this._geometryCount++,i.push(r)),this.setGeometryAt(s,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,s}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=null!==n.getIndex(),i=n.getIndex(),a=t.getIndex(),s=this._geometryInfo[e];if(r&&a.count>s.reservedIndexCount||t.attributes.position.count>s.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const o=s.vertexStart,l=s.reservedVertexCount;s.vertexCount=t.getAttribute("position").count;for(const c in n.attributes){const e=t.getAttribute(c),r=n.getAttribute(c);GM(e,r,o);const i=e.itemSize;for(let t=e.count,n=l;t<n;t++){const e=o+t;for(let t=0;t<i;t++)r.setComponent(e,t,0)}r.needsUpdate=!0,r.addUpdateRange(o*i,l*i)}if(r){const e=s.indexStart,n=s.reservedIndexCount;s.indexCount=t.getIndex().count;for(let t=0;t<a.count;t++)i.setX(e+t,o+a.getX(t));for(let t=a.count,r=n;t<r;t++)i.setX(e+t,o);i.needsUpdate=!0,i.addUpdateRange(e,s.reservedIndexCount)}return s.start=r?s.indexStart:s.vertexStart,s.count=r?s.indexCount:s.vertexCount,s.boundingBox=null,null!==t.boundingBox&&(s.boundingBox=t.boundingBox.clone()),s.boundingSphere=null,null!==t.boundingSphere&&(s.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||!1===t[e].active)return this;const n=this._instanceInfo;for(let r=0,i=n.length;r<i;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((e,t)=>t).sort((e,t)=>n[e].vertexStart-n[t].vertexStart),i=this.geometry;for(let a=0,s=n.length;a<s;a++){const s=r[a],o=n[s];if(!1!==o.active){if(null!==i.index){if(o.indexStart!==t){const{indexStart:n,vertexStart:r,reservedIndexCount:a}=o,s=i.index,l=s.array,c=e-r;for(let e=n;e<n+a;e++)l[e]=l[e]+c;s.array.copyWithin(t,n,n+a),s.addUpdateRange(t,a),s.needsUpdate=!0,o.indexStart=t}t+=o.reservedIndexCount}if(o.vertexStart!==e){const{vertexStart:t,reservedVertexCount:n}=o,r=i.attributes;for(const i in r){const a=r[i],{array:s,itemSize:o}=a;s.copyWithin(e*o,t*o,(t+n)*o),a.addUpdateRange(e*o,n*o),a.needsUpdate=!0}o.vertexStart=e}e+=o.reservedVertexCount,o.start=i.index?o.indexStart:o.vertexStart,this._nextIndexStart=i.index?o.indexStart+o.reservedIndexCount:0,this._nextVertexStart=o.vertexStart+o.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingBox){const e=new Kx,t=n.index,i=n.attributes.position;for(let n=r.start,a=r.start+r.count;n<a;n++){let r=n;t&&(r=t.getX(r)),e.expandByPoint(FM.fromBufferAttribute(i,r))}r.boundingBox=e}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(null===r.boundingSphere){const t=new fw;this.getBoundingBoxAt(e,OM),OM.getCenter(t.center);const i=n.index,a=n.attributes.position;let s=0;for(let e=r.start,n=r.start+r.count;e<n;e++){let n=e;i&&(n=i.getX(n)),FM.fromBufferAttribute(a,n),s=Math.max(s,t.center.distanceToSquared(FM))}t.radius=Math.sqrt(s),r.boundingSphere=t}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,16*e),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,16*e)}setColorAt(e,t){return this.validateInstanceId(e),null===this._colorsTexture&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,4*e),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,4*e)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t||(this._instanceInfo[e].visible=t,this._visibilityChanged=!0),this}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(AM);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error("BatchedMesh: Instance ids outside the range ".concat(e," are being used. Cannot shrink instance count."));const r=new Int32Array(e),i=new Int32Array(e);WM(this._multiDrawCounts,r),WM(this._multiDrawStarts,i),this._multiDrawCounts=r,this._multiDrawStarts=i,this._maxInstanceCount=e;const a=this._indirectTexture,s=this._matricesTexture,o=this._colorsTexture;a.dispose(),this._initIndirectTexture(),WM(a.image.data,this._indirectTexture.image.data),s.dispose(),this._initMatricesTexture(),WM(s.image.data,this._matricesTexture.image.data),o&&(o.dispose(),this._initColorsTexture(),WM(o.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(e=>e.active);if(Math.max(...n.map(e=>e.vertexStart+e.reservedVertexCount))>e)throw new Error("BatchedMesh: Geometry vertex values are being used outside the range ".concat(t,". Cannot shrink further."));if(this.geometry.index){if(Math.max(...n.map(e=>e.indexStart+e.reservedIndexCount))>t)throw new Error("BatchedMesh: Geometry index values are being used outside the range ".concat(t,". Cannot shrink further."))}const r=this.geometry;r.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new GE,this._initializeGeometry(r));const i=this.geometry;r.index&&WM(r.index.array,i.index.array);for(const a in r.attributes)WM(r.attributes[a].array,i.attributes[a].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,i=this.matrixWorld,a=this.geometry;HM.material=this.material,HM.geometry.index=a.index,HM.geometry.attributes=a.attributes,null===HM.geometry.boundingBox&&(HM.geometry.boundingBox=new Kx),null===HM.geometry.boundingSphere&&(HM.geometry.boundingSphere=new fw);for(let s=0,o=n.length;s<o;s++){if(!n[s].visible||!n[s].active)continue;const a=n[s].geometryIndex,o=r[a];HM.geometry.setDrawRange(o.start,o.count),this.getMatrixAt(s,HM.matrixWorld).premultiply(i),this.getBoundingBoxAt(a,HM.geometry.boundingBox),this.getBoundingSphereAt(a,HM.geometry.boundingSphere),HM.raycast(e,jM);for(let e=0,n=jM.length;e<n;e++){const n=jM[e];n.object=this,n.batchId=s,t.push(n)}jM.length=0}HM.material=null,HM.geometry.index=null,HM.geometry.attributes={},HM.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=null!==e.boundingBox?e.boundingBox.clone():null,this.boundingSphere=null!==e.boundingSphere?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(e=>d(d({},e),{},{boundingBox:null!==e.boundingBox?e.boundingBox.clone():null,boundingSphere:null!==e.boundingSphere?e.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(e=>d({},e)),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),null!==this._colorsTexture&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,null!==this._colorsTexture&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,i){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),s=null===a?1:a.array.BYTES_PER_ELEMENT,o=this._instanceInfo,l=this._multiDrawStarts,c=this._multiDrawCounts,u=this._geometryInfo,h=this.perObjectFrustumCulled,d=this._indirectTexture,f=d.image.data,p=n.isArrayCamera?DM:LM;h&&!n.isArrayCamera&&(NM.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),LM.setFromProjectionMatrix(NM,n.coordinateSystem,n.reversedDepth));let m=0;if(this.sortObjects){NM.copy(this.matrixWorld).invert(),FM.setFromMatrixPosition(n.matrixWorld).applyMatrix4(NM),zM.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(NM);for(let r=0,i=o.length;r<i;r++)if(o[r].visible&&o[r].active){const e=o[r].geometryIndex;this.getMatrixAt(r,NM),this.getBoundingSphereAt(e,UM).applyMatrix4(NM);let t=!1;if(h&&(t=!p.intersectsSphere(UM,n)),!t){const t=u[e],n=BM.subVectors(UM.center,FM).dot(zM);VM.push(t.start,t.count,n,r)}}const e=VM.list,t=this.customSort;null===t?e.sort(i.transparent?RM:IM):t.call(this,e,n);for(let n=0,r=e.length;n<r;n++){const t=e[n];l[m]=t.start*s,c[m]=t.count,f[m]=t.index,m++}VM.reset()}else for(let g=0,v=o.length;g<v;g++)if(o[g].visible&&o[g].active){const e=o[g].geometryIndex;let t=!1;if(h&&(this.getMatrixAt(g,NM),this.getBoundingSphereAt(e,UM).applyMatrix4(NM),t=!p.intersectsSphere(UM,n)),!t){const t=u[e];l[m]=t.start*s,c[m]=t.count,f[m]=g,m++}}d.needsUpdate=!0,this._multiDrawCount=m,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,i,a){this.onBeforeRender(e,null,r,i,a)}}class XM extends vE{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new pE(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const YM=new wx,KM=new wx,JM=new xw,QM=new Sw,ZM=new fw,$M=new wx,eC=new wx;class tC extends Kw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new GE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new XM;super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let e=1,r=t.count;e<r;e++)YM.fromBufferAttribute(t,e-1),KM.fromBufferAttribute(t,e),n[e]=n[e-1],n[e]+=YM.distanceTo(KM);e.setAttribute("lineDistance",new OE(n,1))}else sx("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ZM.copy(n.boundingSphere),ZM.applyMatrix4(r),ZM.radius+=i,!1===e.ray.intersectsSphere(ZM))return;JM.copy(r).invert(),QM.copy(e.ray).applyMatrix4(JM);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=this.isLineSegments?2:1,c=n.index,u=n.attributes.position;if(null!==c){const n=Math.max(0,a.start),r=Math.min(c.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=c.getX(i),r=c.getX(i+1),a=nC(this,e,QM,o,n,r,i);a&&t.push(a)}if(this.isLineLoop){const i=c.getX(r-1),a=c.getX(n),s=nC(this,e,QM,o,i,a,r-1);s&&t.push(s)}}else{const n=Math.max(0,a.start),r=Math.min(u.count,a.start+a.count);for(let i=n,a=r-1;i<a;i+=l){const n=nC(this,e,QM,o,i,i+1,i);n&&t.push(n)}if(this.isLineLoop){const i=nC(this,e,QM,o,r-1,n,r-1);i&&t.push(i)}}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function nC(e,t,n,r,i,a,s){const o=e.geometry.attributes.position;YM.fromBufferAttribute(o,i),KM.fromBufferAttribute(o,a);if(n.distanceSqToSegment(YM,KM,$M,eC)>r)return;$M.applyMatrix4(e.matrixWorld);const l=t.ray.origin.distanceTo($M);return l<t.near||l>t.far?void 0:{distance:l,point:eC.clone().applyMatrix4(e.matrixWorld),index:s,face:null,faceIndex:null,barycoord:null,object:e}}const rC=new wx,iC=new wx;class aC extends tC{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let e=0,r=t.count;e<r;e+=2)rC.fromBufferAttribute(t,e),iC.fromBufferAttribute(t,e+1),n[e]=0===e?0:n[e-1],n[e+1]=n[e]+rC.distanceTo(iC);e.setAttribute("lineDistance",new OE(n,1))}else sx("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class sC extends tC{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class oC extends vE{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new pE(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const lC=new xw,cC=new Sw,uC=new fw,hC=new wx;class dC extends Kw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new GE,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new oC;super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,i=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),uC.copy(n.boundingSphere),uC.applyMatrix4(r),uC.radius+=i,!1===e.ray.intersectsSphere(uC))return;lC.copy(r).invert(),cC.copy(e.ray).applyMatrix4(lC);const s=i/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=n.index,c=n.attributes.position;if(null!==l){for(let n=Math.max(0,a.start),i=Math.min(l.count,a.start+a.count);n<i;n++){const i=l.getX(n);hC.fromBufferAttribute(c,i),fC(hC,i,o,r,e,t,this)}}else{for(let n=Math.max(0,a.start),i=Math.min(c.count,a.start+a.count);n<i;n++)hC.fromBufferAttribute(c,n),fC(hC,n,o,r,e,t,this)}}updateMorphTargets(){const e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){const n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,t=n.length;e<t;e++){const t=n[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[t]=e}}}}}function fC(e,t,n,r,i,a,s){const o=cC.distanceSqToPoint(e);if(o<n){const n=new wx;cC.closestPointToPoint(e,n),n.applyMatrix4(r);const l=i.ray.origin.distanceTo(n);if(l<i.near||l>i.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:n,index:t,face:null,faceIndex:null,barycoord:null,object:s})}}class pC extends Vx{constructor(e,t,n,r){super(e,t,n,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:E_,arguments.length>5&&void 0!==arguments[5]?arguments[5]:E_,arguments.length>6?arguments[6]:void 0,arguments.length>7?arguments[7]:void 0,arguments.length>8?arguments[8]:void 0),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const i=this;"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(function t(){i.needsUpdate=!0,i._requestVideoFrameCallbackId=e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){0!==this._requestVideoFrameCallbackId&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class mC extends pC{constructor(e,t,n,r,i,a,s,o){super({},e,t,n,r,i,a,s,o),this.isVideoFrameTexture=!0}update(){}clone(){return(new this.constructor).copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class gC extends Vx{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=__,this.minFilter=__,this.generateMipmaps=!1,this.needsUpdate=!0}}class vC extends Vx{constructor(e,t,n,r,i,a,s,o,l,c,u,h){super(null,a,s,o,l,c,r,i,u,h),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class yC extends vC{constructor(e,t,n,r,i,a){super(e,t,n,i,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=v_,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class _C extends vC{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,h_),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class bC extends Vx{constructor(e,t,n,r,i,a,s,o,l){super(e,t,n,r,i,a,s,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class SC extends Vx{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L_,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:__,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:__,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:W_,u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1;if(c!==W_&&c!==q_)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super({width:e,height:t,depth:u},r,i,a,s,o,c,n,l),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Ux(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class xC extends SC{constructor(e){const t={width:e,height:e,depth:1},n=[t,t,t,t,t,t];super(e,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:L_,arguments.length>2&&void 0!==arguments[2]?arguments[2]:h_,arguments.length>3?arguments[3]:void 0,arguments.length>4?arguments[4]:void 0,arguments.length>5&&void 0!==arguments[5]?arguments[5]:__,arguments.length>6&&void 0!==arguments[6]?arguments[6]:__,arguments.length>7?arguments[7]:void 0,arguments.length>8&&void 0!==arguments[8]?arguments[8]:W_),this.image=n,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class wC extends Vx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class EC extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:i},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),i=Math.max(1,Math.floor(i));const a=[],s=[],o=[],l=[],c=t/2,u=Math.PI/2*e,h=t,d=2*u+h,f=2*n+i,p=r+1,m=new wx,g=new wx;for(let v=0;v<=f;v++){let y=0,_=0,b=0,S=0;if(v<=n){const t=v/n,r=t*Math.PI/2;_=-c-e*Math.cos(r),b=e*Math.sin(r),S=-e*Math.cos(r),y=t*u}else if(v<=n+i){const r=(v-n)/i;_=r*t-c,b=e,S=0,y=u+r*h}else{const t=(v-n-i)/n,r=t*Math.PI/2;_=c+e*Math.sin(r),b=e*Math.cos(r),S=e*Math.sin(r),y=u+h+t*u}const x=Math.max(0,Math.min(1,y/d));let w=0;0===v?w=.5/r:v===f&&(w=-.5/r);for(let e=0;e<=r;e++){const t=e/r,n=t*Math.PI*2,i=Math.sin(n),a=Math.cos(n);g.x=-b*a,g.y=_,g.z=b*i,s.push(g.x,g.y,g.z),m.set(-b*a,S,b*i),m.normalize(),o.push(m.x,m.y,m.z),l.push(t+w,x)}if(v>0){const e=(v-1)*p;for(let t=0;t<r;t++){const n=e+t,r=e+t+1,i=v*p+t,s=v*p+t+1;a.push(n,r,i),a.push(r,s,i)}}}this.setIndex(a),this.setAttribute("position",new OE(s,3)),this.setAttribute("normal",new OE(o,3)),this.setAttribute("uv",new OE(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new EC(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class TC extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const i=[],a=[],s=[],o=[],l=new wx,c=new Sx;a.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let u=0,h=3;u<=t;u++,h+=3){const i=n+u/t*r;l.x=e*Math.cos(i),l.y=e*Math.sin(i),a.push(l.x,l.y,l.z),s.push(0,0,1),c.x=(a[h]/e+1)/2,c.y=(a[h+1]/e+1)/2,o.push(c.x,c.y)}for(let u=1;u<=t;u++)i.push(u,u+1,0);this.setIndex(i),this.setAttribute("position",new OE(a,3)),this.setAttribute("normal",new OE(s,3)),this.setAttribute("uv",new OE(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TC(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class MC extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:i,openEnded:a,thetaStart:s,thetaLength:o};const l=this;r=Math.floor(r),i=Math.floor(i);const c=[],u=[],h=[],d=[];let f=0;const p=[],m=n/2;let g=0;function v(n){const i=f,a=new Sx,p=new wx;let v=0;const y=!0===n?e:t,_=!0===n?1:-1;for(let e=1;e<=r;e++)u.push(0,m*_,0),h.push(0,_,0),d.push(.5,.5),f++;const b=f;for(let e=0;e<=r;e++){const t=e/r*o+s,n=Math.cos(t),i=Math.sin(t);p.x=y*i,p.y=m*_,p.z=y*n,u.push(p.x,p.y,p.z),h.push(0,_,0),a.x=.5*n+.5,a.y=.5*i*_+.5,d.push(a.x,a.y),f++}for(let e=0;e<r;e++){const t=i+e,r=b+e;!0===n?c.push(r,r+1,t):c.push(r+1,r,t),v+=3}l.addGroup(g,v,!0===n?1:2),g+=v}!function(){const a=new wx,v=new wx;let y=0;const _=(t-e)/n;for(let l=0;l<=i;l++){const c=[],g=l/i,y=g*(t-e)+e;for(let e=0;e<=r;e++){const t=e/r,i=t*o+s,l=Math.sin(i),p=Math.cos(i);v.x=y*l,v.y=-g*n+m,v.z=y*p,u.push(v.x,v.y,v.z),a.set(l,_,p).normalize(),h.push(a.x,a.y,a.z),d.push(t,1-g),c.push(f++)}p.push(c)}for(let n=0;n<r;n++)for(let r=0;r<i;r++){const a=p[r][n],s=p[r+1][n],o=p[r+1][n+1],l=p[r][n+1];(e>0||0!==r)&&(c.push(a,s,l),y+=3),(t>0||r!==i-1)&&(c.push(s,o,l),y+=3)}l.addGroup(g,y,0),g+=y}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new OE(u,3)),this.setAttribute("normal",new OE(h,3)),this.setAttribute("uv",new OE(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MC(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class CC extends MC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;super(0,e,t,n,r,i,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:a,thetaLength:s}}static fromJSON(e){return new CC(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class AC extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const i=[],a=[];function s(e,t,n,r){const i=r+1,a=[];for(let s=0;s<=i;s++){a[s]=[];const r=e.clone().lerp(n,s/i),o=t.clone().lerp(n,s/i),l=i-s;for(let e=0;e<=l;e++)a[s][e]=0===e&&s===i?r:r.clone().lerp(o,e/l)}for(let s=0;s<i;s++)for(let e=0;e<2*(i-s)-1;e++){const t=Math.floor(e/2);e%2===0?(o(a[s][t+1]),o(a[s+1][t]),o(a[s][t])):(o(a[s][t+1]),o(a[s+1][t+1]),o(a[s+1][t]))}}function o(e){i.push(e.x,e.y,e.z)}function l(t,n){const r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function c(e,t,n,r){r<0&&1===e.x&&(a[t]=e.x-1),0===n.x&&0===n.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}function h(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}!function(e){const n=new wx,r=new wx,i=new wx;for(let a=0;a<t.length;a+=3)l(t[a+0],n),l(t[a+1],r),l(t[a+2],i),s(n,r,i,e)}(r),function(e){const t=new wx;for(let n=0;n<i.length;n+=3)t.x=i[n+0],t.y=i[n+1],t.z=i[n+2],t.normalize().multiplyScalar(e),i[n+0]=t.x,i[n+1]=t.y,i[n+2]=t.z}(n),function(){const e=new wx;for(let t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];const n=u(e)/2/Math.PI+.5,r=h(e)/Math.PI+.5;a.push(n,1-r)}(function(){const e=new wx,t=new wx,n=new wx,r=new wx,s=new Sx,o=new Sx,l=new Sx;for(let h=0,d=0;h<i.length;h+=9,d+=6){e.set(i[h+0],i[h+1],i[h+2]),t.set(i[h+3],i[h+4],i[h+5]),n.set(i[h+6],i[h+7],i[h+8]),s.set(a[d+0],a[d+1]),o.set(a[d+2],a[d+3]),l.set(a[d+4],a[d+5]),r.copy(e).add(t).add(n).divideScalar(3);const f=u(r);c(s,d+0,e,f),c(o,d+2,t,f),c(l,d+4,n,f)}})(),function(){for(let e=0;e<a.length;e+=6){const t=a[e+0],n=a[e+2],r=a[e+4],i=Math.max(t,n,r),s=Math.min(t,n,r);i>.9&&s<.1&&(t<.2&&(a[e+0]+=1),n<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new OE(i,3)),this.setAttribute("normal",new OE(i.slice(),3)),this.setAttribute("uv",new OE(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new AC(e.vertices,e.indices,e.radius,e.detail)}}class IC extends AC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2,r=1/n;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new IC(e.radius,e.detail)}}const RC=new wx,PC=new wx,NC=new wx,kC=new cE;class LC extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const n=4,r=Math.pow(10,n),i=Math.cos(dx*t),a=e.getIndex(),s=e.getAttribute("position"),o=a?a.count:s.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<o;e+=3){a?(l[0]=a.getX(e),l[1]=a.getX(e+1),l[2]=a.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:n,c:o}=kC;if(t.fromBufferAttribute(s,l[0]),n.fromBufferAttribute(s,l[1]),o.fromBufferAttribute(s,l[2]),kC.getNormal(NC),u[0]="".concat(Math.round(t.x*r),",").concat(Math.round(t.y*r),",").concat(Math.round(t.z*r)),u[1]="".concat(Math.round(n.x*r),",").concat(Math.round(n.y*r),",").concat(Math.round(n.z*r)),u[2]="".concat(Math.round(o.x*r),",").concat(Math.round(o.y*r),",").concat(Math.round(o.z*r)),u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,n=u[e],r=u[t],a=kC[c[e]],s=kC[c[t]],o="".concat(n,"_").concat(r),f="".concat(r,"_").concat(n);f in h&&h[f]?(NC.dot(h[f].normal)<=i&&(d.push(a.x,a.y,a.z),d.push(s.x,s.y,s.z)),h[f]=null):o in h||(h[o]={index0:l[e],index1:l[t],normal:NC.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:n}=h[e];RC.fromBufferAttribute(s,t),PC.fromBufferAttribute(s,n),d.push(RC.x,RC.y,RC.z),d.push(PC.x,PC.y,PC.z)}this.setAttribute("position",new OE(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class DC{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){sx("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),i=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),i+=n.distanceTo(r),t.push(i),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getLengths();let r=0;const i=n.length;let a;a=t||e*n[i-1];let s,o=0,l=i-1;for(;o<=l;)if(r=Math.floor(o+(l-o)/2),s=n[r]-a,s<0)o=r+1;else{if(!(s>0)){l=r;break}l=r-1}if(r=l,n[r]===a)return r/(i-1);const c=n[r];return(r+(a-c)/(n[r+1]-c))/(i-1)}getTangent(e,t){const n=1e-4;let r=e-n,i=e+n;r<0&&(r=0),i>1&&(i=1);const a=this.getPoint(r),s=this.getPoint(i),o=t||(a.isVector2?new Sx:new wx);return o.copy(s).sub(a).normalize(),o}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new wx,r=[],i=[],a=[],s=new wx,o=new xw;for(let d=0;d<=e;d++){const t=d/e;r[d]=this.getTangentAt(t,new wx)}i[0]=new wx,a[0]=new wx;let l=Number.MAX_VALUE;const c=Math.abs(r[0].x),u=Math.abs(r[0].y),h=Math.abs(r[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),s.crossVectors(r[0],n).normalize(),i[0].crossVectors(r[0],s),a[0].crossVectors(r[0],i[0]);for(let d=1;d<=e;d++){if(i[d]=i[d-1].clone(),a[d]=a[d-1].clone(),s.crossVectors(r[d-1],r[d]),s.length()>Number.EPSILON){s.normalize();const e=Math.acos(mx(r[d-1].dot(r[d]),-1,1));i[d].applyMatrix4(o.makeRotationAxis(s,e))}a[d].crossVectors(r[d],i[d])}if(!0===t){let t=Math.acos(mx(i[0].dot(i[e]),-1,1));t/=e,r[0].dot(s.crossVectors(i[0],i[e]))>0&&(t=-t);for(let n=1;n<=e;n++)i[n].applyMatrix4(o.makeRotationAxis(r[n],t*n)),a[n].crossVectors(r[n],i[n])}return{tangents:r,normals:i,binormals:a}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class OC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=i,this.aEndAngle=a,this.aClockwise=s,this.aRotation=o}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=i?0:n),!0!==this.aClockwise||i||(r===n?r=-n:r-=n);const a=this.aStartAngle+e*r;let s=this.aX+this.xRadius*Math.cos(a),o=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),n=s-this.aX,r=o-this.aY;s=n*e-r*t+this.aX,o=n*t+r*e+this.aY}return t.set(s,o)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class UC extends OC{constructor(e,t,n,r,i,a){super(e,t,n,n,r,i,a),this.isArcCurve=!0,this.type="ArcCurve"}}function FC(){let e=0,t=0,n=0,r=0;function i(i,a,s,o){e=i,t=s,n=-3*i+3*a-2*s-o,r=2*i-2*a+s+o}return{initCatmullRom:function(e,t,n,r,a){i(t,n,a*(n-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,a,s,o){let l=(t-e)/a-(n-e)/(a+s)+(n-t)/s,c=(n-t)/s-(r-t)/(s+o)+(r-n)/o;l*=s,c*=s,i(t,n,l,c)},calc:function(i){const a=i*i;return e+t*i+n*a+r*(a*i)}}}const zC=new wx,BC=new FC,VC=new FC,HC=new FC;class jC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=this.points,r=n.length,i=(r-(this.closed?0:1))*e;let a,s,o=Math.floor(i),l=i-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:0===l&&o===r-1&&(o=r-2,l=1),this.closed||o>0?a=n[(o-1)%r]:(zC.subVectors(n[0],n[1]).add(n[0]),a=zC);const c=n[o%r],u=n[(o+1)%r];if(this.closed||o+2<r?s=n[(o+2)%r]:(zC.subVectors(n[r-1],n[r-2]).add(n[r-1]),s=zC),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(a.distanceToSquared(c),e),n=Math.pow(c.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(s),e);n<1e-4&&(n=1),t<1e-4&&(t=n),r<1e-4&&(r=n),BC.initNonuniformCatmullRom(a.x,c.x,u.x,s.x,t,n,r),VC.initNonuniformCatmullRom(a.y,c.y,u.y,s.y,t,n,r),HC.initNonuniformCatmullRom(a.z,c.z,u.z,s.z,t,n,r)}else"catmullrom"===this.curveType&&(BC.initCatmullRom(a.x,c.x,u.x,s.x,this.tension),VC.initCatmullRom(a.y,c.y,u.y,s.y,this.tension),HC.initCatmullRom(a.z,c.z,u.z,s.z,this.tension));return t.set(BC.calc(l),VC.calc(l),HC.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new wx).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function GC(e,t,n,r,i){const a=.5*(r-t),s=.5*(i-n),o=e*e;return(2*n-2*r+a+s)*(e*o)+(-3*n+3*r-2*a-s)*o+a*e+n}function WC(e,t,n,r){return function(e,t){const n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function qC(e,t,n,r,i){return function(e,t){const n=1-e;return n*n*n*t}(e,t)+function(e,t){const n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,i)}class XC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Sx,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Sx;super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(qC(e,n.x,r.x,i.x,a.x),qC(e,n.y,r.y,i.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class YC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new wx,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new wx;super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=this.v0,r=this.v1,i=this.v2,a=this.v3;return t.set(qC(e,n.x,r.x,i.x,a.x),qC(e,n.y,r.y,i.y,a.y),qC(e,n.z,r.z,i.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class KC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx;super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class JC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx;super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx;return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx).subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class QC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Sx;super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=this.v0,r=this.v1,i=this.v2;return t.set(WC(e,n.x,r.x,i.x),WC(e,n.y,r.y,i.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ZC extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new wx;super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx,n=this.v0,r=this.v1,i=this.v2;return t.set(WC(e,n.x,r.x,i.x),WC(e,n.y,r.y,i.y),WC(e,n.z,r.z,i.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $C extends DC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx,n=this.points,r=(n.length-1)*e,i=Math.floor(r),a=r-i,s=n[0===i?i:i-1],o=n[i],l=n[i>n.length-2?n.length-1:i+1],c=n[i>n.length-3?n.length-1:i+2];return t.set(GC(a,s.x,o.x,l.x,c.x),GC(a,s.y,o.y,l.y,c.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const n=e.points[t];this.points.push((new Sx).fromArray(n))}return this}}var eA=Object.freeze({__proto__:null,ArcCurve:UC,CatmullRomCurve3:jC,CubicBezierCurve:XC,CubicBezierCurve3:YC,EllipseCurve:OC,LineCurve:KC,LineCurve3:JC,QuadraticBezierCurve:QC,QuadraticBezierCurve3:ZC,SplineCurve:$C});class tA extends DC{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=!0===e.isVector2?"LineCurve":"LineCurve3";this.curves.push(new eA[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let i=0;for(;i<r.length;){if(r[i]>=n){const e=r[i]-n,a=this.curves[i],s=a.getLength(),o=0===s?0:1-e/s;return a.getPointAt(o,t)}i++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40;const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;const t=[];let n;for(let r=0,i=this.curves;r<i.length;r++){const a=i[r],s=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,o=a.getPoints(s);for(let e=0;e<o.length;e++){const r=o[e];n&&n.equals(r)||(t.push(r),n=r)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const n=e.curves[t];this.curves.push((new eA[n.type]).fromJSON(n))}return this}}class nA extends tA{constructor(e){super(),this.type="Path",this.currentPoint=new Sx,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new KC(this.currentPoint.clone(),new Sx(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const i=new QC(this.currentPoint.clone(),new Sx(e,t),new Sx(n,r));return this.curves.push(i),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,i,a){const s=new XC(this.currentPoint.clone(),new Sx(e,t),new Sx(n,r),new Sx(i,a));return this.curves.push(s),this.currentPoint.set(i,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new $C(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,i,a){const s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,n,r,i,a),this}absarc(e,t,n,r,i,a){return this.absellipse(e,t,n,n,r,i,a),this}ellipse(e,t,n,r,i,a,s,o){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,r,i,a,s,o),this}absellipse(e,t,n,r,i,a,s,o){const l=new OC(e,t,n,r,i,a,s,o);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class rA extends nA{constructor(e){super(e),this.uuid=px(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const n=e.holes[t];this.holes.push((new nA).fromJSON(n))}return this}}function iA(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let a=aA(e,0,i,n,!0);const s=[];if(!a||a.next===a.prev)return s;let o,l,c;if(r&&(a=function(e,t,n,r){const i=[];for(let a=0,s=t.length;a<s;a++){const n=aA(e,t[a]*r,a<s-1?t[a+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),i.push(gA(n))}i.sort(dA);for(let a=0;a<i.length;a++)n=fA(i[a],n);return n}(e,t,a,n)),e.length>80*n){o=e[0],l=e[1];let t=o,r=l;for(let a=n;a<i;a+=n){const n=e[a],i=e[a+1];n<o&&(o=n),i<l&&(l=i),n>t&&(t=n),i>r&&(r=i)}c=Math.max(t-o,r-l),c=0!==c?32767/c:0}return oA(a,s,n,o,l,c,0),s}function aA(e,t,n,r,i){let a;if(i===function(e,t,n,r){let i=0;for(let a=t,s=n-r;a<n;a+=r)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}(e,t,n,r)>0)for(let s=t;s<n;s+=r)a=CA(s/r|0,e[s],e[s+1],a);else for(let s=n-r;s>=t;s-=r)a=CA(s/r|0,e[s],e[s+1],a);return a&&SA(a,a.next)&&(AA(a),a=a.next),a}function sA(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!SA(r,r.next)&&0!==bA(r.prev,r,r.next))r=r.next;else{if(AA(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function oA(e,t,n,r,i,a,s){if(!e)return;!s&&a&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=mA(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r,i=e;e=null;let a=null;for(t=0;i;){t++;let s=i,o=0;for(let e=0;e<n&&(o++,s=s.nextZ,s);e++);let l=n;for(;o>0||l>0&&s;)0!==o&&(0===l||!s||i.z<=s.z)?(r=i,i=i.nextZ,o--):(r=s,s=s.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=s}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);let o=e;for(;e.prev!==e.next;){const l=e.prev,c=e.next;if(a?cA(e,r,i,a):lA(e))t.push(l.i,e.i,c.i),AA(e),e=c.next,o=c.next;else if((e=c)===o){s?1===s?oA(e=uA(sA(e),t),t,n,r,i,a,2):2===s&&hA(e,t,n,r,i,a):oA(sA(e),t,n,r,i,a,1);break}}}function lA(e){const t=e.prev,n=e,r=e.next;if(bA(t,n,r)>=0)return!1;const i=t.x,a=n.x,s=r.x,o=t.y,l=n.y,c=r.y,u=Math.min(i,a,s),h=Math.min(o,l,c),d=Math.max(i,a,s),f=Math.max(o,l,c);let p=r.next;for(;p!==t;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&yA(i,o,a,l,s,c,p.x,p.y)&&bA(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function cA(e,t,n,r){const i=e.prev,a=e,s=e.next;if(bA(i,a,s)>=0)return!1;const o=i.x,l=a.x,c=s.x,u=i.y,h=a.y,d=s.y,f=Math.min(o,l,c),p=Math.min(u,h,d),m=Math.max(o,l,c),g=Math.max(u,h,d),v=mA(f,p,t,n,r),y=mA(m,g,t,n,r);let _=e.prevZ,b=e.nextZ;for(;_&&_.z>=v&&b&&b.z<=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==s&&yA(o,u,l,h,c,d,_.x,_.y)&&bA(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==s&&yA(o,u,l,h,c,d,b.x,b.y)&&bA(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;_&&_.z>=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==s&&yA(o,u,l,h,c,d,_.x,_.y)&&bA(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==s&&yA(o,u,l,h,c,d,b.x,b.y)&&bA(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function uA(e,t){let n=e;do{const r=n.prev,i=n.next.next;!SA(r,i)&&xA(r,n,n.next,i)&&TA(r,i)&&TA(i,r)&&(t.push(r.i,n.i,i.i),AA(n),AA(n.next),n=e=i),n=n.next}while(n!==e);return sA(n)}function hA(e,t,n,r,i,a){let s=e;do{let e=s.next.next;for(;e!==s.prev;){if(s.i!==e.i&&_A(s,e)){let o=MA(s,e);return s=sA(s,s.next),o=sA(o,o.next),oA(s,t,n,r,i,a,0),void oA(o,t,n,r,i,a,0)}e=e.next}s=s.next}while(s!==e)}function dA(e,t){let n=e.x-t.x;if(0===n&&(n=e.y-t.y,0===n)){n=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return n}function fA(e,t){const n=function(e,t){let n=t;const r=e.x,i=e.y;let a,s=-1/0;if(SA(e,n))return n;do{if(SA(e,n.next))return n.next;if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>s&&(s=e,a=n.x<n.next.x?n:n.next,e===r))return a}n=n.next}while(n!==t);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;n=a;do{if(r>=n.x&&n.x>=l&&r!==n.x&&vA(i<c?r:s,i,l,c,i<c?s:r,i,n.x,n.y)){const t=Math.abs(i-n.y)/(r-n.x);TA(n,e)&&(t<u||t===u&&(n.x>a.x||n.x===a.x&&pA(a,n)))&&(a=n,u=t)}n=n.next}while(n!==o);return a}(e,t);if(!n)return t;const r=MA(n,e);return sA(r,r.next),sA(n,n.next)}function pA(e,t){return bA(e.prev,e,t.prev)<0&&bA(t.next,e,e.next)<0}function mA(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function gA(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function vA(e,t,n,r,i,a,s,o){return(i-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(r-o)>=(n-s)*(t-o)&&(n-s)*(a-o)>=(i-s)*(r-o)}function yA(e,t,n,r,i,a,s,o){return!(e===s&&t===o)&&vA(e,t,n,r,i,a,s,o)}function _A(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&xA(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(TA(e,t)&&TA(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(bA(e.prev,e,t.prev)||bA(e,t.prev,t))||SA(e,t)&&bA(e.prev,e,e.next)>0&&bA(t.prev,t,t.next)>0)}function bA(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function SA(e,t){return e.x===t.x&&e.y===t.y}function xA(e,t,n,r){const i=EA(bA(e,t,n)),a=EA(bA(e,t,r)),s=EA(bA(n,r,e)),o=EA(bA(n,r,t));return i!==a&&s!==o||(!(0!==i||!wA(e,n,t))||(!(0!==a||!wA(e,r,t))||(!(0!==s||!wA(n,e,r))||!(0!==o||!wA(n,t,r)))))}function wA(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function EA(e){return e>0?1:e<0?-1:0}function TA(e,t){return bA(e.prev,e,e.next)<0?bA(e,t,e.next)>=0&&bA(e,e.prev,t)>=0:bA(e,t,e.prev)<0||bA(e,e.next,t)<0}function MA(e,t){const n=IA(e.i,e.x,e.y),r=IA(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function CA(e,t,n,r){const i=IA(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function AA(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function IA(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class RA{static triangulate(e,t){return iA(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:2)}}class PA{static area(e){const t=e.length;let n=0;for(let r=t-1,i=0;i<t;r=i++)n+=e[r].x*e[i].y-e[i].x*e[r].y;return.5*n}static isClockWise(e){return PA.area(e)<0}static triangulateShape(e,t){const n=[],r=[],i=[];NA(e),kA(n,e);let a=e.length;t.forEach(NA);for(let o=0;o<t.length;o++)r.push(a),a+=t[o].length,kA(n,t[o]);const s=RA.triangulate(n,r);for(let o=0;o<s.length;o+=3)i.push(s.slice(o,o+3));return i}}function NA(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function kA(e,t){for(let n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}class LA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new rA([new Sx(.5,.5),new Sx(-.5,.5),new Sx(-.5,-.5),new Sx(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],i=[];for(let s=0,o=e.length;s<o;s++){a(e[s])}function a(e){const a=[],s=void 0!==t.curveSegments?t.curveSegments:12,o=void 0!==t.steps?t.steps:1,l=void 0!==t.depth?t.depth:1;let c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:DA;let g,v,y,_,b,S=!1;if(p){g=p.getSpacedPoints(o),S=!0,c=!1;const e=!!p.isCatmullRomCurve3&&p.closed;v=p.computeFrenetFrames(o,e),y=new wx,_=new wx,b=new wx}c||(f=0,u=0,h=0,d=0);const x=e.extractPoints(s);let w=x.shape;const E=x.holes;if(!PA.isClockWise(w)){w=w.reverse();for(let e=0,t=E.length;e<t;e++){const t=E[e];PA.isClockWise(t)&&(E[e]=t.reverse())}}function T(e){const t=1e-10*1e-10;let n=e[0];for(let r=1;r<=e.length;r++){const i=r%e.length,a=e[i],s=a.x-n.x,o=a.y-n.y,l=s*s+o*o,c=Math.max(Math.abs(a.x),Math.abs(a.y),Math.abs(n.x),Math.abs(n.y));l<=t*c*c?(e.splice(i,1),r--):n=a}}T(w),E.forEach(T);const M=E.length,C=w;for(let t=0;t<M;t++){const e=E[t];w=w.concat(e)}function A(e,t,n){return t||ox("ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,n)}const I=w.length;function R(e,t,n){let r,i,a;const s=e.x-t.x,o=e.y-t.y,l=n.x-e.x,c=n.y-e.y,u=s*s+o*o,h=s*c-o*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),f=t.x-o/h,p=t.y+s/h,m=((n.x-c/d-f)*c-(n.y+l/d-p)*l)/(s*c-o*l);r=f+s*m-e.x,i=p+o*m-e.y;const g=r*r+i*i;if(g<=2)return new Sx(r,i);a=Math.sqrt(g/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(c)&&(e=!0),e?(r=-o,i=s,a=Math.sqrt(u)):(r=s,i=o,a=Math.sqrt(u/2))}return new Sx(r/a,i/a)}const P=[];for(let t=0,n=C.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),P[t]=R(C[t],C[r],C[i]);const N=[];let k,L,D=P.concat();for(let t=0,n=M;t<n;t++){const e=E[t];k=[];for(let t=0,n=e.length,r=n-1,i=t+1;t<n;t++,r++,i++)r===n&&(r=0),i===n&&(i=0),k[t]=R(e[t],e[r],e[i]);N.push(k),D=D.concat(k)}if(0===f)L=PA.triangulateShape(C,E);else{const e=[],t=[];for(let n=0;n<f;n++){const r=n/f,i=u*Math.cos(r*Math.PI/2),a=h*Math.sin(r*Math.PI/2)+d;for(let t=0,n=C.length;t<n;t++){const n=A(C[t],P[t],a);z(n.x,n.y,-i),0===r&&e.push(n)}for(let e=0,n=M;e<n;e++){const n=E[e];k=N[e];const s=[];for(let e=0,t=n.length;e<t;e++){const t=A(n[e],k[e],a);z(t.x,t.y,-i),0===r&&s.push(t)}0===r&&t.push(s)}}L=PA.triangulateShape(e,t)}const O=L.length,U=h+d;for(let t=0;t<I;t++){const e=c?A(w[t],D[t],U):w[t];S?(_.copy(v.normals[0]).multiplyScalar(e.x),y.copy(v.binormals[0]).multiplyScalar(e.y),b.copy(g[0]).add(_).add(y),z(b.x,b.y,b.z)):z(e.x,e.y,0)}for(let t=1;t<=o;t++)for(let e=0;e<I;e++){const n=c?A(w[e],D[e],U):w[e];S?(_.copy(v.normals[t]).multiplyScalar(n.x),y.copy(v.binormals[t]).multiplyScalar(n.y),b.copy(g[t]).add(_).add(y),z(b.x,b.y,b.z)):z(n.x,n.y,l/o*t)}for(let t=f-1;t>=0;t--){const e=t/f,n=u*Math.cos(e*Math.PI/2),r=h*Math.sin(e*Math.PI/2)+d;for(let t=0,i=C.length;t<i;t++){const e=A(C[t],P[t],r);z(e.x,e.y,l+n)}for(let t=0,i=E.length;t<i;t++){const e=E[t];k=N[t];for(let t=0,i=e.length;t<i;t++){const i=A(e[t],k[t],r);S?z(i.x,i.y+g[o-1].y,g[o-1].x+n):z(i.x,i.y,l+n)}}}function F(e,t){let n=e.length;for(;--n>=0;){const r=n;let i=n-1;i<0&&(i=e.length-1);for(let e=0,n=o+2*f;e<n;e++){const n=I*e,a=I*(e+1);V(t+r+n,t+i+n,t+i+a,t+r+a)}}}function z(e,t,n){a.push(e),a.push(t),a.push(n)}function B(e,t,i){H(e),H(t),H(i);const a=r.length/3,s=m.generateTopUV(n,r,a-3,a-2,a-1);j(s[0]),j(s[1]),j(s[2])}function V(e,t,i,a){H(e),H(t),H(a),H(t),H(i),H(a);const s=r.length/3,o=m.generateSideWallUV(n,r,s-6,s-3,s-2,s-1);j(o[0]),j(o[1]),j(o[3]),j(o[1]),j(o[2]),j(o[3])}function H(e){r.push(a[3*e+0]),r.push(a[3*e+1]),r.push(a[3*e+2])}function j(e){i.push(e.x),i.push(e.y)}!function(){const e=r.length/3;if(c){let e=0,t=I*e;for(let n=0;n<O;n++){const e=L[n];B(e[2]+t,e[1]+t,e[0]+t)}e=o+2*f,t=I*e;for(let n=0;n<O;n++){const e=L[n];B(e[0]+t,e[1]+t,e[2]+t)}}else{for(let e=0;e<O;e++){const t=L[e];B(t[2],t[1],t[0])}for(let e=0;e<O;e++){const t=L[e];B(t[0]+I*o,t[1]+I*o,t[2]+I*o)}}n.addGroup(e,r.length/3-e,0)}(),function(){const e=r.length/3;let t=0;F(C,t),t+=C.length;for(let n=0,r=E.length;n<r;n++){const e=E[n];F(e,t),t+=e.length}n.addGroup(e,r.length/3-e,1)}()}this.setAttribute("position",new OE(r,3)),this.setAttribute("uv",new OE(i,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const t=e[r];n.shapes.push(t.uuid)}else n.shapes.push(e.uuid);n.options=Object.assign({},t),void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const r=t[e.shapes[i]];n.push(r)}const r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=(new eA[r.type]).fromJSON(r)),new LA(n,e.options)}}const DA={generateTopUV:function(e,t,n,r,i){const a=t[3*n],s=t[3*n+1],o=t[3*r],l=t[3*r+1],c=t[3*i],u=t[3*i+1];return[new Sx(a,s),new Sx(o,l),new Sx(c,u)]},generateSideWallUV:function(e,t,n,r,i,a){const s=t[3*n],o=t[3*n+1],l=t[3*n+2],c=t[3*r],u=t[3*r+1],h=t[3*r+2],d=t[3*i],f=t[3*i+1],p=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(o-u)<Math.abs(s-c)?[new Sx(s,1-l),new Sx(c,1-h),new Sx(d,1-p),new Sx(m,1-v)]:[new Sx(o,1-l),new Sx(u,1-h),new Sx(f,1-p),new Sx(g,1-v)]}};class OA extends AC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=(1+Math.sqrt(5))/2;super([-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new OA(e.radius,e.detail)}}class UA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[new Sx(0,-.5),new Sx(.5,0),new Sx(0,.5)],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=mx(r,0,2*Math.PI);const i=[],a=[],s=[],o=[],l=[],c=1/t,u=new wx,h=new Sx,d=new wx,f=new wx,p=new wx;let m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),o.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=t;v++){const i=n+v*c*r,d=Math.sin(i),f=Math.cos(i);for(let n=0;n<=e.length-1;n++){u.x=e[n].x*d,u.y=e[n].y,u.z=e[n].x*f,a.push(u.x,u.y,u.z),h.x=v/t,h.y=n/(e.length-1),s.push(h.x,h.y);const r=o[3*n+0]*d,i=o[3*n+1],c=o[3*n+0]*f;l.push(r,i,c)}}for(let v=0;v<t;v++)for(let t=0;t<e.length-1;t++){const n=t+v*e.length,r=n,a=n+e.length,s=n+e.length+1,o=n+1;i.push(r,a,o),i.push(s,o,a)}this.setIndex(i),this.setAttribute("position",new OE(a,3)),this.setAttribute("uv",new OE(s,2)),this.setAttribute("normal",new OE(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UA(e.points,e.segments,e.phiStart,e.phiLength)}}class FA extends AC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new FA(e.radius,e.detail)}}class zA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const i=e/2,a=t/2,s=Math.floor(n),o=Math.floor(r),l=s+1,c=o+1,u=e/s,h=t/o,d=[],f=[],p=[],m=[];for(let g=0;g<c;g++){const e=g*h-a;for(let t=0;t<l;t++){const n=t*u-i;f.push(n,-e,0),p.push(0,0,1),m.push(t/s),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let e=0;e<s;e++){const t=e+l*g,n=e+l*(g+1),r=e+1+l*(g+1),i=e+1+l*g;d.push(t,n,i),d.push(n,r,i)}this.setIndex(d),this.setAttribute("position",new OE(f,3)),this.setAttribute("normal",new OE(p,3)),this.setAttribute("uv",new OE(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zA(e.width,e.height,e.widthSegments,e.heightSegments)}}class BA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:32,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const s=[],o=[],l=[],c=[];let u=e;const h=(t-e)/r,d=new wx,f=new Sx;for(let p=0;p<=r;p++){for(let e=0;e<=n;e++){const r=i+e/n*a;d.x=u*Math.cos(r),d.y=u*Math.sin(r),o.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/t+1)/2,f.y=(d.y/t+1)/2,c.push(f.x,f.y)}u+=h}for(let p=0;p<r;p++){const e=p*(n+1);for(let t=0;t<n;t++){const r=t+e,i=r,a=r+n+1,o=r+n+2,l=r+1;s.push(i,a,l),s.push(a,o,l)}}this.setIndex(s),this.setAttribute("position",new OE(o,3)),this.setAttribute("normal",new OE(l,3)),this.setAttribute("uv",new OE(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BA(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class VA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new rA([new Sx(0,.5),new Sx(-.5,-.5),new Sx(.5,-.5)]),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],i=[],a=[];let s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let c=0;c<e.length;c++)l(e[c]),this.addGroup(s,o,c),s+=o,o=0;function l(e){const s=r.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===PA.isClockWise(c)&&(c=c.reverse());for(let t=0,n=u.length;t<n;t++){const e=u[t];!0===PA.isClockWise(e)&&(u[t]=e.reverse())}const h=PA.triangulateShape(c,u);for(let t=0,n=u.length;t<n;t++){const e=u[t];c=c.concat(e)}for(let t=0,n=c.length;t<n;t++){const e=c[t];r.push(e.x,e.y,0),i.push(0,0,1),a.push(e.x,e.y)}for(let t=0,r=h.length;t<r;t++){const e=h[t],r=e[0]+s,i=e[1]+s,a=e[2]+s;n.push(r,i,a),o+=3}}this.setIndex(n),this.setAttribute("position",new OE(r,3)),this.setAttribute("normal",new OE(i,3)),this.setAttribute("uv",new OE(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let n=0,r=e.length;n<r;n++){const r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const n=[];for(let r=0,i=e.shapes.length;r<i;r++){const i=t[e.shapes[r]];n.push(i)}return new VA(n,e.curveSegments)}}class HA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:i,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const o=Math.min(a+s,Math.PI);let l=0;const c=[],u=new wx,h=new wx,d=[],f=[],p=[],m=[];for(let g=0;g<=n;g++){const d=[],v=g/n;let y=0;0===g&&0===a?y=.5/t:g===n&&o===Math.PI&&(y=-.5/t);for(let n=0;n<=t;n++){const o=n/t;u.x=-e*Math.cos(r+o*i)*Math.sin(a+v*s),u.y=e*Math.cos(a+v*s),u.z=e*Math.sin(r+o*i)*Math.sin(a+v*s),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(o+y,1-v),d.push(l++)}c.push(d)}for(let g=0;g<n;g++)for(let e=0;e<t;e++){const t=c[g][e+1],r=c[g][e],i=c[g+1][e],s=c[g+1][e+1];(0!==g||a>0)&&d.push(t,r,s),(g!==n-1||o<Math.PI)&&d.push(r,i,s)}this.setIndex(d),this.setAttribute("position",new OE(f,3)),this.setAttribute("normal",new OE(p,3)),this.setAttribute("uv",new OE(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new HA(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class jA extends AC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jA(e.radius,e.detail)}}class GA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:48,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:i},n=Math.floor(n),r=Math.floor(r);const a=[],s=[],o=[],l=[],c=new wx,u=new wx,h=new wx;for(let d=0;d<=n;d++)for(let a=0;a<=r;a++){const f=a/r*i,p=d/n*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),s.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),h.subVectors(u,c).normalize(),o.push(h.x,h.y,h.z),l.push(a/r),l.push(d/n)}for(let d=1;d<=n;d++)for(let e=1;e<=r;e++){const t=(r+1)*d+e-1,n=(r+1)*(d-1)+e-1,i=(r+1)*(d-1)+e,s=(r+1)*d+e;a.push(t,n,s),a.push(n,i,s)}this.setIndex(a),this.setAttribute("position",new OE(s,3)),this.setAttribute("normal",new OE(o,3)),this.setAttribute("uv",new OE(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GA(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class WA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:i,q:a},n=Math.floor(n),r=Math.floor(r);const s=[],o=[],l=[],c=[],u=new wx,h=new wx,d=new wx,f=new wx,p=new wx,m=new wx,g=new wx;for(let y=0;y<=n;++y){const s=y/n*i*Math.PI*2;v(s,i,a,e,d),v(s+.01,i,a,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=r;++e){const i=e/r*Math.PI*2,a=-t*Math.cos(i),s=t*Math.sin(i);u.x=d.x+(a*g.x+s*p.x),u.y=d.y+(a*g.y+s*p.y),u.z=d.z+(a*g.z+s*p.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/n),c.push(e/r)}}for(let y=1;y<=n;y++)for(let e=1;e<=r;e++){const t=(r+1)*(y-1)+(e-1),n=(r+1)*y+(e-1),i=(r+1)*y+e,a=(r+1)*(y-1)+e;s.push(t,n,a),s.push(n,i,a)}function v(e,t,n,r,i){const a=Math.cos(e),s=Math.sin(e),o=n/t*e,l=Math.cos(o);i.x=r*(2+l)*.5*a,i.y=r*(2+l)*s*.5,i.z=r*Math.sin(o)*.5}this.setIndex(s),this.setAttribute("position",new OE(o,3)),this.setAttribute("normal",new OE(l,3)),this.setAttribute("uv",new OE(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new WA(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class qA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ZC(new wx(-1,-1,0),new wx(-1,1,0),new wx(1,1,0)),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:i};const a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const s=new wx,o=new wx,l=new Sx;let c=new wx;const u=[],h=[],d=[],f=[];function p(i){c=e.getPointAt(i/t,c);const l=a.normals[i],d=a.binormals[i];for(let e=0;e<=r;e++){const t=e/r*Math.PI*2,i=Math.sin(t),a=-Math.cos(t);o.x=a*l.x+i*d.x,o.y=a*l.y+i*d.y,o.z=a*l.z+i*d.z,o.normalize(),h.push(o.x,o.y,o.z),s.x=c.x+n*o.x,s.y=c.y+n*o.y,s.z=c.z+n*o.z,u.push(s.x,s.y,s.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===i?t:0),function(){for(let e=0;e<=t;e++)for(let n=0;n<=r;n++)l.x=e/t,l.y=n/r,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){const n=(r+1)*(e-1)+(t-1),i=(r+1)*e+(t-1),a=(r+1)*e+t,s=(r+1)*(e-1)+t;f.push(n,i,s),f.push(i,a,s)}}()}(),this.setIndex(f),this.setAttribute("position",new OE(u,3)),this.setAttribute("normal",new OE(h,3)),this.setAttribute("uv",new OE(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new qA((new eA[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class XA extends GE{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],n=new Set,r=new wx,i=new wx;if(null!==e.index){const a=e.attributes.position,s=e.index;let o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){const l=o[e],c=l.start;for(let e=c,o=c+l.count;e<o;e+=3)for(let l=0;l<3;l++){const o=s.getX(e+l),c=s.getX(e+(l+1)%3);r.fromBufferAttribute(a,o),i.fromBufferAttribute(a,c),!0===YA(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}}else{const a=e.attributes.position;for(let e=0,s=a.count/3;e<s;e++)for(let o=0;o<3;o++){const s=3*e+o,l=3*e+(o+1)%3;r.fromBufferAttribute(a,s),i.fromBufferAttribute(a,l),!0===YA(r,i,n)&&(t.push(r.x,r.y,r.z),t.push(i.x,i.y,i.z))}}this.setAttribute("position",new OE(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function YA(e,t,n){const r="".concat(e.x,",").concat(e.y,",").concat(e.z,"-").concat(t.x,",").concat(t.y,",").concat(t.z),i="".concat(t.x,",").concat(t.y,",").concat(t.z,"-").concat(e.x,",").concat(e.y,",").concat(e.z);return!0!==n.has(r)&&!0!==n.has(i)&&(n.add(r),n.add(i),!0)}var KA=Object.freeze({__proto__:null,BoxGeometry:iT,CapsuleGeometry:EC,CircleGeometry:TC,ConeGeometry:CC,CylinderGeometry:MC,DodecahedronGeometry:IC,EdgesGeometry:LC,ExtrudeGeometry:LA,IcosahedronGeometry:OA,LatheGeometry:UA,OctahedronGeometry:FA,PlaneGeometry:zA,PolyhedronGeometry:AC,RingGeometry:BA,ShapeGeometry:VA,SphereGeometry:HA,TetrahedronGeometry:jA,TorusGeometry:GA,TorusKnotGeometry:WA,TubeGeometry:qA,WireframeGeometry:XA});class JA extends vE{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new pE(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class QA extends cT{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class ZA extends vE{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new pE(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nw,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class $A extends ZA{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Sx(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return mx(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new pE(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new pE(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new pE(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!==e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!==e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!==e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!==e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!==e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!==e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class eI extends vE{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new pE(16777215),this.specular=new pE(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nw,this.combine=Qy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class tI extends vE{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new pE(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class nI extends vE{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class rI extends vE{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new pE(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pE(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Nw,this.combine=Qy,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class iI extends vE{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Kb,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class aI extends vE{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class sI extends vE{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new pE(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=$b,this.normalScale=new Sx(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oI extends XM{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function lI(e,t){return e&&e.constructor!==t?"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function cI(e){const t=e.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function(t,n){return e[t]-e[n]}),n}function uI(e,t,n){const r=e.length,i=new e.constructor(r);for(let a=0,s=0;s!==r;++a){const r=n[a]*t;for(let n=0;n!==t;++n)i[s++]=e[r+n]}return i}function hI(e,t,n,r){let i=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[i++];if(void 0===a)return;let s=a[r];if(void 0!==s)if(Array.isArray(s))do{s=a[r],void 0!==s&&(t.push(a.time),n.push(...s)),a=e[i++]}while(void 0!==a);else if(void 0!==s.toArray)do{s=a[r],void 0!==s&&(t.push(a.time),s.toArray(n,n.length)),a=e[i++]}while(void 0!==a);else do{s=a[r],void 0!==s&&(t.push(a.time),n.push(s)),a=e[i++]}while(void 0!==a)}class dI{static convertArray(e,t){return lI(e,t)}static isTypedArray(e){return ZS(e)}static getKeyframeOrder(e){return cI(e)}static sortedArray(e,t,n){return uI(e,t,n)}static flattenJSON(e,t,n,r){hI(e,t,n,r)}static subclip(e,t,n,r){return function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30;const a=e.clone();a.name=t;const s=[];for(let l=0;l<a.tracks.length;++l){const e=a.tracks[l],t=e.getValueSize(),o=[],c=[];for(let a=0;a<e.times.length;++a){const s=e.times[a]*i;if(!(s<n||s>=r)){o.push(e.times[a]);for(let n=0;n<t;++n)c.push(e.values[a*t+n])}}0!==o.length&&(e.times=lI(o,e.times.constructor),e.values=lI(c,e.values.constructor),s.push(e))}a.tracks=s;let o=1/0;for(let l=0;l<a.tracks.length;++l)o>a.tracks[l].times[0]&&(o=a.tracks[l].times[0]);for(let l=0;l<a.tracks.length;++l)a.tracks[l].shift(-1*o);return a.resetDuration(),a}(e,t,n,r,arguments.length>4&&void 0!==arguments[4]?arguments[4]:30)}static makeClipAdditive(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);const i=n.tracks.length,a=t/r;for(let s=0;s<i;++s){const t=n.tracks[s],r=t.ValueTypeName;if("bool"===r||"string"===r)continue;const i=e.tracks.find(function(e){return e.name===t.name&&e.ValueTypeName===r});if(void 0===i)continue;let o=0;const l=t.getValueSize();t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(o=l/3);let c=0;const u=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=t.times.length-1;let d;if(a<=t.times[0]){const e=o,n=l-o;d=t.values.slice(e,n)}else if(a>=t.times[h]){const e=h*l+o,n=e+l-o;d=t.values.slice(e,n)}else{const e=t.createInterpolant(),n=o,r=l-o;e.evaluate(a),d=e.resultBuffer.slice(n,r)}"quaternion"===r&&(new xx).fromArray(d).normalize().conjugate().toArray(d);const f=i.times.length;for(let e=0;e<f;++e){const t=e*u+c;if("quaternion"===r)xx.multiplyQuaternionsFlat(i.values,t,d,0,i.values,t);else{const e=u-2*c;for(let n=0;n<e;++n)i.values[t+n]-=d[n]}}}return e.blendMode=Wb,e}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,arguments.length>3&&void 0!==arguments[3]?arguments[3]:30)}}class fI{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],i=t[n-1];e:{t:{let a;n:{r:if(!(e<r)){for(let a=n+2;;){if(void 0===r){if(e<i)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(i=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=i)){const s=t[1];e<s&&(n=2,i=s);for(let a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(n===a)break;if(r=i,i=t[--n-1],e>=i)break t}a=n,n=0;break n}break e}for(;n<a;){const r=n+a>>>1;e<t[r]?a=r:n=r+1}if(r=t[n],i=t[n-1],void 0===i)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r;for(let a=0;a!==r;++a)t[a]=n[i+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class pI extends fI{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Vb,endingEnd:Vb}}intervalChanged_(e,t,n){const r=this.parameterPositions;let i=e-2,a=e+1,s=r[i],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case Hb:i=e,s=2*t-n;break;case jb:i=r.length-2,s=t+r[i]-r[i+1];break;default:i=e,s=n}if(void 0===o)switch(this.getSettings_().endingEnd){case Hb:a=e,o=2*n-t;break;case jb:a=1,o=n+r[1]-r[0];break;default:a=e-1,o=t}const l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-n),this._offsetPrev=i*c,this._offsetNext=a*c}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,y=(-1-d)*m+(1.5+d)*p+.5*f,_=d*m-d*p;for(let b=0;b!==s;++b)i[b]=g*a[c+b]+v*a[l+b]+y*a[o+b]+_*a[u+b];return i}}class mI extends fI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,c=(n-t)/(r-t),u=1-c;for(let h=0;h!==s;++h)i[h]=a[l+h]*u+a[o+h]*c;return i}}class gI extends fI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class vI{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=lI(t,this.TimeBufferType),this.values=lI(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:lI(e.times,Array),values:lI(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(n.interpolation=t)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new gI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new mI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pI(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Fb:t=this.InterpolantFactoryMethodDiscrete;break;case zb:t=this.InterpolantFactoryMethodLinear;break;case Bb:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return sx("KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Fb;case this.InterpolantFactoryMethodLinear:return zb;case this.InterpolantFactoryMethodSmooth:return Bb}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let i=0,a=r-1;for(;i!==r&&n[i]<e;)++i;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==i||a!==r){i>=a&&(a=Math.max(a,1),i=a-1);const e=this.getValueSize();this.times=n.slice(i,a),this.values=this.values.slice(i*e,a*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(ox("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,i=n.length;0===i&&(ox("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let s=0;s!==i;s++){const t=n[s];if("number"===typeof t&&isNaN(t)){ox("KeyframeTrack: Time is not a valid number.",this,s,t),e=!1;break}if(null!==a&&a>t){ox("KeyframeTrack: Out of order keys.",this,s,t,a),e=!1;break}a=t}if(void 0!==r&&ZS(r))for(let s=0,o=r.length;s!==o;++s){const t=r[s];if(isNaN(t)){ox("KeyframeTrack: Value is not a valid number.",this,s,t),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Bb,i=e.length-1;let a=1;for(let s=1;s<i;++s){let i=!1;const o=e[s];if(o!==e[s+1]&&(1!==s||o!==e[0]))if(r)i=!0;else{const e=s*n,r=e-n,a=e+n;for(let s=0;s!==n;++s){const n=t[e+s];if(n!==t[r+s]||n!==t[a+s]){i=!0;break}}}if(i){if(s!==a){e[a]=e[s];const r=s*n,i=a*n;for(let e=0;e!==n;++e)t[i+e]=t[r+e]}++a}}if(i>0){e[a]=e[i];for(let e=i*n,r=a*n,s=0;s!==n;++s)t[r+s]=t[e+s];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}vI.prototype.ValueTypeName="",vI.prototype.TimeBufferType=Float32Array,vI.prototype.ValueBufferType=Float32Array,vI.prototype.DefaultInterpolation=zb;class yI extends vI{constructor(e,t,n){super(e,t,n)}}yI.prototype.ValueTypeName="bool",yI.prototype.ValueBufferType=Array,yI.prototype.DefaultInterpolation=Fb,yI.prototype.InterpolantFactoryMethodLinear=void 0,yI.prototype.InterpolantFactoryMethodSmooth=void 0;class _I extends vI{constructor(e,t,n,r){super(e,t,n,r)}}_I.prototype.ValueTypeName="color";class bI extends vI{constructor(e,t,n,r){super(e,t,n,r)}}bI.prototype.ValueTypeName="number";class SI extends fI{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(n-t)/(r-t);let l=e*s;for(let c=l+s;l!==c;l+=4)xx.slerpFlat(i,0,a,l-s,a,l,o);return i}}class xI extends vI{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new SI(this.times,this.values,this.getValueSize(),e)}}xI.prototype.ValueTypeName="quaternion",xI.prototype.InterpolantFactoryMethodSmooth=void 0;class wI extends vI{constructor(e,t,n){super(e,t,n)}}wI.prototype.ValueTypeName="string",wI.prototype.ValueBufferType=Array,wI.prototype.DefaultInterpolation=Fb,wI.prototype.InterpolantFactoryMethodLinear=void 0,wI.prototype.InterpolantFactoryMethodSmooth=void 0;class EI extends vI{constructor(e,t,n,r){super(e,t,n,r)}}EI.prototype.ValueTypeName="vector";class TI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Gb;this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=px(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,s=n.length;a!==s;++a)t.push(MI(n[a]).scale(r));const i=new this(e.name,e.duration,t,e.blendMode);return i.uuid=e.uuid,i.userData=JSON.parse(e.userData||"{}"),i}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let i=0,a=n.length;i!==a;++i)t.push(vI.toJSON(n[i]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const i=t.length,a=[];for(let s=0;s<i;s++){let e=[],o=[];e.push((s+i-1)%i,s,(s+1)%i),o.push(0,1,0);const l=cI(e);e=uI(e,1,l),o=uI(o,1,l),r||0!==e[0]||(e.push(i),o.push(o[0])),a.push(new bI(".morphTargetInfluences["+t[s].name+"]",e,o).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const t=e;n=t.geometry&&t.geometry.animations||t.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},i=/^([\w-]*?)([\d]+)$/;for(let s=0,o=e.length;s<o;s++){const t=e[s],n=t.name.match(i);if(n&&n.length>1){const e=n[1];let i=r[e];i||(r[e]=i=[]),i.push(t)}}const a=[];for(const s in r)a.push(this.CreateFromMorphTargetSequence(s,r[s],t,n));return a}static parseAnimation(e,t){if(sx("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return ox("AnimationClip: No animation in JSONLoader data."),null;const n=function(e,t,n,r,i){if(0!==n.length){const a=[],s=[];hI(n,a,s,r),0!==a.length&&i.push(new e(t,a,s))}},r=[],i=e.name||"default",a=e.fps||30,s=e.blendMode;let o=e.length||-1;const l=e.hierarchy||[];for(let c=0;c<l.length;c++){const e=l[c].keys;if(e&&0!==e.length)if(e[0].morphTargets){const t={};let n;for(n=0;n<e.length;n++)if(e[n].morphTargets)for(let r=0;r<e[n].morphTargets.length;r++)t[e[n].morphTargets[r]]=-1;for(const i in t){const t=[],a=[];for(let r=0;r!==e[n].morphTargets.length;++r){const r=e[n];t.push(r.time),a.push(r.morphTarget===i?1:0)}r.push(new bI(".morphTargetInfluence["+i+"]",t,a))}o=t.length*a}else{const i=".bones["+t[c].name+"]";n(EI,i+".position",e,"pos",r),n(xI,i+".quaternion",e,"rot",r),n(EI,i+".scale",e,"scl",r)}}if(0===r.length)return null;return new this(i,o,r,s)}resetDuration(){let e=0;for(let t=0,n=this.tracks.length;t!==n;++t){const n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function MI(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return bI;case"vector":case"vector2":case"vector3":case"vector4":return EI;case"color":return _I;case"quaternion":return xI;case"bool":case"boolean":return yI;case"string":return wI}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],n=[];hI(e.keys,t,n,"value"),e.times=t,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const CI={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class AI{constructor(e,t,n){const r=this;let i,a=!1,s=0,o=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==r.onProgress&&r.onProgress(e,s,o),s===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return i?i(e):e},this.setURLModifier=function(e){return i=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,n=l.length;t<n;t+=2){const n=l[t],r=l[t+1];if(n.global&&(n.lastIndex=0),n.test(e))return r}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const II=new AI;class RI{constructor(e){this.manager=void 0!==e?e:II,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,i){n.load(e,r,t,i)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}RI.DEFAULT_MATERIAL_NAME="__DEFAULT";const PI={};class NI extends Error{constructor(e,t){super(e),this.response=t}}class kI extends RI{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=CI.get("file:".concat(e));if(void 0!==i)return this.manager.itemStart(e),setTimeout(()=>{t&&t(i),this.manager.itemEnd(e)},0),i;if(void 0!==PI[e])return void PI[e].push({onLoad:t,onProgress:n,onError:r});PI[e]=[],PI[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:"function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),s=this.mimeType,o=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&sx("FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const n=PI[e],r=t.body.getReader(),i=t.headers.get("X-File-Size")||t.headers.get("Content-Length"),a=i?parseInt(i):0,s=0!==a;let o=0;const l=new ReadableStream({start(e){!function t(){r.read().then(r=>{let{done:i,value:l}=r;if(i)e.close();else{o+=l.byteLength;const r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:a});for(let e=0,t=n.length;e<t;e++){const t=n[e];t.onProgress&&t.onProgress(r)}e.enqueue(l),t()}},t=>{e.error(t)})}()}});return new Response(l)}throw new NI('fetch for "'.concat(t.url,'" responded with ').concat(t.status,": ").concat(t.statusText),t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>(new DOMParser).parseFromString(e,s));case"json":return e.json();default:if(""===s)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(s),n=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(n);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{CI.add("file:".concat(e),t);const n=PI[e];delete PI[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onLoad&&r.onLoad(t)}}).catch(t=>{const n=PI[e];if(void 0===n)throw this.manager.itemError(e),t;delete PI[e];for(let e=0,r=n.length;e<r;e++){const r=n[e];r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class LI extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new kI(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(cU){r?r(cU):ox(cU),i.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=TI.parse(e[n]);t.push(r)}return t}}class DI extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=[],s=new vC,o=new kI(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(i.withCredentials);let l=0;function c(c){o.load(e[c],function(e){const n=i.parse(e,!0);a[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},l+=1,6===l&&(1===n.mipmapCount&&(s.minFilter=E_),s.image=a,s.format=n.format,s.needsUpdate=!0,t&&t(s))},n,r)}if(Array.isArray(e))for(let u=0,h=e.length;u<h;++u)c(u);else o.load(e,function(e){const n=i.parse(e,!0);if(n.isCubemap){const e=n.mipmaps.length/n.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<n.mipmapCount;e++)a[t].mipmaps.push(n.mipmaps[t*n.mipmapCount+e]),a[t].format=n.format,a[t].width=n.width,a[t].height=n.height}s.image=a}else s.image.width=n.width,s.image.height=n.height,s.mipmaps=n.mipmaps;1===n.mipmapCount&&(s.minFilter=E_),s.format=n.format,s.needsUpdate=!0,t&&t(s)},n,r);return s}}const OI=new WeakMap;class UI extends RI{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=CI.get("image:".concat(e));if(void 0!==a){if(!0===a.complete)i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0);else{let e=OI.get(a);void 0===e&&(e=[],OI.set(a,e)),e.push({onLoad:t,onError:r})}return a}const s=$S("img");function o(){c(),t&&t(this);const n=OI.get(this)||[];for(let e=0;e<n.length;e++){const t=n[e];t.onLoad&&t.onLoad(this)}OI.delete(this),i.manager.itemEnd(e)}function l(t){c(),r&&r(t),CI.remove("image:".concat(e));const n=OI.get(this)||[];for(let e=0;e<n.length;e++){const r=n[e];r.onError&&r.onError(t)}OI.delete(this),i.manager.itemError(e),i.manager.itemEnd(e)}function c(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),CI.add("image:".concat(e),s),i.manager.itemStart(e),s.src=e,s}}class FI extends RI{constructor(e){super(e)}load(e,t,n,r){const i=new vT;i.colorSpace=nS;const a=new UI(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;function o(n){a.load(e[n],function(e){i.images[n]=e,s++,6===s&&(i.needsUpdate=!0,t&&t(i))},void 0,r)}for(let l=0;l<e.length;++l)o(l);return i}}class zI extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new iM,s=new kI(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(i.withCredentials),s.load(e,function(e){let n;try{n=i.parse(e)}catch(ox){if(void 0===r)return void ox(ox);r(ox)}void 0!==n.image?a.image=n.image:void 0!==n.data&&(a.image.width=n.width,a.image.height=n.height,a.image.data=n.data),a.wrapS=void 0!==n.wrapS?n.wrapS:v_,a.wrapT=void 0!==n.wrapT?n.wrapT:v_,a.magFilter=void 0!==n.magFilter?n.magFilter:E_,a.minFilter=void 0!==n.minFilter?n.minFilter:E_,a.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.colorSpace&&(a.colorSpace=n.colorSpace),void 0!==n.flipY&&(a.flipY=n.flipY),void 0!==n.format&&(a.format=n.format),void 0!==n.type&&(a.type=n.type),void 0!==n.mipmaps&&(a.mipmaps=n.mipmaps,a.minFilter=C_),1===n.mipmapCount&&(a.minFilter=E_),void 0!==n.generateMipmaps&&(a.generateMipmaps=n.generateMipmaps),a.needsUpdate=!0,t&&t(a,n)},n,r),a}}class BI extends RI{constructor(e){super(e)}load(e,t,n,r){const i=new Vx,a=new UI(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){i.image=e,i.needsUpdate=!0,void 0!==t&&t(i)},n,r),i}}class VI extends Kw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;super(),this.isLight=!0,this.type="Light",this.color=new pE(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class HI extends VI{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Kw.DEFAULT_UP),this.updateMatrix(),this.groundColor=new pE(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const jI=new xw,GI=new wx,WI=new wx;class qI{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Sx(512,512),this.mapType=I_,this.map=null,this.mapPass=null,this.matrix=new xw,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new EM,this._frameExtents=new Sx(1,1),this._viewportCount=1,this._viewports=[new Hx(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;GI.setFromMatrixPosition(e.matrixWorld),t.position.copy(GI),WI.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(WI),t.updateMatrixWorld(),jI.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jI,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(jI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class XI extends qI{constructor(){super(new pT(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=2*fx*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,i=e.distance||t.far;n===t.fov&&r===t.aspect&&i===t.far||(t.fov=n,t.aspect=r,t.far=i,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class YI extends VI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2;super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Kw.DEFAULT_UP),this.updateMatrix(),this.target=new Kw,this.distance=n,this.angle=r,this.penumbra=i,this.decay=a,this.map=null,this.shadow=new XI}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class KI extends qI{constructor(){super(new pT(90,1,.5,500)),this.isPointLightShadow=!0}}class JI extends VI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new KI}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class QI extends uT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=i,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let i=n-e,a=n+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i+=e*this.view.offsetX,a=i+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(i,a,s,o,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}class ZI extends qI{constructor(){super(new QI(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class $I extends VI{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Kw.DEFAULT_UP),this.updateMatrix(),this.target=new Kw,this.shadow=new ZI}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class eR extends VI{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class tR extends VI{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class nR{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new wx)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*i),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],n*r*1.092548),t.addScaledVector(a[5],r*i*1.092548),t.addScaledVector(a[6],.315392*(3*i*i-1)),t.addScaledVector(a[7],n*i*1.092548),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,i=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*i),t.addScaledVector(a[3],1.023328*n),t.addScaledVector(a[4],.858086*n*r),t.addScaledVector(a[5],.858086*r*i),t.addScaledVector(a[6],.743125*i*i-.247708),t.addScaledVector(a[7],.858086*n*i),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}toArray(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const n=e.x,r=e.y,i=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*i,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*i,t[6]=.315392*(3*i*i-1),t[7]=1.092548*n*i,t[8]=.546274*(n*n-r*r)}}class rR extends VI{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nR;super(void 0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class iR extends RI{constructor(e){super(e),this.textures={}}load(e,t,n,r){const i=this,a=new kI(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(cU){r?r(cU):ox(cU),i.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(e){return void 0===t[e]&&sx("MaterialLoader: Undefined texture",e),t[e]}const r=this.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=(new pE).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.dispersion&&(r.dispersion=e.dispersion),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthFunc&&(r.depthFunc=e.depthFunc),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.blendSrc&&(r.blendSrc=e.blendSrc),void 0!==e.blendDst&&(r.blendDst=e.blendDst),void 0!==e.blendEquation&&(r.blendEquation=e.blendEquation),void 0!==e.blendSrcAlpha&&(r.blendSrcAlpha=e.blendSrcAlpha),void 0!==e.blendDstAlpha&&(r.blendDstAlpha=e.blendDstAlpha),void 0!==e.blendEquationAlpha&&(r.blendEquationAlpha=e.blendEquationAlpha),void 0!==e.blendColor&&void 0!==r.blendColor&&r.blendColor.setHex(e.blendColor),void 0!==e.blendAlpha&&(r.blendAlpha=e.blendAlpha),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),void 0!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.allowOverride&&(r.allowOverride=e.allowOverride),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const i in e.uniforms){const t=e.uniforms[i];switch(r.uniforms[i]={},t.type){case"t":r.uniforms[i].value=n(t.value);break;case"c":r.uniforms[i].value=(new pE).setHex(t.value);break;case"v2":r.uniforms[i].value=(new Sx).fromArray(t.value);break;case"v3":r.uniforms[i].value=(new wx).fromArray(t.value);break;case"v4":r.uniforms[i].value=(new Hx).fromArray(t.value);break;case"m3":r.uniforms[i].value=(new Mx).fromArray(t.value);break;case"m4":r.uniforms[i].value=(new xw).fromArray(t.value);break;default:r.uniforms[i].value=t.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(const i in e.extensions)r.extensions[i]=e.extensions[i];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=(new Sx).fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=n(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=n(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapRotation&&r.envMapRotation.fromArray(e.envMapRotation),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new Sx).fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=n(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=n(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=n(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=n(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return iR.createMaterialFromType(e)}static createMaterialFromType(e){return new{ShadowMaterial:JA,SpriteMaterial:AT,RawShaderMaterial:QA,ShaderMaterial:cT,PointsMaterial:oC,MeshPhysicalMaterial:$A,MeshStandardMaterial:ZA,MeshPhongMaterial:eI,MeshToonMaterial:tI,MeshNormalMaterial:nI,MeshLambertMaterial:rI,MeshDepthMaterial:iI,MeshDistanceMaterial:aI,MeshBasicMaterial:yE,MeshMatcapMaterial:sI,LineDashedMaterial:oI,LineBasicMaterial:XM,Material:vE}[e]}}class aR{static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class sR extends GE{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class oR extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new kI(i.manager);a.setPath(i.path),a.setRequestHeader(i.requestHeader),a.setWithCredentials(i.withCredentials),a.load(e,function(n){try{t(i.parse(JSON.parse(n)))}catch(cU){r?r(cU):ox(cU),i.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(e,r){if(void 0!==t[r])return t[r];const i=e.interleavedBuffers[r],a=function(e,t){if(void 0!==n[t])return n[t];const r=e.arrayBuffers,i=r[t],a=new Uint32Array(i).buffer;return n[t]=a,a}(e,i.buffer),s=QS(i.type,a),o=new TT(s,i.stride);return o.uuid=i.uuid,t[r]=o,o}const i=e.isInstancedBufferGeometry?new sR:new GE,a=e.data.index;if(void 0!==a){const e=QS(a.type,a.array);i.setIndex(new CE(e,1))}const s=e.data.attributes;for(const u in s){const t=s[u];let n;if(t.isInterleavedBufferAttribute){const i=r(e.data,t.data);n=new CT(i,t.itemSize,t.offset,t.normalized)}else{const e=QS(t.type,t.array);n=new(t.isInstancedBufferAttribute?lM:CE)(e,t.itemSize,t.normalized)}void 0!==t.name&&(n.name=t.name),void 0!==t.usage&&n.setUsage(t.usage),i.setAttribute(u,n)}const o=e.data.morphAttributes;if(o)for(const u in o){const t=o[u],n=[];for(let i=0,a=t.length;i<a;i++){const a=t[i];let s;if(a.isInterleavedBufferAttribute){const t=r(e.data,a.data);s=new CT(t,a.itemSize,a.offset,a.normalized)}else{const e=QS(a.type,a.array);s=new CE(e,a.itemSize,a.normalized)}void 0!==a.name&&(s.name=a.name),n.push(s)}i.morphAttributes[u]=n}e.data.morphTargetsRelative&&(i.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let u=0,h=l.length;u!==h;++u){const e=l[u];i.addGroup(e.start,e.count,e.materialIndex)}const c=e.data.boundingSphere;return void 0!==c&&(i.boundingSphere=(new fw).fromJSON(c)),e.name&&(i.name=e.name),e.userData&&(i.userData=e.userData),i}}class lR extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=""===this.path?aR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const s=new kI(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(n){let a=null;try{a=JSON.parse(n)}catch(ox){return void 0!==r&&r(ox),void ox("ObjectLoader: Can't parse "+e+".",ox.message)}const s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())return void 0!==r&&r(new Error("THREE.ObjectLoader: Can't load "+e)),void ox("ObjectLoader: Can't load "+e);i.parse(a,t)},n,r)}async loadAsync(e,t){const n=""===this.path?aR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||n;const r=new kI(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);const i=await r.loadAsync(e,t),a=JSON.parse(i),s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),s=this.parseTextures(e.textures,a),o=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,i,o,s,n),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),this.bindLightTargets(l),void 0!==t){let e=!1;for(const t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),i=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,r,s,a,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),this.bindLightTargets(o),o}parseShapes(e){const t={};if(void 0!==e)for(let n=0,r=e.length;n<r;n++){const r=(new rA).fromJSON(e[n]);t[r.uuid]=r}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(let i=0,a=e.length;i<a;i++){const t=(new oM).fromJSON(e[i],r);n[t.uuid]=t}return n}parseGeometries(e,t){const n={};if(void 0!==e){const r=new oR;for(let i=0,a=e.length;i<a;i++){let a;const s=e[i];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;default:s.type in KA?a=KA[s.type].fromJSON(s,t):sx('ObjectLoader: Unsupported geometry type "'.concat(s.type,'"'))}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.userData&&(a.userData=s.userData),n[s.uuid]=a}}return n}parseMaterials(e,t){const n={},r={};if(void 0!==e){const i=new iR;i.setTextures(t);for(let t=0,a=e.length;t<a;t++){const a=e[t];void 0===n[a.uuid]&&(n[a.uuid]=i.parse(a)),r[a.uuid]=n[a.uuid]}}return r}parseAnimations(e){const t={};if(void 0!==e)for(let n=0;n<e.length;n++){const r=e[n],i=TI.parse(r);t[i.uuid]=i}return t}parseImages(e,t){const n=this,r={};let i;function a(e){if("string"===typeof e){const t=e;return function(e){return n.manager.itemStart(e),i.load(e,function(){n.manager.itemEnd(e)},void 0,function(){n.manager.itemError(e),n.manager.itemEnd(e)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:n.resourcePath+t)}return e.data?{data:QS(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const n=new AI(t);i=new UI(n),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const n=e[t],i=n.url;if(Array.isArray(i)){const e=[];for(let t=0,n=i.length;t<n;t++){const n=a(i[t]);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new iM(n.data,n.width,n.height)))}r[n.uuid]=new Ux(e)}else{const e=a(n.url);r[n.uuid]=new Ux(e)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function i(e){if("string"===typeof e){const n=e,i=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(n)?n:t.resourcePath+n;return await r.loadAsync(i)}return e.data?{data:QS(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){r=new UI(this.manager),r.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],a=r.url;if(Array.isArray(a)){const e=[];for(let t=0,n=a.length;t<n;t++){const n=a[t],r=await i(n);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new iM(r.data,r.width,r.height)))}n[r.uuid]=new Ux(e)}else{const e=await i(r.url);n[r.uuid]=new Ux(e)}}}return n}parseTextures(e,t){function n(e,t){return"number"===typeof e?e:(sx("ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const r={};if(void 0!==e)for(let i=0,a=e.length;i<a;i++){const a=e[i];void 0===a.image&&sx('ObjectLoader: No "image" specified for',a.uuid),void 0===t[a.image]&&sx("ObjectLoader: Undefined image",a.image);const s=t[a.image],o=s.data;let l;Array.isArray(o)?(l=new vT,6===o.length&&(l.needsUpdate=!0)):(l=o&&o.data?new iM:new Vx,o&&(l.needsUpdate=!0)),l.source=s,l.uuid=a.uuid,void 0!==a.name&&(l.name=a.name),void 0!==a.mapping&&(l.mapping=n(a.mapping,cR)),void 0!==a.channel&&(l.channel=a.channel),void 0!==a.offset&&l.offset.fromArray(a.offset),void 0!==a.repeat&&l.repeat.fromArray(a.repeat),void 0!==a.center&&l.center.fromArray(a.center),void 0!==a.rotation&&(l.rotation=a.rotation),void 0!==a.wrap&&(l.wrapS=n(a.wrap[0],uR),l.wrapT=n(a.wrap[1],uR)),void 0!==a.format&&(l.format=a.format),void 0!==a.internalFormat&&(l.internalFormat=a.internalFormat),void 0!==a.type&&(l.type=a.type),void 0!==a.colorSpace&&(l.colorSpace=a.colorSpace),void 0!==a.minFilter&&(l.minFilter=n(a.minFilter,hR)),void 0!==a.magFilter&&(l.magFilter=n(a.magFilter,hR)),void 0!==a.anisotropy&&(l.anisotropy=a.anisotropy),void 0!==a.flipY&&(l.flipY=a.flipY),void 0!==a.generateMipmaps&&(l.generateMipmaps=a.generateMipmaps),void 0!==a.premultiplyAlpha&&(l.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(l.unpackAlignment=a.unpackAlignment),void 0!==a.compareFunction&&(l.compareFunction=a.compareFunction),void 0!==a.userData&&(l.userData=a.userData),r[a.uuid]=l}return r}parseObject(e,t,n,r,i){let a,s,o;function l(e){return void 0===t[e]&&sx("ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];void 0===n[i]&&sx("ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&sx("ObjectLoader: Undefined material",e),n[e]}}function u(e){return void 0===r[e]&&sx("ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new ET,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new pE(e.background):a.background=u(e.background)),void 0!==e.environment&&(a.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new wT(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new xT(e.fog.color,e.fog.density)),""!==e.fog.name&&(a.fog.name=e.fog.name)),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity),void 0!==e.backgroundRotation&&a.backgroundRotation.fromArray(e.backgroundRotation),void 0!==e.environmentIntensity&&(a.environmentIntensity=e.environmentIntensity),void 0!==e.environmentRotation&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new pT(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new QI(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new eR(e.color,e.intensity);break;case"DirectionalLight":a=new $I(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new JI(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new tR(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new YI(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new HI(e.color,e.groundColor,e.intensity);break;case"LightProbe":const t=(new nR).fromArray(e.sh);a=new rR(t,e.intensity);break;case"SkinnedMesh":s=l(e.geometry),o=c(e.material),a=new nM(s,o),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":s=l(e.geometry),o=c(e.material),a=new nT(s,o);break;case"InstancedMesh":s=l(e.geometry),o=c(e.material);const n=e.count,r=e.instanceMatrix,i=e.instanceColor;a=new gM(s,o,n),a.instanceMatrix=new lM(new Float32Array(r.array),16),void 0!==i&&(a.instanceColor=new lM(new Float32Array(i.array),i.itemSize));break;case"BatchedMesh":s=l(e.geometry),o=c(e.material),a=new qM(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,o),a.geometry=s,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(e=>{let t=null,n=null;return void 0!==e.boundingBox&&(t=(new Kx).fromJSON(e.boundingBox)),void 0!==e.boundingSphere&&(n=(new fw).fromJSON(e.boundingSphere)),d(d({},e),{},{boundingBox:t,boundingSphere:n})}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=u(e.matricesTexture.uuid),a._indirectTexture=u(e.indirectTexture.uuid),void 0!==e.colorsTexture&&(a._colorsTexture=u(e.colorsTexture.uuid)),void 0!==e.boundingSphere&&(a.boundingSphere=(new fw).fromJSON(e.boundingSphere)),void 0!==e.boundingBox&&(a.boundingBox=(new Kx).fromJSON(e.boundingBox));break;case"LOD":a=new qT;break;case"Line":a=new tC(l(e.geometry),c(e.material));break;case"LineLoop":a=new sC(l(e.geometry),c(e.material));break;case"LineSegments":a=new aC(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new dC(l(e.geometry),c(e.material));break;case"Sprite":a=new HT(c(e.material));break;case"Group":a=new _T;break;case"Bone":a=new rM;break;default:a=new Kw}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.intensity&&(a.shadow.intensity=e.shadow.intensity),void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){const s=e.children;for(let e=0;e<s.length;e++)a.add(this.parseObject(s[e],t,n,r,i))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const n=t[e];a.animations.push(i[n])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const n=t[e],r=a.getObjectByProperty("uuid",n.object);void 0!==r&&a.addLevel(r,n.distance,n.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const n=t[e.skeleton];void 0===n?sx("ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);t.target=void 0!==r?r:new Kw}})}}const cR={UVMapping:u_,CubeReflectionMapping:h_,CubeRefractionMapping:d_,EquirectangularReflectionMapping:f_,EquirectangularRefractionMapping:p_,CubeUVReflectionMapping:m_},uR={RepeatWrapping:g_,ClampToEdgeWrapping:v_,MirroredRepeatWrapping:y_},hR={NearestFilter:__,NearestMipmapNearestFilter:b_,NearestMipmapLinearFilter:x_,LinearFilter:E_,LinearMipmapNearestFilter:T_,LinearMipmapLinearFilter:C_},dR=new WeakMap;class fR extends RI{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&sx("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&sx("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const i=this,a=CI.get("image-bitmap:".concat(e));if(void 0!==a)return i.manager.itemStart(e),a.then?void a.then(n=>{if(!0!==dR.has(a))return t&&t(n),i.manager.itemEnd(e),n;r&&r(dR.get(a)),i.manager.itemError(e),i.manager.itemEnd(e)}):(setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a);const s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,s.signal="function"===typeof AbortSignal.any?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const o=fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(i.options,{colorSpaceConversion:"none"}))}).then(function(n){return CI.add("image-bitmap:".concat(e),n),t&&t(n),i.manager.itemEnd(e),n}).catch(function(t){r&&r(t),dR.set(o,t),CI.remove("image-bitmap:".concat(e)),i.manager.itemError(e),i.manager.itemEnd(e)});CI.add("image-bitmap:".concat(e),o),i.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let pR;class mR{static getContext(){return void 0===pR&&(pR=new(window.AudioContext||window.webkitAudioContext)),pR}static setContext(e){pR=e}}class gR extends RI{constructor(e){super(e)}load(e,t,n,r){const i=this,a=new kI(this.manager);function s(t){r?r(t):ox(t),i.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{const n=e.slice(0);mR.getContext().decodeAudioData(n,function(e){t(e)}).catch(s)}catch(cU){s(cU)}},n,r)}}const vR=new xw,yR=new xw,_R=new xw;class bR{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new pT,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new pT,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,_R.copy(e.projectionMatrix);const n=t.eyeSep/2,r=n*t.near/t.focus,i=t.near*Math.tan(dx*t.fov*.5)/t.zoom;let a,s;yR.elements[12]=-n,vR.elements[12]=n,a=-i*t.aspect+r,s=i*t.aspect+r,_R.elements[0]=2*t.near/(s-a),_R.elements[8]=(s+a)/(s-a),this.cameraL.projectionMatrix.copy(_R),a=-i*t.aspect-r,s=i*t.aspect-r,_R.elements[0]=2*t.near/(s-a),_R.elements[8]=(s+a)/(s-a),this.cameraR.projectionMatrix.copy(_R)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(yR),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(vR)}}class SR extends pT{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class xR{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const wR=new wx,ER=new xx,TR=new wx,MR=new wx,CR=new wx;class AR extends Kw{constructor(){super(),this.type="AudioListener",this.context=mR.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new xR}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(wR,ER,TR),MR.set(0,0,-1).applyQuaternion(ER),CR.set(0,1,0).applyQuaternion(ER),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(wR.x,e),t.positionY.linearRampToValueAtTime(wR.y,e),t.positionZ.linearRampToValueAtTime(wR.z,e),t.forwardX.linearRampToValueAtTime(MR.x,e),t.forwardY.linearRampToValueAtTime(MR.y,e),t.forwardZ.linearRampToValueAtTime(MR.z,e),t.upX.linearRampToValueAtTime(CR.x,e),t.upY.linearRampToValueAtTime(CR.y,e),t.upZ.linearRampToValueAtTime(CR.z,e)}else t.setPosition(wR.x,wR.y,wR.z),t.setOrientation(MR.x,MR.y,MR.z,CR.x,CR.y,CR.z)}}class IR extends Kw{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0===this.isPlaying)return void sx("Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void sx("Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;sx("Audio: this Audio has no playback control.")}stop(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!1!==this.hasPlaybackControl)return this._progress=0,null!==this.source&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this;sx("Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,!0===this.isPlaying&&void 0!==this.source.detune&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;sx("Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return!1===this.hasPlaybackControl?(sx("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;sx("Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),"buffer"!==e.sourceType?(sx("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const RR=new wx,PR=new xx,NR=new wx,kR=new wx;class LR extends IR{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(RR,PR,NR),kR.set(0,0,1).applyQuaternion(PR);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(RR.x,e),t.positionY.linearRampToValueAtTime(RR.y,e),t.positionZ.linearRampToValueAtTime(RR.z,e),t.orientationX.linearRampToValueAtTime(kR.x,e),t.orientationY.linearRampToValueAtTime(kR.y,e),t.orientationZ.linearRampToValueAtTime(kR.z,e)}else t.setPosition(RR.x,RR.y,RR.z),t.setOrientation(kR.x,kR.y,kR.z)}}class DR{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class OR{constructor(e,t,n){let r,i,a;switch(this.binding=e,this.valueSize=n,t){case"quaternion":r=this._slerp,i=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":r=this._select,i=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:r=this._lerp,i=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=i,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,i=e*r+r;let a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)n[i+e]=n[e];a=t}else{a+=t;const e=t/a;this._mixBufferRegion(n,i,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,i=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,i<1){const e=t*this._origIndex;this._mixBufferRegion(n,r,e,1-i,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(n[o]!==n[o+t]){s.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let i=n,a=r;i!==a;++i)t[i]=t[r+i%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,i){if(r>=.5)for(let a=0;a!==i;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){xx.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,i){const a=this._workIndex*i;xx.multiplyQuaternionsFlat(e,a,e,t,e,n),xx.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,i){const a=1-r;for(let s=0;s!==i;++s){const i=t+s;e[i]=e[i]*a+e[n+s]*r}}_lerpAdditive(e,t,n,r,i){for(let a=0;a!==i;++a){const i=t+a;e[i]=e[i]+e[n+a]*r}}}const UR="\\[\\]\\.:\\/",FR=new RegExp("["+UR+"]","g"),zR="[^"+UR+"]",BR="[^"+UR.replace("\\.","")+"]",VR=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",zR)+/(WCOD+)?/.source.replace("WCOD",BR)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",zR)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",zR)+"$"),HR=["material","materials","bones","map"];class jR{constructor(e,t,n){this.path=t,this.parsedPath=n||jR.parseTrackName(t),this.node=jR.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new jR.Composite(e,t,n):new jR(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(FR,"")}static parseTrackName(e){const t=VR.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){const e=n.nodeName.substring(r+1);-1!==HR.indexOf(e)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=e)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){const n=function(e){for(let r=0;r<e.length;r++){const i=e[r];if(i.name===t||i.uuid===t)return i;const a=n(i.children);if(a)return a}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,i=n.length;r!==i;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let i=t.propertyIndex;if(e||(e=jR.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void sx("PropertyBinding: No target node found for track: "+this.path+".");if(n){let r=t.objectIndex;switch(n){case"materials":if(!e.material)return void ox("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void ox("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void ox("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void ox("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void ox("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[n])return void ox("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==r){if(void 0===e[r])return void ox("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[r]}}const a=e[r];if(void 0===a){return void ox("PropertyBinding: Trying to update property for track: "+t.nodeName+"."+r+" but it wasn't found.",e)}let s=this.Versioning.None;this.targetObject=e,!0===e.isMaterial?s=this.Versioning.NeedsUpdate:!0===e.isObject3D&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!e.geometry)return void ox("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void ox("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[i]&&(i=e.morphTargetDictionary[i])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}jR.Composite=class{constructor(e,t,n){const r=n||jR.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},jR.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},jR.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},jR.prototype.GetterByBindingType=[jR.prototype._getValue_direct,jR.prototype._getValue_array,jR.prototype._getValue_arrayElement,jR.prototype._getValue_toArray],jR.prototype.SetterByBindingTypeAndVersioning=[[jR.prototype._setValue_direct,jR.prototype._setValue_direct_setNeedsUpdate,jR.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[jR.prototype._setValue_array,jR.prototype._setValue_array_setNeedsUpdate,jR.prototype._setValue_array_setMatrixWorldNeedsUpdate],[jR.prototype._setValue_arrayElement,jR.prototype._setValue_arrayElement_setNeedsUpdate,jR.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[jR.prototype._setValue_fromArray,jR.prototype._setValue_fromArray_setNeedsUpdate,jR.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class GR{constructor(){this.isAnimationObjectGroup=!0,this.uuid=px(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,i=this._bindings,a=i.length;let s,o=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=o++,t[h]=d,e.push(u);for(let e=0,t=a;e!==t;++e)i[e].push(new jR(u,n[e],r[e]))}else if(d<l){s=e[d];const o=--l,c=e[o];t[c.uuid]=d,e[d]=c,t[h]=o,e[o]=u;for(let e=0,t=a;e!==t;++e){const t=i[e],a=t[o];let s=t[d];t[d]=a,void 0===s&&(s=new jR(u,n[e],r[e])),t[o]=s}}else e[d]!==s&&ox("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){const s=arguments[a],o=s.uuid,l=t[o];if(void 0!==l&&l>=i){const a=i++,c=e[a];t[c.uuid]=l,e[l]=c,t[o]=a,e[a]=s;for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[a],i=t[l];t[l]=r,t[a]=i}}}this.nCachedObjects_=i}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let i=this.nCachedObjects_,a=e.length;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s].uuid,l=t[o];if(void 0!==l)if(delete t[o],l<i){const s=--i,o=e[s],c=--a,u=e[c];t[o.uuid]=l,e[l]=o,t[u.uuid]=s,e[s]=u,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e],r=t[s],i=t[c];t[l]=r,t[s]=i,t.pop()}}else{const i=--a,s=e[i];i>0&&(t[s.uuid]=l),e[l]=s,e.pop();for(let e=0,t=r;e!==t;++e){const t=n[e];t[l]=t[i],t.pop()}}}this.nCachedObjects_=i}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const i=this._bindings;if(void 0!==r)return i[r];const a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,c=this.nCachedObjects_,u=new Array(l);r=i.length,n[e]=r,a.push(e),s.push(t),i.push(u);for(let h=c,d=o.length;h!==d;++h){const n=o[h];u[h]=new jR(n,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){const r=this._paths,i=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s];t[e[s]]=n,a[n]=o,a.pop(),i[n]=i[s],i.pop(),r[n]=r[s],r.pop()}}}class WR{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.blendMode;this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const i=t.tracks,a=i.length,s=new Array(a),o={endingStart:Vb,endingEnd:Vb};for(let l=0;l!==a;++l){const e=i[l].createInterpolant(null);s[l]=e,e.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ob,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e.fadeOut(t),this.fadeIn(t),!0===n){const n=this._clip.duration,r=e._clip.duration,i=r/n,a=n/r;e.warp(1,i,t),this.warp(a,1,t)}return this}crossFadeTo(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,i=r.time,a=this.timeScale;let s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);const o=s.parameterPositions,l=s.sampleValues;return o[0]=i,o[1]=i+n,l[0]=e/a,l[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled)return void this._updateWeight(e);const i=this._startTime;if(null!==i){const r=(e-i)*n;r<0||0===n?t=0:(this._startTime=null,t=n*r)}t*=this._updateTimeScale(e);const a=this._updateTime(t),s=this._updateWeight(e);if(s>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===Wb)for(let n=0,r=e.length;n!==r;++n)e[n].evaluate(a),t[n].accumulateAdditive(s);else for(let n=0,i=e.length;n!==i;++n)e[n].evaluate(a),t[n].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(null!==n){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(null!==n){t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,i=this._loopCount;const a=n===Ub;if(0===e)return-1===i?r:a&&1===(1&i)?t-r:r;if(n===Db){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){const n=Math.floor(r/t);r-=t*n,i+=Math.abs(n);const s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){const t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=r;if(a&&1===(1&i))return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Hb,r.endingEnd=Hb):(r.endingStart=e?this.zeroSlopeAtStart?Hb:Vb:jb,r.endingEnd=t?this.zeroSlopeAtEnd?Hb:Vb:jb)}_scheduleFading(e,t,n){const r=this._mixer,i=r.time;let a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const s=a.parameterPositions,o=a.sampleValues;return s[0]=i,o[0]=t,s[1]=i+e,o[1]=n,this}}const qR=new Float32Array(1);class XR extends cx{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,i=r.length,a=e._propertyBindings,s=e._interpolants,o=n.uuid,l=this._bindingsByRootAndName;let c=l[o];void 0===c&&(c={},l[o]=c);for(let u=0;u!==i;++u){const e=r[u],i=e.name;let l=c[i];if(void 0!==l)++l.referenceCount,a[u]=l;else{if(l=a[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,o,i));continue}const r=t&&t._propertyBindings[u].binding.parsedPath;l=new OR(jR.create(n,i,r),e.ValueTypeName,e.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,o,i),a[u]=l}s[u].resultBuffer=l.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,n=t.length;e!==n;++e){const n=t[e];0===--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,i=this._actionsByClip;let a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{const t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const i=e._clip.uuid,a=this._actionsByClip,s=a[i],o=s.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;delete s.actionByRoot[(e._localRoot||this._root).uuid],0===o.length&&delete a[i],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const e=t[n];0===--e.referenceCount&&this._removeInactiveBinding(e)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,i=this._bindings;let a=r[t];void 0===a&&(a={},r[t]=a),a[n]=e,e._cacheIndex=i.length,i.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,i=n.path,a=this._bindingsByRootAndName,s=a[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[i],0===Object.keys(s).length&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,i=t[r];e._cacheIndex=r,t[r]=e,i._cacheIndex=n,t[n]=i}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return void 0===n&&(n=new mI(new Float32Array(2),new Float32Array(2),1,qR),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,i=t[r];e.__cacheIndex=r,t[r]=e,i.__cacheIndex=n,t[n]=i}clipAction(e,t,n){const r=t||this._root,i=r.uuid;let a="string"===typeof e?TI.findByName(r,e):e;const s=null!==a?a.uuid:e,o=this._actionsByClip[s];let l=null;if(void 0===n&&(n=null!==a?a.blendMode:Gb),void 0!==o){const e=o.actionByRoot[i];if(void 0!==e&&e.blendMode===n)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;const c=new WR(this,a,t,n);return this._bindAction(c,l),this._addInactiveAction(c,s,i),c}existingAction(e,t){const n=t||this._root,r=n.uuid,i="string"===typeof e?TI.findByName(n,e):e,a=i?i.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==n;++l){t[l]._update(r,e,i,a)}const s=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)s[l].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){const e=i.knownActions;for(let n=0,r=e.length;n!==r;++n){const r=e[n];this._deactivateAction(r);const i=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=i,t[i]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const i in n){const e=n[i].actionByRoot[t];void 0!==e&&(this._deactivateAction(e),this._removeInactiveAction(e))}const r=this._bindingsByRootAndName[t];if(void 0!==r)for(const i in r){const e=r[i];e.restoreOriginalState(),this._removeInactiveBinding(e)}}uncacheAction(e,t){const n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class YR extends jx{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new Xx(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class KR{constructor(e){this.value=e}clone(){return new KR(void 0===this.value.clone?this.value:this.value.clone())}}let JR=0;class QR extends cx{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:JR++}),this.name="",this.usage=kS,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return-1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const e=Array.isArray(t[n])?t[n]:[t[n]];for(let t=0;t<e.length;t++)this.uniforms.push(e[t].clone())}return this}clone(){return(new this.constructor).copy(this)}}class ZR extends TT{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class $R{constructor(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=i,this.normalized=a,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const eP=new xw;class tP{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Sw(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new kw,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):ox("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return eP.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(eP),this}intersectObject(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return rP(e,this,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]),t.sort(nP),t}intersectObjects(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(let r=0,i=e.length;r<i;r++)rP(e[r],this,n,t);return n.sort(nP),n}}function nP(e,t){return e.distance-t.distance}function rP(e,t,n,r){let i=!0;if(e.layers.test(t.layers)){!1===e.raycast(t,n)&&(i=!1)}if(!0===i&&!0===r){const r=e.children;for(let e=0,i=r.length;e<i;e++)rP(r[e],t,n,!0)}}class iP{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,void 0!==e.hidden&&(this._pageVisibilityHandler=aP.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){null!==this._pageVisibilityHandler&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return null!==this._pageVisibilityHandler&&!0===this._document.hidden?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(void 0!==e?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function aP(){!1===this._document.hidden&&this.reset()}class sP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=mx(this.phi,e,Math.PI-e),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(mx(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class oP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return(new this.constructor).copy(this)}}class lP{constructor(e,t,n,r){lP.prototype.isMatrix2=!0,this.elements=[1,0,0,1],void 0!==e&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const i=this.elements;return i[0]=e,i[2]=t,i[1]=n,i[3]=r,this}}const cP=new Sx;class uP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Sx(1/0,1/0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Sx(-1/0,-1/0);this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=cP.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,cP).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hP=new wx,dP=new wx,fP=new wx,pP=new wx,mP=new wx,gP=new wx,vP=new wx;class yP{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx;this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){hP.subVectors(e,this.start),dP.subVectors(this.end,this.start);const n=dP.dot(dP);let r=dP.dot(hP)/n;return t&&(r=mx(r,0,1)),r}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:gP,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vP;const r=1e-8*1e-8;let i,a;const s=this.start,o=e.start,l=this.end,c=e.end;fP.subVectors(l,s),pP.subVectors(c,o),mP.subVectors(s,o);const u=fP.dot(fP),h=pP.dot(pP),d=pP.dot(mP);if(u<=r&&h<=r)return t.copy(s),n.copy(o),t.sub(n),t.dot(t);if(u<=r)i=0,a=d/h,a=mx(a,0,1);else{const e=fP.dot(mP);if(h<=r)a=0,i=mx(-e/u,0,1);else{const t=fP.dot(pP),n=u*h-t*t;i=0!==n?mx((t*d-e*h)/n,0,1):0,a=(t*i+d)/h,a<0?(a=0,i=mx(-e/u,0,1)):a>1&&(a=1,i=mx((t-e)/u,0,1))}}return t.copy(s).add(fP.multiplyScalar(i)),n.copy(o).add(pP.multiplyScalar(a)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const _P=new wx;class bP extends Kw{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new GE,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,s=1,o=32;a<o;a++,s++){const e=a/o*Math.PI*2,t=s/o*Math.PI*2;r.push(Math.cos(e),Math.sin(e),1,Math.cos(t),Math.sin(t),1)}n.setAttribute("position",new OE(r,3));const i=new XM({fog:!1,toneMapped:!1});this.cone=new aC(n,i),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),_P.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_P),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const SP=new wx,xP=new xw,wP=new xw;class EP extends aC{constructor(e){const t=TP(e),n=new GE,r=[],i=[];for(let o=0;o<t.length;o++){const e=t[o];e.parent&&e.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(0,0,0),i.push(0,0,0))}n.setAttribute("position",new OE(r,3)),n.setAttribute("color",new OE(i,3));super(n,new XM({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const a=new pE(255),s=new pE(65280);this.setColors(a,s)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");wP.copy(this.root.matrixWorld).invert();for(let i=0,a=0;i<t.length;i++){const e=t[i];e.parent&&e.parent.isBone&&(xP.multiplyMatrices(wP,e.matrixWorld),SP.setFromMatrixPosition(xP),r.setXYZ(a,SP.x,SP.y,SP.z),xP.multiplyMatrices(wP,e.parent.matrixWorld),SP.setFromMatrixPosition(xP),r.setXYZ(a+1,SP.x,SP.y,SP.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const n=this.geometry.getAttribute("color");for(let r=0;r<n.count;r+=2)n.setXYZ(r,e.r,e.g,e.b),n.setXYZ(r+1,t.r,t.g,t.b);return n.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function TP(e){const t=[];!0===e.isBone&&t.push(e);for(let n=0;n<e.children.length;n++)t.push(...TP(e.children[n]));return t}class MP extends nT{constructor(e,t,n){super(new HA(t,4,2),new yE({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const CP=new wx,AP=new pE,IP=new pE;class RP extends Kw{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new FA(t);r.rotateY(.5*Math.PI),this.material=new yE({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const i=r.getAttribute("position"),a=new Float32Array(3*i.count);r.setAttribute("color",new CE(a,3)),this.add(new nT(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");AP.copy(this.light.color),IP.copy(this.light.groundColor);for(let e=0,n=t.count;e<n;e++){const r=e<n/2?AP:IP;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(CP.setFromMatrixPosition(this.light.matrixWorld).negate())}}class PP extends aC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;n=new pE(n),r=new pE(r);const i=t/2,a=e/t,s=e/2,o=[],l=[];for(let u=0,h=0,d=-s;u<=t;u++,d+=a){o.push(-s,0,d,s,0,d),o.push(d,0,-s,d,0,s);const e=u===i?n:r;e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3,e.toArray(l,h),h+=3}const c=new GE;c.setAttribute("position",new OE(o,3)),c.setAttribute("color",new OE(l,3));super(c,new XM({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class NP extends aC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;i=new pE(i),a=new pE(a);const s=[],o=[];if(t>1)for(let c=0;c<t;c++){const n=c/t*(2*Math.PI),r=Math.sin(n)*e,l=Math.cos(n)*e;s.push(0,0,0),s.push(r,0,l);const u=1&c?i:a;o.push(u.r,u.g,u.b),o.push(u.r,u.g,u.b)}for(let c=0;c<n;c++){const t=1&c?i:a,l=e-e/n*c;for(let e=0;e<r;e++){let n=e/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l;s.push(i,0,a),o.push(t.r,t.g,t.b),n=(e+1)/r*(2*Math.PI),i=Math.sin(n)*l,a=Math.cos(n)*l,s.push(i,0,a),o.push(t.r,t.g,t.b)}}const l=new GE;l.setAttribute("position",new OE(s,3)),l.setAttribute("color",new OE(o,3));super(l,new XM({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const kP=new wx,LP=new wx,DP=new wx;class OP extends Kw{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new GE;r.setAttribute("position",new OE([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const i=new XM({fog:!1,toneMapped:!1});this.lightPlane=new tC(r,i),this.add(this.lightPlane),r=new GE,r.setAttribute("position",new OE([0,0,0,0,0,1],3)),this.targetLine=new tC(r,i),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),kP.setFromMatrixPosition(this.light.matrixWorld),LP.setFromMatrixPosition(this.light.target.matrixWorld),DP.subVectors(LP,kP),this.lightPlane.lookAt(LP),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(LP),this.targetLine.scale.z=DP.length()}}const UP=new wx,FP=new uT;class zP extends aC{constructor(e){const t=new GE,n=new XM({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],i=[],a={};function s(e,t){o(e),o(t)}function o(e){r.push(0,0,0),i.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new OE(r,3)),t.setAttribute("color",new OE(i,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new pE(16755200),c=new pE(16711680),u=new pE(43775),h=new pE(16777215),d=new pE(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,n,r,i){const a=this.geometry.getAttribute("color");return a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,n.r,n.g,n.b),a.setXYZ(33,n.r,n.g,n.b),a.setXYZ(34,n.r,n.g,n.b),a.setXYZ(35,n.r,n.g,n.b),a.setXYZ(36,n.r,n.g,n.b),a.setXYZ(37,n.r,n.g,n.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,i.r,i.g,i.b),a.setXYZ(41,i.r,i.g,i.b),a.setXYZ(42,i.r,i.g,i.b),a.setXYZ(43,i.r,i.g,i.b),a.setXYZ(44,i.r,i.g,i.b),a.setXYZ(45,i.r,i.g,i.b),a.setXYZ(46,i.r,i.g,i.b),a.setXYZ(47,i.r,i.g,i.b),a.setXYZ(48,i.r,i.g,i.b),a.setXYZ(49,i.r,i.g,i.b),a.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap;let n,r;if(FP.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),!0===this.camera.reversedDepth)n=1,r=0;else if(this.camera.coordinateSystem===GS)n=-1,r=1;else{if(this.camera.coordinateSystem!==WS)throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);n=0,r=1}BP("c",t,e,FP,0,0,n),BP("t",t,e,FP,0,0,r),BP("n1",t,e,FP,-1,-1,n),BP("n2",t,e,FP,1,-1,n),BP("n3",t,e,FP,-1,1,n),BP("n4",t,e,FP,1,1,n),BP("f1",t,e,FP,-1,-1,r),BP("f2",t,e,FP,1,-1,r),BP("f3",t,e,FP,-1,1,r),BP("f4",t,e,FP,1,1,r),BP("u1",t,e,FP,.7,1.1,n),BP("u2",t,e,FP,-.7,1.1,n),BP("u3",t,e,FP,0,2,n),BP("cf1",t,e,FP,-1,0,r),BP("cf2",t,e,FP,1,0,r),BP("cf3",t,e,FP,0,-1,r),BP("cf4",t,e,FP,0,1,r),BP("cn1",t,e,FP,-1,0,n),BP("cn2",t,e,FP,1,0,n),BP("cn3",t,e,FP,0,-1,n),BP("cn4",t,e,FP,0,1,n),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function BP(e,t,n,r,i,a,s){UP.set(i,a,s).unproject(r);const o=t[e];if(void 0!==o){const e=n.getAttribute("position");for(let t=0,n=o.length;t<n;t++)e.setXYZ(o[t],UP.x,UP.y,UP.z)}}const VP=new Kx;class HP extends aC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new GE;i.setIndex(new CE(n,1)),i.setAttribute("position",new CE(r,3)),super(i,new XM({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(void 0!==this.object&&VP.setFromObject(this.object),VP.isEmpty())return;const e=VP.min,t=VP.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class jP extends aC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new GE;r.setIndex(new CE(n,1)),r.setAttribute("position",new OE([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new XM({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class GP extends tC{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960,r=new GE;r.setAttribute("position",new OE([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new XM({color:n,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const i=new GE;i.setAttribute("position",new OE([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),i.computeBoundingSphere(),this.add(new nT(i,new yE({color:n,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const WP=new wx;let qP,XP;class YP extends Kw{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wx(0,0,1),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wx(0,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*n,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*i;super(),this.type="ArrowHelper",void 0===qP&&(qP=new GE,qP.setAttribute("position",new OE([0,0,0,0,1,0],3)),XP=new CC(.5,1,5,1),XP.translate(0,-.5,0)),this.position.copy(t),this.line=new tC(qP,new XM({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new nT(XP,new yE({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,i,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{WP.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(WP,t)}}setLength(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class KP extends aC{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=new GE;n.setAttribute("position",new OE(t,3)),n.setAttribute("color",new OE([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(n,new XM({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,n){const r=new pE,i=this.geometry.attributes.color.array;return r.set(e),r.toArray(i,0),r.toArray(i,3),r.set(t),r.toArray(i,6),r.toArray(i,9),r.set(n),r.toArray(i,12),r.toArray(i,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class JP{constructor(){this.type="ShapePath",this.color=new pE,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new nA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,i,a){return this.currentPath.bezierCurveTo(e,t,n,r,i,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(e,t){const n=t.length;let r=!1;for(let i=n-1,a=0;a<n;i=a++){let n=t[i],s=t[a],o=s.x-n.x,l=s.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=t[a],o=-o,s=t[i],l=-l),e.y<n.y||e.y>s.y)continue;if(e.y===n.y){if(e.x===n.x)return!0}else{const t=l*(e.x-n.x)-o*(e.y-n.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==n.y)continue;if(s.x<=e.x&&e.x<=n.x||n.x<=e.x&&e.x<=s.x)return!0}}return r}const n=PA.isClockWise,r=this.subPaths;if(0===r.length)return[];let i,a,s;const o=[];if(1===r.length)return a=r[0],s=new rA,s.curves=a.curves,o.push(s),o;let l=!n(r[0].getPoints());l=e?!l:l;const c=[],u=[];let h,d,f=[],p=0;u[p]=void 0,f[p]=[];for(let m=0,g=r.length;m<g;m++)a=r[m],h=a.getPoints(),i=n(h),i=e?!i:i,i?(!l&&u[p]&&p++,u[p]={s:new rA,p:h},u[p].s.curves=a.curves,l&&p++,f[p]=[]):f[p].push({h:a,p:h[0]});if(!u[0])return function(e){const t=[];for(let n=0,r=e.length;n<r;n++){const r=e[n],i=new rA;i.curves=r.curves,t.push(i)}return t}(r);if(u.length>1){let e=!1,n=0;for(let t=0,r=u.length;t<r;t++)c[t]=[];for(let r=0,i=u.length;r<i;r++){const i=f[r];for(let a=0;a<i.length;a++){const s=i[a];let o=!0;for(let i=0;i<u.length;i++)t(s.p,u[i].p)&&(r!==i&&n++,o?(o=!1,c[i].push(s)):e=!0);o&&c[r].push(s)}}n>0&&!1===e&&(f=c)}for(let m=0,g=u.length;m<g;m++){s=u[m].s,o.push(s),d=f[m];for(let e=0,t=d.length;e<t;e++)s.holes.push(d[e].h)}return o}}class QP extends cx{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){void 0!==e?(null!==this.domElement&&this.disconnect(),this.domElement=e):sx("Controls: connect() now requires an element.")}disconnect(){}dispose(){}update(){}}function ZP(e,t,n,r){const i=function(e){switch(e){case I_:case R_:return{byteLength:1,components:1};case N_:case P_:case O_:return{byteLength:2,components:1};case U_:case F_:return{byteLength:2,components:4};case L_:case k_:case D_:return{byteLength:4,components:1};case B_:case V_:return{byteLength:4,components:3}}throw new Error("Unknown texture type ".concat(e,"."))}(r);switch(n){case H_:return e*t;case X_:case Y_:return e*t/i.components*i.byteLength;case K_:case J_:return e*t*2/i.components*i.byteLength;case j_:return e*t*3/i.components*i.byteLength;case G_:case Z_:return e*t*4/i.components*i.byteLength;case $_:case eb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case tb:case nb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case ib:case sb:return Math.max(e,16)*Math.max(t,8)/4;case rb:case ab:return Math.max(e,8)*Math.max(t,8)/2;case ob:case lb:case ub:case hb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case cb:case db:case fb:case pb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case mb:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case gb:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case vb:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case yb:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case _b:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case bb:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Sb:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case xb:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case wb:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Eb:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case Tb:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case Mb:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case Cb:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case Ab:case Ib:case Rb:return Math.ceil(e/4)*Math.ceil(t/4)*16;case Pb:case Nb:return Math.ceil(e/4)*Math.ceil(t/4)*8;case kb:case Lb:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error("Unable to determine texture byte length for ".concat(n," format."))}class $P{static contain(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2):(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0),e}(e,t)}static cover(e,t){return function(e,t){const n=e.image&&e.image.width?e.image.width/e.image.height:1;return n>t?(e.repeat.x=t/n,e.repeat.y=1,e.offset.x=(1-e.repeat.x)/2,e.offset.y=0):(e.repeat.x=1,e.repeat.y=n/t,e.offset.x=0,e.offset.y=(1-e.repeat.y)/2),e}(e,t)}static fill(e){return function(e){return e.repeat.x=1,e.repeat.y=1,e.offset.x=0,e.offset.y=0,e}(e)}static getByteLength(e,t,n,r){return ZP(e,t,n,r)}}function eN(){let e=null,t=!1,n=null,r=null;function i(t,a){n(t,a),r=e.requestAnimationFrame(i)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function tN(e){const t=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t.get(e)},remove:function(n){n.isInterleavedBufferAttribute&&(n=n.data);const r=t.get(n);r&&(e.deleteBuffer(r.buffer),t.delete(n))},update:function(n,r){if(n.isInterleavedBufferAttribute&&(n=n.data),n.isGLBufferAttribute){const e=t.get(n);return void((!e||e.version<n.version)&&t.set(n,{buffer:n.buffer,type:n.type,bytesPerElement:n.elementSize,version:n.version}))}const i=t.get(n);if(void 0===i)t.set(n,function(t,n){const r=t.array,i=t.usage,a=r.byteLength,s=e.createBuffer();let o;if(e.bindBuffer(n,s),e.bufferData(n,r,i),t.onUploadCallback(),r instanceof Float32Array)o=e.FLOAT;else if("undefined"!==typeof Float16Array&&r instanceof Float16Array)o=e.HALF_FLOAT;else if(r instanceof Uint16Array)o=t.isFloat16BufferAttribute?e.HALF_FLOAT:e.UNSIGNED_SHORT;else if(r instanceof Int16Array)o=e.SHORT;else if(r instanceof Uint32Array)o=e.UNSIGNED_INT;else if(r instanceof Int32Array)o=e.INT;else if(r instanceof Int8Array)o=e.BYTE;else if(r instanceof Uint8Array)o=e.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);o=e.UNSIGNED_BYTE}return{buffer:s,type:o,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version,size:a}}(n,r));else if(i.version<n.version){if(i.size!==n.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(t,n,r){const i=n.array,a=n.updateRanges;if(e.bindBuffer(r,t),0===a.length)e.bufferSubData(r,0,i);else{a.sort((e,t)=>e.start-t.start);let t=0;for(let e=1;e<a.length;e++){const n=a[t],r=a[e];r.start<=n.start+n.count+1?n.count=Math.max(n.count,r.start+r.count-n.start):(++t,a[t]=r)}a.length=t+1;for(let n=0,s=a.length;n<s;n++){const t=a[n];e.bufferSubData(r,t.start*i.BYTES_PER_ELEMENT,i,t.start,t.count)}n.clearUpdateRanges()}n.onUploadCallback()}(i.buffer,n,r),i.version=n.version}}}}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ry}})),"undefined"!==typeof window&&(window.__THREE__?sx("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ry);const nN={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\t#if ! defined( GL_ANGLE_multi_draw )\n\t#define gl_DrawID _gl_DrawID\n\tuniform int _gl_DrawID;\n\t#endif\n\tuniform highp sampler2D batchingTexture;\n\tuniform highp usampler2D batchingIdTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n\tfloat getIndirectIndex( const in int i ) {\n\t\tint size = textureSize( batchingIdTexture, 0 ).x;\n\t\tint x = i % size;\n\t\tint y = i / size;\n\t\treturn float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );\n\t}\n#endif\n#ifdef USE_BATCHING_COLOR\n\tuniform sampler2D batchingColorTexture;\n\tvec3 getBatchingColor( const in float i ) {\n\t\tint size = textureSize( batchingColorTexture, 0 ).x;\n\t\tint j = int( i );\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\treturn texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif\n#ifdef USE_BATCHING_COLOR\n\tvec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );\n\tvColor.xyz *= batchingColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE\n\t\temissiveColor = sRGBTransferEOTF( emissiveColor );\n\t#endif\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferEOTF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform mat3 envMapRotation;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif ( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.metalness = metalnessFactor;\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = vec3( 0.04 );\n\tmaterial.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_DISPERSION\n\tmaterial.dispersion = dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"uniform sampler2D dfgLUT;\nstruct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tvec3 diffuseContribution;\n\tvec3 specularColor;\n\tvec3 specularColorBlended;\n\tfloat roughness;\n\tfloat metalness;\n\tfloat specularF90;\n\tfloat dispersion;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t\tvec3 iridescenceFresnelDielectric;\n\t\tvec3 iridescenceFresnelMetallic;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn v;\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColorBlended;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transpose( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat rInv = 1.0 / ( roughness + 0.1 );\n\tfloat a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;\n\tfloat b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;\n\tfloat DG = exp( a * dotNV + b );\n\treturn saturate( DG );\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nvec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;\n\tvec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;\n\tvec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;\n\tvec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;\n\tfloat Ess_V = dfgV.x + dfgV.y;\n\tfloat Ess_L = dfgL.x + dfgL.y;\n\tfloat Ems_V = 1.0 - Ess_V;\n\tfloat Ems_L = 1.0 - Ess_L;\n\tvec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;\n\tvec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );\n\tfloat compensationFactor = Ems_V * Ems_L;\n\tvec3 multiScatter = Fms * compensationFactor;\n\treturn singleScatter + multiScatter;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n \n \t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n \n \t\tfloat sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n \t\tfloat sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );\n \n \t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );\n \n \t\tirradiance *= sheenEnergyComp;\n \n \t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tdiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectDiffuse += diffuse;\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;\n \t#endif\n\tvec3 singleScatteringDielectric = vec3( 0.0 );\n\tvec3 multiScatteringDielectric = vec3( 0.0 );\n\tvec3 singleScatteringMetallic = vec3( 0.0 );\n\tvec3 multiScatteringMetallic = vec3( 0.0 );\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );\n\t#endif\n\tvec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );\n\tvec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );\n\tvec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;\n\tvec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tvec3 indirectSpecular = radiance * singleScattering;\n\tindirectSpecular += multiScattering * cosineWeightedIrradiance;\n\tvec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t\tfloat sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;\n\t\tindirectSpecular *= sheenEnergyComp;\n\t\tindirectDiffuse *= sheenEnergyComp;\n\t#endif\n\treflectedLight.indirectSpecular += indirectSpecular;\n\treflectedLight.indirectDiffuse += indirectDiffuse;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );\n\t\tmaterial.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tgl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGARITHMIC_DEPTH_BUFFER\n\tvFragDepth = 1.0 + gl_Position.w;\n\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphinstance_vertex:"#ifdef USE_INSTANCING_MORPH\n\tfloat morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\tfloat morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tmorphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;\n\t}\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_INSTANCING_MORPH\n\t\tuniform float morphTargetBaseInfluence;\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t#endif\n\tuniform sampler2DArray morphTargetsTexture;\n\tuniform ivec2 morphTargetsTextureSize;\n\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t}\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t}\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;\nconst float Inv255 = 1. / 255.;\nconst vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );\nconst vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );\nconst vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );\nconst vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );\nvec4 packDepthToRGBA( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec4( 0., 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec4( 1., 1., 1., 1. );\n\tfloat vuf;\n\tfloat af = modf( v * PackFactors.a, vuf );\n\tfloat bf = modf( vuf * ShiftRight8, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );\n}\nvec3 packDepthToRGB( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec3( 0., 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec3( 1., 1., 1. );\n\tfloat vuf;\n\tfloat bf = modf( v * PackFactors.b, vuf );\n\tfloat gf = modf( vuf * ShiftRight8, vuf );\n\treturn vec3( vuf * Inv255, gf * PackUpscale, bf );\n}\nvec2 packDepthToRG( const in float v ) {\n\tif( v <= 0.0 )\n\t\treturn vec2( 0., 0. );\n\tif( v >= 1.0 )\n\t\treturn vec2( 1., 1. );\n\tfloat vuf;\n\tfloat gf = modf( v * 256., vuf );\n\treturn vec2( vuf * Inv255, gf );\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors4 );\n}\nfloat unpackRGBToDepth( const in vec3 v ) {\n\treturn dot( v, UnpackFactors3 );\n}\nfloat unpackRGToDepth( const in vec2 v ) {\n\treturn v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;\n}\nvec4 pack2HalfToRGBA( const in vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( const in vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#else\n\t\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tuniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\t\t\tuniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\t#endif\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat interleavedGradientNoise( vec2 position ) {\n\t\t\treturn fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );\n\t\t}\n\t\tvec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {\n\t\t\tconst float goldenAngle = 2.399963229728653;\n\t\t\tfloat r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );\n\t\t\tfloat theta = float( sampleIndex ) * goldenAngle + phi;\n\t\t\treturn vec2( cos( theta ), sin( theta ) ) * r;\n\t\t}\n\t#endif\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\tfloat getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\t\tfloat radius = shadowRadius * texelSize.x;\n\t\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\t\tshadow = (\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +\n\t\t\t\t\ttexture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )\n\t\t\t\t) * 0.2;\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tvec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;\n\t\t\t\tfloat mean = distribution.x;\n\t\t\t\tfloat variance = distribution.y * distribution.y;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tfloat hard_shadow = step( mean, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tfloat hard_shadow = step( shadowCoord.z, mean );\n\t\t\t\t#endif\n\t\t\t\tif ( hard_shadow == 1.0 ) {\n\t\t\t\t\tshadow = 1.0;\n\t\t\t\t} else {\n\t\t\t\t\tvariance = max( variance, 0.0000001 );\n\t\t\t\t\tfloat d = shadowCoord.z - mean;\n\t\t\t\t\tfloat p_max = variance / ( variance + d * d );\n\t\t\t\t\tp_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );\n\t\t\t\t\tshadow = max( hard_shadow, p_max );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#else\n\t\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\t\tfloat shadow = 1.0;\n\t\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\t\tshadowCoord.z += shadowBias;\n\t\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\t\tif ( frustumTest ) {\n\t\t\t\tfloat depth = texture2D( shadowMap, shadowCoord.xy ).r;\n\t\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\t\tshadow = step( depth, shadowCoord.z );\n\t\t\t\t#else\n\t\t\t\t\tshadow = step( shadowCoord.z, depth );\n\t\t\t\t#endif\n\t\t\t}\n\t\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t\t}\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#if defined( SHADOWMAP_TYPE_PCF )\n\tfloat getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat texelSize = shadowRadius / shadowMapSize.x;\n\t\t\tvec3 absDir = abs( bd3D );\n\t\t\tvec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );\n\t\t\ttangent = normalize( cross( bd3D, tangent ) );\n\t\t\tvec3 bitangent = cross( bd3D, tangent );\n\t\t\tfloat phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;\n\t\t\tshadow = (\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +\n\t\t\t\ttexture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )\n\t\t\t) * 0.2;\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#elif defined( SHADOWMAP_TYPE_BASIC )\n\tfloat getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tfloat shadow = 1.0;\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tvec3 absVec = abs( lightToPosition );\n\t\tfloat viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );\n\t\tif ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {\n\t\t\tfloat dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );\n\t\t\tdp += shadowBias;\n\t\t\tfloat depth = textureCube( shadowMap, bd3D ).r;\n\t\t\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\t\t\tshadow = step( depth, dp );\n\t\t\t#else\n\t\t\t\tshadow = step( dp, depth );\n\t\t\t#endif\n\t\t}\n\t\treturn mix( 1.0, shadow, shadowIntensity );\n\t}\n\t#endif\n\t#endif\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowIntensity;\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 CineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 NeutralToneMapping( vec3 color ) {\n\tconst float StartCompression = 0.8 - 0.04;\n\tconst float Desaturation = 0.15;\n\tcolor *= toneMappingExposure;\n\tfloat x = min( color.r, min( color.g, color.b ) );\n\tfloat offset = x < 0.08 ? x - 6.25 * x * x : 0.04;\n\tcolor -= offset;\n\tfloat peak = max( color.r, max( color.g, color.b ) );\n\tif ( peak < StartCompression ) return color;\n\tfloat d = 1. - StartCompression;\n\tfloat newPeak = 1. - d * d / ( peak + d - StartCompression );\n\tcolor *= newPeak / peak;\n\tfloat g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );\n\treturn mix( color, vec3( newPeak ), g );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec4 transmittedLight;\n\t\tvec3 transmittance;\n\t\t#ifdef USE_DISPERSION\n\t\t\tfloat halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;\n\t\t\tvec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );\n\t\t\tfor ( int i = 0; i < 3; i ++ ) {\n\t\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );\n\t\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\t\trefractionCoords += 1.0;\n\t\t\t\trefractionCoords /= 2.0;\n\t\t\t\tvec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );\n\t\t\t\ttransmittedLight[ i ] = transmissionSample[ i ];\n\t\t\t\ttransmittedLight.a += transmissionSample.a;\n\t\t\t\ttransmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];\n\t\t\t}\n\t\t\ttransmittedLight.a /= 3.0;\n\t\t#else\n\t\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\t\trefractionCoords += 1.0;\n\t\t\trefractionCoords /= 2.0;\n\t\t\ttransmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\t\ttransmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\t#endif\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nuniform mat3 backgroundRotation;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_REVERSED_DEPTH_BUFFER\n\t\tfloat fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];\n\t#else\n\t\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;\n\t#endif\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#elif DEPTH_PACKING == 3202\n\t\tgl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );\n\t#elif DEPTH_PACKING == 3203\n\t\tgl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );\n\t#endif\n}",distance_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#include <morphinstance_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distance_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_DISPERSION\n\tuniform float dispersion;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n \n\t\toutgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;\n \n \t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphinstance_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix[ 3 ];\n\tvec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},rN={common:{diffuse:{value:new pE(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Mx},alphaMap:{value:null},alphaMapTransform:{value:new Mx},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Mx}},envmap:{envMap:{value:null},envMapRotation:{value:new Mx},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Mx}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Mx}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Mx},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Mx},normalScale:{value:new Sx(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Mx},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Mx}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Mx}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Mx}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pE(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pE(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Mx},alphaTest:{value:0},uvTransform:{value:new Mx}},sprite:{diffuse:{value:new pE(16777215)},opacity:{value:1},center:{value:new Sx(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Mx},alphaMap:{value:null},alphaMapTransform:{value:new Mx},alphaTest:{value:0}}},iN={basic:{uniforms:sT([rN.common,rN.specularmap,rN.envmap,rN.aomap,rN.lightmap,rN.fog]),vertexShader:nN.meshbasic_vert,fragmentShader:nN.meshbasic_frag},lambert:{uniforms:sT([rN.common,rN.specularmap,rN.envmap,rN.aomap,rN.lightmap,rN.emissivemap,rN.bumpmap,rN.normalmap,rN.displacementmap,rN.fog,rN.lights,{emissive:{value:new pE(0)}}]),vertexShader:nN.meshlambert_vert,fragmentShader:nN.meshlambert_frag},phong:{uniforms:sT([rN.common,rN.specularmap,rN.envmap,rN.aomap,rN.lightmap,rN.emissivemap,rN.bumpmap,rN.normalmap,rN.displacementmap,rN.fog,rN.lights,{emissive:{value:new pE(0)},specular:{value:new pE(1118481)},shininess:{value:30}}]),vertexShader:nN.meshphong_vert,fragmentShader:nN.meshphong_frag},standard:{uniforms:sT([rN.common,rN.envmap,rN.aomap,rN.lightmap,rN.emissivemap,rN.bumpmap,rN.normalmap,rN.displacementmap,rN.roughnessmap,rN.metalnessmap,rN.fog,rN.lights,{emissive:{value:new pE(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:nN.meshphysical_vert,fragmentShader:nN.meshphysical_frag},toon:{uniforms:sT([rN.common,rN.aomap,rN.lightmap,rN.emissivemap,rN.bumpmap,rN.normalmap,rN.displacementmap,rN.gradientmap,rN.fog,rN.lights,{emissive:{value:new pE(0)}}]),vertexShader:nN.meshtoon_vert,fragmentShader:nN.meshtoon_frag},matcap:{uniforms:sT([rN.common,rN.bumpmap,rN.normalmap,rN.displacementmap,rN.fog,{matcap:{value:null}}]),vertexShader:nN.meshmatcap_vert,fragmentShader:nN.meshmatcap_frag},points:{uniforms:sT([rN.points,rN.fog]),vertexShader:nN.points_vert,fragmentShader:nN.points_frag},dashed:{uniforms:sT([rN.common,rN.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:nN.linedashed_vert,fragmentShader:nN.linedashed_frag},depth:{uniforms:sT([rN.common,rN.displacementmap]),vertexShader:nN.depth_vert,fragmentShader:nN.depth_frag},normal:{uniforms:sT([rN.common,rN.bumpmap,rN.normalmap,rN.displacementmap,{opacity:{value:1}}]),vertexShader:nN.meshnormal_vert,fragmentShader:nN.meshnormal_frag},sprite:{uniforms:sT([rN.sprite,rN.fog]),vertexShader:nN.sprite_vert,fragmentShader:nN.sprite_frag},background:{uniforms:{uvTransform:{value:new Mx},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:nN.background_vert,fragmentShader:nN.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Mx}},vertexShader:nN.backgroundCube_vert,fragmentShader:nN.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:nN.cube_vert,fragmentShader:nN.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:nN.equirect_vert,fragmentShader:nN.equirect_frag},distance:{uniforms:sT([rN.common,rN.displacementmap,{referencePosition:{value:new wx},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:nN.distance_vert,fragmentShader:nN.distance_frag},shadow:{uniforms:sT([rN.lights,rN.fog,{color:{value:new pE(0)},opacity:{value:1}}]),vertexShader:nN.shadow_vert,fragmentShader:nN.shadow_frag}};iN.physical={uniforms:sT([iN.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Mx},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Mx},clearcoatNormalScale:{value:new Sx(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Mx},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Mx},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Mx},sheen:{value:0},sheenColor:{value:new pE(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Mx},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Mx},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Mx},transmissionSamplerSize:{value:new Sx},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Mx},attenuationDistance:{value:0},attenuationColor:{value:new pE(0)},specularColor:{value:new pE(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Mx},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Mx},anisotropyVector:{value:new Sx},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Mx}}]),vertexShader:nN.meshphysical_vert,fragmentShader:nN.meshphysical_frag};const aN={r:0,b:0,g:0},sN=new Nw,oN=new xw;function lN(e,t,n,r,i,a,s){const o=new pE(0);let l,c,u=!0===a?0:1,h=null,d=0,f=null;function p(e){let r=!0===e.isScene?e.background:null;if(r&&r.isTexture){r=(e.backgroundBlurriness>0?n:t).get(r)}return r}function m(t,n){t.getRGB(aN,oT(e)),r.buffers.color.setClear(aN.r,aN.g,aN.b,n,s)}return{getClearColor:function(){return o},setClearColor:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;o.set(e),u=t,m(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(e){u=e,m(o,u)},render:function(t){let n=!1;const i=p(t);null===i?m(o,u):i&&i.isColor&&(m(i,1),n=!0);const a=e.xr.getEnvironmentBlendMode();"additive"===a?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===a&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||n)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))},addToRenderList:function(t,n){const r=p(n);r&&(r.isCubeTexture||r.mapping===m_)?(void 0===c&&(c=new nT(new iT(1,1,1),new cT({name:"BackgroundCubeMaterial",uniforms:aT(iN.backgroundCube.uniforms),vertexShader:iN.backgroundCube.vertexShader,fragmentShader:iN.backgroundCube.fragmentShader,side:my,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(c)),sN.copy(n.backgroundRotation),sN.x*=-1,sN.y*=-1,sN.z*=-1,r.isCubeTexture&&!1===r.isRenderTargetTexture&&(sN.y*=-1,sN.z*=-1),c.material.uniforms.envMap.value=r,c.material.uniforms.flipEnvMap.value=r.isCubeTexture&&!1===r.isRenderTargetTexture?-1:1,c.material.uniforms.backgroundBlurriness.value=n.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(oN.makeRotationFromEuler(sN)),c.material.toneMapped=Px.getTransfer(r.colorSpace)!==aS,h===r&&d===r.version&&f===e.toneMapping||(c.material.needsUpdate=!0,h=r,d=r.version,f=e.toneMapping),c.layers.enableAll(),t.unshift(c,c.geometry,c.material,0,0,null)):r&&r.isTexture&&(void 0===l&&(l=new nT(new zA(2,2),new cT({name:"BackgroundMaterial",uniforms:aT(iN.background.uniforms),vertexShader:iN.background.vertexShader,fragmentShader:iN.background.fragmentShader,side:py,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=r,l.material.uniforms.backgroundIntensity.value=n.backgroundIntensity,l.material.toneMapped=Px.getTransfer(r.colorSpace)!==aS,!0===r.matrixAutoUpdate&&r.updateMatrix(),l.material.uniforms.uvTransform.value.copy(r.matrix),h===r&&d===r.version&&f===e.toneMapping||(l.material.needsUpdate=!0,h=r,d=r.version,f=e.toneMapping),l.layers.enableAll(),t.unshift(l,l.geometry,l.material,0,0,null))},dispose:function(){void 0!==c&&(c.geometry.dispose(),c.material.dispose(),c=void 0),void 0!==l&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}}}function cN(e,t){const n=e.getParameter(e.MAX_VERTEX_ATTRIBS),r={},i=c(null);let a=i,s=!1;function o(t){return e.bindVertexArray(t)}function l(t){return e.deleteVertexArray(t)}function c(e){const t=[],r=[],i=[];for(let a=0;a<n;a++)t[a]=0,r[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function u(){const e=a.newAttributes;for(let t=0,n=e.length;t<n;t++)e[t]=0}function h(e){d(e,0)}function d(t,n){const r=a.newAttributes,i=a.enabledAttributes,s=a.attributeDivisors;r[t]=1,0===i[t]&&(e.enableVertexAttribArray(t),i[t]=1),s[t]!==n&&(e.vertexAttribDivisor(t,n),s[t]=n)}function f(){const t=a.newAttributes,n=a.enabledAttributes;for(let r=0,i=n.length;r<i;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function p(t,n,r,i,a,s,o){!0===o?e.vertexAttribIPointer(t,n,r,a,s):e.vertexAttribPointer(t,n,r,i,a,s)}function m(){g(),s=!0,a!==i&&(a=i,o(a.object))}function g(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:function(n,i,l,m,g){let v=!1;const y=function(t,n,i){const a=!0===i.wireframe;let s=r[t.id];void 0===s&&(s={},r[t.id]=s);let o=s[n.id];void 0===o&&(o={},s[n.id]=o);let l=o[a];void 0===l&&(l=c(e.createVertexArray()),o[a]=l);return l}(m,l,i);a!==y&&(a=y,o(a.object)),v=function(e,t,n,r){const i=a.attributes,s=t.attributes;let o=0;const l=n.getAttributes();for(const a in l){if(l[a].location>=0){const t=i[a];let n=s[a];if(void 0===n&&("instanceMatrix"===a&&e.instanceMatrix&&(n=e.instanceMatrix),"instanceColor"===a&&e.instanceColor&&(n=e.instanceColor)),void 0===t)return!0;if(t.attribute!==n)return!0;if(n&&t.data!==n.data)return!0;o++}}return a.attributesNum!==o||a.index!==r}(n,m,l,g),v&&function(e,t,n,r){const i={},s=t.attributes;let o=0;const l=n.getAttributes();for(const a in l){if(l[a].location>=0){let t=s[a];void 0===t&&("instanceMatrix"===a&&e.instanceMatrix&&(t=e.instanceMatrix),"instanceColor"===a&&e.instanceColor&&(t=e.instanceColor));const n={};n.attribute=t,t&&t.data&&(n.data=t.data),i[a]=n,o++}}a.attributes=i,a.attributesNum=o,a.index=r}(n,m,l,g),null!==g&&t.update(g,e.ELEMENT_ARRAY_BUFFER),(v||s)&&(s=!1,function(n,r,i,a){u();const s=a.attributes,o=i.getAttributes(),l=r.defaultAttributeValues;for(const c in o){const r=o[c];if(r.location>=0){let i=s[c];if(void 0===i&&("instanceMatrix"===c&&n.instanceMatrix&&(i=n.instanceMatrix),"instanceColor"===c&&n.instanceColor&&(i=n.instanceColor)),void 0!==i){const s=i.normalized,o=i.itemSize,l=t.get(i);if(void 0===l)continue;const c=l.buffer,u=l.type,f=l.bytesPerElement,m=u===e.INT||u===e.UNSIGNED_INT||i.gpuType===k_;if(i.isInterleavedBufferAttribute){const t=i.data,l=t.stride,g=i.offset;if(t.isInstancedInterleavedBuffer){for(let e=0;e<r.locationSize;e++)d(r.location+e,t.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=t.meshPerAttribute*t.count)}else for(let e=0;e<r.locationSize;e++)h(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)p(r.location+e,o/r.locationSize,u,s,l*f,(g+o/r.locationSize*e)*f,m)}else{if(i.isInstancedBufferAttribute){for(let e=0;e<r.locationSize;e++)d(r.location+e,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<r.locationSize;e++)h(r.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<r.locationSize;e++)p(r.location+e,o/r.locationSize,u,s,o*f,o/r.locationSize*e*f,m)}}else if(void 0!==l){const t=l[c];if(void 0!==t)switch(t.length){case 2:e.vertexAttrib2fv(r.location,t);break;case 3:e.vertexAttrib3fv(r.location,t);break;case 4:e.vertexAttrib4fv(r.location,t);break;default:e.vertexAttrib1fv(r.location,t)}}}}f()}(n,i,l,m),null!==g&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(g).buffer))},reset:m,resetDefaultState:g,dispose:function(){m();for(const e in r){const t=r[e];for(const e in t){const n=t[e];for(const e in n)l(n[e].object),delete n[e];delete t[e]}delete r[e]}},releaseStatesOfGeometry:function(e){if(void 0===r[e.id])return;const t=r[e.id];for(const n in t){const e=t[n];for(const t in e)l(e[t].object),delete e[t];delete t[n]}delete r[e.id]},releaseStatesOfProgram:function(e){for(const t in r){const n=r[t];if(void 0===n[e.id])continue;const i=n[e.id];for(const e in i)l(i[e].object),delete i[e];delete n[e.id]}},initAttributes:u,enableAttribute:h,disableUnusedAttributes:f}}function uN(e,t,n){let r;function i(t,i,a){0!==a&&(e.drawArraysInstanced(r,t,i,a),n.update(i,r,a))}this.setMode=function(e){r=e},this.render=function(t,i){e.drawArrays(r,t,i),n.update(i,r,1)},this.renderInstances=i,this.renderMultiDraw=function(e,i,a){if(0===a)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,e,0,i,0,a);let s=0;for(let t=0;t<a;t++)s+=i[t];n.update(s,r,1)},this.renderMultiDrawInstances=function(e,a,s,o){if(0===s)return;const l=t.get("WEBGL_multi_draw");if(null===l)for(let t=0;t<e.length;t++)i(e[t],a[t],o[t]);else{l.multiDrawArraysInstancedWEBGL(r,e,0,a,0,o,0,s);let t=0;for(let e=0;e<s;e++)t+=a[e]*o[e];n.update(t,r,1)}}}function hN(e,t,n,r){let i;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let s=void 0!==n.precision?n.precision:"highp";const o=a(s);o!==s&&(sx("WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);return{isWebGL2:!0,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const n=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:a,textureFormatReadable:function(t){return t===G_||r.convert(t)===e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT)},textureTypeReadable:function(n){const i=n===O_&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(n!==I_&&r.convert(n)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&n!==D_&&!i)},precision:s,logarithmicDepthBuffer:!0===n.logarithmicDepthBuffer,reversedDepthBuffer:!0===n.reversedDepthBuffer&&t.has("EXT_clip_control"),maxTextures:e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),maxVertexTextures:e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:e.getParameter(e.MAX_TEXTURE_SIZE),maxCubemapSize:e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),maxAttributes:e.getParameter(e.MAX_VERTEX_ATTRIBS),maxVertexUniforms:e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),maxVaryings:e.getParameter(e.MAX_VARYING_VECTORS),maxFragmentUniforms:e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),maxSamples:e.getParameter(e.MAX_SAMPLES),samples:e.getParameter(e.SAMPLES)}}function dN(e){const t=this;let n=null,r=0,i=!1,a=!1;const s=new bM,o=new Mx,l={value:null,needsUpdate:!1};function c(e,n,r,i){const a=null!==e?e.length:0;let c=null;if(0!==a){if(c=l.value,!0!==i||null===c){const t=r+4*a,i=n.matrixWorldInverse;o.getNormalMatrix(i),(null===c||c.length<t)&&(c=new Float32Array(t));for(let n=0,l=r;n!==a;++n,l+=4)s.copy(e[n]).applyMatrix4(i,o),s.normal.toArray(c,l),c[l+3]=s.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){const n=0!==e.length||t||0!==r||i;return i=t,r=e.length,n},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(s,o,u){const h=s.clippingPlanes,d=s.clipIntersection,f=s.clipShadows,p=e.get(s);if(!i||null===h||0===h.length||a&&!f)a?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{const e=a?0:r,t=4*e;let i=p.clippingState||null;l.value=i,i=c(h,o,t,u);for(let r=0;r!==t;++r)i[r]=n[r];p.clippingState=i,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function fN(e){let t=new WeakMap;function n(e,t){return t===f_?e.mapping=h_:t===p_&&(e.mapping=d_),e}function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping;if(a===f_||a===p_){if(t.has(i)){return n(t.get(i).texture,i.mapping)}{const a=i.image;if(a&&a.height>0){const s=new yT(a.height);return s.fromEquirectangularTexture(e,i),t.set(i,s),i.addEventListener("dispose",r),n(s.texture,i.mapping)}return null}}}return i},dispose:function(){t=new WeakMap}}}const pN=[.125,.215,.35,.446,.526,.582],mN=20,gN=new QI,vN=new pE;let yN=null,_N=0,bN=0,SN=!1;const xN=new wx;class wN{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{size:a=256,position:s=xN}=i;yN=this._renderer.getRenderTarget(),_N=this._renderer.getActiveCubeFace(),bN=this._renderer.getActiveMipmapLevel(),SN=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,n,r,o,s),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}fromCubemap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=CN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=MN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose(),null!==this._backgroundBox&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._ggxMaterial&&this._ggxMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(yN,_N,bN),this._renderer.xr.enabled=SN,e.scissorTest=!1,TN(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===h_||e.mapping===d_?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),yN=this._renderer.getRenderTarget(),_N=this._renderer.getActiveCubeFace(),bN=this._renderer.getActiveMipmapLevel(),SN=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:E_,minFilter:E_,generateMipmaps:!1,type:O_,format:G_,colorSpace:rS,depthBuffer:!1},r=EN(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=EN(e,t,n);const{_lodMax:r}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=function(e){const t=[],n=[],r=[];let i=e;const a=e-4+1+pN.length;for(let s=0;s<a;s++){const a=Math.pow(2,i);t.push(a);let o=1/a;s>e-4?o=pN[s-e+4-1]:0===s&&(o=0),n.push(o);const l=1/(a-2),c=-l,u=1+l,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),y=new Float32Array(m*f*d),_=new Float32Array(g*f*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,n=e>2?0:-1,r=[t,n,0,t+2/3,n,0,t+2/3,n+1,0,t,n,0,t+2/3,n+1,0,t,n+1,0];v.set(r,p*f*e),y.set(h,m*f*e);const i=[e,e,e,e,e,e];_.set(i,g*f*e)}const b=new GE;b.setAttribute("position",new CE(v,p)),b.setAttribute("uv",new CE(y,m)),b.setAttribute("faceIndex",new CE(_,g)),r.push(new nT(b,null)),i>4&&i--}return{lodMeshes:r,sizeLods:t,sigmas:n}}(r)),this._blurMaterial=function(e,t,n){const r=new Float32Array(mN),i=new wx(0,1,0),a=new cT({name:"SphericalGaussianBlur",defines:{n:mN,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:vy,depthTest:!1,depthWrite:!1});return a}(r,e,t),this._ggxMaterial=function(e,t,n){const r=new cT({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:256,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:'\n\n\t\t\tprecision highp float;\n\t\t\tprecision highp int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform float roughness;\n\t\t\tuniform float mipInt;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\t#define PI 3.14159265359\n\n\t\t\t// Van der Corput radical inverse\n\t\t\tfloat radicalInverse_VdC(uint bits) {\n\t\t\t\tbits = (bits << 16u) | (bits >> 16u);\n\t\t\t\tbits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);\n\t\t\t\tbits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);\n\t\t\t\tbits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);\n\t\t\t\tbits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);\n\t\t\t\treturn float(bits) * 2.3283064365386963e-10; // / 0x100000000\n\t\t\t}\n\n\t\t\t// Hammersley sequence\n\t\t\tvec2 hammersley(uint i, uint N) {\n\t\t\t\treturn vec2(float(i) / float(N), radicalInverse_VdC(i));\n\t\t\t}\n\n\t\t\t// GGX VNDF importance sampling (Eric Heitz 2018)\n\t\t\t// "Sampling the GGX Distribution of Visible Normals"\n\t\t\t// https://jcgt.org/published/0007/04/01/\n\t\t\tvec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {\n\t\t\t\tfloat alpha = roughness * roughness;\n\n\t\t\t\t// Section 3.2: Transform view direction to hemisphere configuration\n\t\t\t\tvec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));\n\n\t\t\t\t// Section 4.1: Orthonormal basis\n\t\t\t\tfloat lensq = Vh.x * Vh.x + Vh.y * Vh.y;\n\t\t\t\tvec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 T2 = cross(Vh, T1);\n\n\t\t\t\t// Section 4.2: Parameterization of projected area\n\t\t\t\tfloat r = sqrt(Xi.x);\n\t\t\t\tfloat phi = 2.0 * PI * Xi.y;\n\t\t\t\tfloat t1 = r * cos(phi);\n\t\t\t\tfloat t2 = r * sin(phi);\n\t\t\t\tfloat s = 0.5 * (1.0 + Vh.z);\n\t\t\t\tt2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;\n\n\t\t\t\t// Section 4.3: Reprojection onto hemisphere\n\t\t\t\tvec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;\n\n\t\t\t\t// Section 3.4: Transform back to ellipsoid configuration\n\t\t\t\treturn normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));\n\t\t\t}\n\n\t\t\tvoid main() {\n\t\t\t\tvec3 N = normalize(vOutputDirection);\n\t\t\t\tvec3 V = N; // Assume view direction equals normal for pre-filtering\n\n\t\t\t\tvec3 prefilteredColor = vec3(0.0);\n\t\t\t\tfloat totalWeight = 0.0;\n\n\t\t\t\t// For very low roughness, just sample the environment directly\n\t\t\t\tif (roughness < 0.001) {\n\t\t\t\t\tgl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Tangent space basis for VNDF sampling\n\t\t\t\tvec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\n\t\t\t\tvec3 tangent = normalize(cross(up, N));\n\t\t\t\tvec3 bitangent = cross(N, tangent);\n\n\t\t\t\tfor(uint i = 0u; i < uint(GGX_SAMPLES); i++) {\n\t\t\t\t\tvec2 Xi = hammersley(i, uint(GGX_SAMPLES));\n\n\t\t\t\t\t// For PMREM, V = N, so in tangent space V is always (0, 0, 1)\n\t\t\t\t\tvec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);\n\n\t\t\t\t\t// Transform H back to world space\n\t\t\t\t\tvec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);\n\t\t\t\t\tvec3 L = normalize(2.0 * dot(V, H) * H - V);\n\n\t\t\t\t\tfloat NdotL = max(dot(N, L), 0.0);\n\n\t\t\t\t\tif(NdotL > 0.0) {\n\t\t\t\t\t\t// Sample environment at fixed mip level\n\t\t\t\t\t\t// VNDF importance sampling handles the distribution filtering\n\t\t\t\t\t\tvec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);\n\n\t\t\t\t\t\t// Weight by NdotL for the split-sum approximation\n\t\t\t\t\t\t// VNDF PDF naturally accounts for the visible microfacet distribution\n\t\t\t\t\t\tprefilteredColor += sampleColor * NdotL;\n\t\t\t\t\t\ttotalWeight += NdotL;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (totalWeight > 0.0) {\n\t\t\t\t\tprefilteredColor = prefilteredColor / totalWeight;\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = vec4(prefilteredColor, 1.0);\n\t\t\t}\n\t\t',blending:vy,depthTest:!1,depthWrite:!1});return r}(r,e,t)}return r}_compileMaterial(e){const t=new nT(new GE,e);this._renderer.compile(t,gN)}_sceneToCubeUV(e,t,n,r,i){const a=new pT(90,1,t,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],l=this._renderer,c=l.autoClear,u=l.toneMapping;l.getClearColor(vN),l.toneMapping=e_,l.autoClear=!1;l.state.buffers.depth.getReversed()&&(l.setRenderTarget(r),l.clearDepth(),l.setRenderTarget(null)),null===this._backgroundBox&&(this._backgroundBox=new nT(new iT,new yE({name:"PMREM.Background",side:my,depthWrite:!1,depthTest:!1})));const h=this._backgroundBox,d=h.material;let f=!1;const p=e.background;p?p.isColor&&(d.color.copy(p),e.background=null,f=!0):(d.color.copy(vN),f=!0);for(let m=0;m<6;m++){const t=m%3;0===t?(a.up.set(0,s[m],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x+o[m],i.y,i.z)):1===t?(a.up.set(0,0,s[m]),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y+o[m],i.z)):(a.up.set(0,s[m],0),a.position.set(i.x,i.y,i.z),a.lookAt(i.x,i.y,i.z+o[m]));const n=this._cubeSize;TN(r,t*n,m>2?n:0,n,n),l.setRenderTarget(r),f&&l.render(h,a),l.render(e,a)}l.toneMapping=u,l.autoClear=c,e.background=p}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===h_||e.mapping===d_;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=CN()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=MN());const i=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=i;i.uniforms.envMap.value=e;const s=this._cubeSize;TN(t,0,0,3*s,2*s),n.setRenderTarget(t),n.render(a,gN)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let i=1;i<r;i++)this._applyGGXFilter(e,i-1,i);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,i=this._pingPongRenderTarget,a=this._ggxMaterial,s=this._lodMeshes[n];s.material=a;const o=a.uniforms,l=n/(this._lodMeshes.length-1),c=t/(this._lodMeshes.length-1),u=Math.sqrt(l*l-c*c)*(0+1.25*l),{_lodMax:h}=this,d=this._sizeLods[n],f=3*d*(n>h-4?n-h+4:0),p=4*(this._cubeSize-d);o.envMap.value=e.texture,o.roughness.value=u,o.mipInt.value=h-t,TN(i,f,p,3*d,2*d),r.setRenderTarget(i),r.render(s,gN),o.envMap.value=i.texture,o.roughness.value=0,o.mipInt.value=h-n,TN(e,f,p,3*d,2*d),r.setRenderTarget(e),r.render(s,gN)}_blur(e,t,n,r,i){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",i),this._halfBlur(a,e,n,n,r,"longitudinal",i)}_halfBlur(e,t,n,r,i,a,s){const o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&ox("blur direction must be either latitudinal or longitudinal!");const c=this._lodMeshes[r];c.material=l;const u=l.uniforms,h=this._sizeLods[n]-1,d=isFinite(i)?Math.PI/(2*h):2*Math.PI/39,f=i/d,p=isFinite(i)?1+Math.floor(3*f):mN;p>mN&&sx("sigmaRadians, ".concat(i,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(mN));const m=[];let g=0;for(let _=0;_<mN;++_){const e=_/f,t=Math.exp(-e*e/2);m.push(t),0===_?g+=t:_<p&&(g+=2*t)}for(let _=0;_<m.length;_++)m[_]=m[_]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===a,s&&(u.poleAxis.value=s);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-n;const y=this._sizeLods[r];TN(t,3*y*(r>v-4?r-v+4:0),4*(this._cubeSize-y),3*y,2*y),o.setRenderTarget(t),o.render(c,gN)}}function EN(e,t,n){const r=new Gx(e,t,n);return r.texture.mapping=m_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function TN(e,t,n,r,i){e.viewport.set(t,n,r,i),e.scissor.set(t,n,r,i)}function MN(){return new cT({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:vy,depthTest:!1,depthWrite:!1})}function CN(){return new cT({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:vy,depthTest:!1,depthWrite:!1})}function AN(e){let t=new WeakMap,n=null;function r(e){const n=e.target;n.removeEventListener("dispose",r);const i=t.get(n);void 0!==i&&(t.delete(n),i.dispose())}return{get:function(i){if(i&&i.isTexture){const a=i.mapping,s=a===f_||a===p_,o=a===h_||a===d_;if(s||o){let a=t.get(i);const l=void 0!==a?a.texture.pmremVersion:0;if(i.isRenderTargetTexture&&i.pmremVersion!==l)return null===n&&(n=new wN(e)),a=s?n.fromEquirectangular(i,a):n.fromCubemap(i,a),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),a.texture;if(void 0!==a)return a.texture;{const l=i.image;return s&&l&&l.height>0||o&&l&&function(e){let t=0;const n=6;for(let r=0;r<n;r++)void 0!==e[r]&&t++;return t===n}(l)?(null===n&&(n=new wN(e)),a=s?n.fromEquirectangular(i):n.fromCubemap(i),a.texture.pmremVersion=i.pmremVersion,t.set(i,a),i.addEventListener("dispose",r),a.texture):null}}}return i},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function IN(e){const t={};function n(n){if(void 0!==t[n])return t[n];const r=e.getExtension(n);return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(e){const t=n(e);return null===t&&lx("WebGLRenderer: "+e+" extension not supported."),t}}}function RN(e,t,n,r){const i={},a=new WeakMap;function s(e){const o=e.target;null!==o.index&&t.remove(o.index);for(const n in o.attributes)t.remove(o.attributes[n]);o.removeEventListener("dispose",s),delete i[o.id];const l=a.get(o);l&&(t.remove(l),a.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(e){const n=[],r=e.index,i=e.attributes.position;let s=0;if(null!==r){const e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){const r=e[t+0],i=e[t+1],a=e[t+2];n.push(r,i,i,a,a,r)}}else{if(void 0===i)return;{const e=i.array;s=i.version;for(let t=0,r=e.length/3-1;t<r;t+=3){const e=t+0,r=t+1,i=t+2;n.push(e,r,r,i,i,e)}}}const o=new(KS(n)?LE:NE)(n,1);o.version=s;const l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===i[t.id]||(t.addEventListener("dispose",s),i[t.id]=!0,n.memory.geometries++),t},update:function(n){const r=n.attributes;for(const i in r)t.update(r[i],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){const t=a.get(e);if(t){const n=e.index;null!==n&&t.version<n.version&&o(e)}else o(e);return a.get(e)}}}function PN(e,t,n){let r,i,a;function s(t,s,o){0!==o&&(e.drawElementsInstanced(r,s,i,t*a,o),n.update(s,r,o))}this.setMode=function(e){r=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,s){e.drawElements(r,s,i,t*a),n.update(s,r,1)},this.renderInstances=s,this.renderMultiDraw=function(e,a,s){if(0===s)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,a,0,i,e,0,s);let o=0;for(let t=0;t<s;t++)o+=a[t];n.update(o,r,1)},this.renderMultiDrawInstances=function(e,o,l,c){if(0===l)return;const u=t.get("WEBGL_multi_draw");if(null===u)for(let t=0;t<e.length;t++)s(e[t]/a,o[t],c[t]);else{u.multiDrawElementsInstancedWEBGL(r,o,0,i,e,0,c,0,l);let t=0;for(let e=0;e<l;e++)t+=o[e]*c[e];n.update(t,r,1)}}}function NN(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:ox("WebGLInfo: Unknown draw mode:",r)}}}}function kN(e,t,n){const r=new WeakMap,i=new Hx;return{update:function(a,s,o){const l=a.morphTargetInfluences,c=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,u=void 0!==c?c.length:0;let h=r.get(s);if(void 0===h||h.count!==u){void 0!==h&&h.texture.dispose();const d=void 0!==s.morphAttributes.position,f=void 0!==s.morphAttributes.normal,p=void 0!==s.morphAttributes.color,m=s.morphAttributes.position||[],g=s.morphAttributes.normal||[],v=s.morphAttributes.color||[];let y=0;!0===d&&(y=1),!0===f&&(y=2),!0===p&&(y=3);let _=s.attributes.position.count*y,b=1;_>t.maxTextureSize&&(b=Math.ceil(_/t.maxTextureSize),_=t.maxTextureSize);const S=new Float32Array(_*b*4*u),x=new Wx(S,_,b,u);x.type=D_,x.needsUpdate=!0;const w=4*y;for(let T=0;T<u;T++){const M=m[T],C=g[T],A=v[T],I=_*b*4*T;for(let R=0;R<M.count;R++){const P=R*w;!0===d&&(i.fromBufferAttribute(M,R),S[I+P+0]=i.x,S[I+P+1]=i.y,S[I+P+2]=i.z,S[I+P+3]=0),!0===f&&(i.fromBufferAttribute(C,R),S[I+P+4]=i.x,S[I+P+5]=i.y,S[I+P+6]=i.z,S[I+P+7]=0),!0===p&&(i.fromBufferAttribute(A,R),S[I+P+8]=i.x,S[I+P+9]=i.y,S[I+P+10]=i.z,S[I+P+11]=4===A.itemSize?i.w:1)}}function E(){x.dispose(),r.delete(s),s.removeEventListener("dispose",E)}h={count:u,texture:x,size:new Sx(_,b)},r.set(s,h),s.addEventListener("dispose",E)}if(!0===a.isInstancedMesh&&null!==a.morphTexture)o.getUniforms().setValue(e,"morphTexture",a.morphTexture,n);else{let N=0;for(let L=0;L<l.length;L++)N+=l[L];const k=s.morphTargetsRelative?1:1-N;o.getUniforms().setValue(e,"morphTargetBaseInfluence",k),o.getUniforms().setValue(e,"morphTargetInfluences",l)}o.getUniforms().setValue(e,"morphTargetsTexture",h.texture,n),o.getUniforms().setValue(e,"morphTargetsTextureSize",h.size)}}}function LN(e,t,n,r){let i=new WeakMap;function a(e){const t=e.target;t.removeEventListener("dispose",a),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(s){const o=r.render.frame,l=s.geometry,c=t.get(s,l);if(i.get(c)!==o&&(t.update(c),i.set(c,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",a)&&s.addEventListener("dispose",a),i.get(s)!==o&&(n.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&n.update(s.instanceColor,e.ARRAY_BUFFER),i.set(s,o))),s.isSkinnedMesh){const e=s.skeleton;i.get(e)!==o&&(e.update(),i.set(e,o))}return c},dispose:function(){i=new WeakMap}}}const DN={[t_]:"LINEAR_TONE_MAPPING",[n_]:"REINHARD_TONE_MAPPING",[r_]:"CINEON_TONE_MAPPING",[i_]:"ACES_FILMIC_TONE_MAPPING",[s_]:"AGX_TONE_MAPPING",[o_]:"NEUTRAL_TONE_MAPPING",[a_]:"CUSTOM_TONE_MAPPING"};function ON(e,t,n,r,i){const a=new Gx(t,n,{type:e,depthBuffer:r,stencilBuffer:i}),s=new Gx(t,n,{type:O_,depthBuffer:!1,stencilBuffer:!1}),o=new GE;o.setAttribute("position",new OE([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new OE([0,2,0,0,2,0],2));const l=new QA({uniforms:{tDiffuse:{value:null}},vertexShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform mat4 modelViewMatrix;\n\t\t\tuniform mat4 projectionMatrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\tvoid main() {\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t}",fragmentShader:"\n\t\t\tprecision highp float;\n\n\t\t\tuniform sampler2D tDiffuse;\n\n\t\t\tvarying vec2 vUv;\n\n\t\t\t#include <tonemapping_pars_fragment>\n\t\t\t#include <colorspace_pars_fragment>\n\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\t\t\t\t#ifdef LINEAR_TONE_MAPPING\n\t\t\t\t\tgl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( REINHARD_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CINEON_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( ACES_FILMIC_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( AGX_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( NEUTRAL_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );\n\t\t\t\t#elif defined( CUSTOM_TONE_MAPPING )\n\t\t\t\t\tgl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );\n\t\t\t\t#endif\n\n\t\t\t\t#ifdef SRGB_TRANSFER\n\t\t\t\t\tgl_FragColor = sRGBTransferOETF( gl_FragColor );\n\t\t\t\t#endif\n\t\t\t}",depthTest:!1,depthWrite:!1}),c=new nT(o,l),u=new QI(-1,1,1,-1,0,1);let h,d=null,f=null,p=!1,m=null,g=[],v=!1;this.setSize=function(e,t){a.setSize(e,t),s.setSize(e,t);for(let n=0;n<g.length;n++){const r=g[n];r.setSize&&r.setSize(e,t)}},this.setEffects=function(e){g=e,v=g.length>0&&!0===g[0].isRenderPass;const t=a.width,n=a.height;for(let r=0;r<g.length;r++){const e=g[r];e.setSize&&e.setSize(t,n)}},this.begin=function(e,t){if(p)return!1;if(e.toneMapping===e_&&0===g.length)return!1;if(m=t,null!==t){const e=t.width,n=t.height;a.width===e&&a.height===n||this.setSize(e,n)}return!1===v&&e.setRenderTarget(a),h=e.toneMapping,e.toneMapping=e_,!0},this.hasRenderPass=function(){return v},this.end=function(e,t){e.toneMapping=h,p=!0;let n=a,r=s;for(let i=0;i<g.length;i++){const a=g[i];if(!1!==a.enabled&&(a.render(e,r,n,t),!1!==a.needsSwap)){const e=n;n=r,r=e}}if(d!==e.outputColorSpace||f!==e.toneMapping){d=e.outputColorSpace,f=e.toneMapping,l.defines={},Px.getTransfer(d)===aS&&(l.defines.SRGB_TRANSFER="");const t=DN[f];t&&(l.defines[t]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=n.texture,e.setRenderTarget(m),e.render(c,u),m=null,p=!1},this.isCompositing=function(){return p},this.dispose=function(){a.dispose(),s.dispose(),o.dispose(),l.dispose()}}const UN=new Vx,FN=new SC(1,1),zN=new Wx,BN=new Xx,VN=new vT,HN=[],jN=[],GN=new Float32Array(16),WN=new Float32Array(9),qN=new Float32Array(4);function XN(e,t,n){const r=e[0];if(r<=0||r>0)return e;const i=t*n;let a=HN[i];if(void 0===a&&(a=new Float32Array(i),HN[i]=a),0!==t){r.toArray(a,0);for(let r=1,i=0;r!==t;++r)i+=n,e[r].toArray(a,i)}return a}function YN(e,t){if(e.length!==t.length)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function KN(e,t){for(let n=0,r=t.length;n<r;n++)e[n]=t[n]}function JN(e,t){let n=jN[t];void 0===n&&(n=new Int32Array(t),jN[t]=n);for(let r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function QN(e,t){const n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function ZN(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(YN(n,t))return;e.uniform2fv(this.addr,t),KN(n,t)}}function $N(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(YN(n,t))return;e.uniform3fv(this.addr,t),KN(n,t)}}function ek(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(YN(n,t))return;e.uniform4fv(this.addr,t),KN(n,t)}}function tk(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(YN(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),KN(n,t)}else{if(YN(n,r))return;qN.set(r),e.uniformMatrix2fv(this.addr,!1,qN),KN(n,r)}}function nk(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(YN(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),KN(n,t)}else{if(YN(n,r))return;WN.set(r),e.uniformMatrix3fv(this.addr,!1,WN),KN(n,r)}}function rk(e,t){const n=this.cache,r=t.elements;if(void 0===r){if(YN(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),KN(n,t)}else{if(YN(n,r))return;GN.set(r),e.uniformMatrix4fv(this.addr,!1,GN),KN(n,r)}}function ik(e,t){const n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ak(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(YN(n,t))return;e.uniform2iv(this.addr,t),KN(n,t)}}function sk(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(YN(n,t))return;e.uniform3iv(this.addr,t),KN(n,t)}}function ok(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(YN(n,t))return;e.uniform4iv(this.addr,t),KN(n,t)}}function lk(e,t){const n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function ck(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(YN(n,t))return;e.uniform2uiv(this.addr,t),KN(n,t)}}function uk(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(YN(n,t))return;e.uniform3uiv(this.addr,t),KN(n,t)}}function hk(e,t){const n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(YN(n,t))return;e.uniform4uiv(this.addr,t),KN(n,t)}}function dk(e,t,n){const r=this.cache,i=n.allocateTextureUnit();let a;r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),this.type===e.SAMPLER_2D_SHADOW?(FN.compareFunction=n.isReversedDepthBuffer()?PS:AS,a=FN):a=UN,n.setTexture2D(t||a,i)}function fk(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||BN,i)}function pk(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(t||VN,i)}function mk(e,t,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||zN,i)}function gk(e,t){e.uniform1fv(this.addr,t)}function vk(e,t){const n=XN(t,this.size,2);e.uniform2fv(this.addr,n)}function yk(e,t){const n=XN(t,this.size,3);e.uniform3fv(this.addr,n)}function _k(e,t){const n=XN(t,this.size,4);e.uniform4fv(this.addr,n)}function bk(e,t){const n=XN(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Sk(e,t){const n=XN(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function xk(e,t){const n=XN(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function wk(e,t){e.uniform1iv(this.addr,t)}function Ek(e,t){e.uniform2iv(this.addr,t)}function Tk(e,t){e.uniform3iv(this.addr,t)}function Mk(e,t){e.uniform4iv(this.addr,t)}function Ck(e,t){e.uniform1uiv(this.addr,t)}function Ak(e,t){e.uniform2uiv(this.addr,t)}function Ik(e,t){e.uniform3uiv(this.addr,t)}function Rk(e,t){e.uniform4uiv(this.addr,t)}function Pk(e,t,n){const r=this.cache,i=t.length,a=JN(n,i);let s;YN(r,a)||(e.uniform1iv(this.addr,a),KN(r,a)),s=this.type===e.SAMPLER_2D_SHADOW?FN:UN;for(let o=0;o!==i;++o)n.setTexture2D(t[o]||s,a[o])}function Nk(e,t,n){const r=this.cache,i=t.length,a=JN(n,i);YN(r,a)||(e.uniform1iv(this.addr,a),KN(r,a));for(let s=0;s!==i;++s)n.setTexture3D(t[s]||BN,a[s])}function kk(e,t,n){const r=this.cache,i=t.length,a=JN(n,i);YN(r,a)||(e.uniform1iv(this.addr,a),KN(r,a));for(let s=0;s!==i;++s)n.setTextureCube(t[s]||VN,a[s])}function Lk(e,t,n){const r=this.cache,i=t.length,a=JN(n,i);YN(r,a)||(e.uniform1iv(this.addr,a),KN(r,a));for(let s=0;s!==i;++s)n.setTexture2DArray(t[s]||zN,a[s])}class Dk{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=function(e){switch(e){case 5126:return QN;case 35664:return ZN;case 35665:return $N;case 35666:return ek;case 35674:return tk;case 35675:return nk;case 35676:return rk;case 5124:case 35670:return ik;case 35667:case 35671:return ak;case 35668:case 35672:return sk;case 35669:case 35673:return ok;case 5125:return lk;case 36294:return ck;case 36295:return uk;case 36296:return hk;case 35678:case 36198:case 36298:case 36306:case 35682:return dk;case 35679:case 36299:case 36307:return fk;case 35680:case 36300:case 36308:case 36293:return pk;case 36289:case 36303:case 36311:case 36292:return mk}}(t.type)}}class Ok{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return gk;case 35664:return vk;case 35665:return yk;case 35666:return _k;case 35674:return bk;case 35675:return Sk;case 35676:return xk;case 5124:case 35670:return wk;case 35667:case 35671:return Ek;case 35668:case 35672:return Tk;case 35669:case 35673:return Mk;case 5125:return Ck;case 36294:return Ak;case 36295:return Ik;case 36296:return Rk;case 35678:case 36198:case 36298:case 36306:case 35682:return Pk;case 35679:case 36299:case 36307:return Nk;case 35680:case 36300:case 36308:case 36293:return kk;case 36289:case 36303:case 36311:case 36292:return Lk}}(t.type)}}class Uk{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let i=0,a=r.length;i!==a;++i){const a=r[i];a.setValue(e,t[a.id],n)}}}const Fk=/(\w+)(\])?(\[|\.)?/g;function zk(e,t){e.seq.push(t),e.map[t.id]=t}function Bk(e,t,n){const r=e.name,i=r.length;for(Fk.lastIndex=0;;){const a=Fk.exec(r),s=Fk.lastIndex;let o=a[1];const l="]"===a[2],c=a[3];if(l&&(o|=0),void 0===c||"["===c&&s+2===i){zk(n,void 0===c?new Dk(o,e,t):new Ok(o,e,t));break}{let e=n.map[o];void 0===e&&(e=new Uk(o),zk(n,e)),n=e}}}class Vk{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const n=e.getActiveUniform(t,a);Bk(n,e.getUniformLocation(t,n.name),this)}const r=[],i=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(a):i.push(a);r.length>0&&(this.seq=r.concat(i))}setValue(e,t,n,r){const i=this.map[t];void 0!==i&&i.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let i=0,a=t.length;i!==a;++i){const a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,i=e.length;r!==i;++r){const i=e[r];i.id in t&&n.push(i)}return n}}function Hk(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}let jk=0;const Gk=new Mx;function Wk(e,t,n){const r=e.getShaderParameter(t,e.COMPILE_STATUS),i=(e.getShaderInfoLog(t)||"").trim();if(r&&""===i)return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const r=parseInt(a[1]);return n.toUpperCase()+"\n\n"+i+"\n\n"+function(e,t){const n=e.split("\n"),r=[],i=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let s=i;s<a;s++){const e=s+1;r.push("".concat(e===t?">":" "," ").concat(e,": ").concat(n[s]))}return r.join("\n")}(e.getShaderSource(t),r)}return i}function qk(e,t){const n=function(e){Px._getMatrix(Gk,Px.workingColorSpace,e);const t="mat3( ".concat(Gk.elements.map(e=>e.toFixed(4))," )");switch(Px.getTransfer(e)){case iS:return[t,"LinearTransferOETF"];case aS:return[t,"sRGBTransferOETF"];default:return sx("WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}(t);return["vec4 ".concat(e,"( vec4 value ) {"),"\treturn ".concat(n[1],"( vec4( value.rgb * ").concat(n[0],", value.a ) );"),"}"].join("\n")}const Xk={[t_]:"Linear",[n_]:"Reinhard",[r_]:"Cineon",[i_]:"ACESFilmic",[s_]:"AgX",[o_]:"Neutral",[a_]:"Custom"};function Yk(e,t){const n=Xk[t];return void 0===n?(sx("WebGLProgram: Unsupported toneMapping:",t),"vec3 "+e+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Kk=new wx;function Jk(){Px.getLuminanceCoefficients(Kk);const e=Kk.x.toFixed(4),t=Kk.y.toFixed(4),n=Kk.z.toFixed(4);return["float luminance( const in vec3 rgb ) {","\tconst vec3 weights = vec3( ".concat(e,", ").concat(t,", ").concat(n," );"),"\treturn dot( weights, rgb );","}"].join("\n")}function Qk(e){return""!==e}function Zk(e,t){const n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function $k(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const eL=/^[ \t]*#include +<([\w\d./]+)>/gm;function tL(e){return e.replace(eL,rL)}const nL=new Map;function rL(e,t){let n=nN[t];if(void 0===n){const e=nL.get(t);if(void 0===e)throw new Error("Can not resolve #include <"+t+">");n=nN[e],sx('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e)}return tL(n)}const iL=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function aL(e){return e.replace(iL,sL)}function sL(e,t,n,r){let i="";for(let a=parseInt(t);a<parseInt(n);a++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function oL(e){let t="precision ".concat(e.precision," float;\n\tprecision ").concat(e.precision," int;\n\tprecision ").concat(e.precision," sampler2D;\n\tprecision ").concat(e.precision," samplerCube;\n\tprecision ").concat(e.precision," sampler3D;\n\tprecision ").concat(e.precision," sampler2DArray;\n\tprecision ").concat(e.precision," sampler2DShadow;\n\tprecision ").concat(e.precision," samplerCubeShadow;\n\tprecision ").concat(e.precision," sampler2DArrayShadow;\n\tprecision ").concat(e.precision," isampler2D;\n\tprecision ").concat(e.precision," isampler3D;\n\tprecision ").concat(e.precision," isamplerCube;\n\tprecision ").concat(e.precision," isampler2DArray;\n\tprecision ").concat(e.precision," usampler2D;\n\tprecision ").concat(e.precision," usampler3D;\n\tprecision ").concat(e.precision," usamplerCube;\n\tprecision ").concat(e.precision," usampler2DArray;\n\t");return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}const lL={[hy]:"SHADOWMAP_TYPE_PCF",[fy]:"SHADOWMAP_TYPE_VSM"};const cL={[h_]:"ENVMAP_TYPE_CUBE",[d_]:"ENVMAP_TYPE_CUBE",[m_]:"ENVMAP_TYPE_CUBE_UV"};const uL={[d_]:"ENVMAP_MODE_REFRACTION"};const hL={[Qy]:"ENVMAP_BLENDING_MULTIPLY",[Zy]:"ENVMAP_BLENDING_MIX",[$y]:"ENVMAP_BLENDING_ADD"};function dL(e,t,n,r){const i=e.getContext(),a=n.defines;let s=n.vertexShader,o=n.fragmentShader;const l=function(e){return lL[e.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}(n),c=function(e){return!1===e.envMap?"ENVMAP_TYPE_CUBE":cL[e.envMapMode]||"ENVMAP_TYPE_CUBE"}(n),u=function(e){return!1===e.envMap?"ENVMAP_MODE_REFLECTION":uL[e.envMapMode]||"ENVMAP_MODE_REFLECTION"}(n),h=function(e){return!1===e.envMap?"ENVMAP_BLENDING_NONE":hL[e.combine]||"ENVMAP_BLENDING_NONE"}(n),d=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),f=function(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Qk).join("\n")}(n),p=function(e){const t=[];for(const n in e){const r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),m=i.createProgram();let g,v,y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Qk).join("\n"),g.length>0&&(g+="\n"),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(Qk).join("\n"),v.length>0&&(v+="\n")):(g=[oL(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","\tuniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Qk).join("\n"),v=[oL(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",n.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==e_?"#define TONE_MAPPING":"",n.toneMapping!==e_?nN.tonemapping_pars_fragment:"",n.toneMapping!==e_?Yk("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",nN.colorspace_pars_fragment,qk("linearToOutputTexel",n.outputColorSpace),Jk(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Qk).join("\n")),s=tL(s),s=Zk(s,n),s=$k(s,n),o=tL(o),o=Zk(o,n),o=$k(o,n),s=aL(s),o=aL(o),!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",g=[f,"#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,v=["#define varying in",n.glslVersion===jS?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===jS?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+v);const _=y+g+s,b=y+v+o,S=Hk(i,i.VERTEX_SHADER,_),x=Hk(i,i.FRAGMENT_SHADER,b);function w(t){if(e.debug.checkShaderErrors){const n=i.getProgramInfoLog(m)||"",r=i.getShaderInfoLog(S)||"",a=i.getShaderInfoLog(x)||"",s=n.trim(),o=r.trim(),l=a.trim();let c=!0,u=!0;if(!1===i.getProgramParameter(m,i.LINK_STATUS))if(c=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(i,m,S,x);else{const e=Wk(i,S,"vertex"),n=Wk(i,x,"fragment");ox("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+"\n\nMaterial Name: "+t.name+"\nMaterial Type: "+t.type+"\n\nProgram Info Log: "+s+"\n"+e+"\n"+n)}else""!==s?sx("WebGLProgram: Program Info Log:",s):""!==o&&""!==l||(u=!1);u&&(t.diagnostics={runnable:c,programLog:s,vertexShader:{log:o,prefix:g},fragmentShader:{log:l,prefix:v}})}i.deleteShader(S),i.deleteShader(x),E=new Vk(i,m),T=function(e,t){const n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const r=e.getActiveAttrib(t,i),a=r.name;let s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),n[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:s}}return n}(i,m)}let E,T;i.attachShader(m,S),i.attachShader(m,x),void 0!==n.index0AttributeName?i.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m),this.getUniforms=function(){return void 0===E&&w(this),E},this.getAttributes=function(){return void 0===T&&w(this),T};let M=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===M&&(M=i.getProgramParameter(m,37297)),M},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=jk++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=S,this.fragmentShader=x,this}let fL=0;class pL{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),i=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(i)&&(a.add(i),i.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return void 0===n&&(n=new mL(e),t.set(e,n)),n}}class mL{constructor(e){this.id=fL++,this.code=e,this.usedTimes=0}}function gL(e,t,n,r,i,a,s){const o=new kw,l=new pL,c=new Set,u=[],h=new Map,d=i.logarithmicDepthBuffer;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return c.add(e),0===e?"uv":"uv".concat(e)}return{getParameters:function(a,o,u,h,g){const v=h.fog,y=g.geometry,_=a.isMeshStandardMaterial?h.environment:null,b=(a.isMeshStandardMaterial?n:t).get(a.envMap||_),S=b&&b.mapping===m_?b.image.height:null,x=p[a.type];null!==a.precision&&(f=i.getMaxPrecision(a.precision),f!==a.precision&&sx("WebGLProgram.getParameters:",a.precision,"not supported, using",f,"instead."));const w=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,E=void 0!==w?w.length:0;let T,M,C,A,I=0;if(void 0!==y.morphAttributes.position&&(I=1),void 0!==y.morphAttributes.normal&&(I=2),void 0!==y.morphAttributes.color&&(I=3),x){const e=iN[x];T=e.vertexShader,M=e.fragmentShader}else T=a.vertexShader,M=a.fragmentShader,l.update(a),C=l.getVertexShaderID(a),A=l.getFragmentShaderID(a);const R=e.getRenderTarget(),P=e.state.buffers.depth.getReversed(),N=!0===g.isInstancedMesh,k=!0===g.isBatchedMesh,L=!!a.map,D=!!a.matcap,O=!!b,U=!!a.aoMap,F=!!a.lightMap,z=!!a.bumpMap,B=!!a.normalMap,V=!!a.displacementMap,H=!!a.emissiveMap,j=!!a.metalnessMap,G=!!a.roughnessMap,W=a.anisotropy>0,q=a.clearcoat>0,X=a.dispersion>0,Y=a.iridescence>0,K=a.sheen>0,J=a.transmission>0,Q=W&&!!a.anisotropyMap,Z=q&&!!a.clearcoatMap,$=q&&!!a.clearcoatNormalMap,ee=q&&!!a.clearcoatRoughnessMap,te=Y&&!!a.iridescenceMap,ne=Y&&!!a.iridescenceThicknessMap,re=K&&!!a.sheenColorMap,ie=K&&!!a.sheenRoughnessMap,ae=!!a.specularMap,se=!!a.specularColorMap,oe=!!a.specularIntensityMap,le=J&&!!a.transmissionMap,ce=J&&!!a.thicknessMap,ue=!!a.gradientMap,he=!!a.alphaMap,de=a.alphaTest>0,fe=!!a.alphaHash,pe=!!a.extensions;let me=e_;a.toneMapped&&(null!==R&&!0!==R.isXRRenderTarget||(me=e.toneMapping));const ge={shaderID:x,shaderType:a.type,shaderName:a.name,vertexShader:T,fragmentShader:M,defines:a.defines,customVertexShaderID:C,customFragmentShaderID:A,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:f,batching:k,batchingColor:k&&null!==g._colorsTexture,instancing:N,instancingColor:N&&null!==g.instanceColor,instancingMorph:N&&null!==g.morphTexture,outputColorSpace:null===R?e.outputColorSpace:!0===R.isXRRenderTarget?R.texture.colorSpace:rS,alphaToCoverage:!!a.alphaToCoverage,map:L,matcap:D,envMap:O,envMapMode:O&&b.mapping,envMapCubeUVHeight:S,aoMap:U,lightMap:F,bumpMap:z,normalMap:B,displacementMap:V,emissiveMap:H,normalMapObjectSpace:B&&a.normalMapType===eS,normalMapTangentSpace:B&&a.normalMapType===$b,metalnessMap:j,roughnessMap:G,anisotropy:W,anisotropyMap:Q,clearcoat:q,clearcoatMap:Z,clearcoatNormalMap:$,clearcoatRoughnessMap:ee,dispersion:X,iridescence:Y,iridescenceMap:te,iridescenceThicknessMap:ne,sheen:K,sheenColorMap:re,sheenRoughnessMap:ie,specularMap:ae,specularColorMap:se,specularIntensityMap:oe,transmission:J,transmissionMap:le,thicknessMap:ce,gradientMap:ue,opaque:!1===a.transparent&&a.blending===yy&&!1===a.alphaToCoverage,alphaMap:he,alphaTest:de,alphaHash:fe,combine:a.combine,mapUv:L&&m(a.map.channel),aoMapUv:U&&m(a.aoMap.channel),lightMapUv:F&&m(a.lightMap.channel),bumpMapUv:z&&m(a.bumpMap.channel),normalMapUv:B&&m(a.normalMap.channel),displacementMapUv:V&&m(a.displacementMap.channel),emissiveMapUv:H&&m(a.emissiveMap.channel),metalnessMapUv:j&&m(a.metalnessMap.channel),roughnessMapUv:G&&m(a.roughnessMap.channel),anisotropyMapUv:Q&&m(a.anisotropyMap.channel),clearcoatMapUv:Z&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:$&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ee&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:te&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:ne&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:re&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:ie&&m(a.sheenRoughnessMap.channel),specularMapUv:ae&&m(a.specularMap.channel),specularColorMapUv:se&&m(a.specularColorMap.channel),specularIntensityMapUv:oe&&m(a.specularIntensityMap.channel),transmissionMapUv:le&&m(a.transmissionMap.channel),thicknessMapUv:ce&&m(a.thicknessMap.channel),alphaMapUv:he&&m(a.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(B||W),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===g.isPoints&&!!y.attributes.uv&&(L||he),fog:!!v,useFog:!0===a.fog,fogExp2:!!v&&v.isFogExp2,flatShading:!0===a.flatShading&&!1===a.wireframe,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:d,reversedDepthBuffer:P,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:E,morphTextureStride:I,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:me,decodeVideoTexture:L&&!0===a.map.isVideoTexture&&Px.getTransfer(a.map.colorSpace)===aS,decodeVideoTextureEmissive:H&&!0===a.emissiveMap.isVideoTexture&&Px.getTransfer(a.emissiveMap.colorSpace)===aS,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===gy,flipSided:a.side===my,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionClipCullDistance:pe&&!0===a.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(pe&&!0===a.extensions.multiDraw||k)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:a.customProgramCacheKey()};return ge.vertexUv1s=c.has(1),ge.vertexUv2s=c.has(2),ge.vertexUv3s=c.has(3),c.clear(),ge},getProgramCacheKey:function(t){const n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)n.push(e),n.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.numLightProbes),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){o.disableAll(),t.instancing&&o.enable(0);t.instancingColor&&o.enable(1);t.instancingMorph&&o.enable(2);t.matcap&&o.enable(3);t.envMap&&o.enable(4);t.normalMapObjectSpace&&o.enable(5);t.normalMapTangentSpace&&o.enable(6);t.clearcoat&&o.enable(7);t.iridescence&&o.enable(8);t.alphaTest&&o.enable(9);t.vertexColors&&o.enable(10);t.vertexAlphas&&o.enable(11);t.vertexUv1s&&o.enable(12);t.vertexUv2s&&o.enable(13);t.vertexUv3s&&o.enable(14);t.vertexTangents&&o.enable(15);t.anisotropy&&o.enable(16);t.alphaHash&&o.enable(17);t.batching&&o.enable(18);t.dispersion&&o.enable(19);t.batchingColor&&o.enable(20);t.gradientMap&&o.enable(21);e.push(o.mask),o.disableAll(),t.fog&&o.enable(0);t.useFog&&o.enable(1);t.flatShading&&o.enable(2);t.logarithmicDepthBuffer&&o.enable(3);t.reversedDepthBuffer&&o.enable(4);t.skinning&&o.enable(5);t.morphTargets&&o.enable(6);t.morphNormals&&o.enable(7);t.morphColors&&o.enable(8);t.premultipliedAlpha&&o.enable(9);t.shadowMapEnabled&&o.enable(10);t.doubleSided&&o.enable(11);t.flipSided&&o.enable(12);t.useDepthPacking&&o.enable(13);t.dithering&&o.enable(14);t.transmission&&o.enable(15);t.sheen&&o.enable(16);t.opaque&&o.enable(17);t.pointsUvs&&o.enable(18);t.decodeVideoTexture&&o.enable(19);t.decodeVideoTextureEmissive&&o.enable(20);t.alphaToCoverage&&o.enable(21);e.push(o.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){const t=p[e.type];let n;if(t){const e=iN[t];n=lT.clone(e.uniforms)}else n=e.uniforms;return n},acquireProgram:function(t,n){let r=h.get(n);return void 0!==r?++r.usedTimes:(r=new dL(e,n,t,a),u.push(r),h.set(n,r)),r},releaseProgram:function(e){if(0===--e.usedTimes){const t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),h.delete(e.cacheKey),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function vL(){let e=new WeakMap;return{has:function(t){return e.has(t)},get:function(t){let n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function yL(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function _L(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function bL(){const e=[];let t=0;const n=[],r=[],i=[];function a(n,r,i,a,s,o){let l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:o},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=i,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:n,transmissive:r,transparent:i,init:function(){t=0,n.length=0,r.length=0,i.length=0},push:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.push(u):!0===s.transparent?i.push(u):n.push(u)},unshift:function(e,t,s,o,l,c){const u=a(e,t,s,o,l,c);s.transmission>0?r.unshift(u):!0===s.transparent?i.unshift(u):n.unshift(u)},finish:function(){for(let n=t,r=e.length;n<r;n++){const t=e[n];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){n.length>1&&n.sort(e||yL),r.length>1&&r.sort(t||_L),i.length>1&&i.sort(t||_L)}}}function SL(){let e=new WeakMap;return{get:function(t,n){const r=e.get(t);let i;return void 0===r?(i=new bL,e.set(t,[i])):n>=r.length?(i=new bL,r.push(i)):i=r[n],i},dispose:function(){e=new WeakMap}}}function xL(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new wx,color:new pE};break;case"SpotLight":n={position:new wx,direction:new wx,color:new pE,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new wx,color:new pE,distance:0,decay:0};break;case"HemisphereLight":n={direction:new wx,skyColor:new pE,groundColor:new pE};break;case"RectAreaLight":n={color:new pE,position:new wx,halfWidth:new wx,halfHeight:new wx}}return e[t.id]=n,n}}}let wL=0;function EL(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function TL(e){const t=new xL,n=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sx};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sx,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let o=0;o<9;o++)r.probe.push(new wx);const i=new wx,a=new xw,s=new xw;return{setup:function(i){let a=0,s=0,o=0;for(let e=0;e<9;e++)r.probe[e].set(0,0,0);let l=0,c=0,u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0;i.sort(EL);for(let e=0,b=i.length;e<b;e++){const _=i[e],b=_.color,S=_.intensity,x=_.distance;let w=null;if(_.shadow&&_.shadow.map&&(w=_.shadow.map.texture.format===K_?_.shadow.map.texture:_.shadow.map.depthTexture||_.shadow.map.texture),_.isAmbientLight)a+=b.r*S,s+=b.g*S,o+=b.b*S;else if(_.isLightProbe){for(let e=0;e<9;e++)r.probe[e].addScaledVector(_.sh.coefficients[e],S);y++}else if(_.isDirectionalLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,r.directionalShadow[l]=t,r.directionalShadowMap[l]=w,r.directionalShadowMatrix[l]=_.shadow.matrix,f++}r.directional[l]=e,l++}else if(_.isSpotLight){const e=t.get(_);e.position.setFromMatrixPosition(_.matrixWorld),e.color.copy(b).multiplyScalar(S),e.distance=x,e.coneCos=Math.cos(_.angle),e.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),e.decay=_.decay,r.spot[u]=e;const i=_.shadow;if(_.map&&(r.spotLightMap[g]=_.map,g++,i.updateMatrices(_),_.castShadow&&v++),r.spotLightMatrix[u]=i.matrix,_.castShadow){const e=n.get(_);e.shadowIntensity=i.intensity,e.shadowBias=i.bias,e.shadowNormalBias=i.normalBias,e.shadowRadius=i.radius,e.shadowMapSize=i.mapSize,r.spotShadow[u]=e,r.spotShadowMap[u]=w,m++}u++}else if(_.isRectAreaLight){const e=t.get(_);e.color.copy(b).multiplyScalar(S),e.halfWidth.set(.5*_.width,0,0),e.halfHeight.set(0,.5*_.height,0),r.rectArea[h]=e,h++}else if(_.isPointLight){const e=t.get(_);if(e.color.copy(_.color).multiplyScalar(_.intensity),e.distance=_.distance,e.decay=_.decay,_.castShadow){const e=_.shadow,t=n.get(_);t.shadowIntensity=e.intensity,t.shadowBias=e.bias,t.shadowNormalBias=e.normalBias,t.shadowRadius=e.radius,t.shadowMapSize=e.mapSize,t.shadowCameraNear=e.camera.near,t.shadowCameraFar=e.camera.far,r.pointShadow[c]=t,r.pointShadowMap[c]=w,r.pointShadowMatrix[c]=_.shadow.matrix,p++}r.point[c]=e,c++}else if(_.isHemisphereLight){const e=t.get(_);e.skyColor.copy(_.color).multiplyScalar(S),e.groundColor.copy(_.groundColor).multiplyScalar(S),r.hemi[d]=e,d++}}h>0&&(!0===e.has("OES_texture_float_linear")?(r.rectAreaLTC1=rN.LTC_FLOAT_1,r.rectAreaLTC2=rN.LTC_FLOAT_2):(r.rectAreaLTC1=rN.LTC_HALF_1,r.rectAreaLTC2=rN.LTC_HALF_2)),r.ambient[0]=a,r.ambient[1]=s,r.ambient[2]=o;const _=r.hash;_.directionalLength===l&&_.pointLength===c&&_.spotLength===u&&_.rectAreaLength===h&&_.hemiLength===d&&_.numDirectionalShadows===f&&_.numPointShadows===p&&_.numSpotShadows===m&&_.numSpotMaps===g&&_.numLightProbes===y||(r.directional.length=l,r.spot.length=u,r.rectArea.length=h,r.point.length=c,r.hemi.length=d,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=p,r.pointShadowMap.length=p,r.spotShadow.length=m,r.spotShadowMap.length=m,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=p,r.spotLightMatrix.length=m+g-v,r.spotLightMap.length=g,r.numSpotLightShadowsWithMaps=v,r.numLightProbes=y,_.directionalLength=l,_.pointLength=c,_.spotLength=u,_.rectAreaLength=h,_.hemiLength=d,_.numDirectionalShadows=f,_.numPointShadows=p,_.numSpotShadows=m,_.numSpotMaps=g,_.numLightProbes=y,r.version=wL++)},setupView:function(e,t){let n=0,o=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let d=0,f=e.length;d<f;d++){const t=e[d];if(t.isDirectionalLight){const e=r.directional[n];e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),n++}else if(t.isSpotLight){const e=r.spot[l];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(t.matrixWorld),i.setFromMatrixPosition(t.target.matrixWorld),e.direction.sub(i),e.direction.transformDirection(h),l++}else if(t.isRectAreaLight){const e=r.rectArea[c];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),s.identity(),a.copy(t.matrixWorld),a.premultiply(h),s.extractRotation(a),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),e.halfWidth.applyMatrix4(s),e.halfHeight.applyMatrix4(s),c++}else if(t.isPointLight){const e=r.point[o];e.position.setFromMatrixPosition(t.matrixWorld),e.position.applyMatrix4(h),o++}else if(t.isHemisphereLight){const e=r.hemi[u];e.direction.setFromMatrixPosition(t.matrixWorld),e.direction.transformDirection(h),u++}}},state:r}}function ML(e){const t=new TL(e),n=[],r=[];const i={lightsArray:n,shadowsArray:r,camera:null,lights:t,transmissionRenderTarget:{}};return{init:function(e){i.camera=e,n.length=0,r.length=0},state:i,setupLights:function(){t.setup(n)},setupLightsView:function(e){t.setupView(n,e)},pushLight:function(e){n.push(e)},pushShadow:function(e){r.push(e)}}}function CL(e){let t=new WeakMap;return{get:function(n){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=t.get(n);let a;return void 0===i?(a=new ML(e),t.set(n,[a])):r>=i.length?(a=new ML(e),i.push(a)):a=i[r],a},dispose:function(){t=new WeakMap}}}const AL=[new wx(1,0,0),new wx(-1,0,0),new wx(0,1,0),new wx(0,-1,0),new wx(0,0,1),new wx(0,0,-1)],IL=[new wx(0,-1,0),new wx(0,-1,0),new wx(0,0,1),new wx(0,0,-1),new wx(0,-1,0),new wx(0,-1,0)],RL=new xw,PL=new wx,NL=new wx;function kL(e,t,n){let r=new EM;const i=new Sx,a=new Sx,s=new Hx,o=new iI,l=new aI,c={},u=n.maxTextureSize,h={[py]:my,[my]:py,[gy]:gy},d=new cT({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Sx},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );\n\tgl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new GE;p.setAttribute("position",new CE(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new nT(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=hy;let v=this.type;function y(n,r){const a=t.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new Gx(i.x,i.y,{format:K_,type:O_})),d.uniforms.shadow_pass.value=n.map.depthTexture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,d,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,f,m,null)}function _(t,n,r,i){let a=null;const s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0||!0===n.alphaToCoverage){const e=a.uuid,t=n.uuid;let r=c[e];void 0===r&&(r={},c[e]=r);let i=r[t];void 0===i&&(i=a.clone(),r[t]=i,n.addEventListener("dispose",S)),a=i}if(a.visible=n.visible,a.wireframe=n.wireframe,a.side=i===fy?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:h[n.side],a.alphaMap=n.alphaMap,a.alphaTest=!0===n.alphaToCoverage?.5:n.alphaTest,a.map=n.map,a.clipShadows=n.clipShadows,a.clippingPlanes=n.clippingPlanes,a.clipIntersection=n.clipIntersection,a.displacementMap=n.displacementMap,a.displacementScale=n.displacementScale,a.displacementBias=n.displacementBias,a.wireframeLinewidth=n.wireframeLinewidth,a.linewidth=n.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial){e.properties.get(a).light=r}return a}function b(n,i,a,s,o){if(!1===n.visible)return;if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&o===fy)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);const r=t.update(n),l=n.material;if(Array.isArray(l)){const t=r.groups;for(let c=0,u=t.length;c<u;c++){const u=t[c],h=l[u.materialIndex];if(h&&h.visible){const t=_(n,h,s,o);n.onBeforeShadow(e,n,i,a,r,t,u),e.renderBufferDirect(a,null,r,t,n,u),n.onAfterShadow(e,n,i,a,r,t,u)}}}else if(l.visible){const t=_(n,l,s,o);n.onBeforeShadow(e,n,i,a,r,t,null),e.renderBufferDirect(a,null,r,t,n,null),n.onAfterShadow(e,n,i,a,r,t,null)}}const l=n.children;for(let e=0,t=l.length;e<t;e++)b(l[e],i,a,s,o)}function S(e){e.target.removeEventListener("dispose",S);for(const t in c){const n=c[t],r=e.target.uuid;if(r in n){n[r].dispose(),delete n[r]}}}this.render=function(t,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===t.length)return;t.type===dy&&(sx("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),t.type=hy);const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(vy),!0===d.buffers.depth.getReversed()?d.buffers.color.setClear(0,0,0,0):d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const f=v!==this.type;f&&n.traverse(function(e){e.material&&(Array.isArray(e.material)?e.material.forEach(e=>e.needsUpdate=!0):e.material.needsUpdate=!0)});for(let p=0,m=t.length;p<m;p++){const l=t[p],c=l.shadow;if(void 0===c){sx("WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;i.copy(c.mapSize);const h=c.getFrameExtents();if(i.multiply(h),a.copy(c.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(a.x=Math.floor(u/h.x),i.x=a.x*h.x,c.mapSize.x=a.x),i.y>u&&(a.y=Math.floor(u/h.y),i.y=a.y*h.y,c.mapSize.y=a.y)),null===c.map||!0===f){if(null!==c.map&&(null!==c.map.depthTexture&&(c.map.depthTexture.dispose(),c.map.depthTexture=null),c.map.dispose()),this.type===fy){if(l.isPointLight){sx("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}c.map=new Gx(i.x,i.y,{format:K_,type:O_,minFilter:E_,magFilter:E_,generateMipmaps:!1}),c.map.texture.name=l.name+".shadowMap",c.map.depthTexture=new SC(i.x,i.y,D_),c.map.depthTexture.name=l.name+".shadowMapDepth",c.map.depthTexture.format=W_,c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=__,c.map.depthTexture.magFilter=__}else{l.isPointLight?(c.map=new yT(i.x),c.map.depthTexture=new xC(i.x,L_)):(c.map=new Gx(i.x,i.y),c.map.depthTexture=new SC(i.x,i.y,L_)),c.map.depthTexture.name=l.name+".shadowMap",c.map.depthTexture.format=W_;const t=e.state.buffers.depth.getReversed();this.type===hy?(c.map.depthTexture.compareFunction=t?PS:AS,c.map.depthTexture.minFilter=E_,c.map.depthTexture.magFilter=E_):(c.map.depthTexture.compareFunction=null,c.map.depthTexture.minFilter=__,c.map.depthTexture.magFilter=__)}c.camera.updateProjectionMatrix()}const m=c.map.isWebGLCubeRenderTarget?6:1;for(let t=0;t<m;t++){if(c.map.isWebGLCubeRenderTarget)e.setRenderTarget(c.map,t),e.clear();else{0===t&&(e.setRenderTarget(c.map),e.clear());const n=c.getViewport(t);s.set(a.x*n.x,a.y*n.y,a.x*n.z,a.y*n.w),d.viewport(s)}if(l.isPointLight){const e=c.camera,n=c.matrix,r=l.distance||e.far;r!==e.far&&(e.far=r,e.updateProjectionMatrix()),PL.setFromMatrixPosition(l.matrixWorld),e.position.copy(PL),NL.copy(e.position),NL.add(AL[t]),e.up.copy(IL[t]),e.lookAt(NL),e.updateMatrixWorld(),n.makeTranslation(-PL.x,-PL.y,-PL.z),RL.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),c._frustum.setFromProjectionMatrix(RL,e.coordinateSystem,e.reversedDepth)}else c.updateMatrices(l);r=c.getFrustum(),b(n,o,c.camera,l,this.type)}!0!==c.isPointLightShadow&&this.type===fy&&y(c,o),c.needsUpdate=!1}v=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,h)}}const LL={[jy]:Gy,[Wy]:Ky,[Xy]:Jy,[qy]:Yy,[Gy]:jy,[Ky]:Wy,[Jy]:Xy,[Yy]:qy};function DL(e,t){const n=new function(){let t=!1;const n=new Hx;let r=null;const i=new Hx(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,a,s,o){!0===o&&(t*=s,r*=s,a*=s),n.set(t,r,a,s),!1===i.equals(n)&&(e.clearColor(t,r,a,s),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},r=new function(){let n=!1,r=!1,i=null,a=null,s=null;return{setReversed:function(e){if(r!==e){const n=t.get("EXT_clip_control");e?n.clipControlEXT(n.LOWER_LEFT_EXT,n.ZERO_TO_ONE_EXT):n.clipControlEXT(n.LOWER_LEFT_EXT,n.NEGATIVE_ONE_TO_ONE_EXT),r=e;const i=s;s=null,this.setClear(i)}},getReversed:function(){return r},setTest:function(t){t?B(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(t){i===t||n||(e.depthMask(t),i=t)},setFunc:function(t){if(r&&(t=LL[t]),a!==t){switch(t){case jy:e.depthFunc(e.NEVER);break;case Gy:e.depthFunc(e.ALWAYS);break;case Wy:e.depthFunc(e.LESS);break;case qy:e.depthFunc(e.LEQUAL);break;case Xy:e.depthFunc(e.EQUAL);break;case Yy:e.depthFunc(e.GEQUAL);break;case Ky:e.depthFunc(e.GREATER);break;case Jy:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}a=t}},setLocked:function(e){n=e},setClear:function(t){s!==t&&(r&&(t=1-t),e.clearDepth(t),s=t)},reset:function(){n=!1,i=null,a=null,s=null,r=!1}}},i=new function(){let t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null;return{setTest:function(n){t||(n?B(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,s){r===t&&i===n&&a===s||(e.stencilFunc(t,n,s),r=t,i=n,a=s)},setOp:function(t,n,r){s===t&&o===n&&l===r||(e.stencilOp(t,n,r),s=t,o=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,i=null,a=null,s=null,o=null,l=null,c=null}}},a=new WeakMap,s=new WeakMap;let o={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new pE(0,0,0),S=0,x=!1,w=null,E=null,T=null,M=null,C=null;const A=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let I=!1,R=0;const P=e.getParameter(e.VERSION);-1!==P.indexOf("WebGL")?(R=parseFloat(/^WebGL (\d)/.exec(P)[1]),I=R>=1):-1!==P.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL ES (\d)/.exec(P)[1]),I=R>=2);let N=null,k={};const L=e.getParameter(e.SCISSOR_BOX),D=e.getParameter(e.VIEWPORT),O=(new Hx).fromArray(L),U=(new Hx).fromArray(D);function F(t,n,r,i){const a=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<r;o++)t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY?e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,a):e.texImage2D(n+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,a);return s}const z={};function B(t){!0!==o[t]&&(e.enable(t),o[t]=!0)}function V(t){!1!==o[t]&&(e.disable(t),o[t]=!1)}z[e.TEXTURE_2D]=F(e.TEXTURE_2D,e.TEXTURE_2D,1),z[e.TEXTURE_CUBE_MAP]=F(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),z[e.TEXTURE_2D_ARRAY]=F(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),z[e.TEXTURE_3D]=F(e.TEXTURE_3D,e.TEXTURE_3D,1,1),n.setClear(0,0,0,1),r.setClear(1),i.setClear(0),B(e.DEPTH_TEST),r.setFunc(qy),W(!1),q(oy),B(e.CULL_FACE),G(vy);const H={[wy]:e.FUNC_ADD,[Ey]:e.FUNC_SUBTRACT,[Ty]:e.FUNC_REVERSE_SUBTRACT};H[My]=e.MIN,H[Cy]=e.MAX;const j={[Ay]:e.ZERO,[Iy]:e.ONE,[Ry]:e.SRC_COLOR,[Ny]:e.SRC_ALPHA,[Fy]:e.SRC_ALPHA_SATURATE,[Oy]:e.DST_COLOR,[Ly]:e.DST_ALPHA,[Py]:e.ONE_MINUS_SRC_COLOR,[ky]:e.ONE_MINUS_SRC_ALPHA,[Uy]:e.ONE_MINUS_DST_COLOR,[Dy]:e.ONE_MINUS_DST_ALPHA,[zy]:e.CONSTANT_COLOR,[By]:e.ONE_MINUS_CONSTANT_COLOR,[Vy]:e.CONSTANT_ALPHA,[Hy]:e.ONE_MINUS_CONSTANT_ALPHA};function G(t,n,r,i,a,s,o,l,c,u){if(t!==vy){if(!1===d&&(B(e.BLEND),d=!0),t===xy)a=a||n,s=s||r,o=o||i,n===p&&a===v||(e.blendEquationSeparate(H[n],H[a]),p=n,v=a),r===m&&i===g&&s===y&&o===_||(e.blendFuncSeparate(j[r],j[i],j[s],j[o]),m=r,g=i,y=s,_=o),!1!==l.equals(b)&&c===S||(e.blendColor(l.r,l.g,l.b,c),b.copy(l),S=c),f=t,x=!1;else if(t!==f||u!==x){if(p===wy&&v===wy||(e.blendEquation(e.FUNC_ADD),p=wy,v=wy),u)switch(t){case yy:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case _y:e.blendFunc(e.ONE,e.ONE);break;case by:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case Sy:e.blendFuncSeparate(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ZERO,e.ONE);break;default:ox("WebGLState: Invalid blending: ",t)}else switch(t){case yy:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case _y:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE,e.ONE,e.ONE);break;case by:ox("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Sy:ox("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:ox("WebGLState: Invalid blending: ",t)}m=null,g=null,y=null,_=null,b.set(0,0,0),S=0,f=t,x=u}}else!0===d&&(V(e.BLEND),d=!1)}function W(t){w!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),w=t)}function q(t){t!==sy?(B(e.CULL_FACE),t!==E&&(t===oy?e.cullFace(e.BACK):t===ly?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),E=t}function X(t,n,r){t?(B(e.POLYGON_OFFSET_FILL),M===n&&C===r||(e.polygonOffset(n,r),M=n,C=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:r,stencil:i},enable:B,disable:V,bindFramebuffer:function(t,n){return l[t]!==n&&(e.bindFramebuffer(t,n),l[t]=n,t===e.DRAW_FRAMEBUFFER&&(l[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(l[e.DRAW_FRAMEBUFFER]=n),!0)},drawBuffers:function(t,n){let r=u,i=!1;if(t){r=c.get(n),void 0===r&&(r=[],c.set(n,r));const a=t.textures;if(r.length!==a.length||r[0]!==e.COLOR_ATTACHMENT0){for(let t=0,n=a.length;t<n;t++)r[t]=e.COLOR_ATTACHMENT0+t;r.length=a.length,i=!0}}else r[0]!==e.BACK&&(r[0]=e.BACK,i=!0);i&&e.drawBuffers(r)},useProgram:function(t){return h!==t&&(e.useProgram(t),h=t,!0)},setBlending:G,setMaterial:function(t,a){t.side===gy?V(e.CULL_FACE):B(e.CULL_FACE);let s=t.side===my;a&&(s=!s),W(s),t.blending===yy&&!1===t.transparent?G(vy):G(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.blendColor,t.blendAlpha,t.premultipliedAlpha),r.setFunc(t.depthFunc),r.setTest(t.depthTest),r.setMask(t.depthWrite),n.setMask(t.colorWrite);const o=t.stencilWrite;i.setTest(o),o&&(i.setMask(t.stencilWriteMask),i.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),i.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),X(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?B(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:W,setCullFace:q,setLineWidth:function(t){t!==T&&(I&&e.lineWidth(t),T=t)},setPolygonOffset:X,setScissorTest:function(t){t?B(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+A-1),N!==t&&(e.activeTexture(t),N=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===N?e.TEXTURE0+A-1:N);let i=k[r];void 0===i&&(i={type:void 0,texture:void 0},k[r]=i),i.type===t&&i.texture===n||(N!==r&&(e.activeTexture(r),N=r),e.bindTexture(t,n||z[t]),i.type=t,i.texture=n)},unbindTexture:function(){const t=k[N];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D(...arguments)}catch(cU){ox("WebGLState:",cU)}},compressedTexImage3D:function(){try{e.compressedTexImage3D(...arguments)}catch(cU){ox("WebGLState:",cU)}},texImage2D:function(){try{e.texImage2D(...arguments)}catch(cU){ox("WebGLState:",cU)}},texImage3D:function(){try{e.texImage3D(...arguments)}catch(cU){ox("WebGLState:",cU)}},updateUBOMapping:function(t,n){let r=s.get(n);void 0===r&&(r=new WeakMap,s.set(n,r));let i=r.get(t);void 0===i&&(i=e.getUniformBlockIndex(n,t.name),r.set(t,i))},uniformBlockBinding:function(t,n){const r=s.get(n).get(t);a.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),a.set(n,r))},texStorage2D:function(){try{e.texStorage2D(...arguments)}catch(cU){ox("WebGLState:",cU)}},texStorage3D:function(){try{e.texStorage3D(...arguments)}catch(cU){ox("WebGLState:",cU)}},texSubImage2D:function(){try{e.texSubImage2D(...arguments)}catch(cU){ox("WebGLState:",cU)}},texSubImage3D:function(){try{e.texSubImage3D(...arguments)}catch(cU){ox("WebGLState:",cU)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D(...arguments)}catch(cU){ox("WebGLState:",cU)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D(...arguments)}catch(cU){ox("WebGLState:",cU)}},scissor:function(t){!1===O.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),O.copy(t))},viewport:function(t){!1===U.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),U.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),r.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),o={},N=null,k={},l={},c=new WeakMap,u=[],h=null,d=!1,f=null,p=null,m=null,g=null,v=null,y=null,_=null,b=new pE(0,0,0),S=0,x=!1,w=null,E=null,T=null,M=null,C=null,O.set(0,0,e.canvas.width,e.canvas.height),U.set(0,0,e.canvas.width,e.canvas.height),n.reset(),r.reset(),i.reset()}}}function OL(e,t,n,r,i,a,s){const o=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new Sx,u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(G){}function p(e,t){return f?new OffscreenCanvas(e,t):$S("canvas")}function m(e,t,n){let r=1;const i=j(e);if((i.width>n||i.height>n)&&(r=n/Math.max(i.width,i.height)),r<1){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!==typeof VideoFrame&&e instanceof VideoFrame){const n=Math.floor(r*i.width),a=Math.floor(r*i.height);void 0===h&&(h=p(n,a));const s=t?p(n,a):h;s.width=n,s.height=a;return s.getContext("2d").drawImage(e,0,0,n,a),sx("WebGLRenderer: Texture has been resized from ("+i.width+"x"+i.height+") to ("+n+"x"+a+")."),s}return"data"in e&&sx("WebGLRenderer: Image in DataTexture is too big ("+i.width+"x"+i.height+")."),e}return e}function g(e){return e.generateMipmaps}function v(t){e.generateMipmap(t)}function y(t){return t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:t.isWebGL3DRenderTarget?e.TEXTURE_3D:t.isWebGLArrayRenderTarget||t.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function _(n,r,i,a){let s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(null!==n){if(void 0!==e[n])return e[n];sx("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let o=r;if(r===e.RED&&(i===e.FLOAT&&(o=e.R32F),i===e.HALF_FLOAT&&(o=e.R16F),i===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RED_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.R8UI),i===e.UNSIGNED_SHORT&&(o=e.R16UI),i===e.UNSIGNED_INT&&(o=e.R32UI),i===e.BYTE&&(o=e.R8I),i===e.SHORT&&(o=e.R16I),i===e.INT&&(o=e.R32I)),r===e.RG&&(i===e.FLOAT&&(o=e.RG32F),i===e.HALF_FLOAT&&(o=e.RG16F),i===e.UNSIGNED_BYTE&&(o=e.RG8)),r===e.RG_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RG8UI),i===e.UNSIGNED_SHORT&&(o=e.RG16UI),i===e.UNSIGNED_INT&&(o=e.RG32UI),i===e.BYTE&&(o=e.RG8I),i===e.SHORT&&(o=e.RG16I),i===e.INT&&(o=e.RG32I)),r===e.RGB_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGB8UI),i===e.UNSIGNED_SHORT&&(o=e.RGB16UI),i===e.UNSIGNED_INT&&(o=e.RGB32UI),i===e.BYTE&&(o=e.RGB8I),i===e.SHORT&&(o=e.RGB16I),i===e.INT&&(o=e.RGB32I)),r===e.RGBA_INTEGER&&(i===e.UNSIGNED_BYTE&&(o=e.RGBA8UI),i===e.UNSIGNED_SHORT&&(o=e.RGBA16UI),i===e.UNSIGNED_INT&&(o=e.RGBA32UI),i===e.BYTE&&(o=e.RGBA8I),i===e.SHORT&&(o=e.RGBA16I),i===e.INT&&(o=e.RGBA32I)),r===e.RGB&&(i===e.UNSIGNED_INT_5_9_9_9_REV&&(o=e.RGB9_E5),i===e.UNSIGNED_INT_10F_11F_11F_REV&&(o=e.R11F_G11F_B10F)),r===e.RGBA){const t=s?iS:Px.getTransfer(a);i===e.FLOAT&&(o=e.RGBA32F),i===e.HALF_FLOAT&&(o=e.RGBA16F),i===e.UNSIGNED_BYTE&&(o=t===aS?e.SRGB8_ALPHA8:e.RGBA8),i===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),i===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)}return o!==e.R16F&&o!==e.R32F&&o!==e.RG16F&&o!==e.RG32F&&o!==e.RGBA16F&&o!==e.RGBA32F||t.get("EXT_color_buffer_float"),o}function b(t,n){let r;return t?null===n||n===L_||n===z_?r=e.DEPTH24_STENCIL8:n===D_?r=e.DEPTH32F_STENCIL8:n===N_&&(r=e.DEPTH24_STENCIL8,sx("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):null===n||n===L_||n===z_?r=e.DEPTH_COMPONENT24:n===D_?r=e.DEPTH_COMPONENT32F:n===N_&&(r=e.DEPTH_COMPONENT16),r}function S(e,t){return!0===g(e)||e.isFramebufferTexture&&e.minFilter!==__&&e.minFilter!==E_?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function x(e){const t=e.target;t.removeEventListener("dispose",x),function(e){const t=r.get(e);if(void 0===t.__webglInit)return;const n=e.source,i=d.get(n);if(i){const r=i[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&E(e),0===Object.keys(i).length&&d.delete(n)}r.remove(e)}(t),t.isVideoTexture&&u.delete(t)}function w(t){const n=t.target;n.removeEventListener("dispose",w),function(t){const n=r.get(t);t.depthTexture&&(t.depthTexture.dispose(),r.remove(t.depthTexture));if(t.isWebGLCubeRenderTarget)for(let r=0;r<6;r++){if(Array.isArray(n.__webglFramebuffer[r]))for(let t=0;t<n.__webglFramebuffer[r].length;t++)e.deleteFramebuffer(n.__webglFramebuffer[r][t]);else e.deleteFramebuffer(n.__webglFramebuffer[r]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[r])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}const i=t.textures;for(let a=0,o=i.length;a<o;a++){const t=r.get(i[a]);t.__webglTexture&&(e.deleteTexture(t.__webglTexture),s.memory.textures--),r.remove(i[a])}r.remove(t)}(n)}function E(t){const n=r.get(t);e.deleteTexture(n.__webglTexture);const i=t.source;delete d.get(i)[n.__cacheKey],s.memory.textures--}let T=0;function M(t,i){const a=r.get(t);if(t.isVideoTexture&&function(e){const t=s.render.frame;u.get(e)!==t&&(u.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&!0!==t.isExternalTexture&&t.version>0&&a.__version!==t.version){const e=t.image;if(null===e)sx("WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==e.complete)return void k(a,t,i);sx("WebGLRenderer: Texture marked for update but image is incomplete")}}else t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null);n.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+i)}const C={[g_]:e.REPEAT,[v_]:e.CLAMP_TO_EDGE,[y_]:e.MIRRORED_REPEAT},A={[__]:e.NEAREST,[b_]:e.NEAREST_MIPMAP_NEAREST,[x_]:e.NEAREST_MIPMAP_LINEAR,[E_]:e.LINEAR,[T_]:e.LINEAR_MIPMAP_NEAREST,[C_]:e.LINEAR_MIPMAP_LINEAR},I={[TS]:e.NEVER,[NS]:e.ALWAYS,[MS]:e.LESS,[AS]:e.LEQUAL,[CS]:e.EQUAL,[PS]:e.GEQUAL,[IS]:e.GREATER,[RS]:e.NOTEQUAL};function R(n,a){if(a.type!==D_||!1!==t.has("OES_texture_float_linear")||a.magFilter!==E_&&a.magFilter!==T_&&a.magFilter!==x_&&a.magFilter!==C_&&a.minFilter!==E_&&a.minFilter!==T_&&a.minFilter!==x_&&a.minFilter!==C_||sx("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(n,e.TEXTURE_WRAP_S,C[a.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,C[a.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,C[a.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,A[a.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,A[a.minFilter]),a.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,I[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){if(a.magFilter===__)return;if(a.minFilter!==x_&&a.minFilter!==C_)return;if(a.type===D_&&!1===t.has("OES_texture_float_linear"))return;if(a.anisotropy>1||r.get(a).__currentAnisotropy){const s=t.get("EXT_texture_filter_anisotropic");e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy}}}function P(t,n){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",x));const i=n.source;let a=d.get(i);void 0===a&&(a={},d.set(i,a));const o=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;const i=a[t.__cacheKey];void 0!==i&&(a[t.__cacheKey].usedTimes--,0===i.usedTimes&&E(n)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function N(e,t,n){return Math.floor(Math.floor(e/n)/t)}function k(t,s,o){let l=e.TEXTURE_2D;(s.isDataArrayTexture||s.isCompressedArrayTexture)&&(l=e.TEXTURE_2D_ARRAY),s.isData3DTexture&&(l=e.TEXTURE_3D);const c=P(t,s),u=s.source;n.bindTexture(l,t.__webglTexture,e.TEXTURE0+o);const h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+o);const t=Px.getPrimaries(Px.workingColorSpace),r=s.colorSpace===tS?null:Px.getPrimaries(s.colorSpace),d=s.colorSpace===tS||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);let f=m(s.image,!1,i.maxTextureSize);f=H(s,f);const p=a.convert(s.format,s.colorSpace),y=a.convert(s.type);let x,w=_(s.internalFormat,p,y,s.colorSpace,s.isVideoTexture);R(l,s);const E=s.mipmaps,T=!0!==s.isVideoTexture,M=void 0===h.__version||!0===c,C=u.dataReady,A=S(s,f);if(s.isDepthTexture)w=b(s.format===q_,s.type),M&&(T?n.texStorage2D(e.TEXTURE_2D,1,w,f.width,f.height):n.texImage2D(e.TEXTURE_2D,0,w,f.width,f.height,0,p,y,null));else if(s.isDataTexture)if(E.length>0){T&&M&&n.texStorage2D(e.TEXTURE_2D,A,w,E[0].width,E[0].height);for(let t=0,r=E.length;t<r;t++)x=E[t],T?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,p,y,x.data):n.texImage2D(e.TEXTURE_2D,t,w,x.width,x.height,0,p,y,x.data);s.generateMipmaps=!1}else T?(M&&n.texStorage2D(e.TEXTURE_2D,A,w,f.width,f.height),C&&function(t,r,i,a){const s=t.updateRanges;if(0===s.length)n.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,i,a,r.data);else{s.sort((e,t)=>e.start-t.start);let o=0;for(let e=1;e<s.length;e++){const t=s[o],n=s[e],i=t.start+t.count,a=N(n.start,r.width,4),l=N(t.start,r.width,4);n.start<=i+1&&a===l&&N(n.start+n.count-1,r.width,4)===a?t.count=Math.max(t.count,n.start+n.count-t.start):(++o,s[o]=n)}s.length=o+1;const l=e.getParameter(e.UNPACK_ROW_LENGTH),c=e.getParameter(e.UNPACK_SKIP_PIXELS),u=e.getParameter(e.UNPACK_SKIP_ROWS);e.pixelStorei(e.UNPACK_ROW_LENGTH,r.width);for(let t=0,h=s.length;t<h;t++){const o=s[t],l=Math.floor(o.start/4),c=Math.ceil(o.count/4),u=l%r.width,h=Math.floor(l/r.width),d=c,f=1;e.pixelStorei(e.UNPACK_SKIP_PIXELS,u),e.pixelStorei(e.UNPACK_SKIP_ROWS,h),n.texSubImage2D(e.TEXTURE_2D,0,u,h,d,f,i,a,r.data)}t.clearUpdateRanges(),e.pixelStorei(e.UNPACK_ROW_LENGTH,l),e.pixelStorei(e.UNPACK_SKIP_PIXELS,c),e.pixelStorei(e.UNPACK_SKIP_ROWS,u)}}(s,f,p,y)):n.texImage2D(e.TEXTURE_2D,0,w,f.width,f.height,0,p,y,f.data);else if(s.isCompressedTexture)if(s.isCompressedArrayTexture){T&&M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,A,w,E[0].width,E[0].height,f.depth);for(let t=0,r=E.length;t<r;t++)if(x=E[t],s.format!==G_)if(null!==p)if(T){if(C)if(s.layerUpdates.size>0){const r=ZP(x.width,x.height,s.format,s.type);for(const i of s.layerUpdates){const a=x.data.subarray(i*r/x.data.BYTES_PER_ELEMENT,(i+1)*r/x.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,i,x.width,x.height,1,p,a)}s.clearLayerUpdates()}else n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,x.width,x.height,f.depth,p,x.data)}else n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,t,w,x.width,x.height,f.depth,0,x.data,0,0);else sx("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else T?C&&n.texSubImage3D(e.TEXTURE_2D_ARRAY,t,0,0,0,x.width,x.height,f.depth,p,y,x.data):n.texImage3D(e.TEXTURE_2D_ARRAY,t,w,x.width,x.height,f.depth,0,p,y,x.data)}else{T&&M&&n.texStorage2D(e.TEXTURE_2D,A,w,E[0].width,E[0].height);for(let t=0,r=E.length;t<r;t++)x=E[t],s.format!==G_?null!==p?T?C&&n.compressedTexSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,p,x.data):n.compressedTexImage2D(e.TEXTURE_2D,t,w,x.width,x.height,0,x.data):sx("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):T?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,x.width,x.height,p,y,x.data):n.texImage2D(e.TEXTURE_2D,t,w,x.width,x.height,0,p,y,x.data)}else if(s.isDataArrayTexture)if(T){if(M&&n.texStorage3D(e.TEXTURE_2D_ARRAY,A,w,f.width,f.height,f.depth),C)if(s.layerUpdates.size>0){const t=ZP(f.width,f.height,s.format,s.type);for(const r of s.layerUpdates){const i=f.data.subarray(r*t/f.data.BYTES_PER_ELEMENT,(r+1)*t/f.data.BYTES_PER_ELEMENT);n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,r,f.width,f.height,1,p,y,i)}s.clearLayerUpdates()}else n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)}else n.texImage3D(e.TEXTURE_2D_ARRAY,0,w,f.width,f.height,f.depth,0,p,y,f.data);else if(s.isData3DTexture)T?(M&&n.texStorage3D(e.TEXTURE_3D,A,w,f.width,f.height,f.depth),C&&n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,p,y,f.data)):n.texImage3D(e.TEXTURE_3D,0,w,f.width,f.height,f.depth,0,p,y,f.data);else if(s.isFramebufferTexture){if(M)if(T)n.texStorage2D(e.TEXTURE_2D,A,w,f.width,f.height);else{let t=f.width,r=f.height;for(let i=0;i<A;i++)n.texImage2D(e.TEXTURE_2D,i,w,t,r,0,p,y,null),t>>=1,r>>=1}}else if(E.length>0){if(T&&M){const t=j(E[0]);n.texStorage2D(e.TEXTURE_2D,A,w,t.width,t.height)}for(let t=0,r=E.length;t<r;t++)x=E[t],T?C&&n.texSubImage2D(e.TEXTURE_2D,t,0,0,p,y,x):n.texImage2D(e.TEXTURE_2D,t,w,p,y,x);s.generateMipmaps=!1}else if(T){if(M){const t=j(f);n.texStorage2D(e.TEXTURE_2D,A,w,t.width,t.height)}C&&n.texSubImage2D(e.TEXTURE_2D,0,0,0,p,y,f)}else n.texImage2D(e.TEXTURE_2D,0,w,p,y,f);g(s)&&v(l),h.__version=u.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}function L(t,i,s,l,c,u){const h=a.convert(s.format,s.colorSpace),d=a.convert(s.type),f=_(s.internalFormat,h,d,s.colorSpace),p=r.get(i),m=r.get(s);if(m.__renderTarget=i,!p.__hasExternalTextures){const t=Math.max(1,i.width>>u),r=Math.max(1,i.height>>u);c===e.TEXTURE_3D||c===e.TEXTURE_2D_ARRAY?n.texImage3D(c,u,f,t,r,i.depth,0,h,d,null):n.texImage2D(c,u,f,t,r,0,h,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,l,c,m.__webglTexture,0,B(i)):(c===e.TEXTURE_2D||c>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&c<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,l,c,m.__webglTexture,u),n.bindFramebuffer(e.FRAMEBUFFER,null)}function D(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer){const i=n.depthTexture,a=i&&i.isDepthTexture?i.type:null,s=b(n.stencilBuffer,a),l=n.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;V(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,B(n),s,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,B(n),s,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,s,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,t)}else{const t=n.textures;for(let i=0;i<t.length;i++){const s=t[i],l=a.convert(s.format,s.colorSpace),c=a.convert(s.type),u=_(s.internalFormat,l,c,s.colorSpace);V(n)?o.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,B(n),u,n.width,n.height):r?e.renderbufferStorageMultisample(e.RENDERBUFFER,B(n),u,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,u,n.width,n.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function O(t,i,s){const l=!0===i.isWebGLCubeRenderTarget;if(n.bindFramebuffer(e.FRAMEBUFFER,t),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const c=r.get(i.depthTexture);if(c.__renderTarget=i,c.__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),l){if(void 0===c.__webglInit&&(c.__webglInit=!0,i.depthTexture.addEventListener("dispose",x)),void 0===c.__webglTexture){c.__webglTexture=e.createTexture(),n.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),R(e.TEXTURE_CUBE_MAP,i.depthTexture);const t=a.convert(i.depthTexture.format),r=a.convert(i.depthTexture.type);let s;i.depthTexture.format===W_?s=e.DEPTH_COMPONENT24:i.depthTexture.format===q_&&(s=e.DEPTH24_STENCIL8);for(let n=0;n<6;n++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,s,i.width,i.height,0,t,r,null)}}else M(i.depthTexture,0);const u=c.__webglTexture,h=B(i),d=l?e.TEXTURE_CUBE_MAP_POSITIVE_X+s:e.TEXTURE_2D,f=i.depthTexture.format===q_?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;if(i.depthTexture.format===W_)V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,f,d,u,0,h):e.framebufferTexture2D(e.FRAMEBUFFER,f,d,u,0);else{if(i.depthTexture.format!==q_)throw new Error("Unknown depthTexture format");V(i)?o.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,f,d,u,0,h):e.framebufferTexture2D(e.FRAMEBUFFER,f,d,u,0)}}function U(t){const i=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(i.__boundDepthTexture!==t.depthTexture){const e=t.depthTexture;if(i.__depthDisposeCallback&&i.__depthDisposeCallback(),e){const t=()=>{delete i.__boundDepthTexture,delete i.__depthDisposeCallback,e.removeEventListener("dispose",t)};e.addEventListener("dispose",t),i.__depthDisposeCallback=t}i.__boundDepthTexture=e}if(t.depthTexture&&!i.__autoAllocateDepthBuffer)if(a)for(let e=0;e<6;e++)O(i.__webglFramebuffer[e],t,e);else{const e=t.texture.mipmaps;e&&e.length>0?O(i.__webglFramebuffer[0],t,0):O(i.__webglFramebuffer,t,0)}else if(a){i.__webglDepthbuffer=[];for(let r=0;r<6;r++)if(n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[r]),void 0===i.__webglDepthbuffer[r])i.__webglDepthbuffer[r]=e.createRenderbuffer(),D(i.__webglDepthbuffer[r],t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,a=i.__webglDepthbuffer[r];e.bindRenderbuffer(e.RENDERBUFFER,a),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,a)}}else{const r=t.texture.mipmaps;if(r&&r.length>0?n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer[0]):n.bindFramebuffer(e.FRAMEBUFFER,i.__webglFramebuffer),void 0===i.__webglDepthbuffer)i.__webglDepthbuffer=e.createRenderbuffer(),D(i.__webglDepthbuffer,t,!1);else{const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,r=i.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,r),e.framebufferRenderbuffer(e.FRAMEBUFFER,n,e.RENDERBUFFER,r)}}n.bindFramebuffer(e.FRAMEBUFFER,null)}const F=[],z=[];function B(e){return Math.min(i.maxSamples,e.samples)}function V(e){const n=r.get(e);return e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function H(e,t){const n=e.colorSpace,r=e.format,i=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||n!==rS&&n!==tS&&(Px.getTransfer(n)===aS?r===G_&&i===I_||sx("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):ox("WebGLTextures: Unsupported texture color space:",n)),t}function j(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement?(c.width=e.naturalWidth||e.width,c.height=e.naturalHeight||e.height):"undefined"!==typeof VideoFrame&&e instanceof VideoFrame?(c.width=e.displayWidth,c.height=e.displayHeight):(c.width=e.width,c.height=e.height),c}this.allocateTextureUnit=function(){const e=T;return e>=i.maxTextures&&sx("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+i.maxTextures),T+=1,e},this.resetTextureUnits=function(){T=0},this.setTexture2D=M,this.setTexture2DArray=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?k(a,t,i):(t.isExternalTexture&&(a.__webglTexture=t.sourceTexture?t.sourceTexture:null),n.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+i))},this.setTexture3D=function(t,i){const a=r.get(t);!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version?k(a,t,i):n.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+i)},this.setTextureCube=function(t,s){const o=r.get(t);!0!==t.isCubeDepthTexture&&t.version>0&&o.__version!==t.version?function(t,s,o){if(6!==s.image.length)return;const l=P(t,s),c=s.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);const u=r.get(c);if(c.version!==u.__version||!0===l){n.activeTexture(e.TEXTURE0+o);const t=Px.getPrimaries(Px.workingColorSpace),r=s.colorSpace===tS?null:Px.getPrimaries(s.colorSpace),h=s.colorSpace===tS||t===r?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,s.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,h);const d=s.isCompressedTexture||s.image[0].isCompressedTexture,f=s.image[0]&&s.image[0].isDataTexture,p=[];for(let e=0;e<6;e++)p[e]=d||f?f?s.image[e].image:s.image[e]:m(s.image[e],!0,i.maxCubemapSize),p[e]=H(s,p[e]);const y=p[0],b=a.convert(s.format,s.colorSpace),x=a.convert(s.type),w=_(s.internalFormat,b,x,s.colorSpace),E=!0!==s.isVideoTexture,T=void 0===u.__version||!0===l,M=c.dataReady;let C,A=S(s,y);if(R(e.TEXTURE_CUBE_MAP,s),d){E&&T&&n.texStorage2D(e.TEXTURE_CUBE_MAP,A,w,y.width,y.height);for(let t=0;t<6;t++){C=p[t].mipmaps;for(let r=0;r<C.length;r++){const i=C[r];s.format!==G_?null!==b?E?M&&n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,b,i.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,w,i.width,i.height,0,i.data):sx("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):E?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,0,0,i.width,i.height,b,x,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r,w,i.width,i.height,0,b,x,i.data)}}}else{if(C=s.mipmaps,E&&T){C.length>0&&A++;const t=j(p[0]);n.texStorage2D(e.TEXTURE_CUBE_MAP,A,w,t.width,t.height)}for(let t=0;t<6;t++)if(f){E?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,p[t].width,p[t].height,b,x,p[t].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,w,p[t].width,p[t].height,0,b,x,p[t].data);for(let r=0;r<C.length;r++){const i=C[r].image[t].image;E?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,i.width,i.height,b,x,i.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,w,i.width,i.height,0,b,x,i.data)}}else{E?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,0,0,b,x,p[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,w,b,x,p[t]);for(let r=0;r<C.length;r++){const i=C[r];E?M&&n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,0,0,b,x,i.image[t]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,r+1,w,b,x,i.image[t])}}}g(s)&&v(e.TEXTURE_CUBE_MAP),u.__version=c.version,s.onUpdate&&s.onUpdate(s)}t.__version=s.version}(o,t,s):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+s)},this.rebindTextures=function(t,n,i){const a=r.get(t);void 0!==n&&L(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==i&&U(t)},this.setupRenderTarget=function(t){const i=t.texture,o=r.get(t),l=r.get(i);t.addEventListener("dispose",w);const c=t.textures,u=!0===t.isWebGLCubeRenderTarget,h=c.length>1;if(h||(void 0===l.__webglTexture&&(l.__webglTexture=e.createTexture()),l.__version=i.version,s.memory.textures++),u){o.__webglFramebuffer=[];for(let t=0;t<6;t++)if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer[t]=[];for(let n=0;n<i.mipmaps.length;n++)o.__webglFramebuffer[t][n]=e.createFramebuffer()}else o.__webglFramebuffer[t]=e.createFramebuffer()}else{if(i.mipmaps&&i.mipmaps.length>0){o.__webglFramebuffer=[];for(let t=0;t<i.mipmaps.length;t++)o.__webglFramebuffer[t]=e.createFramebuffer()}else o.__webglFramebuffer=e.createFramebuffer();if(h)for(let t=0,n=c.length;t<n;t++){const n=r.get(c[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}if(t.samples>0&&!1===V(t)){o.__webglMultisampledFramebuffer=e.createFramebuffer(),o.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,o.__webglMultisampledFramebuffer);for(let n=0;n<c.length;n++){const r=c[n];o.__webglColorRenderbuffer[n]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,o.__webglColorRenderbuffer[n]);const i=a.convert(r.format,r.colorSpace),s=a.convert(r.type),l=_(r.internalFormat,i,s,r.colorSpace,!0===t.isXRRenderTarget),u=B(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,u,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,e.RENDERBUFFER,o.__webglColorRenderbuffer[n])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(o.__webglDepthRenderbuffer=e.createRenderbuffer(),D(o.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(u){n.bindTexture(e.TEXTURE_CUBE_MAP,l.__webglTexture),R(e.TEXTURE_CUBE_MAP,i);for(let n=0;n<6;n++)if(i.mipmaps&&i.mipmaps.length>0)for(let r=0;r<i.mipmaps.length;r++)L(o.__webglFramebuffer[n][r],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,r);else L(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);g(i)&&v(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(let i=0,a=c.length;i<a;i++){const a=c[i],s=r.get(a);let l=e.TEXTURE_2D;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(l,s.__webglTexture),R(l,a),L(o.__webglFramebuffer,t,a,e.COLOR_ATTACHMENT0+i,l,0),g(a)&&v(l)}n.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),n.bindTexture(r,l.__webglTexture),R(r,i),i.mipmaps&&i.mipmaps.length>0)for(let n=0;n<i.mipmaps.length;n++)L(o.__webglFramebuffer[n],t,i,e.COLOR_ATTACHMENT0,r,n);else L(o.__webglFramebuffer,t,i,e.COLOR_ATTACHMENT0,r,0);g(i)&&v(r),n.unbindTexture()}t.depthBuffer&&U(t)},this.updateRenderTargetMipmap=function(e){const t=e.textures;for(let i=0,a=t.length;i<a;i++){const a=t[i];if(g(a)){const t=y(e),i=r.get(a).__webglTexture;n.bindTexture(t,i),v(t),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(t.samples>0)if(!1===V(t)){const i=t.textures,a=t.width,s=t.height;let o=e.COLOR_BUFFER_BIT;const c=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,u=r.get(t),h=i.length>1;if(h)for(let t=0;t<i.length;t++)n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer);const d=t.texture.mipmaps;d&&d.length>0?n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer[0]):n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<i.length;n++){if(t.resolveDepthBuffer&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&t.resolveStencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),h){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,u.__webglColorRenderbuffer[n]);const t=r.get(i[n]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,e.NEAREST),!0===l&&(F.length=0,z.length=0,F.push(e.COLOR_ATTACHMENT0+n),t.depthBuffer&&!1===t.resolveDepthBuffer&&(F.push(c),z.push(c),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,z)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,F))}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(let t=0;t<i.length;t++){n.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,u.__webglColorRenderbuffer[t]);const a=r.get(i[t]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,u.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}else if(t.depthBuffer&&!1===t.resolveDepthBuffer&&l){const n=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[n])}},this.setupDepthRenderbuffer=U,this.setupFrameBufferTexture=L,this.useMultisampledRTT=V,this.isReversedDepthBuffer=function(){return n.buffers.depth.getReversed()}}function UL(e,t){return{convert:function(n){let r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tS;const a=Px.getTransfer(i);if(n===I_)return e.UNSIGNED_BYTE;if(n===U_)return e.UNSIGNED_SHORT_4_4_4_4;if(n===F_)return e.UNSIGNED_SHORT_5_5_5_1;if(n===B_)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===V_)return e.UNSIGNED_INT_10F_11F_11F_REV;if(n===R_)return e.BYTE;if(n===P_)return e.SHORT;if(n===N_)return e.UNSIGNED_SHORT;if(n===k_)return e.INT;if(n===L_)return e.UNSIGNED_INT;if(n===D_)return e.FLOAT;if(n===O_)return e.HALF_FLOAT;if(n===H_)return e.ALPHA;if(n===j_)return e.RGB;if(n===G_)return e.RGBA;if(n===W_)return e.DEPTH_COMPONENT;if(n===q_)return e.DEPTH_STENCIL;if(n===X_)return e.RED;if(n===Y_)return e.RED_INTEGER;if(n===K_)return e.RG;if(n===J_)return e.RG_INTEGER;if(n===Z_)return e.RGBA_INTEGER;if(n===$_||n===eb||n===tb||n===nb)if(a===aS){if(r=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===r)return null;if(n===$_)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===eb)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===tb)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===nb)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(r=t.get("WEBGL_compressed_texture_s3tc"),null===r)return null;if(n===$_)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===eb)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===tb)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===nb)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===rb||n===ib||n===ab||n===sb){if(r=t.get("WEBGL_compressed_texture_pvrtc"),null===r)return null;if(n===rb)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===ib)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===ab)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===sb)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===ob||n===lb||n===cb||n===ub||n===hb||n===db||n===fb){if(r=t.get("WEBGL_compressed_texture_etc"),null===r)return null;if(n===ob||n===lb)return a===aS?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===cb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC;if(n===ub)return r.COMPRESSED_R11_EAC;if(n===hb)return r.COMPRESSED_SIGNED_R11_EAC;if(n===db)return r.COMPRESSED_RG11_EAC;if(n===fb)return r.COMPRESSED_SIGNED_RG11_EAC}if(n===pb||n===mb||n===gb||n===vb||n===yb||n===_b||n===bb||n===Sb||n===xb||n===wb||n===Eb||n===Tb||n===Mb||n===Cb){if(r=t.get("WEBGL_compressed_texture_astc"),null===r)return null;if(n===pb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===mb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===gb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===vb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===yb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===_b)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===bb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Sb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===xb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===wb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Eb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Tb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Mb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Cb)return a===aS?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===Ab||n===Ib||n===Rb){if(r=t.get("EXT_texture_compression_bptc"),null===r)return null;if(n===Ab)return a===aS?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Ib)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Rb)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(n===Pb||n===Nb||n===kb||n===Lb){if(r=t.get("EXT_texture_compression_rgtc"),null===r)return null;if(n===Pb)return r.COMPRESSED_RED_RGTC1_EXT;if(n===Nb)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===kb)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Lb)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===z_?e.UNSIGNED_INT_24_8:void 0!==e[n]?e[n]:null}}}class FL{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(null===this.texture){const n=new wC(e.texture);e.depthNear===t.depthNear&&e.depthFar===t.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(null!==this.texture&&null===this.mesh){const t=e.cameras[0].viewport,n=new cT({vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new nT(new zA(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class zL extends cx{constructor(e,t){super();const n=this;let r=null,i=1,a=null,s="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,f=null;const p="undefined"!==typeof XRWebGLBinding,m=new FL,g={},v=t.getContextAttributes();let y=null,_=null;const b=[],S=[],x=new Sx;let w=null;const E=new pT;E.viewport=new Hx;const T=new pT;T.viewport=new Hx;const M=[E,T],C=new SR;let A=null,I=null;function R(e){const t=S.indexOf(e.inputSource);if(-1===t)return;const n=b[t];void 0!==n&&(n.update(e.inputSource,e.frame,l||a),n.dispatchEvent({type:e.type,data:e.inputSource}))}function P(){r.removeEventListener("select",R),r.removeEventListener("selectstart",R),r.removeEventListener("selectend",R),r.removeEventListener("squeeze",R),r.removeEventListener("squeezestart",R),r.removeEventListener("squeezeend",R),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",N);for(let e=0;e<b.length;e++){const t=S[e];null!==t&&(S[e]=null,b[e].disconnect(t))}A=null,I=null,m.reset();for(const e in g)delete g[e];e.setRenderTarget(y),d=null,h=null,u=null,r=null,_=null,U.stop(),n.isPresenting=!1,e.setPixelRatio(w),e.setSize(x.width,x.height,!1),n.dispatchEvent({type:"sessionend"})}function N(e){for(let t=0;t<e.removed.length;t++){const n=e.removed[t],r=S.indexOf(n);r>=0&&(S[r]=null,b[r].disconnect(n))}for(let t=0;t<e.added.length;t++){const n=e.added[t];let r=S.indexOf(n);if(-1===r){for(let e=0;e<b.length;e++){if(e>=S.length){S.push(n),r=e;break}if(null===S[e]){S[e]=n,r=e;break}}if(-1===r)break}const i=b[r];i&&i.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=b[e];return void 0===t&&(t=new ST,b[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=b[e];return void 0===t&&(t=new ST,b[e]=t),t.getGripSpace()},this.getHand=function(e){let t=b[e];return void 0===t&&(t=new ST,b[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){i=e,!0===n.isPresenting&&sx("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===n.isPresenting&&sx("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==h?h:d},this.getBinding=function(){return null===u&&p&&(u=new XRWebGLBinding(r,t)),u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(c){if(r=c,null!==r){y=e.getRenderTarget(),r.addEventListener("select",R),r.addEventListener("selectstart",R),r.addEventListener("selectend",R),r.addEventListener("squeeze",R),r.addEventListener("squeezestart",R),r.addEventListener("squeezeend",R),r.addEventListener("end",P),r.addEventListener("inputsourceschange",N),!0!==v.xrCompatible&&await t.makeXRCompatible(),w=e.getPixelRatio(),e.getSize(x);if(p&&"createProjectionLayer"in XRWebGLBinding.prototype){let n=null,a=null,s=null;v.depth&&(s=v.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,n=v.stencil?q_:W_,a=v.stencil?z_:L_);const o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:i};u=this.getBinding(),h=u.createProjectionLayer(o),r.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),_=new Gx(h.textureWidth,h.textureHeight,{format:G_,type:I_,depthTexture:new SC(h.textureWidth,h.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,n),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:!1===h.ignoreDepthValues,resolveStencilBuffer:!1===h.ignoreDepthValues})}else{const n={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:i};d=new XRWebGLLayer(r,t,n),r.updateRenderState({baseLayer:d}),e.setPixelRatio(1),e.setSize(d.framebufferWidth,d.framebufferHeight,!1),_=new Gx(d.framebufferWidth,d.framebufferHeight,{format:G_,type:I_,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:!1===d.ignoreDepthValues,resolveStencilBuffer:!1===d.ignoreDepthValues})}_.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await r.requestReferenceSpace(s),U.setContext(r),U.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode},this.getDepthTexture=function(){return m.getDepthTexture()};const k=new wx,L=new wx;function D(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;let t=e.near,n=e.far;null!==m.texture&&(m.depthNear>0&&(t=m.depthNear),m.depthFar>0&&(n=m.depthFar)),C.near=T.near=E.near=t,C.far=T.far=E.far=n,A===C.near&&I===C.far||(r.updateRenderState({depthNear:C.near,depthFar:C.far}),A=C.near,I=C.far),C.layers.mask=6|e.layers.mask,E.layers.mask=3&C.layers.mask,T.layers.mask=5&C.layers.mask;const i=e.parent,a=C.cameras;D(C,i);for(let r=0;r<a.length;r++)D(a[r],i);2===a.length?function(e,t,n){k.setFromMatrixPosition(t.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);const r=k.distanceTo(L),i=t.projectionMatrix.elements,a=n.projectionMatrix.elements,s=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],u=(i[8]-1)/i[0],h=(a[8]+1)/a[0],d=s*u,f=s*h,p=r/(-u+h),m=p*-u;if(t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert(),-1===i[10])e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse);else{const t=s+p,n=o+p,i=d-m,a=f+(r-m),u=l*o/n*t,h=c*o/n*t;e.projectionMatrix.makePerspective(i,a,u,h,t,n),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}}(C,E,T):C.projectionMatrix.copy(E.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*fx*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,C,i)},this.getCamera=function(){return C},this.getFoveation=function(){if(null!==h||null!==d)return o},this.setFoveation=function(e){o=e,null!==h&&(h.fixedFoveation=e),null!==d&&void 0!==d.fixedFoveation&&(d.fixedFoveation=e)},this.hasDepthSensing=function(){return null!==m.texture},this.getDepthSensingMesh=function(){return m.getMesh(C)},this.getCameraTexture=function(e){return g[e]};let O=null;const U=new eN;U.setAnimationLoop(function(t,i){if(c=i.getViewerPose(l||a),f=i,null!==c){const t=c.views;null!==d&&(e.setRenderTargetFramebuffer(_,d.framebuffer),e.setRenderTarget(_));let i=!1;t.length!==C.cameras.length&&(C.cameras.length=0,i=!0);for(let n=0;n<t.length;n++){const r=t[n];let a=null;if(null!==d)a=d.getViewport(r);else{const t=u.getViewSubImage(h,r);a=t.viewport,0===n&&(e.setRenderTargetTextures(_,t.colorTexture,t.depthStencilTexture),e.setRenderTarget(_))}let s=M[n];void 0===s&&(s=new pT,s.layers.enable(n),s.viewport=new Hx,M[n]=s),s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(r.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===n&&(C.matrix.copy(s.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),!0===i&&C.cameras.push(s)}const a=r.enabledFeatures;if(a&&a.includes("depth-sensing")&&"gpu-optimized"==r.depthUsage&&p){u=n.getBinding();const e=u.getDepthInformation(t[0]);e&&e.isValid&&e.texture&&m.init(e,r.renderState)}if(a&&a.includes("camera-access")&&p){e.state.unbindTexture(),u=n.getBinding();for(let e=0;e<t.length;e++){const n=t[e].camera;if(n){let e=g[n];e||(e=new wC,g[n]=e);const t=u.getCameraImage(n);e.sourceTexture=t}}}}for(let e=0;e<b.length;e++){const t=S[e],n=b[e];null!==t&&void 0!==n&&n.update(t,i,l||a)}O&&O(t,i),i.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:i}),f=null}),this.setAnimationLoop=function(e){O=e},this.dispose=function(){}}}const BL=new Nw,VL=new xw;function HL(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(e,r){e.opacity.value=r.opacity,r.color&&e.diffuse.value.copy(r.color),r.emissive&&e.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(e.map.value=r.map,n(r.map,e.mapTransform)),r.alphaMap&&(e.alphaMap.value=r.alphaMap,n(r.alphaMap,e.alphaMapTransform)),r.bumpMap&&(e.bumpMap.value=r.bumpMap,n(r.bumpMap,e.bumpMapTransform),e.bumpScale.value=r.bumpScale,r.side===my&&(e.bumpScale.value*=-1)),r.normalMap&&(e.normalMap.value=r.normalMap,n(r.normalMap,e.normalMapTransform),e.normalScale.value.copy(r.normalScale),r.side===my&&e.normalScale.value.negate()),r.displacementMap&&(e.displacementMap.value=r.displacementMap,n(r.displacementMap,e.displacementMapTransform),e.displacementScale.value=r.displacementScale,e.displacementBias.value=r.displacementBias),r.emissiveMap&&(e.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,e.emissiveMapTransform)),r.specularMap&&(e.specularMap.value=r.specularMap,n(r.specularMap,e.specularMapTransform)),r.alphaTest>0&&(e.alphaTest.value=r.alphaTest);const i=t.get(r),a=i.envMap,s=i.envMapRotation;a&&(e.envMap.value=a,BL.copy(s),BL.x*=-1,BL.y*=-1,BL.z*=-1,a.isCubeTexture&&!1===a.isRenderTargetTexture&&(BL.y*=-1,BL.z*=-1),e.envMapRotation.value.setFromMatrix4(VL.makeRotationFromEuler(BL)),e.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,e.reflectivity.value=r.reflectivity,e.ior.value=r.ior,e.refractionRatio.value=r.refractionRatio),r.lightMap&&(e.lightMap.value=r.lightMap,e.lightMapIntensity.value=r.lightMapIntensity,n(r.lightMap,e.lightMapTransform)),r.aoMap&&(e.aoMap.value=r.aoMap,e.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,e.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,oT(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,i,a,s,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?r(e,i):i.isMeshToonMaterial?(r(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,i)):i.isMeshPhongMaterial?(r(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,i)):i.isMeshStandardMaterial?(r(e,i),function(e,t){e.metalness.value=t.metalness,t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap,n(t.metalnessMap,e.metalnessMapTransform));e.roughness.value=t.roughness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap,n(t.roughnessMap,e.roughnessMapTransform));t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}(e,i),i.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),t.side===my&&e.clearcoatNormalScale.value.negate()));t.dispersion>0&&(e.dispersion.value=t.dispersion);t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,i,o)):i.isMeshMatcapMaterial?(r(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,i)):i.isMeshDepthMaterial?r(e,i):i.isMeshDistanceMaterial?(r(e,i),function(e,n){const r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,i)):i.isMeshNormalMaterial?r(e,i):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i,a,s):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function jL(e,t,n,r){let i={},a={},s=[];const o=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(e,t,n,r){const i=e.value,a=t+"_"+n;if(void 0===r[a])return r[a]="number"===typeof i||"boolean"===typeof i?i:i.clone(),!0;{const e=r[a];if("number"===typeof i||"boolean"===typeof i){if(e!==i)return r[a]=i,!0}else if(!1===e.equals(i))return e.copy(i),!0}return!1}function c(e){const t={boundary:0,storage:0};return"number"===typeof e||"boolean"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?sx("WebGLRenderer: Texture samplers can not be part of an uniforms group."):sx("WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){const n=t.target;n.removeEventListener("dispose",u);const r=s.indexOf(n.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(i[n.id]),delete i[n.id],delete a[n.id]}return{bind:function(e,t){const n=t.program;r.uniformBlockBinding(e,n)},update:function(n,h){let d=i[n.id];void 0===d&&(!function(e){const t=e.uniforms;let n=0;const r=16;for(let a=0,s=t.length;a<s;a++){const e=Array.isArray(t[a])?t[a]:[t[a]];for(let t=0,i=e.length;t<i;t++){const i=e[t],a=Array.isArray(i.value)?i.value:[i.value];for(let e=0,t=a.length;e<t;e++){const t=c(a[e]),s=n%r,o=s%t.boundary,l=s+o;n+=o,0!==l&&r-l<t.storage&&(n+=r-l),i.__data=new Float32Array(t.storage/Float32Array.BYTES_PER_ELEMENT),i.__offset=n,n+=t.storage}}}const i=n%r;i>0&&(n+=r-i);e.__size=n,e.__cache={}}(n),d=function(t){const n=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return ox("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;const r=e.createBuffer(),i=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,i,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),i[n.id]=d,n.addEventListener("dispose",u));const f=h.program;r.updateUBOMapping(n,f);const p=t.render.frame;a[n.id]!==p&&(!function(t){const n=i[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(let i=0,s=r.length;i<s;i++){const t=Array.isArray(r[i])?r[i]:[r[i]];for(let n=0,r=t.length;n<r;n++){const r=t[n];if(!0===l(r,i,n,a)){const t=r.__offset,n=Array.isArray(r.value)?r.value:[r.value];let i=0;for(let a=0;a<n.length;a++){const s=n[a],o=c(s);"number"===typeof s||"boolean"===typeof s?(r.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+i,r.__data)):s.isMatrix3?(r.__data[0]=s.elements[0],r.__data[1]=s.elements[1],r.__data[2]=s.elements[2],r.__data[3]=0,r.__data[4]=s.elements[3],r.__data[5]=s.elements[4],r.__data[6]=s.elements[5],r.__data[7]=0,r.__data[8]=s.elements[6],r.__data[9]=s.elements[7],r.__data[10]=s.elements[8],r.__data[11]=0):(s.toArray(r.__data,i),i+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,r.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),a[n.id]=p)},dispose:function(){for(const t in i)e.deleteBuffer(i[t]);s=[],i={},a={}}}}const GL=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let WL=null;class qL{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{canvas:t=ex(),context:n=null,depth:r=!0,stencil:i=!1,alpha:a=!1,antialias:s=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:u=!1,reversedDepthBuffer:h=!1,outputBufferType:d=I_}=e;let f;if(this.isWebGLRenderer=!0,null!==n){if("undefined"!==typeof WebGLRenderingContext&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=n.getContextAttributes().alpha}else f=a;const p=d,m=new Set([Z_,J_,Y_]),g=new Set([I_,L_,N_,z_,U_,F_]),v=new Uint32Array(4),y=new Int32Array(4);let _=null,b=null;const S=[],x=[];let w=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=e_,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const E=this;let T=!1;this._outputColorSpace=nS;let M=0,C=0,A=null,I=-1,R=null;const P=new Hx,N=new Hx;let k=null;const L=new pE(0);let D=0,O=t.width,U=t.height,F=1,z=null,B=null;const V=new Hx(0,0,O,U),H=new Hx(0,0,O,U);let j=!1;const G=new EM;let W=!1,q=!1;const X=new xw,Y=new wx,K=new Hx,J={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Q=!1;function Z(){return null===A?F:1}let $,ee,te,ne,re,ie,ae,se,oe,le,ce,ue,he,de,fe,pe,me,ge,ve,ye,_e,be,Se,xe,we=n;function Ee(e,n){return t.getContext(e,n)}try{const e={alpha:!0,depth:r,stencil:i,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine","three.js r".concat(ry)),t.addEventListener("webglcontextlost",Ce,!1),t.addEventListener("webglcontextrestored",Ae,!1),t.addEventListener("webglcontextcreationerror",Ie,!1),null===we){const t="webgl2";if(we=Ee(t,e),null===we)throw Ee(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(cU){throw ox("WebGLRenderer: "+cU.message),cU}function Te(){$=new IN(we),$.init(),be=new UL(we,$),ee=new hN(we,$,e,be),te=new DL(we,$),ee.reversedDepthBuffer&&h&&te.buffers.depth.setReversed(!0),ne=new NN(we),re=new vL,ie=new OL(we,$,te,re,ee,be,ne),ae=new fN(E),se=new AN(E),oe=new tN(we),Se=new cN(we,oe),le=new RN(we,oe,ne,Se),ce=new LN(we,le,oe,ne),ve=new kN(we,ee,ie),pe=new dN(re),ue=new gL(E,ae,se,$,ee,Se,pe),he=new HL(E,re),de=new SL,fe=new CL($),ge=new lN(E,ae,se,te,ce,f,o),me=new kL(E,ce,ee),xe=new jL(we,ne,ee,te),ye=new uN(we,$,ne),_e=new PN(we,$,ne),ne.programs=ue.programs,E.capabilities=ee,E.extensions=$,E.properties=re,E.renderLists=de,E.shadowMap=me,E.state=te,E.info=ne}Te(),p!==I_&&(w=new ON(p,t.width,t.height,r,i));const Me=new zL(E,we);function Ce(e){e.preventDefault(),ax("WebGLRenderer: Context Lost."),T=!0}function Ae(){ax("WebGLRenderer: Context Restored."),T=!1;const e=ne.autoReset,t=me.enabled,n=me.autoUpdate,r=me.needsUpdate,i=me.type;Te(),ne.autoReset=e,me.enabled=t,me.autoUpdate=n,me.needsUpdate=r,me.type=i}function Ie(e){ox("WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Re(e){const t=e.target;t.removeEventListener("dispose",Re),function(e){(function(e){const t=re.get(e).programs;void 0!==t&&(t.forEach(function(e){ue.releaseProgram(e)}),e.isShaderMaterial&&ue.releaseShaderCache(e))})(e),re.remove(e)}(t)}function Pe(e,t,n){!0===e.transparent&&e.side===gy&&!1===e.forceSinglePass?(e.side=my,e.needsUpdate=!0,Ve(e,t,n),e.side=py,e.needsUpdate=!0,Ve(e,t,n),e.side=gy):Ve(e,t,n)}this.xr=Me,this.getContext=function(){return we},this.getContextAttributes=function(){return we.getContextAttributes()},this.forceContextLoss=function(){const e=$.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=$.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(e){void 0!==e&&(F=e,this.setSize(O,U,!1))},this.getSize=function(e){return e.set(O,U)},this.setSize=function(e,n){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Me.isPresenting?sx("WebGLRenderer: Can't change size while VR device is presenting."):(O=e,U=n,t.width=Math.floor(e*F),t.height=Math.floor(n*F),!0===r&&(t.style.width=e+"px",t.style.height=n+"px"),null!==w&&w.setSize(t.width,t.height),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return e.set(O*F,U*F).floor()},this.setDrawingBufferSize=function(e,n,r){O=e,U=n,F=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.setEffects=function(e){if(p!==I_){if(e)for(let t=0;t<e.length;t++)if(!0===e[t].isOutputPass){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}w.setEffects(e||[])}else console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.")},this.getCurrentViewport=function(e){return e.copy(P)},this.getViewport=function(e){return e.copy(V)},this.setViewport=function(e,t,n,r){e.isVector4?V.set(e.x,e.y,e.z,e.w):V.set(e,t,n,r),te.viewport(P.copy(V).multiplyScalar(F).round())},this.getScissor=function(e){return e.copy(H)},this.setScissor=function(e,t,n,r){e.isVector4?H.set(e.x,e.y,e.z,e.w):H.set(e,t,n,r),te.scissor(N.copy(H).multiplyScalar(F).round())},this.getScissorTest=function(){return j},this.setScissorTest=function(e){te.setScissorTest(j=e)},this.setOpaqueSort=function(e){z=e},this.setTransparentSort=function(e){B=e},this.getClearColor=function(e){return e.copy(ge.getClearColor())},this.setClearColor=function(){ge.setClearColor(...arguments)},this.getClearAlpha=function(){return ge.getClearAlpha()},this.setClearAlpha=function(){ge.setClearAlpha(...arguments)},this.clear=function(){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=0;if(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]){let e=!1;if(null!==A){const t=A.texture.format;e=m.has(t)}if(e){const e=A.texture.type,t=g.has(e),n=ge.getClearColor(),r=ge.getClearAlpha(),i=n.r,a=n.g,s=n.b;t?(v[0]=i,v[1]=a,v[2]=s,v[3]=r,we.clearBufferuiv(we.COLOR,0,v)):(y[0]=i,y[1]=a,y[2]=s,y[3]=r,we.clearBufferiv(we.COLOR,0,y))}else n|=we.COLOR_BUFFER_BIT}e&&(n|=we.DEPTH_BUFFER_BIT),t&&(n|=we.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),we.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ce,!1),t.removeEventListener("webglcontextrestored",Ae,!1),t.removeEventListener("webglcontextcreationerror",Ie,!1),ge.dispose(),de.dispose(),fe.dispose(),re.dispose(),ae.dispose(),se.dispose(),ce.dispose(),Se.dispose(),xe.dispose(),ue.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",ke),Me.removeEventListener("sessionend",Le),De.stop()},this.renderBufferDirect=function(e,t,n,r,i,a){null===t&&(t=J);const s=i.isMesh&&i.matrixWorld.determinant()<0,o=function(e,t,n,r,i){!0!==t.isScene&&(t=J);ie.resetTextureUnits();const a=t.fog,s=r.isMeshStandardMaterial?t.environment:null,o=null===A?E.outputColorSpace:!0===A.isXRRenderTarget?A.texture.colorSpace:rS,l=(r.isMeshStandardMaterial?se:ae).get(r.envMap||s),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),h=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,f=!!n.morphAttributes.color;let p=e_;r.toneMapped&&(null!==A&&!0!==A.isXRRenderTarget||(p=E.toneMapping));const m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,g=void 0!==m?m.length:0,v=re.get(r),y=b.state.lights;if(!0===W&&(!0===q||e!==R)){const t=e===R&&r.id===I;pe.setState(r,e,t)}let _=!1;r.version===v.__version?v.needsLights&&v.lightsStateVersion!==y.state.version||v.outputColorSpace!==o||i.isBatchedMesh&&!1===v.batching?_=!0:i.isBatchedMesh||!0!==v.batching?i.isBatchedMesh&&!0===v.batchingColor&&null===i.colorTexture||i.isBatchedMesh&&!1===v.batchingColor&&null!==i.colorTexture||i.isInstancedMesh&&!1===v.instancing?_=!0:i.isInstancedMesh||!0!==v.instancing?i.isSkinnedMesh&&!1===v.skinning?_=!0:i.isSkinnedMesh||!0!==v.skinning?i.isInstancedMesh&&!0===v.instancingColor&&null===i.instanceColor||i.isInstancedMesh&&!1===v.instancingColor&&null!==i.instanceColor||i.isInstancedMesh&&!0===v.instancingMorph&&null===i.morphTexture||i.isInstancedMesh&&!1===v.instancingMorph&&null!==i.morphTexture||v.envMap!==l||!0===r.fog&&v.fog!==a?_=!0:void 0===v.numClippingPlanes||v.numClippingPlanes===pe.numPlanes&&v.numIntersection===pe.numIntersection?(v.vertexAlphas!==c||v.vertexTangents!==u||v.morphTargets!==h||v.morphNormals!==d||v.morphColors!==f||v.toneMapping!==p||v.morphTargetsCount!==g)&&(_=!0):_=!0:_=!0:_=!0:_=!0:(_=!0,v.__version=r.version);let S=v.currentProgram;!0===_&&(S=Ve(r,t,i));let x=!1,w=!1,T=!1;const M=S.getUniforms(),C=v.uniforms;te.useProgram(S.program)&&(x=!0,w=!0,T=!0);r.id!==I&&(I=r.id,w=!0);if(x||R!==e){te.buffers.depth.getReversed()&&!0!==e.reversedDepth&&(e._reversedDepth=!0,e.updateProjectionMatrix()),M.setValue(we,"projectionMatrix",e.projectionMatrix),M.setValue(we,"viewMatrix",e.matrixWorldInverse);const t=M.map.cameraPosition;void 0!==t&&t.setValue(we,Y.setFromMatrixPosition(e.matrixWorld)),ee.logarithmicDepthBuffer&&M.setValue(we,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&M.setValue(we,"isOrthographic",!0===e.isOrthographicCamera),R!==e&&(R=e,w=!0,T=!0)}v.needsLights&&(y.state.directionalShadowMap.length>0&&M.setValue(we,"directionalShadowMap",y.state.directionalShadowMap,ie),y.state.spotShadowMap.length>0&&M.setValue(we,"spotShadowMap",y.state.spotShadowMap,ie),y.state.pointShadowMap.length>0&&M.setValue(we,"pointShadowMap",y.state.pointShadowMap,ie));if(i.isSkinnedMesh){M.setOptional(we,i,"bindMatrix"),M.setOptional(we,i,"bindMatrixInverse");const e=i.skeleton;e&&(null===e.boneTexture&&e.computeBoneTexture(),M.setValue(we,"boneTexture",e.boneTexture,ie))}i.isBatchedMesh&&(M.setOptional(we,i,"batchingTexture"),M.setValue(we,"batchingTexture",i._matricesTexture,ie),M.setOptional(we,i,"batchingIdTexture"),M.setValue(we,"batchingIdTexture",i._indirectTexture,ie),M.setOptional(we,i,"batchingColorTexture"),null!==i._colorsTexture&&M.setValue(we,"batchingColorTexture",i._colorsTexture,ie));const P=n.morphAttributes;void 0===P.position&&void 0===P.normal&&void 0===P.color||ve.update(i,n,S);(w||v.receiveShadow!==i.receiveShadow)&&(v.receiveShadow=i.receiveShadow,M.setValue(we,"receiveShadow",i.receiveShadow));r.isMeshGouraudMaterial&&null!==r.envMap&&(C.envMap.value=l,C.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);r.isMeshStandardMaterial&&null===r.envMap&&null!==t.environment&&(C.envMapIntensity.value=t.environmentIntensity);void 0!==C.dfgLUT&&(C.dfgLUT.value=(null===WL&&(WL=new iM(GL,16,16,K_,O_),WL.name="DFG_LUT",WL.minFilter=E_,WL.magFilter=E_,WL.wrapS=v_,WL.wrapT=v_,WL.generateMipmaps=!1,WL.needsUpdate=!0),WL));w&&(M.setValue(we,"toneMappingExposure",E.toneMappingExposure),v.needsLights&&(k=T,(N=C).ambientLightColor.needsUpdate=k,N.lightProbe.needsUpdate=k,N.directionalLights.needsUpdate=k,N.directionalLightShadows.needsUpdate=k,N.pointLights.needsUpdate=k,N.pointLightShadows.needsUpdate=k,N.spotLights.needsUpdate=k,N.spotLightShadows.needsUpdate=k,N.rectAreaLights.needsUpdate=k,N.hemisphereLights.needsUpdate=k),a&&!0===r.fog&&he.refreshFogUniforms(C,a),he.refreshMaterialUniforms(C,r,F,U,b.state.transmissionRenderTarget[e.id]),Vk.upload(we,He(v),C,ie));var N,k;r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Vk.upload(we,He(v),C,ie),r.uniformsNeedUpdate=!1);r.isSpriteMaterial&&M.setValue(we,"center",i.center);if(M.setValue(we,"modelViewMatrix",i.modelViewMatrix),M.setValue(we,"normalMatrix",i.normalMatrix),M.setValue(we,"modelMatrix",i.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial){const e=r.uniformsGroups;for(let t=0,n=e.length;t<n;t++){const n=e[t];xe.update(n,S),xe.bind(n,S)}}return S}(e,t,n,r,i);te.setMaterial(r,s);let l=n.index,c=1;if(!0===r.wireframe){if(l=le.getWireframeAttribute(n),void 0===l)return;c=2}const u=n.drawRange,h=n.attributes.position;let d=u.start*c,f=(u.start+u.count)*c;null!==a&&(d=Math.max(d,a.start*c),f=Math.min(f,(a.start+a.count)*c)),null!==l?(d=Math.max(d,0),f=Math.min(f,l.count)):void 0!==h&&null!==h&&(d=Math.max(d,0),f=Math.min(f,h.count));const p=f-d;if(p<0||p===1/0)return;let m;Se.setup(i,r,o,n,l);let g=ye;if(null!==l&&(m=oe.get(l),g=_e,g.setIndex(m)),i.isMesh)!0===r.wireframe?(te.setLineWidth(r.wireframeLinewidth*Z()),g.setMode(we.LINES)):g.setMode(we.TRIANGLES);else if(i.isLine){let e=r.linewidth;void 0===e&&(e=1),te.setLineWidth(e*Z()),i.isLineSegments?g.setMode(we.LINES):i.isLineLoop?g.setMode(we.LINE_LOOP):g.setMode(we.LINE_STRIP)}else i.isPoints?g.setMode(we.POINTS):i.isSprite&&g.setMode(we.TRIANGLES);if(i.isBatchedMesh)if(null!==i._multiDrawInstances)lx("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),g.renderMultiDrawInstances(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount,i._multiDrawInstances);else if($.get("WEBGL_multi_draw"))g.renderMultiDraw(i._multiDrawStarts,i._multiDrawCounts,i._multiDrawCount);else{const e=i._multiDrawStarts,t=i._multiDrawCounts,n=i._multiDrawCount,a=l?oe.get(l).bytesPerElement:1,s=re.get(r).currentProgram.getUniforms();for(let r=0;r<n;r++)s.setValue(we,"_gl_DrawID",r),g.render(e[r]/a,t[r])}else if(i.isInstancedMesh)g.renderInstances(d,p,i.count);else if(n.isInstancedBufferGeometry){const e=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,t=Math.min(n.instanceCount,e);g.renderInstances(d,p,t)}else g.render(d,p)},this.compile=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===n&&(n=e),b=fe.get(n),b.init(t),x.push(b),n.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(b.pushLight(e),e.castShadow&&b.pushShadow(e))}),e!==n&&e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(b.pushLight(e),e.castShadow&&b.pushShadow(e))}),b.setupLights();const r=new Set;return e.traverse(function(e){if(!(e.isMesh||e.isPoints||e.isLine||e.isSprite))return;const t=e.material;if(t)if(Array.isArray(t))for(let i=0;i<t.length;i++){const a=t[i];Pe(a,n,e),r.add(a)}else Pe(t,n,e),r.add(t)}),b=x.pop(),r},this.compileAsync=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=this.compile(e,t,n);return new Promise(t=>{function n(){r.forEach(function(e){re.get(e).currentProgram.isReady()&&r.delete(e)}),0!==r.size?setTimeout(n,10):t(e)}null!==$.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)})};let Ne=null;function ke(){De.stop()}function Le(){De.start()}const De=new eN;function Oe(e,t,n,r){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)b.pushLight(e),e.castShadow&&b.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||G.intersectsSprite(e)){r&&K.setFromMatrixPosition(e.matrixWorld).applyMatrix4(X);const t=ce.update(e),i=e.material;i.visible&&_.push(e,t,i,n,K.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||G.intersectsObject(e))){const t=ce.update(e),i=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),K.copy(e.boundingSphere.center)):(null===t.boundingSphere&&t.computeBoundingSphere(),K.copy(t.boundingSphere.center)),K.applyMatrix4(e.matrixWorld).applyMatrix4(X)),Array.isArray(i)){const r=t.groups;for(let a=0,s=r.length;a<s;a++){const s=r[a],o=i[s.materialIndex];o&&o.visible&&_.push(e,t,o,n,K.z,s)}}else i.visible&&_.push(e,t,i,n,K.z,null)}const i=e.children;for(let a=0,s=i.length;a<s;a++)Oe(i[a],t,n,r)}function Ue(e,t,n,r){const{opaque:i,transmissive:a,transparent:s}=e;b.setupLightsView(n),!0===W&&pe.setGlobalState(E.clippingPlanes,n),r&&te.viewport(P.copy(r)),i.length>0&&ze(i,t,n),a.length>0&&ze(a,t,n),s.length>0&&ze(s,t,n),te.buffers.depth.setTest(!0),te.buffers.depth.setMask(!0),te.buffers.color.setMask(!0),te.setPolygonOffset(!1)}function Fe(e,t,n,r){if(null!==(!0===n.isScene?n.overrideMaterial:null))return;if(void 0===b.state.transmissionRenderTarget[r.id]){const e=$.has("EXT_color_buffer_half_float")||$.has("EXT_color_buffer_float");b.state.transmissionRenderTarget[r.id]=new Gx(1,1,{generateMipmaps:!0,type:e?O_:I_,minFilter:C_,samples:ee.samples,stencilBuffer:i,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Px.workingColorSpace})}const a=b.state.transmissionRenderTarget[r.id],s=r.viewport||P;a.setSize(s.z*E.transmissionResolutionScale,s.w*E.transmissionResolutionScale);const o=E.getRenderTarget(),l=E.getActiveCubeFace(),c=E.getActiveMipmapLevel();E.setRenderTarget(a),E.getClearColor(L),D=E.getClearAlpha(),D<1&&E.setClearColor(16777215,.5),E.clear(),Q&&ge.render(n);const u=E.toneMapping;E.toneMapping=e_;const h=r.viewport;if(void 0!==r.viewport&&(r.viewport=void 0),b.setupLightsView(r),!0===W&&pe.setGlobalState(E.clippingPlanes,r),ze(e,n,r),ie.updateMultisampleRenderTarget(a),ie.updateRenderTargetMipmap(a),!1===$.has("WEBGL_multisampled_render_to_texture")){let e=!1;for(let i=0,a=t.length;i<a;i++){const a=t[i],{object:s,geometry:o,material:l,group:c}=a;if(l.side===gy&&s.layers.test(r.layers)){const t=l.side;l.side=my,l.needsUpdate=!0,Be(s,n,r,o,l,c),l.side=t,l.needsUpdate=!0,e=!0}}!0===e&&(ie.updateMultisampleRenderTarget(a),ie.updateRenderTargetMipmap(a))}E.setRenderTarget(o,l,c),E.setClearColor(L,D),void 0!==h&&(r.viewport=h),E.toneMapping=u}function ze(e,t,n){const r=!0===t.isScene?t.overrideMaterial:null;for(let i=0,a=e.length;i<a;i++){const a=e[i],{object:s,geometry:o,group:l}=a;let c=a.material;!0===c.allowOverride&&null!==r&&(c=r),s.layers.test(n.layers)&&Be(s,t,n,o,c,l)}}function Be(e,t,n,r,i,a){e.onBeforeRender(E,t,n,r,i,a),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),i.onBeforeRender(E,t,n,r,e,a),!0===i.transparent&&i.side===gy&&!1===i.forceSinglePass?(i.side=my,i.needsUpdate=!0,E.renderBufferDirect(n,t,r,i,e,a),i.side=py,i.needsUpdate=!0,E.renderBufferDirect(n,t,r,i,e,a),i.side=gy):E.renderBufferDirect(n,t,r,i,e,a),e.onAfterRender(E,t,n,r,i,a)}function Ve(e,t,n){!0!==t.isScene&&(t=J);const r=re.get(e),i=b.state.lights,a=b.state.shadowsArray,s=i.state.version,o=ue.getParameters(e,i.state,a,t,n),l=ue.getProgramCacheKey(o);let c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?se:ae).get(e.envMap||r.environment),r.envMapRotation=null!==r.environment&&null===e.envMap?t.environmentRotation:e.envMapRotation,void 0===c&&(e.addEventListener("dispose",Re),c=new Map,r.programs=c);let u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===s)return je(e,o),u}else o.uniforms=ue.getUniforms(e),e.onBeforeCompile(o,E),u=ue.acquireProgram(o,l),c.set(l,u),r.uniforms=o.uniforms;const h=r.uniforms;return(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=pe.uniform),je(e,o),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=s,r.needsLights&&(h.ambientLightColor.value=i.state.ambient,h.lightProbe.value=i.state.probe,h.directionalLights.value=i.state.directional,h.directionalLightShadows.value=i.state.directionalShadow,h.spotLights.value=i.state.spot,h.spotLightShadows.value=i.state.spotShadow,h.rectAreaLights.value=i.state.rectArea,h.ltc_1.value=i.state.rectAreaLTC1,h.ltc_2.value=i.state.rectAreaLTC2,h.pointLights.value=i.state.point,h.pointLightShadows.value=i.state.pointShadow,h.hemisphereLights.value=i.state.hemi,h.directionalShadowMap.value=i.state.directionalShadowMap,h.directionalShadowMatrix.value=i.state.directionalShadowMatrix,h.spotShadowMap.value=i.state.spotShadowMap,h.spotLightMatrix.value=i.state.spotLightMatrix,h.spotLightMap.value=i.state.spotLightMap,h.pointShadowMap.value=i.state.pointShadowMap,h.pointShadowMatrix.value=i.state.pointShadowMatrix),r.currentProgram=u,r.uniformsList=null,u}function He(e){if(null===e.uniformsList){const t=e.currentProgram.getUniforms();e.uniformsList=Vk.seqWithValue(t.seq,e.uniforms)}return e.uniformsList}function je(e,t){const n=re.get(e);n.outputColorSpace=t.outputColorSpace,n.batching=t.batching,n.batchingColor=t.batchingColor,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.instancingMorph=t.instancingMorph,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}De.setAnimationLoop(function(e){Ne&&Ne(e)}),"undefined"!==typeof self&&De.setContext(self),this.setAnimationLoop=function(e){Ne=e,Me.setAnimationLoop(e),null===e?De.stop():De.start()},Me.addEventListener("sessionstart",ke),Me.addEventListener("sessionend",Le),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void ox("WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===T)return;const n=!0===Me.enabled&&!0===Me.isPresenting,r=null!==w&&(null===A||n)&&w.begin(E,A);if(!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0!==Me.enabled||!0!==Me.isPresenting||null!==w&&!1!==w.isCompositing()||(!0===Me.cameraAutoUpdate&&Me.updateCamera(t),t=Me.getCamera()),!0===e.isScene&&e.onBeforeRender(E,e,t,A),b=fe.get(e,x.length),b.init(t),x.push(b),X.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),G.setFromProjectionMatrix(X,GS,t.reversedDepth),q=this.localClippingEnabled,W=pe.init(this.clippingPlanes,q),_=de.get(e,S.length),_.init(),S.push(_),!0===Me.enabled&&!0===Me.isPresenting){const e=E.xr.getDepthSensingMesh();null!==e&&Oe(e,t,-1/0,E.sortObjects)}Oe(e,t,0,E.sortObjects),_.finish(),!0===E.sortObjects&&_.sort(z,B),Q=!1===Me.enabled||!1===Me.isPresenting||!1===Me.hasDepthSensing(),Q&&ge.addToRenderList(_,e),this.info.render.frame++,!0===W&&pe.beginShadows();const i=b.state.shadowsArray;me.render(i,e,t),!0===W&&pe.endShadows(),!0===this.info.autoReset&&this.info.reset();if(!1===(r&&w.hasRenderPass())){const n=_.opaque,r=_.transmissive;if(b.setupLights(),t.isArrayCamera){const i=t.cameras;if(r.length>0)for(let t=0,a=i.length;t<a;t++){Fe(n,r,e,i[t])}Q&&ge.render(e);for(let t=0,n=i.length;t<n;t++){const n=i[t];Ue(_,e,n,n.viewport)}}else r.length>0&&Fe(n,r,e,t),Q&&ge.render(e),Ue(_,e,t)}null!==A&&0===C&&(ie.updateMultisampleRenderTarget(A),ie.updateRenderTargetMipmap(A)),r&&w.end(E),!0===e.isScene&&e.onAfterRender(E,e,t),Se.resetDefaultState(),I=-1,R=null,x.pop(),x.length>0?(b=x[x.length-1],!0===W&&pe.setGlobalState(E.clippingPlanes,b.state.camera)):b=null,S.pop(),_=S.length>0?S[S.length-1]:null},this.getActiveCubeFace=function(){return M},this.getActiveMipmapLevel=function(){return C},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(e,t,n){const r=re.get(e);r.__autoAllocateDepthBuffer=!1===e.resolveDepthBuffer,!1===r.__autoAllocateDepthBuffer&&(r.__useRenderToTexture=!1),re.get(e.texture).__webglTexture=t,re.get(e.depthTexture).__webglTexture=r.__autoAllocateDepthBuffer?void 0:n,r.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(e,t){const n=re.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t};const Ge=we.createFramebuffer();this.setRenderTarget=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;A=e,M=t,C=n;let r=null,i=!1,a=!1;if(e){const s=re.get(e);if(void 0!==s.__useDefaultFramebuffer)return te.bindFramebuffer(we.FRAMEBUFFER,s.__webglFramebuffer),P.copy(e.viewport),N.copy(e.scissor),k=e.scissorTest,te.viewport(P),te.scissor(N),te.setScissorTest(k),void(I=-1);if(void 0===s.__webglFramebuffer)ie.setupRenderTarget(e);else if(s.__hasExternalTextures)ie.rebindTextures(e,re.get(e.texture).__webglTexture,re.get(e.depthTexture).__webglTexture);else if(e.depthBuffer){const t=e.depthTexture;if(s.__boundDepthTexture!==t){if(null!==t&&re.has(t)&&(e.width!==t.image.width||e.height!==t.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");ie.setupDepthRenderbuffer(e)}}const o=e.texture;(o.isData3DTexture||o.isDataArrayTexture||o.isCompressedArrayTexture)&&(a=!0);const l=re.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=Array.isArray(l[t])?l[t][n]:l[t],i=!0):r=e.samples>0&&!1===ie.useMultisampledRTT(e)?re.get(e).__webglMultisampledFramebuffer:Array.isArray(l)?l[n]:l,P.copy(e.viewport),N.copy(e.scissor),k=e.scissorTest}else P.copy(V).multiplyScalar(F).floor(),N.copy(H).multiplyScalar(F).floor(),k=j;0!==n&&(r=Ge);if(te.bindFramebuffer(we.FRAMEBUFFER,r)&&te.drawBuffers(e,r),te.viewport(P),te.scissor(N),te.setScissorTest(k),i){const r=re.get(e.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,n)}else if(a){const r=t;for(let t=0;t<e.textures.length;t++){const i=re.get(e.textures[t]);we.framebufferTextureLayer(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0+t,i.__webglTexture,n,r)}}else if(null!==e&&0!==n){const t=re.get(e.texture);we.framebufferTexture2D(we.FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,t.__webglTexture,n)}I=-1},this.readRenderTargetPixels=function(e,t,n,r,i,a,s){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)return void ox("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=re.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){te.bindFramebuffer(we.FRAMEBUFFER,l);try{const s=e.textures[o],l=s.format,c=s.type;if(!ee.textureFormatReadable(l))return void ox("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!ee.textureTypeReadable(c))return void ox("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&(e.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+o),we.readPixels(t,n,r,i,be.convert(l),be.convert(c),a))}finally{const e=null!==A?re.get(A).__webglFramebuffer:null;te.bindFramebuffer(we.FRAMEBUFFER,e)}}},this.readRenderTargetPixelsAsync=async function(e,t,n,r,i,a,s){let o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;if(!e||!e.isWebGLRenderTarget)throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let l=re.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==s&&(l=l[s]),l){if(t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i){te.bindFramebuffer(we.FRAMEBUFFER,l);const s=e.textures[o],c=s.format,u=s.type;if(!ee.textureFormatReadable(c))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ee.textureTypeReadable(u))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const h=we.createBuffer();we.bindBuffer(we.PIXEL_PACK_BUFFER,h),we.bufferData(we.PIXEL_PACK_BUFFER,a.byteLength,we.STREAM_READ),e.textures.length>1&&we.readBuffer(we.COLOR_ATTACHMENT0+o),we.readPixels(t,n,r,i,be.convert(c),be.convert(u),0);const d=null!==A?re.get(A).__webglFramebuffer:null;te.bindFramebuffer(we.FRAMEBUFFER,d);const f=we.fenceSync(we.SYNC_GPU_COMMANDS_COMPLETE,0);return we.flush(),await function(e,t,n){return new Promise(function(r,i){setTimeout(function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,n);break;default:r()}},n)})}(we,f,4),we.bindBuffer(we.PIXEL_PACK_BUFFER,h),we.getBufferSubData(we.PIXEL_PACK_BUFFER,0,a),we.deleteBuffer(h),we.deleteSync(f),a}throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=Math.pow(2,-n),i=Math.floor(e.image.width*r),a=Math.floor(e.image.height*r),s=null!==t?t.x:0,o=null!==t?t.y:0;ie.setTexture2D(e,0),we.copyTexSubImage2D(we.TEXTURE_2D,n,0,0,s,o,i,a),te.unbindTexture()};const We=we.createFramebuffer(),qe=we.createFramebuffer();this.copyTextureToTexture=function(e,t){let n,r,i,a,s,o,l,c,u,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;null===p&&(0!==f?(lx("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),p=f,f=0):p=0);const m=e.isCompressedTexture?e.mipmaps[p]:e.image;if(null!==h)n=h.max.x-h.min.x,r=h.max.y-h.min.y,i=h.isBox3?h.max.z-h.min.z:1,a=h.min.x,s=h.min.y,o=h.isBox3?h.min.z:0;else{const t=Math.pow(2,-f);n=Math.floor(m.width*t),r=Math.floor(m.height*t),i=e.isDataArrayTexture?m.depth:e.isData3DTexture?Math.floor(m.depth*t):1,a=0,s=0,o=0}null!==d?(l=d.x,c=d.y,u=d.z):(l=0,c=0,u=0);const g=be.convert(t.format),v=be.convert(t.type);let y;t.isData3DTexture?(ie.setTexture3D(t,0),y=we.TEXTURE_3D):t.isDataArrayTexture||t.isCompressedArrayTexture?(ie.setTexture2DArray(t,0),y=we.TEXTURE_2D_ARRAY):(ie.setTexture2D(t,0),y=we.TEXTURE_2D),we.pixelStorei(we.UNPACK_FLIP_Y_WEBGL,t.flipY),we.pixelStorei(we.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),we.pixelStorei(we.UNPACK_ALIGNMENT,t.unpackAlignment);const _=we.getParameter(we.UNPACK_ROW_LENGTH),b=we.getParameter(we.UNPACK_IMAGE_HEIGHT),S=we.getParameter(we.UNPACK_SKIP_PIXELS),x=we.getParameter(we.UNPACK_SKIP_ROWS),w=we.getParameter(we.UNPACK_SKIP_IMAGES);we.pixelStorei(we.UNPACK_ROW_LENGTH,m.width),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,m.height),we.pixelStorei(we.UNPACK_SKIP_PIXELS,a),we.pixelStorei(we.UNPACK_SKIP_ROWS,s),we.pixelStorei(we.UNPACK_SKIP_IMAGES,o);const E=e.isDataArrayTexture||e.isData3DTexture,T=t.isDataArrayTexture||t.isData3DTexture;if(e.isDepthTexture){const h=re.get(e),d=re.get(t),m=re.get(h.__renderTarget),g=re.get(d.__renderTarget);te.bindFramebuffer(we.READ_FRAMEBUFFER,m.__webglFramebuffer),te.bindFramebuffer(we.DRAW_FRAMEBUFFER,g.__webglFramebuffer);for(let v=0;v<i;v++)E&&(we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,re.get(e).__webglTexture,f,o+v),we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,re.get(t).__webglTexture,p,u+v)),we.blitFramebuffer(a,s,n,r,l,c,n,r,we.DEPTH_BUFFER_BIT,we.NEAREST);te.bindFramebuffer(we.READ_FRAMEBUFFER,null),te.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else if(0!==f||e.isRenderTargetTexture||re.has(e)){const h=re.get(e),d=re.get(t);te.bindFramebuffer(we.READ_FRAMEBUFFER,We),te.bindFramebuffer(we.DRAW_FRAMEBUFFER,qe);for(let e=0;e<i;e++)E?we.framebufferTextureLayer(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,h.__webglTexture,f,o+e):we.framebufferTexture2D(we.READ_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,h.__webglTexture,f),T?we.framebufferTextureLayer(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,d.__webglTexture,p,u+e):we.framebufferTexture2D(we.DRAW_FRAMEBUFFER,we.COLOR_ATTACHMENT0,we.TEXTURE_2D,d.__webglTexture,p),0!==f?we.blitFramebuffer(a,s,n,r,l,c,n,r,we.COLOR_BUFFER_BIT,we.NEAREST):T?we.copyTexSubImage3D(y,p,l,c,u+e,a,s,n,r):we.copyTexSubImage2D(y,p,l,c,a,s,n,r);te.bindFramebuffer(we.READ_FRAMEBUFFER,null),te.bindFramebuffer(we.DRAW_FRAMEBUFFER,null)}else T?e.isDataTexture||e.isData3DTexture?we.texSubImage3D(y,p,l,c,u,n,r,i,g,v,m.data):t.isCompressedArrayTexture?we.compressedTexSubImage3D(y,p,l,c,u,n,r,i,g,m.data):we.texSubImage3D(y,p,l,c,u,n,r,i,g,v,m):e.isDataTexture?we.texSubImage2D(we.TEXTURE_2D,p,l,c,n,r,g,v,m.data):e.isCompressedTexture?we.compressedTexSubImage2D(we.TEXTURE_2D,p,l,c,m.width,m.height,g,m.data):we.texSubImage2D(we.TEXTURE_2D,p,l,c,n,r,g,v,m);we.pixelStorei(we.UNPACK_ROW_LENGTH,_),we.pixelStorei(we.UNPACK_IMAGE_HEIGHT,b),we.pixelStorei(we.UNPACK_SKIP_PIXELS,S),we.pixelStorei(we.UNPACK_SKIP_ROWS,x),we.pixelStorei(we.UNPACK_SKIP_IMAGES,w),0===p&&t.generateMipmaps&&we.generateMipmap(y),te.unbindTexture()},this.initRenderTarget=function(e){void 0===re.get(e).__webglFramebuffer&&ie.setupRenderTarget(e)},this.initTexture=function(e){e.isCubeTexture?ie.setTextureCube(e,0):e.isData3DTexture?ie.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?ie.setTexture2DArray(e,0):ie.setTexture2D(e,0),te.unbindTexture()},this.resetState=function(){M=0,C=0,A=null,te.reset(),Se.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return GS}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Px._getDrawingBufferColorSpace(e),t.unpackColorSpace=Px._getUnpackColorSpace()}}var XL=n(443);const YL=e=>{let t;const n=new Set,r=(e,r)=>{const i="function"===typeof e?e(t):e;if(!Object.is(i,t)){const e=t;t=(null!=r?r:"object"!==typeof i||null===i)?i:Object.assign({},t,i),n.forEach(n=>n(t,e))}},i=()=>t,a={setState:r,getState:i,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(r,i,a);return a},{useSyncExternalStoreWithSelector:KL}=XL,JL=e=>e;const QL=(e,t)=>{const n=(e=>e?YL(e):YL)(e),r=function(e){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JL,n=arguments.length>2?arguments[2]:void 0;const r=KL(e.subscribe,e.getState,e.getInitialState,t,n);return i.useDebugValue(r),r}(n,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:t)};return Object.assign(r,n),r},ZL=[];function $L(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t)=>e===t;if(e===t)return!0;if(!e||!t)return!1;const r=e.length;if(t.length!==r)return!1;for(let i=0;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}function eD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};null===t&&(t=[e]);for(const s of ZL)if($L(t,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!n)throw s.promise}const i={keys:t,equal:r.equal,remove:()=>{const e=ZL.indexOf(i);-1!==e&&ZL.splice(e,1)},promise:(a=e,"object"===typeof a&&"function"===typeof a.then?e:e(...t)).then(e=>{i.response=e,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(e=>i.error=e)};var a;if(ZL.push(i),!n)throw i.promise}var tD=n(16),nD=n.n(tD),rD=n(784);(()=>{var e,t;return"undefined"!=typeof window&&((null==(e=window.document)?void 0:e.createElement)||"ReactNative"===(null==(t=window.navigator)?void 0:t.product))})()?i.useLayoutEffect:i.useEffect;function iD(e,t,n){if(!e)return;if(!0===n(e))return e;let r=t?e.return:e.child;for(;r;){const e=iD(r,t,n);if(e)return e;r=t?null:r.sibling}}function aD(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}const sD=aD(i.createContext(null));class oD extends i.Component{render(){return i.createElement(sD.Provider,{value:this._reactInternals},this.props.children)}}function lD(){const e=i.useContext(sD);if(null===e)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=i.useId();return i.useMemo(()=>{for(const n of[e,null==e?void 0:e.alternate]){if(!n)continue;const e=iD(n,!1,e=>{let n=e.memoizedState;for(;n;){if(n.memoizedState===t)return!0;n=n.next}});if(e)return e}},[e,t])}const cD=Symbol.for("react.context"),uD=e=>null!==e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===cD;function hD(){const e=function(){const e=lD(),[t]=i.useState(()=>new Map);t.clear();let n=e;for(;n;){const e=n.type;uD(e)&&e!==sD&&!t.has(e)&&t.set(e,i.use(aD(e))),n=n.return}return t}();return i.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>r=>i.createElement(t,null,i.createElement(n.Provider,d(d({},r),{},{value:e.get(n)}))),e=>i.createElement(oD,d({},e))),[e])}const dD=["params"];function fD(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}a.act;const pD=e=>e&&e.isOrthographicCamera,mD=e=>null!=e&&("string"===typeof e||"number"===typeof e||e.isColor),gD=((e,t)=>"undefined"!==typeof window&&((null==(e=window.document)?void 0:e.createElement)||"ReactNative"===(null==(t=window.navigator)?void 0:t.product)))()?i.useLayoutEffect:i.useEffect;function vD(e){const t=i.useRef(e);return gD(()=>{t.current=e},[e]),t}function yD(e){let{set:t}=e;return gD(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}const _D=(e=>((e=class extends i.Component{constructor(){super(...arguments),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}).getDerivedStateFromError=()=>({error:!0}),e))();function bD(e){var t;const n="undefined"!==typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function SD(e){var t;return null==(t=e.__r3f)?void 0:t.root.getState()}const xD={obj:e=>e===Object(e)&&!xD.arr(e)&&"function"!==typeof e,fun:e=>"function"===typeof e,str:e=>"string"===typeof e,num:e=>"number"===typeof e,boo:e=>"boolean"===typeof e,und:e=>void 0===e,nul:e=>null===e,arr:e=>Array.isArray(e),equ(e,t){let{arrays:n="shallow",objects:r="reference",strict:i=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(typeof e!==typeof t||!!e!==!!t)return!1;if(xD.str(e)||xD.num(e)||xD.boo(e))return e===t;const a=xD.obj(e);if(a&&"reference"===r)return e===t;const s=xD.arr(e);if(s&&"reference"===n)return e===t;if((s||a)&&e===t)return!0;let o;for(o in e)if(!(o in t))return!1;if(a&&"shallow"===n&&"shallow"===r){for(o in i?t:e)if(!xD.equ(e[o],t[o],{strict:i,objects:"reference"}))return!1}else for(o in i?t:e)if(e[o]!==t[o])return!1;if(xD.und(o)){if(s&&0===e.length&&0===t.length)return!0;if(a&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function wD(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material),e.isMesh&&!t.meshes[e.name]&&(t.meshes[e.name]=e)}),t}const ED=["children","key","ref"];function TD(e){const t={};for(const n in e)ED.includes(n)||(t[n]=e[n]);return t}function MD(e,t,n,r){const i=e;let a=null==i?void 0:i.__r3f;return a||(a={root:t,type:n,parent:null,children:[],props:TD(r),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=a)),a}function CD(e,t){if(!t.includes("-"))return{root:e,key:t,target:e[t]};if(t in e)return{root:e,key:t,target:e[t]};let n=e;const r=t.split("-");for(const i of r){if("object"!==typeof n||null===n){if(void 0!==n){return{root:n,key:r.slice(r.indexOf(i)).join("-"),target:void 0}}return{root:e,key:t,target:void 0}}e=n,n=n[t=i]}return{root:e,key:t,target:n}}const AD=/-\d+$/;function ID(e,t){if(xD.str(t.props.attach)){if(AD.test(t.props.attach)){const n=t.props.attach.replace(AD,""),{root:r,key:i}=CD(e.object,n);Array.isArray(r[i])||(r[i]=[])}const{root:n,key:r}=CD(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else xD.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function RD(e,t){if(xD.str(t.props.attach)){const{root:n,key:r}=CD(e.object,t.props.attach),i=t.previousAttach;void 0===i?delete n[r]:n[r]=i}else null==t.previousAttach||t.previousAttach(e.object,t.object);delete t.previousAttach}const PD=[...ED,"args","dispose","attach","object","onUpdate","dispose"],ND=new Map;function kD(e){let t=ND.get(e.constructor);try{t||(t=new e.constructor,ND.set(e.constructor,t))}catch(cU){}return t}const LD=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],DD=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function OD(e,t){var n;const r=e.__r3f,i=r&&fD(r).getState(),a=null==r?void 0:r.eventCount;for(const o in t){let n=t[o];if(PD.includes(o))continue;if(r&&DD.test(o)){"function"===typeof n?r.handlers[o]=n:delete r.handlers[o],r.eventCount=Object.keys(r.handlers).length;continue}if(void 0===n)continue;let{root:a,key:l,target:c}=CD(e,o);if(void 0===c&&("object"!==typeof a||null===a))throw Error('R3F: Cannot set "'.concat(o,'". Ensure it is an object before setting "').concat(l,'".'));if(c instanceof kw&&n instanceof kw)c.mask=n.mask;else if(c instanceof pE&&mD(n))c.set(n);else if(null!==c&&"object"===typeof c&&"function"===typeof c.set&&"function"===typeof c.copy&&null!=n&&n.constructor&&c.constructor===n.constructor)c.copy(n);else if(null!==c&&"object"===typeof c&&"function"===typeof c.set&&Array.isArray(n))"function"===typeof c.fromArray?c.fromArray(n):c.set(...n);else if(null!==c&&"object"===typeof c&&"function"===typeof c.set&&"number"===typeof n)"function"===typeof c.setScalar?c.setScalar(n):c.set(n);else{var s;a[l]=n,i&&!i.linear&&LD.includes(l)&&null!=(s=a[l])&&s.isTexture&&a[l].format===G_&&a[l].type===I_&&(a[l].colorSpace=nS)}}if(null!=r&&r.parent&&null!=i&&i.internal&&null!=(n=r.object)&&n.isObject3D&&a!==r.eventCount){const e=r.object,t=i.internal.interaction.indexOf(e);t>-1&&i.internal.interaction.splice(t,1),r.eventCount&&null!==e.raycast&&i.internal.interaction.push(e)}return r&&void 0===r.props.attach&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&UD(r),e}function UD(e){var t;if(!e.parent)return;null==e.props.onUpdate||e.props.onUpdate(e.object);const n=null==(t=e.root)||null==t.getState?void 0:t.getState();n&&0===n.internal.frames&&n.invalidate()}function FD(e,t){e.manual||(pD(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const zD=e=>null==e?void 0:e.isObject3D;function BD(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function VD(e,t,n,r){const i=n.get(t);i&&(n.delete(t),0===n.size&&(e.delete(r),i.target.releasePointerCapture(r)))}function HD(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var n;return null==(n=e.__r3f)?void 0:n.handlers["onPointer"+t]}))}function n(t){const{internal:n}=e.getState();for(const e of n.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){const r=e.eventObject.__r3f;if(n.hovered.delete(BD(e)),null!=r&&r.eventCount){const n=r.handlers,i=d(d({},e),{},{intersections:t});null==n.onPointerOut||n.onPointerOut(i),null==n.onPointerLeave||n.onPointerLeave(i)}}}function r(e,t){for(let n=0;n<t.length;n++){const r=t[n].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>n([]);case"onLostPointerCapture":return t=>{const{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),n([]))})}}return function(a){const{onPointerMissed:s,internal:o}=e.getState();o.lastEvent.current=a;const l="onPointerMove"===i,c="onClick"===i||"onContextMenu"===i||"onDoubleClick"===i,u=function(t,n){const r=e.getState(),i=new Set,a=[],s=n?n(r.internal.interaction):r.internal.interaction;for(let e=0;e<s.length;e++){const t=SD(s[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let o=s.flatMap(function(e){const n=SD(e);return n&&n.events.enabled&&null!==n.raycaster.camera?(void 0===n.raycaster.camera&&(null==n.events.compute||n.events.compute(t,n,null==(r=n.previousRoot)?void 0:r.getState()),void 0===n.raycaster.camera&&(n.raycaster.camera=null)),n.raycaster.camera?n.raycaster.intersectObject(e,!0):[]):[];var r}).sort((e,t)=>{const n=SD(e.object),r=SD(t.object);return n&&r&&r.events.priority-n.events.priority||e.distance-t.distance}).filter(e=>{const t=BD(e);return!i.has(t)&&(i.add(t),!0)});r.events.filter&&(o=r.events.filter(o,r));for(const e of o){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&a.push(d(d({},e),{},{eventObject:t})),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())i.has(BD(e.intersection))||a.push(e.intersection);return a}(a,l?t:void 0),h=c?function(t){const{internal:n}=e.getState(),r=t.offsetX-n.initialClick[0],i=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+i*i))}(a):0;"onPointerDown"===i&&(o.initialClick=[a.offsetX,a.offsetY],o.initialHits=u.map(e=>e.eventObject)),c&&!u.length&&h<=2&&(r(a,o.interaction),s&&s(a)),l&&n(u),function(e,t,r,i){if(e.length){const a={stopped:!1};for(const s of e){let o=SD(s.object);if(o||s.object.traverseAncestors(e=>{const t=SD(e);if(t)return o=t,!1}),o){const{raycaster:l,pointer:c,camera:u,internal:h}=o,f=new wx(c.x,c.y,0).unproject(u),p=e=>{var t,n;return null!=(t=null==(n=h.capturedMap.get(e))?void 0:n.has(s.eventObject))&&t},m=e=>{const n={intersection:s,target:t.target};h.capturedMap.has(e)?h.capturedMap.get(e).set(s.eventObject,n):h.capturedMap.set(e,new Map([[s.eventObject,n]])),t.target.setPointerCapture(e)},g=e=>{const t=h.capturedMap.get(e);t&&VD(h.capturedMap,s.eventObject,t,e)};let v={};for(let e in t){let n=t[e];"function"!==typeof n&&(v[e]=n)}let y=d(d(d({},s),v),{},{pointer:c,intersections:e,stopped:a.stopped,delta:r,unprojectedPoint:f,ray:l.ray,camera:u,stopPropagation(){const r="pointerId"in t&&h.capturedMap.get(t.pointerId);(!r||r.has(s.eventObject))&&(y.stopped=a.stopped=!0,h.hovered.size&&Array.from(h.hovered.values()).find(e=>e.eventObject===s.eventObject))&&n([...e.slice(0,e.indexOf(s)),s])},target:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:g},currentTarget:{hasPointerCapture:p,setPointerCapture:m,releasePointerCapture:g},nativeEvent:t});if(i(y),!0===a.stopped)break}}}}(u,a,h,function(e){const t=e.eventObject,n=t.__r3f;if(null==n||!n.eventCount)return;const s=n.handlers;if(l){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){const t=BD(e),n=o.hovered.get(t);n?n.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{const n=s[i];n?c&&!o.initialHits.includes(t)||(r(a,o.interaction.filter(e=>!o.initialHits.includes(e))),n(e)):c&&o.initialHits.includes(t)&&r(a,o.interaction.filter(e=>!o.initialHits.includes(e)))}})}}}}const jD=e=>!(null==e||!e.render),GD=i.createContext(null),WD=(e,t)=>{const n=(r=(n,r)=>{const a=new wx,s=new wx,o=new wx;function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r().size;const{width:i,height:l,top:c,left:u}=n,h=i/l;t.isVector3?o.copy(t):o.set(...t);const d=e.getWorldPosition(a).distanceTo(o);if(pD(e))return{width:i/e.zoom,height:l/e.zoom,top:c,left:u,factor:1,distance:d,aspect:h};{const t=e.fov*Math.PI/180,n=2*Math.tan(t/2)*d,r=n*(i/l);return{width:r,height:n,top:c,left:u,factor:i/r,distance:d,aspect:h}}}let c;const u=e=>n(t=>({performance:d(d({},t.performance),{},{current:e})})),h=new Sx,f={set:n,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return e(r(),t)},advance:(e,n)=>t(e,n,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new xR,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const e=r();c&&clearTimeout(c),e.performance.current!==e.performance.min&&u(e.performance.min),c=setTimeout(()=>u(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:e=>n(t=>d(d({},t),{},{events:d(d({},t.events),e)})),setSize:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const o=r().camera,c={width:e,height:t,top:i,left:a};n(e=>({size:c,viewport:d(d({},e.viewport),l(o,s,c))}))},setDpr:e=>n(t=>{const n=bD(e);return{viewport:d(d({},t.viewport),{},{dpr:n,initialDpr:t.viewport.initialDpr||n})}}),setFrameloop:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"always";const t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),n(()=>({frameloop:e}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:i.createRef(),active:!1,frames:0,priority:0,subscribe:(e,t,n)=>{const i=r().internal;return i.priority=i.priority+(t>0?1:0),i.subscribers.push({ref:e,priority:t,store:n}),i.subscribers=i.subscribers.sort((e,t)=>e.priority-t.priority),()=>{const n=r().internal;null!=n&&n.subscribers&&(n.priority=n.priority-(t>0?1:0),n.subscribers=n.subscribers.filter(t=>t.ref!==e))}}}};return f},r?QL(r,a):QL);var r,a;const s=n.getState();let o=s.size,l=s.viewport.dpr,c=s.camera;return n.subscribe(()=>{const{camera:e,size:t,viewport:r,gl:i,set:a}=n.getState();if(t.width!==o.width||t.height!==o.height||r.dpr!==l){o=t,l=r.dpr,FD(e,t),r.dpr>0&&i.setPixelRatio(r.dpr);const n="undefined"!==typeof HTMLCanvasElement&&i.domElement instanceof HTMLCanvasElement;i.setSize(t.width,t.height,n)}e!==c&&(c=e,a(t=>({viewport:d(d({},t.viewport),t.viewport.getCurrentViewport(e))})))}),n.subscribe(t=>e(t)),n};function qD(){const e=i.useContext(GD);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function XD(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e=>e,t=arguments.length>1?arguments[1]:void 0;return qD()(e,t)}function YD(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=qD(),r=n.getState().internal.subscribe,i=vD(e);return gD(()=>r(i,t,n),[t,r,n]),null}const KD=new WeakMap;function JD(e,t){return function(n){let r;(e=>{var t;return"function"===typeof e&&(null==e||null==(t=e.prototype)?void 0:t.constructor)===e})(n)?(r=KD.get(n),r||(r=new n,KD.set(n,r))):r=n,e&&e(r);for(var i=arguments.length,a=new Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];return Promise.all(a.map(e=>new Promise((n,i)=>r.load(e,e=>{zD(null==e?void 0:e.scene)&&Object.assign(e,wD(e.scene)),n(e)},t,t=>i(new Error("Could not load ".concat(e,": ").concat(null==t?void 0:t.message)))))))}}function QD(e,t,n,r){const i=Array.isArray(t)?t:[t],a=((e,t,n)=>eD(e,t,!1,n))(JD(n,r),[e,...i],{equal:xD.equ});return Array.isArray(t)?a:a[0]}QD.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return((e,t,n)=>{eD(e,t,!0,n)})(JD(n),[e,...r])},QD.clear=function(e,t){return(e=>{if(void 0===e||0===e.length)ZL.splice(0,ZL.length);else{const t=ZL.find(t=>$L(e,t.keys,t.equal));t&&t.remove()}})([e,...Array.isArray(t)?t:[t]])};function ZD(e){const t=nD()(e);return t.injectIntoDevTools(),t}const $D={},eO=/^three(?=[A-Z])/,tO=e=>"".concat(e[0].toUpperCase()).concat(e.slice(1));let nO=0;function rO(e,t){const n=tO(e),r=$D[n];if("primitive"!==e&&!r)throw new Error("R3F: ".concat(n," is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively"));if("primitive"===e&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(void 0!==t.args&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function iO(e){var t;e.isHidden&&(e.props.attach&&null!=(t=e.parent)&&t.object?ID(e.parent,e):zD(e.object)&&!1!==e.props.visible&&(e.object.visible=!0),e.isHidden=!1,UD(e))}function aO(e,t,n){const r=t.root.getState();if(e.parent||e.object===r.scene){if(!t.object){var i,a;const e=$D[tO(t.type)];t.object=null!=(i=t.props.object)?i:new e(...null!=(a=t.props.args)?a:[]),t.object.__r3f=t}if(OD(t.object,t.props),t.props.attach)ID(e,t);else if(zD(t.object)&&zD(e.object)){const r=e.object.children.indexOf(null==n?void 0:n.object);if(n&&-1!==r){const n=e.object.children.indexOf(t.object);if(-1!==n){e.object.children.splice(n,1);const i=n<r?r-1:r;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(r,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const e of t.children)aO(t,e);UD(t)}}function sO(e,t){t&&(t.parent=e,e.children.push(t),aO(e,t))}function oO(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);-1!==r?e.children.splice(r,0,t):e.children.push(t),aO(e,t,n)}function lO(e){if("function"===typeof e.dispose){const t=()=>{try{e.dispose()}catch(t){}};"undefined"!==typeof IS_REACT_ACT_ENVIRONMENT?t():(0,rD.unstable_scheduleCallback)(rD.unstable_IdlePriority,t)}}function cO(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);-1!==r&&e.children.splice(r,1),t.props.attach?RD(e,t):zD(t.object)&&zD(e.object)&&(e.object.remove(t.object),function(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(e=>e!==t),n.initialHits=n.initialHits.filter(e=>e!==t),n.hovered.forEach((e,r)=>{e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}),n.capturedMap.forEach((e,r)=>{VD(n.capturedMap,t,e,r)})}(fD(t),t.object));const i=null!==t.props.dispose&&!1!==n;for(let a=t.children.length-1;a>=0;a--){cO(t,t.children[a],i)}t.children.length=0,delete t.object.__r3f,i&&"primitive"!==t.type&&"Scene"!==t.object.type&&lO(t.object),void 0===n&&UD(t)}function uO(e,t){for(const n of[e,e.alternate])if(null!==n)if("function"===typeof n.ref){null==n.refCleanup||n.refCleanup();const e=n.ref(t);"function"===typeof e&&(n.refCleanup=e)}else n.ref&&(n.ref.current=t)}const hO=[];const dO=()=>{},fO={};let pO=0;const mO=ZD({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:function(e,t,n){var r;return rO(e=tO(e)in $D?e:e.replace(eO,""),t),"primitive"===e&&null!=(r=t.object)&&r.__r3f&&delete t.object.__r3f,MD(t.object,n,e,t)},removeChild:cO,appendChild:sO,appendInitialChild:sO,insertBefore:oO,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&sO(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;t&&n&&cO(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;t&&n&&r&&oO(r,t,n)},getRootHostContext:()=>fO,getChildHostContext:()=>fO,commitUpdate(e,t,n,r,i){var a,s,o;rO(t,r);let l=!1;if(("primitive"===e.type&&n.object!==r.object||(null==(a=r.args)?void 0:a.length)!==(null==(s=n.args)?void 0:s.length)||null!=(o=r.args)&&o.some((e,t)=>{var r;return e!==(null==(r=n.args)?void 0:r[t])}))&&(l=!0),l)hO.push([e,d({},r),i]);else{const t=function(e,t){const n={};for(const r in t)if(!PD.includes(r)&&!xD.equ(t[r],e.props[r])){n[r]=t[r];for(const e in t)e.startsWith("".concat(r,"-"))&&(n[e]=t[e])}for(const r in e.props){if(PD.includes(r)||t.hasOwnProperty(r))continue;const{root:i,key:a}=CD(e.object,r);if(i.constructor&&0===i.constructor.length){const e=kD(i);xD.und(e)||(n[a]=e[a])}else n[a]=0}return n}(e,r);Object.keys(t).length&&(Object.assign(e.props,t),OD(e.object,t))}(null===i.sibling||0===(4&i.flags))&&function(){for(const[n]of hO){const e=n.parent;if(e){n.props.attach?RD(e,n):zD(n.object)&&zD(e.object)&&e.object.remove(n.object);for(const e of n.children)e.props.attach?RD(n,e):zD(e.object)&&zD(n.object)&&n.object.remove(e.object)}n.isHidden&&iO(n),n.object.__r3f&&delete n.object.__r3f,"primitive"!==n.type&&lO(n.object)}for(const[n,r,i]of hO){n.props=r;const a=n.parent;if(a){var e,t;const r=$D[tO(n.type)];n.object=null!=(e=n.props.object)?e:new r(...null!=(t=n.props.args)?t:[]),n.object.__r3f=n,uO(i,n.object),OD(n.object,n.props),n.props.attach?ID(a,n):zD(n.object)&&zD(a.object)&&a.object.add(n.object);for(const e of n.children)e.props.attach?ID(n,e):zD(e.object)&&zD(n.object)&&n.object.add(e.object);UD(n)}}hO.length=0}()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>null==e?void 0:e.object,prepareForCommit:()=>null,preparePortalMount:e=>MD(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:function(e){var t;e.isHidden||(e.props.attach&&null!=(t=e.parent)&&t.object?RD(e.parent,e):zD(e.object)&&(e.object.visible=!1),e.isHidden=!0,UD(e))},unhideInstance:iO,createTextInstance:dO,hideTextInstance:dO,unhideTextInstance:dO,scheduleTimeout:"function"===typeof setTimeout?setTimeout:void 0,cancelTimeout:"function"===typeof clearTimeout?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:i.createContext(null),setCurrentUpdatePriority(e){pO=e},getCurrentUpdatePriority:()=>pO,resolveUpdatePriority(){var e;if(0!==pO)return pO;switch("undefined"!==typeof window&&(null==(e=window.event)?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return ny.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return ny.ContinuousEventPriority;default:return ny.DefaultEventPriority}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:"9.4.2"}),gO=new Map,vO={objects:"shallow",strict:!1};function yO(e){const t=gO.get(e),n=null==t?void 0:t.fiber,r=null==t?void 0:t.store;t&&console.warn("R3F.createRoot should only be called once!");const i="function"===typeof reportError?reportError:console.error,a=r||WD(DO,OO),s=n||mO.createContainer(a,ny.ConcurrentRoot,null,!1,null,"",i,i,i,null);let l,c;t||gO.set(e,{fiber:s,store:a});let u=!1,h=null;return{async configure(){let t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h=new Promise(e=>t=e);let{gl:r,size:i,scene:s,events:f,onCreated:p,shadows:m=!1,linear:g=!1,flat:v=!1,legacy:y=!1,orthographic:_=!1,frameloop:b="always",dpr:S=[1,2],performance:x,raycaster:w,camera:E,onPointerMissed:T}=n,M=a.getState(),C=M.gl;if(!M.gl){const t={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},n="function"===typeof r?await r(t):r;C=jD(n)?n:new qL(d(d({},t),r)),M.set({gl:C})}let A=M.raycaster;A||M.set({raycaster:A=new tP});const I=w||{},{params:R}=I,P=o(I,dD);if(xD.equ(P,A,vO)||OD(A,d({},P)),xD.equ(R,A.params,vO)||OD(A,{params:d(d({},A.params),R)}),!M.camera||M.camera===c&&!xD.equ(c,E,vO)){c=E;const e=null==E?void 0:E.isCamera,t=e?E:_?new QI(0,0,0,0,.1,1e3):new pT(75,0,.1,1e3);e||(t.position.z=5,E&&(OD(t,E),t.manual||("aspect"in E||"left"in E||"right"in E||"bottom"in E||"top"in E)&&(t.manual=!0,t.updateProjectionMatrix())),M.camera||null!=E&&E.rotation||t.lookAt(0,0,0)),M.set({camera:t}),A.camera=t}if(!M.scene){let e;null!=s&&s.isScene?(e=s,MD(e,a,"",{})):(e=new ET,MD(e,a,"",{}),s&&OD(e,s)),M.set({scene:e})}f&&!M.events.handlers&&M.set({events:f(a)});const N=function(e,t){if(!t&&"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:t,height:n,top:r,left:i}=e.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:i}}return!t&&"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:d({width:0,height:0,top:0,left:0},t)}(e,i);if(xD.equ(N,M.size,vO)||M.setSize(N.width,N.height,N.top,N.left),S&&M.viewport.dpr!==bD(S)&&M.setDpr(S),M.frameloop!==b&&M.setFrameloop(b),M.onPointerMissed||M.set({onPointerMissed:T}),x&&!xD.equ(x,M.performance,vO)&&M.set(e=>({performance:d(d({},e.performance),x)})),!M.xr){var k;const e=(e,t)=>{const n=a.getState();"never"!==n.frameloop&&OO(e,!0,n,t)},t=()=>{const t=a.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||DO(t)},n={connect(){const e=a.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){const e=a.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"===typeof(null==(k=C.xr)?void 0:k.addEventListener)&&n.connect(),M.set({xr:n})}if(C.shadowMap){const e=C.shadowMap.enabled,t=C.shadowMap.type;if(C.shadowMap.enabled=!!m,xD.boo(m))C.shadowMap.type=dy;else if(xD.str(m)){var L;const e={basic:uy,percentage:hy,soft:dy,variance:fy};C.shadowMap.type=null!=(L=e[m])?L:dy}else xD.obj(m)&&Object.assign(C.shadowMap,m);e===C.shadowMap.enabled&&t===C.shadowMap.type||(C.shadowMap.needsUpdate=!0)}return Px.enabled=!y,u||(C.outputColorSpace=g?rS:nS,C.toneMapping=v?e_:i_),M.legacy!==y&&M.set(()=>({legacy:y})),M.linear!==g&&M.set(()=>({linear:g})),M.flat!==v&&M.set(()=>({flat:v})),!r||xD.fun(r)||jD(r)||xD.equ(r,C,vO)||OD(C,r),l=p,u=!0,t(),this},render(t){return u||h||this.configure(),h.then(()=>{mO.updateContainer((0,Wv.jsx)(_O,{store:a,children:t,onCreated:l,rootElement:e}),s,null,()=>{})}),a},unmount(){bO(e)}}}function _O(e){let{store:t,children:n,onCreated:r,rootElement:i}=e;return gD(()=>{const e=t.getState();e.set(e=>({internal:d(d({},e.internal),{},{active:!0})})),r&&r(e),t.getState().events.connected||null==e.events.connect||e.events.connect(i)},[]),(0,Wv.jsx)(GD.Provider,{value:t,children:n})}function bO(e,t){const n=gO.get(e),r=null==n?void 0:n.fiber;if(r){const i=null==n?void 0:n.store.getState();i&&(i.internal.active=!1),mO.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var n,r,a,s;null==i.events.disconnect||i.events.disconnect(),null==(n=i.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(a=i.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(s=i.gl)&&s.xr&&i.xr.disconnect(),function(e){"Scene"!==e.type&&(null==e.dispose||e.dispose());for(const t in e){const n=e[t];"Scene"!==(null==n?void 0:n.type)&&(null==n||null==n.dispose||n.dispose())}}(i.scene),gO.delete(e),t&&t(e)}catch(cU){}},500)})}}const SO=new Set,xO=new Set,wO=new Set;function EO(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function TO(e,t){switch(e){case"before":return EO(SO,t);case"after":return EO(xO,t);case"tail":return EO(wO,t)}}let MO,CO;function AO(e,t,n){let r=t.clock.getDelta();"never"===t.frameloop&&"number"===typeof e&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),MO=t.internal.subscribers;for(let i=0;i<MO.length;i++)CO=MO[i],CO.ref.current(CO.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}let IO,RO,PO,NO=!1,kO=!1;function LO(e){RO=requestAnimationFrame(LO),NO=!0,IO=0,TO("before",e),kO=!0;for(const n of gO.values()){var t;PO=n.store.getState(),!PO.internal.active||!("always"===PO.frameloop||PO.internal.frames>0)||null!=(t=PO.gl.xr)&&t.isPresenting||(IO+=AO(e,PO))}if(kO=!1,TO("after",e),0===IO)return TO("tail",e),NO=!1,cancelAnimationFrame(RO)}function DO(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;var n;if(!e)return gO.forEach(e=>DO(e.store.getState(),t));null!=(n=e.gl.xr)&&n.isPresenting||!e.internal.active||"never"===e.frameloop||(e.internal.frames=t>1?Math.min(60,e.internal.frames+t):kO?2:1,NO||(NO=!0,requestAnimationFrame(LO)))}function OO(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(t&&TO("before",e),n)AO(e,n,r);else for(const i of gO.values())AO(e,i.store.getState());t&&TO("after",e)}const UO={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function FO(e){const{handlePointer:t}=HD(e);return{priority:1,enabled:!0,compute(e,t,n){t.pointer.set(e.offsetX/t.size.width*2-1,-e.offsetY/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(UO).reduce((e,n)=>d(d({},e),{},{[n]:t(n)}),{}),update:()=>{var t;const{events:n,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=e.getState();if(null==r.disconnect||r.disconnect(),n(e=>({events:d(d({},e.events),{},{connected:t})})),r.handlers)for(const e in r.handlers){const n=r.handlers[e],[i,a]=UO[e];t.addEventListener(i,n,{passive:a})}},disconnect:()=>{const{set:t,events:n}=e.getState();if(n.connected){if(n.handlers)for(const e in n.handlers){const t=n.handlers[e],[r]=UO[e];n.connected.removeEventListener(r,t)}t(e=>({events:d(d({},e.events),{},{connected:void 0})}))}}}}function zO(e,t){let n;return function(){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];window.clearTimeout(n),n=window.setTimeout(()=>e(...i),t)}}function BO(){let{debounce:e,scroll:t,polyfill:n,offsetSize:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1,offsetSize:!1};const a=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=(0,i.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=(0,i.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=e?"number"==typeof e?e:e.scroll:null,u=e?"number"==typeof e?e:e.resize:null,h=(0,i.useRef)(!1);(0,i.useEffect)(()=>(h.current=!0,()=>{h.current=!1}));const[d,f,p]=(0,i.useMemo)(()=>{const e=()=>{if(!l.current.element)return;const{left:e,top:t,width:n,height:i,bottom:a,right:s,x:c,y:u}=l.current.element.getBoundingClientRect(),d={left:e,top:t,width:n,height:i,bottom:a,right:s,x:c,y:u};l.current.element instanceof HTMLElement&&r&&(d.height=l.current.element.offsetHeight,d.width=l.current.element.offsetWidth),Object.freeze(d),h.current&&!jO(l.current.lastBounds,d)&&o(l.current.lastBounds=d)};return[e,u?zO(e,u):e,c?zO(e,c):e]},[o,r,c,u]);function m(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null),l.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",l.current.orientationHandler))}function g(){l.current.element&&(l.current.resizeObserver=new a(p),l.current.resizeObserver.observe(l.current.element),t&&l.current.scrollContainers&&l.current.scrollContainers.forEach(e=>e.addEventListener("scroll",p,{capture:!0,passive:!0})),l.current.orientationHandler=()=>{p()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",l.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",l.current.orientationHandler))}return function(e,t){(0,i.useEffect)(()=>{if(t){const t=e;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[e,t])}(p,!!t),function(e){(0,i.useEffect)(()=>{const t=e;return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[e])}(f),(0,i.useEffect)(()=>{m(),g()},[t,p,f]),(0,i.useEffect)(()=>m,[]),[e=>{!e||e===l.current.element||(m(),l.current.element=e,l.current.scrollContainers=VO(e),g())},s,d]}function VO(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[n,r,i].some(e=>"auto"===e||"scroll"===e)&&t.push(e),[...t,...VO(e.parentElement)]}const HO=["x","y","top","bottom","left","right","width","height"],jO=(e,t)=>HO.every(n=>e[n]===t[n]),GO=["ref","children","fallback","resize","style","gl","events","eventSource","eventPrefix","shadows","linear","flat","legacy","orthographic","frameloop","dpr","performance","raycaster","camera","scene","onPointerMissed","onCreated"];function WO(e){let{ref:t,children:n,fallback:a,resize:s,style:l,gl:c,events:u=FO,eventSource:h,eventPrefix:f,shadows:p,linear:m,flat:g,legacy:v,orthographic:y,frameloop:_,dpr:b,performance:S,raycaster:x,camera:w,scene:E,onPointerMissed:T,onCreated:M}=e,C=o(e,GO);i.useMemo(()=>function(e){if("function"===typeof e){const t="".concat(nO++);return $D[t]=e,t}Object.assign($D,e)}(r),[]);const A=function(){const e=lD(),t=hD();return i.useMemo(()=>n=>{let{children:r}=n;const a=iD(e,!0,e=>e.type===i.StrictMode)?i.StrictMode:i.Fragment;return(0,Wv.jsx)(a,{children:(0,Wv.jsx)(t,{children:r})})},[e,t])}(),[I,R]=BO(d({scroll:!0,debounce:{scroll:50,resize:0}},s)),P=i.useRef(null),N=i.useRef(null);i.useImperativeHandle(t,()=>P.current);const k=vD(T),[L,D]=i.useState(!1),[O,U]=i.useState(!1);if(L)throw L;if(O)throw O;const F=i.useRef(null);gD(()=>{const e=P.current;if(R.width>0&&R.height>0&&e){async function t(){await F.current.configure({gl:c,scene:E,events:u,shadows:p,linear:m,flat:g,legacy:v,orthographic:y,frameloop:_,dpr:b,performance:S,raycaster:x,camera:w,size:R,onPointerMissed:function(){return null==k.current?void 0:k.current(...arguments)},onCreated:e=>{var t;null==e.events.connect||e.events.connect(h?(t=h)&&t.hasOwnProperty("current")?h.current:h:N.current),f&&e.setEvents({compute:(e,t)=>{const n=e[f+"X"],r=e[f+"Y"];t.pointer.set(n/t.size.width*2-1,-r/t.size.height*2+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==M||M(e)}}),F.current.render((0,Wv.jsx)(A,{children:(0,Wv.jsx)(_D,{set:U,children:(0,Wv.jsx)(i.Suspense,{fallback:(0,Wv.jsx)(yD,{set:D}),children:null!=n?n:null})})}))}F.current||(F.current=yO(e)),t()}}),i.useEffect(()=>{const e=P.current;if(e)return()=>bO(e)},[]);const z=h?"none":"auto";return(0,Wv.jsx)("div",d(d({ref:N,style:d({position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:z},l)},C),{},{children:(0,Wv.jsx)("div",{ref:I,style:{width:"100%",height:"100%"},children:(0,Wv.jsx)("canvas",{ref:P,style:{display:"block"},children:a})})}))}function qO(e){return(0,Wv.jsx)(oD,{children:(0,Wv.jsx)(WO,d({},e))})}function XO(){return XO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},XO.apply(null,arguments)}const YO=["samples","depth"];function KO(e,t,n){const r=XD(e=>e.size),a=XD(e=>e.viewport),s="number"===typeof e?e:r.width*a.dpr,l="number"===typeof t?t:r.height*a.dpr,c=("number"===typeof e?n:e)||{},{samples:u=0,depth:h}=c,f=o(c,YO),p=null!==h&&void 0!==h?h:c.depthBuffer,m=i.useMemo(()=>{const e=new Gx(s,l,d({minFilter:E_,magFilter:E_,type:O_},f));return p&&(e.depthTexture=new SC(s,l,D_)),e.samples=u,e},[]);return i.useLayoutEffect(()=>{m.setSize(s,l),u&&(m.samples=u)},[u,m,s,l]),i.useEffect(()=>()=>m.dispose(),[]),m}const JO=["envMap","resolution","frames","makeDefault","children"],QO=i.forwardRef((e,t)=>{let{envMap:n,resolution:r=256,frames:a=1/0,makeDefault:s,children:l}=e,c=o(e,JO);const u=XD(e=>{let{set:t}=e;return t}),h=XD(e=>{let{camera:t}=e;return t}),d=XD(e=>{let{size:t}=e;return t}),f=i.useRef(null);i.useImperativeHandle(t,()=>f.current,[]);const p=i.useRef(null),m=KO(r);i.useLayoutEffect(()=>{c.manual||(f.current.aspect=d.width/d.height)},[d,c]),i.useLayoutEffect(()=>{f.current.updateProjectionMatrix()});let g=0,v=null;const y="function"===typeof l;return YD(e=>{y&&(a===1/0||g<a)&&(p.current.visible=!1,e.gl.setRenderTarget(m),v=e.scene.background,n&&(e.scene.background=n),e.gl.render(e.scene,f.current),e.scene.background=v,e.gl.setRenderTarget(null),p.current.visible=!0,g++)}),i.useLayoutEffect(()=>{if(s){const e=h;return u(()=>({camera:f.current})),()=>u(()=>({camera:e}))}},[f,s,u]),i.createElement(i.Fragment,null,i.createElement("perspectiveCamera",XO({ref:f},c),!y&&l),i.createElement("group",{ref:p},y&&l(m.texture)))}),ZO=["children","enabled","speed","rotationIntensity","floatIntensity","floatingRange","autoInvalidate"],$O=i.forwardRef((e,t)=>{let{children:n,enabled:r=!0,speed:a=1,rotationIntensity:s=1,floatIntensity:l=1,floatingRange:c=[-.1,.1],autoInvalidate:u=!1}=e,h=o(e,ZO);const d=i.useRef(null);i.useImperativeHandle(t,()=>d.current,[]);const f=i.useRef(1e4*Math.random());return YD(e=>{var t,n;if(!r||0===a)return;u&&e.invalidate();const i=f.current+e.clock.elapsedTime;d.current.rotation.x=Math.cos(i/4*a)/8*s,d.current.rotation.y=Math.sin(i/4*a)/8*s,d.current.rotation.z=Math.sin(i/4*a)/20*s;let o=Math.sin(i/4*a)/10;o=bx.mapLinear(o,-.1,.1,null!==(t=null==c?void 0:c[0])&&void 0!==t?t:-.1,null!==(n=null==c?void 0:c[1])&&void 0!==n?n:.1),d.current.position.y=o*l,d.current.updateMatrix()}),i.createElement("group",h,i.createElement("group",{ref:d,matrixAutoUpdate:!1},n))}),eU={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n      varying vec2 vUv;\n\n      void main() {\n\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n      }\n  ",fragmentShader:"\n    uniform sampler2D tDiffuse;\n    uniform float h;\n\n    varying vec2 vUv;\n\n    void main() {\n\n    \tvec4 sum = vec4( 0.0 );\n\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n    \tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n    \tgl_FragColor = sum;\n\n    }\n  "},tU={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n    varying vec2 vUv;\n\n    void main() {\n\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n    }\n  ",fragmentShader:"\n\n  uniform sampler2D tDiffuse;\n  uniform float v;\n\n  varying vec2 vUv;\n\n  void main() {\n\n    vec4 sum = vec4( 0.0 );\n\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n    gl_FragColor = sum;\n\n  }\n  "},nU=["scale","frames","opacity","width","height","blur","near","far","resolution","smooth","color","depthWrite","renderOrder"],rU=i.forwardRef((e,t)=>{let{scale:n=10,frames:r=1/0,opacity:a=1,width:s=1,height:l=1,blur:c=1,near:u=0,far:h=10,resolution:f=512,smooth:p=!0,color:m="#000000",depthWrite:g=!1,renderOrder:v}=e,y=o(e,nU);const _=i.useRef(null),b=XD(e=>e.scene),S=XD(e=>e.gl),x=i.useRef(null);s*=Array.isArray(n)?n[0]:n||1,l*=Array.isArray(n)?n[1]:n||1;const[w,E,T,M,C,A,I]=i.useMemo(()=>{const e=new Gx(f,f),t=new Gx(f,f);t.texture.generateMipmaps=e.texture.generateMipmaps=!1;const n=new zA(s,l).rotateX(Math.PI/2),r=new nT(n),i=new iI;i.depthTest=i.depthWrite=!1,i.onBeforeCompile=e=>{e.uniforms=d(d({},e.uniforms),{},{ucolor:{value:new pE(m)}}),e.fragmentShader=e.fragmentShader.replace("void main() {","uniform vec3 ucolor;\n           void main() {\n          "),e.fragmentShader=e.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const a=new cT(eU),o=new cT(tU);return o.depthTest=a.depthTest=!1,[e,n,i,r,a,o,t]},[f,s,l,n,m]),R=e=>{M.visible=!0,M.material=C,C.uniforms.tDiffuse.value=w.texture,C.uniforms.h.value=1*e/256,S.setRenderTarget(I),S.render(M,x.current),M.material=A,A.uniforms.tDiffuse.value=I.texture,A.uniforms.v.value=1*e/256,S.setRenderTarget(w),S.render(M,x.current),M.visible=!1};let P,N,k=0;return YD(()=>{x.current&&(r===1/0||k<r)&&(k++,P=b.background,N=b.overrideMaterial,_.current.visible=!1,b.background=null,b.overrideMaterial=T,S.setRenderTarget(w),S.render(b,x.current),R(c),p&&R(.4*c),S.setRenderTarget(null),_.current.visible=!0,b.overrideMaterial=N,b.background=P)}),i.useImperativeHandle(t,()=>_.current,[]),i.createElement("group",XO({"rotation-x":Math.PI/2},y,{ref:_}),i.createElement("mesh",{renderOrder:v,geometry:E,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},i.createElement("meshBasicMaterial",{transparent:!0,map:w.texture,opacity:a,depthWrite:g})),i.createElement("orthographicCamera",{ref:x,args:[-s/2,s/2,l/2,-l/2,u,h]}))});function iU(e){let{position:t}=e;return(0,Wv.jsxs)("group",{position:t,children:[(0,Wv.jsxs)("mesh",{children:[(0,Wv.jsx)("sphereGeometry",{args:[.11,32,32]}),(0,Wv.jsx)("meshStandardMaterial",{color:"white",roughness:.1})]}),(0,Wv.jsxs)("mesh",{position:[0,0,.07],children:[(0,Wv.jsx)("sphereGeometry",{args:[.065,16,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:"#222"})]}),(0,Wv.jsxs)("mesh",{position:[.04,.04,.11],children:[(0,Wv.jsx)("sphereGeometry",{args:[.025,16,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:"white"})]})]})}function aU(){const e=(0,i.useRef)(),t=(0,i.useRef)(),n=(0,i.useRef)(),r="#FFF5E6",a="#FFB3D9",s="#FFFEF7",o="#FF1493",l="#FF9EB3",c="#10B981",u="#34D399";return YD(r=>{const i=r.clock.getElapsedTime(),a=.08*Math.sin(1.5*i);e.current.position.y=a,e.current.scale.y=1+.02*Math.sin(1.5*i),e.current.scale.x=1-.01*Math.sin(1.5*i),e.current.scale.z=1-.01*Math.sin(1.5*i),t.current.rotation.z=.12*Math.sin(2.5*i)-.15,t.current.rotation.x=.05*Math.sin(2*i),n.current.rotation.z=.15-.12*Math.sin(2.7*i),n.current.rotation.x=.05*-Math.sin(2.2*i)}),(0,Wv.jsxs)("group",{ref:e,scale:[.15,.15,.15],position:[0,-.5,-10],children:[" ",(0,Wv.jsxs)("mesh",{position:[0,.7,0],castShadow:!0,children:[(0,Wv.jsx)("sphereGeometry",{args:[.65,32,32]}),(0,Wv.jsx)("meshStandardMaterial",{color:r,roughness:.6,metalness:.1}),(0,Wv.jsxs)("mesh",{position:[0,-.15,.48],children:[(0,Wv.jsx)("sphereGeometry",{args:[.38,32,32]}),(0,Wv.jsx)("meshStandardMaterial",{color:s,roughness:.5})]})]}),(0,Wv.jsxs)("mesh",{position:[0,.4,-.55],castShadow:!0,children:[(0,Wv.jsx)("sphereGeometry",{args:[.15,16,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:s})]}),(0,Wv.jsxs)("group",{position:[0,1.5,.1],children:[(0,Wv.jsxs)("mesh",{castShadow:!0,children:[(0,Wv.jsx)("sphereGeometry",{args:[.52,32,32]}),(0,Wv.jsx)("meshStandardMaterial",{color:r,roughness:.6,metalness:.1})]}),(0,Wv.jsx)(iU,{position:[-.2,.12,.44]}),(0,Wv.jsx)(iU,{position:[.2,.12,.44]}),(0,Wv.jsxs)("mesh",{position:[-.32,-.08,.42],rotation:[0,.3,0],children:[(0,Wv.jsx)("sphereGeometry",{args:[.12,16,16],scale:[1,.6,.3]}),(0,Wv.jsx)("meshStandardMaterial",{color:l,transparent:!0,opacity:.7,roughness:.8})]}),(0,Wv.jsxs)("mesh",{position:[.32,-.08,.42],rotation:[0,-.3,0],children:[(0,Wv.jsx)("sphereGeometry",{args:[.12,16,16],scale:[1,.6,.3]}),(0,Wv.jsx)("meshStandardMaterial",{color:l,transparent:!0,opacity:.7,roughness:.8})]}),(0,Wv.jsxs)("mesh",{position:[0,-.02,.52],children:[(0,Wv.jsx)("sphereGeometry",{args:[.07,16,16],scale:[1,.9,.9]}),(0,Wv.jsx)("meshStandardMaterial",{color:o,roughness:.4})]}),(0,Wv.jsxs)("mesh",{position:[0,-.15,.48],children:[(0,Wv.jsx)("torusGeometry",{args:[.12,.015,8,24,Math.PI]}),(0,Wv.jsx)("meshStandardMaterial",{color:"#333"})]}),(0,Wv.jsx)("group",{ref:t,position:[-.25,.4,0],children:(0,Wv.jsxs)("mesh",{position:[0,.3,0],castShadow:!0,children:[(0,Wv.jsx)("capsuleGeometry",{args:[.1,.5,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:r}),(0,Wv.jsxs)("mesh",{position:[0,0,.06],children:[(0,Wv.jsx)("capsuleGeometry",{args:[.06,.4,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:a})]})]})}),(0,Wv.jsx)("group",{ref:n,position:[.25,.4,0],children:(0,Wv.jsxs)("mesh",{position:[0,.3,0],castShadow:!0,children:[(0,Wv.jsx)("capsuleGeometry",{args:[.1,.5,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:r}),(0,Wv.jsxs)("mesh",{position:[0,0,.06],children:[(0,Wv.jsx)("capsuleGeometry",{args:[.06,.4,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:a})]})]})})]}),(0,Wv.jsxs)("mesh",{position:[-.65,.7,.1],rotation:[0,0,.4],children:[(0,Wv.jsx)("capsuleGeometry",{args:[.08,.25,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:r})]}),(0,Wv.jsxs)("mesh",{position:[.65,.7,.1],rotation:[0,0,-.4],children:[(0,Wv.jsx)("capsuleGeometry",{args:[.08,.25,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:r})]}),(0,Wv.jsxs)("group",{position:[0,.12,0],children:[(0,Wv.jsxs)("group",{position:[-.25,0,0],children:[(0,Wv.jsxs)("mesh",{castShadow:!0,children:[(0,Wv.jsx)("capsuleGeometry",{args:[.14,.18,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:c,roughness:.3,metalness:.2})]}),(0,Wv.jsxs)("mesh",{position:[0,.1,0],children:[(0,Wv.jsx)("torusGeometry",{args:[.145,.02,8,24]}),(0,Wv.jsx)("meshStandardMaterial",{color:u})]})]}),(0,Wv.jsxs)("group",{position:[.25,0,0],children:[(0,Wv.jsxs)("mesh",{castShadow:!0,children:[(0,Wv.jsx)("capsuleGeometry",{args:[.14,.18,8,16]}),(0,Wv.jsx)("meshStandardMaterial",{color:c,roughness:.3,metalness:.2})]}),(0,Wv.jsxs)("mesh",{position:[0,.1,0],children:[(0,Wv.jsx)("torusGeometry",{args:[.145,.02,8,24]}),(0,Wv.jsx)("meshStandardMaterial",{color:u})]})]})]})]})}function sU(){return(0,Wv.jsxs)("div",{className:"mascot-container",children:[" ",(0,Wv.jsxs)(qO,{shadows:!0,antialias:"true",children:[(0,Wv.jsx)(QO,{makeDefault:!0,position:[0,1.5,6],fov:30}),(0,Wv.jsx)("ambientLight",{intensity:.5}),(0,Wv.jsx)("directionalLight",{position:[5,5,5],intensity:1,castShadow:!0,"shadow-mapSize":[1024,1024]}),(0,Wv.jsx)("pointLight",{position:[-5,2,2],intensity:.5,color:"#ffd1dc"}),(0,Wv.jsx)($O,{speed:2,rotationIntensity:.2,floatIntensity:.5,children:(0,Wv.jsx)(aU,{})}),(0,Wv.jsx)(rU,{position:[0,0,0],opacity:.4,scale:10,blur:2.5,far:1})]})]})}function oU(){const{currentUser:e}=Xv();return(0,Wv.jsx)(St,{children:(0,Wv.jsxs)("div",{className:"App",children:[" ",(0,Wv.jsx)("nav",{children:(0,Wv.jsxs)("ul",{children:[e&&(0,Wv.jsxs)("li",{children:[(0,Wv.jsx)(wt,{to:"/",className:"nav-link",children:"Collections"})," "]}),(0,Wv.jsx)("li",{children:e?(0,Wv.jsx)("button",{onClick:async()=>{try{await yg(Hv)}catch(ox){console.error("Error signing out:",ox)}},className:"nav-button",children:"Sign Out"}):(0,Wv.jsx)(wt,{to:"/signin",className:"nav-link",children:"Sign In"})})]})}),(0,Wv.jsxs)(He,{children:[(0,Wv.jsx)(Be,{path:"/signin",element:(0,Wv.jsx)($v,{})}),(0,Wv.jsx)(Be,{path:"/forgot-password",element:(0,Wv.jsx)(ey,{})})," ",(0,Wv.jsx)(Be,{path:"/",element:(0,Wv.jsx)(ty,{children:(0,Wv.jsx)(Jv,{})})}),(0,Wv.jsx)(Be,{path:"/collections/:id",element:(0,Wv.jsx)(ty,{children:(0,Wv.jsx)(Zv,{})})})]}),(0,Wv.jsx)(sU,{})," "]})})}const lU=function(){return(0,Wv.jsx)(Yv,{children:(0,Wv.jsx)(oU,{})})};s.createRoot(document.getElementById("root")).render((0,Wv.jsx)(i.StrictMode,{children:(0,Wv.jsx)(lU,{})}))})();
//# sourceMappingURL=main.54ac9ddc.js.map